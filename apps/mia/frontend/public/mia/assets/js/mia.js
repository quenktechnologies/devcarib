(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JOB=exports.JOBS=void 0;exports.JOBS="/mia/r/jobs";exports.JOB="/mia/r/jobs/{id}"},{}],2:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MiaFormScene=void 0;const validator_1=require("@quenk/jouvert/lib/app/scene/form/validator");class MiaFormScene extends validator_1.BaseValidatorFormScene{constructor(app,target,value={}){super(app,target,value);this.app=app;this.target=target;this.value=value}}exports.MiaFormScene=MiaFormScene},{"@quenk/jouvert/lib/app/scene/form/validator":45}],3:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MiaScene=void 0;const main_1=require("@quenk/jouvert/lib/app/scene/main");class MiaScene extends main_1.MainScene{constructor(app,resume){super(app,resume);this.app=app;this.resume=resume}}exports.MiaScene=MiaScene},{"@quenk/jouvert/lib/app/scene/main":48}],4:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MiaManager=void 0;const _1=require(".");class MiaManager extends _1.MiaScene{}exports.MiaManager=MiaManager},{".":3}],5:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Mia=exports.TIME_SEARCH_DEBOUNCE=exports.RESOURCE_JOB=exports.RESOURCE_JOBS=exports.ACTION_SHOW=exports.ACTION_REMOVE=exports.ACTION_APPROVE=void 0;const function_1=require("@quenk/noni/lib/data/function");const future_1=require("@quenk/noni/lib/control/monad/future");const display_1=require("@quenk/jouvert/lib/app/service/display");const factory_1=require("@quenk/jouvert/lib/app/remote/model/factory");const director_1=require("@quenk/jouvert/lib/app/service/director");const remote_1=require("@quenk/jouvert/lib/app/remote");const jouvert_1=require("@quenk/jouvert");const hash_1=require("@quenk/frontend-routers/lib/hash");const browser_1=require("@quenk/jhr/lib/browser");const app_1=require("./views/app");const routes_1=require("./routes");exports.ACTION_APPROVE="approve";exports.ACTION_REMOVE="remove";exports.ACTION_SHOW="show";exports.RESOURCE_JOBS="/admin/r/jobs";exports.RESOURCE_JOB="/admin/r/jobs/{id}";exports.TIME_SEARCH_DEBOUNCE=500;const REMOTE_BACKGROUD="remote.background";const agent=(0,browser_1.createAgent)();class Mia extends jouvert_1.Jouvert{constructor(appNode,dialogNode){super({log:{level:1e3,logger:console}});this.appNode=appNode;this.dialogNode=dialogNode;this.view=new app_1.MiaView(this);this.router=new hash_1.HashRouter(window,{});this.services={};this.values={header:{links:{Jobs:"/jobs"},logout:()=>this.runFuture(this.logout())}};this.onError=(e=>{console.error(e);alert("An error has occurred! Details have been logged to the console.")})}get models(){return factory_1.RemoteModelFactory.getInstance(this,this.services[REMOTE_BACKGROUD])}static create(appNode,dialogNode){return new Mia(appNode,dialogNode)}getModel(path,handler){return this.models.create(path,handler)}logout(){return confirm("Do you want to logout now?")?agent.post("/admin/logout",{}).chain(()=>{window.location.href="/admin";return(0,future_1.pure)(undefined)}):(0,future_1.pure)(undefined)}runFuture(ft){ft.fork(this.onError,function_1.noop)}spawn(t){let addr=super.spawn(t);this.services[t.id]=addr;return addr}tell(addr,msg){this.vm.tell(addr,msg);return this}run(){let viewDelegate=new display_1.HTMLElementViewDelegate(this.appNode);viewDelegate.set(this.view);this.spawn({id:"views",create:()=>new display_1.Display(new display_1.WMLLayoutViewDelegate(this.view.findById("content").get()),this)});this.spawn({id:"dialogs",create:()=>new display_1.Display(new display_1.HTMLElementViewDelegate(this.dialogNode),this)});this.spawn({id:"remote.background",create:()=>new remote_1.Remote(agent,this)});this.spawn({id:"router",create:()=>new director_1.Director(this.services.views,this.router,{},routes_1.routes,this)});this.router.start();setTimeout(()=>this.router.handleEvent(new Event("hashchanged")),100)}}exports.Mia=Mia},{"./routes":15,"./views/app":16,"@quenk/frontend-routers/lib/hash":18,"@quenk/jhr/lib/browser":25,"@quenk/jouvert":37,"@quenk/jouvert/lib/app/remote":39,"@quenk/jouvert/lib/app/remote/model/factory":40,"@quenk/jouvert/lib/app/service/director":49,"@quenk/jouvert/lib/app/service/display":50,"@quenk/noni/lib/control/monad/future":52,"@quenk/noni/lib/data/function":58}],6:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ActionColumn=exports.StatusColumn=exports.CompanyColumn=exports.TitleColumn=void 0;const views_1=require("./views");class TitleColumn{constructor(action){this.action=action;this.name="title";this.heading="Title";this.cellFragment=(c=>new views_1.TitleColumnView({job:c.datum,onClick:()=>this.action(c.datum)}))}}exports.TitleColumn=TitleColumn;class CompanyColumn{constructor(){this.name="company";this.heading="Company"}}exports.CompanyColumn=CompanyColumn;class StatusColumn{constructor(){this.name="status";this.heading="Status"}}exports.StatusColumn=StatusColumn;class ActionColumn{constructor(actions){this.actions=actions;this.name="";this.heading="Actions";this.cellFragment=(c=>new views_1.ActionColumnView({actions:this.actions,job:c.datum}))}}exports.ActionColumn=ActionColumn},{"./views":7}],7:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ActionColumnView=exports.TitleColumnView=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const drop_down_1=require("@quenk/wml-widgets/lib/control/drop-down");const menu_1=require("@quenk/wml-widgets/lib/menu/menu");const item_1=require("@quenk/wml-widgets/lib/menu/item");const link_1=require("@quenk/wml-widgets/lib/content/link");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class TitleColumnView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("td",{},[__this.widget(new link_1.Link({ww:{text:__context.job.title,onClick:__context.onClick}},[]),{ww:{text:__context.job.title,onClick:__context.onClick}})])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.TitleColumnView=TitleColumnView;class ActionColumnView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("td",{},[__this.widget(new drop_down_1.DropDown({ww:{className:"-left",buttonText:"Action"}},[__this.widget(new menu_1.Menu({},[...__forIn(__context.actions,(spec,_$$i,_$$all)=>[...spec.divider?(()=>[__this.widget(new item_1.Item({ww:{divider:true}},[]),{ww:{divider:true}})])():(()=>[])(),__this.widget(new item_1.Item({},[__this.widget(new link_1.Link({ww:{text:spec.text,onClick:()=>spec.onClick(__context.job)}},[]),{ww:{text:spec.text,onClick:()=>spec.onClick(__context.job)}})]),{})],()=>[])]),{})]),{ww:{className:"-left",buttonText:"Action"}})])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.ActionColumnView=ActionColumnView},{"@quenk/noni/lib/data/maybe":59,"@quenk/wml-widgets/lib/content/link":100,"@quenk/wml-widgets/lib/control/drop-down":116,"@quenk/wml-widgets/lib/menu/item":161,"@quenk/wml-widgets/lib/menu/menu":163,"@quenk/wml/lib/dom":169}],8:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobEditDialog=void 0;const api=require("../../../api");const future_1=require("@quenk/noni/lib/control/monad/future");const form_1=require("@quenk/jouvert/lib/app/scene/form");const display_1=require("@quenk/jouvert/lib/app/service/display");const payment_1=require("@board/common/lib/data/payment");const form_2=require("../../../common/scene/form");const edit_1=require("./views/edit");class JobEditDialog extends form_2.MiaFormScene{constructor(){super(...arguments);this.name="Job Edit Dialog";this.view=new edit_1.JobEditDialogView(this);this.jobModel=this.app.getModel(api.JOB);this.values={data:this.value,errors:{},type:{options:[{label:"Full-Time",value:"Full-Time"},{label:"Part-Time",value:"Part-Time"},{label:"Contractor",value:"Contractor"},{label:"Co-Founder",value:"Co-Founder"},{label:"Contributor",value:"Contributor"},{label:"Volunteer",value:"Volunteer"}]},payment_frequency:{options:payment_1.supportedPaymentFrequencies.map(value=>({label:value,value:value}))},onSelect:e=>{this.tell(this.self(),e)},onChange:e=>{this.tell(this.self(),e)},close:()=>{this.close();this.abort()},save:()=>{this.save()}}}onSaveOk(){this.close()}close(){this.tell(this.app.services.dialogs,new display_1.Close(this.self()))}save(){let that=this;return(0,future_1.doFuture)(function*(){yield that.jobModel.update(that.value.id,that.getModifiedValues());that.tell(that.self(),new form_1.SaveOk);return future_1.voidPure}).fork()}show(){this.tell(this.app.services.dialogs,new display_1.Show(this.name,this.view,this.self()))}}exports.JobEditDialog=JobEditDialog},{"../../../api":1,"../../../common/scene/form":2,"./views/edit":9,"@board/common/lib/data/payment":180,"@quenk/jouvert/lib/app/scene/form":44,"@quenk/jouvert/lib/app/service/display":50,"@quenk/noni/lib/control/monad/future":52}],9:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobEditDialogView=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const modal_1=require("@quenk/wml-widgets/lib/dialog/modal");const button_1=require("@quenk/wml-widgets/lib/control/button");const form_1=require("./form");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class JobEditDialogView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.widget(new modal_1.Modal({ww:{className:"-large"}},[__this.widget(new modal_1.ModalHeader({},[__document.createTextNode("Edit Job")]),{}),__this.widget(new modal_1.ModalBody({},[__this.registerView(new form_1.JobEditDialogFormView(__context)).render()]),{}),__this.widget(new modal_1.ModalFooter({},[__this.widget(new button_1.Button({ww:{onClick:__context.values.close,text:"Close"}},[]),{ww:{onClick:__context.values.close,text:"Close"}}),__this.widget(new button_1.Button({ww:{onClick:__context.values.save,text:"Save"}},[]),{ww:{onClick:__context.values.save,text:"Save"}})]),{})]),{ww:{className:"-large"}})})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.JobEditDialogView=JobEditDialogView},{"./form":10,"@quenk/noni/lib/data/maybe":59,"@quenk/wml-widgets/lib/control/button":110,"@quenk/wml-widgets/lib/dialog/modal":145,"@quenk/wml/lib/dom":169}],10:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobEditDialogFormView=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const grid_1=require("@quenk/wml-widgets/lib/layout/grid");const panel_1=require("@quenk/wml-widgets/lib/layout/panel");const job_1=require("@devcarib/widgets/lib/job/form/fields/job");const company_1=require("@devcarib/widgets/lib/job/form/fields/company");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class JobEditDialogFormView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.widget(new grid_1.GridLayout({},[__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new panel_1.Panel({},[__this.widget(new panel_1.PanelBody({},[__this.registerView(new job_1.JobFormJobFieldsView(__context.values)).render()]),{})]),{})]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new panel_1.Panel({},[__this.widget(new panel_1.PanelBody({},[__this.registerView(new company_1.JobFormCompanyFieldsView(__context.values)).render()]),{})]),{})]),{})]),{})]),{})})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.JobEditDialogFormView=JobEditDialogFormView},{"@devcarib/widgets/lib/job/form/fields/company":184,"@devcarib/widgets/lib/job/form/fields/job":185,"@quenk/noni/lib/data/maybe":59,"@quenk/wml-widgets/lib/layout/grid":150,"@quenk/wml-widgets/lib/layout/panel":157,"@quenk/wml/lib/dom":169}],11:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobPreviewDialog=void 0;const api=require("../../../api");const confirm_1=require("@quenk/jouvert/lib/app/scene/dialog/confirm");const preview_1=require("./views/preview");class JobPreviewDialog extends confirm_1.ConfirmDialog{constructor(app,job,onEdit){super(app,app.services.dialogs,"?");this.app=app;this.job=job;this.onEdit=onEdit;this.name="Job Preview Dialog";this.view=new preview_1.JobPreviewDialogView(this);this.jobModel=this.app.getModel(api.JOB);this.values={data:this.job,frame:{id:"iframe",className:"mia-preview-frame",content:getPreview(this.job)},edit:()=>{this.close();this.onEdit(this.job)},close:()=>this.close()}}}exports.JobPreviewDialog=JobPreviewDialog;const getPreview=({description_html:description_html,title:title})=>`\n<!DOCTYPE html>\n    <html>\n        <head>\n            <meta charset="utf-8">\n            <meta name="viewport" content="width=device-width, initial-scale=1.0">\n            <link rel="stylesheet" href="/assets/css/site.css">\n            <title>${title}</title>\n        </head>\n        <body style="background:#fff">\n            <div class="ww-grid-layout board-job-body">\n                ${description_html}\n            </div>\n        </body>\n    </html>\n`},{"../../../api":1,"./views/preview":12,"@quenk/jouvert/lib/app/scene/dialog/confirm":42}],12:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobPreviewDialogView=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const grid_1=require("@quenk/wml-widgets/lib/layout/grid");const modal_1=require("@quenk/wml-widgets/lib/dialog/modal");const button_1=require("@quenk/wml-widgets/lib/control/button");const features_1=require("@devcarib/widgets/lib/job/panel/features");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class JobPreviewDialogView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.widget(new modal_1.Modal({ww:{className:"-large"}},[__this.widget(new modal_1.ModalHeader({},[text(__context.values.data.company)]),{}),__this.widget(new modal_1.ModalBody({},[__this.widget(new grid_1.GridLayout({},[__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.node("h1",{},[text(__context.values.data.title)])]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.registerView(new features_1.JobFeaturesView(__context.values.data)).render()]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.node("iframe",{wml:{id:__context.values.frame.id},class:__context.values.frame.className,srcdoc:__context.values.frame.content,sandbox:"",allow:""},[])]),{})]),{})]),{})]),{}),__this.widget(new modal_1.ModalFooter({},[__this.widget(new button_1.Button({ww:{className:"-primary",onClick:__context.values.edit,text:"Edit"}},[]),{ww:{className:"-primary",onClick:__context.values.edit,text:"Edit"}}),__this.widget(new button_1.Button({ww:{onClick:__context.values.close,text:"Close"}},[]),{ww:{onClick:__context.values.close,text:"Close"}})]),{})]),{ww:{className:"-large"}})})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.JobPreviewDialogView=JobPreviewDialogView},{"@devcarib/widgets/lib/job/panel/features":186,"@quenk/noni/lib/data/maybe":59,"@quenk/wml-widgets/lib/control/button":110,"@quenk/wml-widgets/lib/dialog/modal":145,"@quenk/wml-widgets/lib/layout/grid":150,"@quenk/wml/lib/dom":169}],13:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobsManager=exports.ShowEditor=exports.TIME_SEARCH_DEBOUNCE=exports.ACTION_SHOW=exports.ACTION_REMOVE=exports.ACTION_APPROVE=void 0;const jobStatus=require("@board/common/lib/data/job");const api=require("../../api");const future_1=require("@quenk/noni/lib/control/monad/future");const string_1=require("@quenk/noni/lib/data/string");const function_1=require("@quenk/noni/lib/data/function");const timer_1=require("@quenk/noni/lib/control/timer");const browser_1=require("@quenk/jhr/lib/browser");const columns_1=require("../columns");const preview_1=require("../dialogs/preview");const manager_1=require("../../common/scene/manager");const jobs_1=require("./views/jobs");const edit_1=require("../dialogs/edit");exports.ACTION_APPROVE="approve";exports.ACTION_REMOVE="remove";exports.ACTION_SHOW="show";exports.TIME_SEARCH_DEBOUNCE=500;const agent=(0,browser_1.createAgent)();class ShowEditor{constructor(data){this.data=data}}exports.ShowEditor=ShowEditor;class JobsManager extends manager_1.MiaManager{constructor(){super(...arguments);this.name="jobs";this.view=new jobs_1.JobsManagerView(this);this.jobsModel=this.app.getModel(api.JOBS);this.values={search:{onChange:(0,timer_1.debounce)(e=>{let qry=e.value===""?{}:{q:e.value};this.search(qry)},exports.TIME_SEARCH_DEBOUNCE)},table:{id:"table",data:[],pagination:{current:{count:0,page:1,limit:50},total:{count:0,pages:0}},columns:[new columns_1.TitleColumn(job=>this.showJob(job)),new columns_1.CompanyColumn,new columns_1.StatusColumn,new columns_1.ActionColumn([{text:"View",divider:false,onClick:data=>this.showJob(data)},{text:"Approve",divider:false,onClick:data=>this.runFuture(this.approveJob(data.id))},{text:"Edit",divider:false,onClick:data=>this.editJob(data)},{text:"Remove",divider:true,onClick:data=>this.runFuture(this.removeJob(data.id))}])]}};this.onError=(e=>{console.error(e);alert("An error has occurred! Details have been logged to the console.")})}search(qry){let that=this;return(0,future_1.doFuture)(function*(){let jobs=yield that.jobsModel.search(qry);that.values.table.data=jobs;let mtable=that.view.findById(that.values.table.id);if(mtable.isJust())mtable.get().update(jobs);return future_1.voidPure})}showJob(data){this.spawn(()=>new preview_1.JobPreviewDialog(this.app,data,job=>this.editJob(job)))}approveJob(id){let that=this;return(0,future_1.doFuture)(function*(){let path=(0,string_1.interpolate)(api.JOB,{id:id});let change={status:jobStatus.JOB_STATUS_ACTIVE};let r=yield agent.patch(path,change);if(r.code==200){alert("Job approved!");that.reload()}else{alert("Could not complete request!")}return(0,future_1.pure)(undefined)})}editJob(job){this.spawn(()=>new edit_1.JobEditDialog(this.app,this.self(),job))}removeJob(id){let that=this;return(0,future_1.doFuture)(function*(){let path=(0,string_1.interpolate)(api.JOB,{id:id});let r=yield agent.delete(path);if(r.code==200){alert("Job removed!");that.reload()}else{alert("Could not complete request!")}return(0,future_1.pure)(undefined)})}runFuture(ft){ft.fork(this.onError,function_1.noop)}run(){let that=this;return(0,future_1.doFuture)(function*(){yield that.search({});console.error("show trime");that.show();return future_1.voidPure})}}exports.JobsManager=JobsManager},{"../../api":1,"../../common/scene/manager":4,"../columns":6,"../dialogs/edit":8,"../dialogs/preview":11,"./views/jobs":14,"@board/common/lib/data/job":179,"@quenk/jhr/lib/browser":25,"@quenk/noni/lib/control/monad/future":52,"@quenk/noni/lib/control/timer":54,"@quenk/noni/lib/data/function":58,"@quenk/noni/lib/data/string":62}],14:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobsManagerView=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const grid_1=require("@quenk/wml-widgets/lib/layout/grid");const table_1=require("@quenk/wml-widgets/lib/data/table");const text_field_1=require("@quenk/wml-widgets/lib/control/text-field");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class JobsManagerView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.widget(new grid_1.GridLayout({},[__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.node("h1",{},[__document.createTextNode("Manage Jobs")])]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new text_field_1.TextField({ww:{placeholder:"Search",onChange:__context.values.search.onChange}},[]),{ww:{placeholder:"Search",onChange:__context.values.search.onChange}})]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new table_1.DataTable({wml:{id:__context.values.table.id},ww:{data:__context.values.table.data,columns:__context.values.table.columns}},[]),{wml:{id:__context.values.table.id},ww:{data:__context.values.table.data,columns:__context.values.table.columns}})]),{})]),{})]),{})})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.JobsManagerView=JobsManagerView},{"@quenk/noni/lib/data/maybe":59,"@quenk/wml-widgets/lib/control/text-field":134,"@quenk/wml-widgets/lib/data/table":142,"@quenk/wml-widgets/lib/layout/grid":150,"@quenk/wml/lib/dom":169}],15:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.routes=void 0;const array_1=require("@quenk/noni/lib/data/array");const template_1=require("@quenk/potoo/lib/actor/template");const manager_1=require("./jobs/manager");let ignoredErrors=["ClientError","ServerError"];const trap=e=>(0,array_1.contains)(ignoredErrors,e.message)?template_1.ACTION_IGNORE:template_1.ACTION_RAISE;exports.routes={"/":{id:"dashboard",trap:trap,create:(s,_,r)=>new manager_1.JobsManager(s,r)}}},{"./jobs/manager":13,"@quenk/noni/lib/data/array":55,"@quenk/potoo/lib/actor/template":97}],16:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MiaView=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const nav_bar_1=require("@quenk/wml-widgets/lib/layout/nav-bar");const nav_1=require("@quenk/wml-widgets/lib/menu/nav");const item_1=require("@quenk/wml-widgets/lib/menu/item");const link_1=require("@quenk/wml-widgets/lib/content/link");const main_1=require("@quenk/wml-widgets/lib/layout/main");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class MiaView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("div",{wml:{id:"main"}},[__this.widget(new nav_bar_1.NavBar({className:"mia-navbar-bar",links:__context.values.header.links},[__this.widget(new nav_1.Nav({ww:{className:"mia-logout"}},[__this.widget(new item_1.Item({},[__this.widget(new link_1.Link({ww:{text:"Logout",onClick:__context.values.header.logout}},[]),{ww:{text:"Logout",onClick:__context.values.header.logout}})]),{})]),{ww:{className:"mia-logout"}})]),{className:"mia-navbar-bar",links:__context.values.header.links}),__this.widget(new main_1.MainLayout({wml:{id:"content"},ww:{className:"mia-content"}},[]),{wml:{id:"content"},ww:{className:"mia-content"}})])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.MiaView=MiaView},{"@quenk/noni/lib/data/maybe":59,"@quenk/wml-widgets/lib/content/link":100,"@quenk/wml-widgets/lib/layout/main":153,"@quenk/wml-widgets/lib/layout/nav-bar":155,"@quenk/wml-widgets/lib/menu/item":161,"@quenk/wml-widgets/lib/menu/nav":166,"@quenk/wml/lib/dom":169}],17:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const app_1=require("./app");window.system=app_1.Mia.create(document.getElementById("app"),document.getElementById("dialogs"));window.system.run()},{"./app":5}],18:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.compile=exports.takeHash=exports.HashRouter=exports.DefaultRequest=exports.AbstractHashRouter=exports.Cache=void 0;var qs=require("qs");var toRegex=require("path-to-regexp");var function_1=require("@quenk/noni/lib/data/function");var future_1=require("@quenk/noni/lib/control/monad/future");var record_1=require("@quenk/noni/lib/data/record");var EVENT_HASH_CHANGED="hashchange";var Cache=function(){function Cache(regex,keys,filters,handler){this.regex=regex;this.keys=keys;this.filters=filters;this.handler=handler}return Cache}();exports.Cache=Cache;var AbstractHashRouter=function(){function AbstractHashRouter(window,routes){if(routes===void 0){routes={}}this.window=window;this.routes=routes;this.cache=[];this.keys=[]}AbstractHashRouter.prototype.handleEvent=function(_){var _this=this;var _a=exports.takeHash(this.window),path=_a[0],query=_a[1];var cache=this.cache;var mware=[];var handler=function(){return future_1.pure(undefined)};var keys=[];var r=null;var count=0;while(r==null&&count<cache.length){r=cache[count].regex.exec(path);keys=cache[count].keys;mware=cache[count].filters;handler=cache[count].handler;count=count+1}if(r!=null){var ft=this.createRequest(path,qs.parse(query),parseParams(keys,r));mware.reduce(function(p,c){return p.chain(c)},ft).chain(handler).catch(function(e){return _this.onError(e)}).fork(console.error,function_1.noop)}else{this.onNotFound(path).fork(console.error,function_1.noop)}};AbstractHashRouter.prototype.add=function(path,handler){if(this.routes.hasOwnProperty(path)){this.routes[path][1]=handler}else{this.routes[path]=[[],handler]}this.cache=exports.compile(this.routes);return this};AbstractHashRouter.prototype.use=function(path,mware){if(this.routes.hasOwnProperty(path)){this.routes[path][0].push(mware)}else{this.routes[path]=[[mware],function(){return future_1.pure(undefined)}]}this.cache=exports.compile(this.routes);return this};AbstractHashRouter.prototype.clear=function(){this.cache=[];this.routes={}};AbstractHashRouter.prototype.start=function(){this.window.addEventListener(EVENT_HASH_CHANGED,this);return this};AbstractHashRouter.prototype.stop=function(){this.window.removeEventListener(EVENT_HASH_CHANGED,this);return this};return AbstractHashRouter}();exports.AbstractHashRouter=AbstractHashRouter;var DefaultRequest=function(){function DefaultRequest(path,query,params){this.path=path;this.query=query;this.params=params}return DefaultRequest}();exports.DefaultRequest=DefaultRequest;var HashRouter=function(_super){__extends(HashRouter,_super);function HashRouter(window,routes,error,notFound){if(routes===void 0){routes={}}if(error===void 0){error=function(e){return future_1.raise(e)}}if(notFound===void 0){notFound=function(){return future_1.pure(function_1.noop())}}var _this=_super.call(this,window,routes)||this;_this.window=window;_this.routes=routes;_this.error=error;_this.notFound=notFound;return _this}HashRouter.prototype.createRequest=function(path,query,params){return future_1.pure(new DefaultRequest(path,query,params))};HashRouter.prototype.onError=function(e){return this.error(e)};HashRouter.prototype.onNotFound=function(path){return this.notFound(path)};return HashRouter}(AbstractHashRouter);exports.HashRouter=HashRouter;var parseParams=function(keys,results){var params=Object.create(null);keys.forEach(function(key,index){return params[key.name]=results[index+1]});return params};exports.takeHash=function(w){return w.location.hash!=null&&w.location.hash!=""?w.location.hash.replace(/^#/,"/").replace(/\/\//g,"/").split("?"):["/"]};exports.compile=function(r){return record_1.reduce(r,[],function(p,c,path){var keys=[];return p.concat(new Cache(toRegex.pathToRegexp(path,keys),keys,c[0],c[1]))})}},{"@quenk/noni/lib/control/monad/future":52,"@quenk/noni/lib/data/function":58,"@quenk/noni/lib/data/record":60,"path-to-regexp":19,qs:174}],19:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.pathToRegexp=exports.tokensToRegexp=exports.regexpToFunction=exports.match=exports.tokensToFunction=exports.compile=exports.parse=void 0;function lexer(str){var tokens=[];var i=0;while(i<str.length){var char=str[i];if(char==="*"||char==="+"||char==="?"){tokens.push({type:"MODIFIER",index:i,value:str[i++]});continue}if(char==="\\"){tokens.push({type:"ESCAPED_CHAR",index:i++,value:str[i++]});continue}if(char==="{"){tokens.push({type:"OPEN",index:i,value:str[i++]});continue}if(char==="}"){tokens.push({type:"CLOSE",index:i,value:str[i++]});continue}if(char===":"){var name="";var j=i+1;while(j<str.length){var code=str.charCodeAt(j);if(code>=48&&code<=57||code>=65&&code<=90||code>=97&&code<=122||code===95){name+=str[j++];continue}break}if(!name)throw new TypeError("Missing parameter name at "+i);tokens.push({type:"NAME",index:i,value:name});i=j;continue}if(char==="("){var count=1;var pattern="";var j=i+1;if(str[j]==="?"){throw new TypeError('Pattern cannot start with "?" at '+j)}while(j<str.length){if(str[j]==="\\"){pattern+=str[j++]+str[j++];continue}if(str[j]===")"){count--;if(count===0){j++;break}}else if(str[j]==="("){count++;if(str[j+1]!=="?"){throw new TypeError("Capturing groups are not allowed at "+j)}}pattern+=str[j++]}if(count)throw new TypeError("Unbalanced pattern at "+i);if(!pattern)throw new TypeError("Missing pattern at "+i);tokens.push({type:"PATTERN",index:i,value:pattern});i=j;continue}tokens.push({type:"CHAR",index:i,value:str[i++]})}tokens.push({type:"END",index:i,value:""});return tokens}function parse(str,options){if(options===void 0){options={}}var tokens=lexer(str);var _a=options.prefixes,prefixes=_a===void 0?"./":_a;var defaultPattern="[^"+escapeString(options.delimiter||"/#?")+"]+?";var result=[];var key=0;var i=0;var path="";var tryConsume=function(type){if(i<tokens.length&&tokens[i].type===type)return tokens[i++].value};var mustConsume=function(type){var value=tryConsume(type);if(value!==undefined)return value;var _a=tokens[i],nextType=_a.type,index=_a.index;throw new TypeError("Unexpected "+nextType+" at "+index+", expected "+type)};var consumeText=function(){var result="";var value;while(value=tryConsume("CHAR")||tryConsume("ESCAPED_CHAR")){result+=value}return result};while(i<tokens.length){var char=tryConsume("CHAR");var name=tryConsume("NAME");var pattern=tryConsume("PATTERN");if(name||pattern){var prefix=char||"";if(prefixes.indexOf(prefix)===-1){path+=prefix;prefix=""}if(path){result.push(path);path=""}result.push({name:name||key++,prefix:prefix,suffix:"",pattern:pattern||defaultPattern,modifier:tryConsume("MODIFIER")||""});continue}var value=char||tryConsume("ESCAPED_CHAR");if(value){path+=value;continue}if(path){result.push(path);path=""}var open=tryConsume("OPEN");if(open){var prefix=consumeText();var name_1=tryConsume("NAME")||"";var pattern_1=tryConsume("PATTERN")||"";var suffix=consumeText();mustConsume("CLOSE");result.push({name:name_1||(pattern_1?key++:""),pattern:name_1&&!pattern_1?defaultPattern:pattern_1,prefix:prefix,suffix:suffix,modifier:tryConsume("MODIFIER")||""});continue}mustConsume("END")}return result}exports.parse=parse;function compile(str,options){return tokensToFunction(parse(str,options),options)}exports.compile=compile;function tokensToFunction(tokens,options){if(options===void 0){options={}}var reFlags=flags(options);var _a=options.encode,encode=_a===void 0?function(x){return x}:_a,_b=options.validate,validate=_b===void 0?true:_b;var matches=tokens.map(function(token){if(typeof token==="object"){return new RegExp("^(?:"+token.pattern+")$",reFlags)}});return function(data){var path="";for(var i=0;i<tokens.length;i++){var token=tokens[i];if(typeof token==="string"){path+=token;continue}var value=data?data[token.name]:undefined;var optional=token.modifier==="?"||token.modifier==="*";var repeat=token.modifier==="*"||token.modifier==="+";if(Array.isArray(value)){if(!repeat){throw new TypeError('Expected "'+token.name+'" to not repeat, but got an array')}if(value.length===0){if(optional)continue;throw new TypeError('Expected "'+token.name+'" to not be empty')}for(var j=0;j<value.length;j++){var segment=encode(value[j],token);if(validate&&!matches[i].test(segment)){throw new TypeError('Expected all "'+token.name+'" to match "'+token.pattern+'", but got "'+segment+'"')}path+=token.prefix+segment+token.suffix}continue}if(typeof value==="string"||typeof value==="number"){var segment=encode(String(value),token);if(validate&&!matches[i].test(segment)){throw new TypeError('Expected "'+token.name+'" to match "'+token.pattern+'", but got "'+segment+'"')}path+=token.prefix+segment+token.suffix;continue}if(optional)continue;var typeOfMessage=repeat?"an array":"a string";throw new TypeError('Expected "'+token.name+'" to be '+typeOfMessage)}return path}}exports.tokensToFunction=tokensToFunction;function match(str,options){var keys=[];var re=pathToRegexp(str,keys,options);return regexpToFunction(re,keys,options)}exports.match=match;function regexpToFunction(re,keys,options){if(options===void 0){options={}}var _a=options.decode,decode=_a===void 0?function(x){return x}:_a;return function(pathname){var m=re.exec(pathname);if(!m)return false;var path=m[0],index=m.index;var params=Object.create(null);var _loop_1=function(i){if(m[i]===undefined)return"continue";var key=keys[i-1];if(key.modifier==="*"||key.modifier==="+"){params[key.name]=m[i].split(key.prefix+key.suffix).map(function(value){return decode(value,key)})}else{params[key.name]=decode(m[i],key)}};for(var i=1;i<m.length;i++){_loop_1(i)}return{path:path,index:index,params:params}}}exports.regexpToFunction=regexpToFunction;function escapeString(str){return str.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function flags(options){return options&&options.sensitive?"":"i"}function regexpToRegexp(path,keys){if(!keys)return path;var groupsRegex=/\((?:\?<(.*?)>)?(?!\?)/g;var index=0;var execResult=groupsRegex.exec(path.source);while(execResult){keys.push({name:execResult[1]||index++,prefix:"",suffix:"",modifier:"",pattern:""});execResult=groupsRegex.exec(path.source)}return path}function arrayToRegexp(paths,keys,options){var parts=paths.map(function(path){return pathToRegexp(path,keys,options).source});return new RegExp("(?:"+parts.join("|")+")",flags(options))}function stringToRegexp(path,keys,options){return tokensToRegexp(parse(path,options),keys,options)}function tokensToRegexp(tokens,keys,options){if(options===void 0){options={}}var _a=options.strict,strict=_a===void 0?false:_a,_b=options.start,start=_b===void 0?true:_b,_c=options.end,end=_c===void 0?true:_c,_d=options.encode,encode=_d===void 0?function(x){return x}:_d;var endsWith="["+escapeString(options.endsWith||"")+"]|$";var delimiter="["+escapeString(options.delimiter||"/#?")+"]";var route=start?"^":"";for(var _i=0,tokens_1=tokens;_i<tokens_1.length;_i++){var token=tokens_1[_i];if(typeof token==="string"){route+=escapeString(encode(token))}else{var prefix=escapeString(encode(token.prefix));var suffix=escapeString(encode(token.suffix));if(token.pattern){if(keys)keys.push(token);if(prefix||suffix){if(token.modifier==="+"||token.modifier==="*"){var mod=token.modifier==="*"?"?":"";route+="(?:"+prefix+"((?:"+token.pattern+")(?:"+suffix+prefix+"(?:"+token.pattern+"))*)"+suffix+")"+mod}else{route+="(?:"+prefix+"("+token.pattern+")"+suffix+")"+token.modifier}}else{route+="("+token.pattern+")"+token.modifier}}else{route+="(?:"+prefix+suffix+")"+token.modifier}}}if(end){if(!strict)route+=delimiter+"?";route+=!options.endsWith?"$":"(?="+endsWith+")"}else{var endToken=tokens[tokens.length-1];var isEndDelimited=typeof endToken==="string"?delimiter.indexOf(endToken[endToken.length-1])>-1:endToken===undefined;if(!strict){route+="(?:"+delimiter+"(?="+endsWith+"))?"}if(!isEndDelimited){route+="(?="+delimiter+"|"+endsWith+")"}}return new RegExp(route,flags(options))}exports.tokensToRegexp=tokensToRegexp;function pathToRegexp(path,keys,options){if(path instanceof RegExp)return regexpToRegexp(path,keys);if(Array.isArray(path))return arrayToRegexp(path,keys,options);return stringToRegexp(path,keys,options)}exports.pathToRegexp=pathToRegexp},{}],20:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Agent=exports.defaultOptions=void 0;var util=require("../util");var record_1=require("@quenk/noni/lib/data/record");var future_1=require("@quenk/noni/lib/control/monad/future");var string_1=require("@quenk/noni/lib/data/string");var request_1=require("../request");exports.defaultOptions={ttl:0,tags:{},context:{}};var Agent=function(){function Agent(host,headers,cookies,options,transport,plugins){this.host=host;this.headers=headers;this.cookies=cookies;this.options=options;this.transport=transport;this.plugins=plugins}Agent.prototype.setTransport=function(transport,plugins){if(plugins===void 0){plugins=[]}var _a=this,host=_a.host,headers=_a.headers,cookies=_a.cookies,options=_a.options;return new Agent(host,headers,cookies,options,transport,plugins)};Agent.prototype.head=function(path,params,headers){if(params===void 0){params={}}if(headers===void 0){headers={}}return this.send(new request_1.Head(path,params,headers))};Agent.prototype.get=function(path,params,headers){if(params===void 0){params={}}if(headers===void 0){headers={}}return this.send(new request_1.Get(path,params,headers))};Agent.prototype.post=function(path,body,headers){if(headers===void 0){headers={}}return this.send(new request_1.Post(path,body,headers))};Agent.prototype.put=function(path,body,headers){if(headers===void 0){headers={}}return this.send(new request_1.Put(path,body,headers))};Agent.prototype.patch=function(path,body,headers){if(headers===void 0){headers={}}return this.send(new request_1.Patch(path,body,headers))};Agent.prototype.delete=function(path,body,headers){return this.send(new request_1.Delete(path,body,headers))};Agent.prototype.send=function(req){var _a=this,host=_a.host,cookies=_a.cookies,headers=_a.headers,transport=_a.transport,plugins=_a.plugins;var options=(0,record_1.rmerge3)(exports.defaultOptions,this.options,req.options);var port=options.port;var method=req.method,params=req.params,body=req.body;var tags=options.tags,context=options.context,ttl=options.ttl;var path=util.urlFromString((0,string_1.interpolate)(req.path,context),params);var ctx={host:host,port:port,method:method,path:path,body:body,headers:headers,cookies:cookies,options:{ttl:ttl,tags:tags,context:context}};var ft=plugins.reduce(function(f,p){return f.chain(function(c){return p.beforeRequest(c)})},(0,future_1.pure)(ctx));return ft.chain(function(ctx){return transport.send(ctx)}).chain(function(r){return plugins.reduce(function(f,p){return f.chain(function(res){return p.afterResponse(res)})},(0,future_1.pure)(r))})};return Agent}();exports.Agent=Agent},{"../request":30,"../util":34,"@quenk/noni/lib/control/monad/future":52,"@quenk/noni/lib/data/record":60,"@quenk/noni/lib/data/string":62}],21:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JSONParser=void 0;var record_1=require("@quenk/noni/lib/data/record");var error_1=require("@quenk/noni/lib/control/error");var either_1=require("@quenk/noni/lib/data/either");var defaultOptions={prefix:/^\)\]\}',?\n/,lenient:false};var JSONParser=function(){function JSONParser(options){if(options===void 0){options={}}this.options=options;this.responseType="";this.accepts="application/json";this.opts=(0,record_1.merge)(defaultOptions,this.options)}JSONParser.prototype.apply=function(body){var _a=this.opts,prefix=_a.prefix,lenient=_a.lenient;var str=body.replace(prefix,"");var eresult=(0,error_1.attempt)(function(){return JSON.parse(str)});return eresult.isLeft()&&lenient?(0,either_1.right)({}):eresult};return JSONParser}();exports.JSONParser=JSONParser},{"@quenk/noni/lib/control/error":51,"@quenk/noni/lib/data/either":57,"@quenk/noni/lib/data/record":60}],22:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CSRFProtectionPlugin=exports.DEFAULT_CSRF_HEADER_NAME=exports.DEFAULT_CSRF_COOKIE_NAME=void 0;var future_1=require("@quenk/noni/lib/control/monad/future");var record_1=require("@quenk/noni/lib/data/record");exports.DEFAULT_CSRF_COOKIE_NAME="xsrf-token";exports.DEFAULT_CSRF_HEADER_NAME="x-xsrf-token";var CSRFProtectionPlugin=function(){function CSRFProtectionPlugin(cookie,header){if(cookie===void 0){cookie=exports.DEFAULT_CSRF_COOKIE_NAME}if(header===void 0){header=exports.DEFAULT_CSRF_HEADER_NAME}this.cookie=cookie;this.header=header}CSRFProtectionPlugin.prototype.beforeRequest=function(ctx){var _a;var mvalue=ctx.cookies.getCookie(this.cookie);if(mvalue.isJust())ctx.headers=(0,record_1.merge)(ctx.headers,(_a={},_a[this.header]=mvalue.get().value,_a));return(0,future_1.pure)(ctx)};CSRFProtectionPlugin.prototype.afterResponse=function(r){return(0,future_1.pure)(r)};return CSRFProtectionPlugin}();exports.CSRFProtectionPlugin=CSRFProtectionPlugin},{"@quenk/noni/lib/control/monad/future":52,"@quenk/noni/lib/data/record":60}],23:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JSONTransform=void 0;var util=require("../../util");var error_1=require("@quenk/noni/lib/control/error");var JSONTransform=function(){function JSONTransform(){this.type="application/json;charset=utf-8"}JSONTransform.prototype.apply=function(body){return(0,error_1.attempt)(function(){return util.isObject(body)&&!util.isFile(body)&&!util.isBlob(body)&&!util.isFormData(body)?JSON.stringify(body):""+body})};return JSONTransform}();exports.JSONTransform=JSONTransform},{"../../util":34,"@quenk/noni/lib/control/error":51}],24:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.XHRTransport=void 0;var future_1=require("@quenk/noni/lib/control/monad/future");var header_1=require("../../header");var response_1=require("../../response");var method_1=require("../../request/method");var headers_1=require("../../headers");var XHRTransport=function(){function XHRTransport(responseType,transform,parser){if(responseType===void 0){responseType=""}this.responseType=responseType;this.transform=transform;this.parser=parser}XHRTransport.prototype.send=function(ctx){var _this=this;var _a=this,parser=_a.parser,transform=_a.transform;var host=ctx.host,port=ctx.port,path=ctx.path,method=ctx.method,body=ctx.body,headers=ctx.headers,options=ctx.options,cookies=ctx.cookies;var xhr=new XMLHttpRequest;var portNumer=port&&port!==80&&port!==443?":"+port:"";var url=""+host+portNumer+(path[0]==="/"?"":"/")+path;return new future_1.Run(function(onError,onSuccess){var transBody=undefined;if(body!=null){var exceptBody=transform.apply(body);if(exceptBody.isLeft()){onError(new Error(exceptBody.takeLeft().message));return function(){}}else{transBody=exceptBody.takeRight()}}xhr.open(method,url,true);xhr.onload=function(){cookies.setCookies(document.cookie.split(";"));var exceptRes=parser.apply(xhr.response);if(exceptRes.isLeft()){onError(new Error(exceptRes.takeLeft().message))}else{var r=(0,response_1.createResponse)(xhr.status,exceptRes.takeRight(),(0,header_1.fromString)(xhr.getAllResponseHeaders()),options);onSuccess(r)}};xhr.timeout=options.ttl;xhr.responseType=_this.responseType;xhr.onerror=function(){return onError(new Error("TransportError"))};xhr.onabort=function(){return onError(new Error("AbortError"))};Object.keys(headers).forEach(function(k){xhr.setRequestHeader(k,headers[k])});if(method===method_1.Method.Get||method===method_1.Method.Head)xhr.setRequestHeader(headers_1.ACCEPTS,parser.accepts);else if(transform.type!=="multipart/form-data")xhr.setRequestHeader(headers_1.CONTENT_TYPE,transform.type);xhr.send(transBody);return function(){return xhr.abort()}})};return XHRTransport}();exports.XHRTransport=XHRTransport},{"../../header":28,"../../headers":29,"../../request/method":31,"../../response":32,"@quenk/noni/lib/control/monad/future":52}],25:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.get=exports.createAgent=exports.splitUrl=void 0;var document_1=require("./cookie/container/document");var json_1=require("./agent/transform/json");var json_2=require("./agent/parser/json");var xhr_1=require("./agent/transport/xhr");var request_1=require("./request");var csrf_1=require("./agent/plugin/csrf");var agent_1=require("./agent");var HTTP="http://";var HTTPS="https://";var splitUrl=function(url){var split=url.split(HTTP).join("").split(HTTPS).join("").split("/");if(split.length===1||split.length===2&&split[1]==="")return[split[0],"/"];return[split[0],"/"+split.slice(1).join("/")]};exports.splitUrl=splitUrl;var createAgent=function(host,port){if(host===void 0){host=getHost()}if(port===void 0){port=getPort()}return new agent_1.Agent(host,{},document_1.DocumentContainer.create(),{ttl:0,tags:{},context:{},port:port},new xhr_1.XHRTransport("",new json_1.JSONTransform,new json_2.JSONParser({lenient:true})),[new csrf_1.CSRFProtectionPlugin])};exports.createAgent=createAgent;var getHost=function(){return window.location.protocol+"//"+window.location.hostname};var getPort=function(){var port=window.location.port;return Number(port===""||port==null?80:port)};var get=function(url,params,headers){if(params===void 0){params={}}if(headers===void 0){headers={}}var _a=(0,exports.splitUrl)(url),host=_a[0],path=_a[1];return(0,exports.createAgent)(host).send(new request_1.Get(path,params,headers))};exports.get=get},{"./agent":20,"./agent/parser/json":21,"./agent/plugin/csrf":22,"./agent/transform/json":23,"./agent/transport/xhr":24,"./cookie/container/document":26,"./request":30}],26:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DocumentContainer=void 0;var record_1=require("@quenk/noni/lib/data/record");var __1=require("../");var DocumentContainer=function(){function DocumentContainer(store,cookies){if(store===void 0){store=document}if(cookies===void 0){cookies={}}this.store=store;this.cookies=cookies}DocumentContainer.create=function(store){if(store===void 0){store=document}return new DocumentContainer(store,(0,__1.fromCookieHeader)(store.cookie))};DocumentContainer.prototype.getCookies=function(){return(0,record_1.make)(this.cookies)};DocumentContainer.prototype.getCookie=function(name){return(0,__1.getCookieByName)(this.cookies,name)};DocumentContainer.prototype.setCookies=function(_){this.cookies=(0,__1.fromCookieHeader)(this.store.cookie);return this};return DocumentContainer}();exports.DocumentContainer=DocumentContainer},{"../":27,"@quenk/noni/lib/data/record":60}],27:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.toCookieHeader=exports.getCookieByName=exports.fromList=exports.fromCookieHeader=void 0;var record_1=require("@quenk/noni/lib/data/record");var fromCookieHeader=function(str){var rec=(0,record_1.make)();var cookies=str.split(";");var created=new Date;for(var i=0;i<cookies.length;i++){var cookie=cookies[i];var cookieLength=cookie.length;var delimIdx=cookie.indexOf("=");delimIdx=delimIdx<0?cookieLength:delimIdx;var name_1=decodeURIComponent(cookie.substring(0,delimIdx).replace(/^\s+|\s+$/g,""));var value=decodeURIComponent(cookie.substring(delimIdx+1,cookieLength));var c={name:name_1,value:value,created:created};rec[getPath(c)]=c}return rec};exports.fromCookieHeader=fromCookieHeader;var fromList=function(list){return list.reduce(function(p,c){var _a;return(0,record_1.merge)(p,(_a={},_a[getPath(c)]=c,_a))},{})};exports.fromList=fromList;var getPath=function(c){return[c.name,c.domain,c.path].join(";;")};var getCookieByName=function(store,name){return(0,record_1.pickValue)(store,function(c){return c.name===name})};exports.getCookieByName=getCookieByName;var toCookieHeader=function(store){return(0,record_1.mapTo)(store,function(c){return c.name+"="+c.value}).join("; ")};exports.toCookieHeader=toCookieHeader},{"@quenk/noni/lib/data/record":60}],28:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.set=exports.fromString=void 0;var fromString=function(headers){if(!headers)return{};var result={};headers.trim().split("\n").forEach(function(row){var index=row.indexOf(":");var key=row.slice(0,index).toLowerCase().trim();var value=row.slice(index+1).trim();if(typeof result[key]==="undefined"){result[key]=value}else if(Array.isArray(result[key])){result[key].push(value)}else{result[key]=[result[key],value]}});return result};exports.fromString=fromString;var set=function(xhr){var args=[];for(var _i=1;_i<arguments.length;_i++){args[_i-1]=arguments[_i]}var i=args.length;if(args.length>0)while(i--)if(i!==0)Object.keys(args[i]).forEach(function(k){if(args[i][k]!=null)xhr.setRequestHeader(k,args[i][k])})};exports.set=set},{}],29:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ACCEPTS=exports.CONTENT_TYPE=void 0;exports.CONTENT_TYPE="Content-Type";exports.ACCEPTS="Accept"},{}],30:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Delete=exports.Patch=exports.Put=exports.Post=exports.Get=exports.Head=void 0;var method_1=require("./method");var Head=function(){function Head(path,params,headers,options){if(headers===void 0){headers={}}if(options===void 0){options={ttl:0,tags:{},context:{}}}this.path=path;this.params=params;this.headers=headers;this.options=options;this.method=method_1.Method.Head}return Head}();exports.Head=Head;var Get=function(_super){__extends(Get,_super);function Get(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.method=method_1.Method.Get;return _this}return Get}(Head);exports.Get=Get;var Post=function(){function Post(path,body,headers,options){if(headers===void 0){headers={}}if(options===void 0){options={ttl:0,tags:{},context:{}}}this.path=path;this.body=body;this.headers=headers;this.options=options;this.method=method_1.Method.Post}return Post}();exports.Post=Post;var Put=function(_super){__extends(Put,_super);function Put(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.method=method_1.Method.Put;return _this}return Put}(Post);exports.Put=Put;var Patch=function(_super){__extends(Patch,_super);function Patch(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.method=method_1.Method.Patch;return _this}return Patch}(Post);exports.Patch=Patch;var Delete=function(_super){__extends(Delete,_super);function Delete(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.method=method_1.Method.Delete;return _this}return Delete}(Post);exports.Delete=Delete},{"./method":31}],31:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Method=void 0;var Method;(function(Method){Method["Head"]="HEAD";Method["Get"]="GET";Method["Put"]="PUT";Method["Post"]="POST";Method["Delete"]="DELETE";Method["Patch"]="PATCH"})(Method=exports.Method||(exports.Method={}))},{}],32:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.createResponse=exports.InternalServerError=exports.ServerError=exports.Conflict=exports.NotFound=exports.Forbidden=exports.Unauthorized=exports.BadRequest=exports.ClientError=exports.Created=exports.NoContent=exports.Accepted=exports.Ok=exports.Success=exports.GenericResponse=void 0;var status=require("./status");var GenericResponse=function(){function GenericResponse(code,body,headers,options){this.code=code;this.body=body;this.headers=headers;this.options=options}return GenericResponse}();exports.GenericResponse=GenericResponse;var Success=function(_super){__extends(Success,_super);function Success(){return _super!==null&&_super.apply(this,arguments)||this}return Success}(GenericResponse);exports.Success=Success;var Ok=function(_super){__extends(Ok,_super);function Ok(body,headers,options){var _this=_super.call(this,status.OK,body,headers,options)||this;_this.body=body;_this.headers=headers;_this.options=options;return _this}return Ok}(Success);exports.Ok=Ok;var Accepted=function(_super){__extends(Accepted,_super);function Accepted(body,headers,options){var _this=_super.call(this,status.ACCEPTED,body,headers,options)||this;_this.body=body;_this.headers=headers;_this.options=options;return _this}return Accepted}(Success);exports.Accepted=Accepted;var NoContent=function(_super){__extends(NoContent,_super);function NoContent(body,headers,options){var _this=_super.call(this,status.NO_CONTENT,body,headers,options)||this;_this.body=body;_this.headers=headers;_this.options=options;return _this}return NoContent}(Success);exports.NoContent=NoContent;var Created=function(_super){__extends(Created,_super);function Created(body,headers,options){var _this=_super.call(this,status.CREATED,body,headers,options)||this;_this.body=body;_this.headers=headers;_this.options=options;return _this}return Created}(Success);exports.Created=Created;var ClientError=function(_super){__extends(ClientError,_super);function ClientError(){return _super!==null&&_super.apply(this,arguments)||this}return ClientError}(GenericResponse);exports.ClientError=ClientError;var BadRequest=function(_super){__extends(BadRequest,_super);function BadRequest(body,headers,options){var _this=_super.call(this,status.BAD_REQUEST,body,headers,options)||this;_this.body=body;_this.headers=headers;_this.options=options;return _this}return BadRequest}(ClientError);exports.BadRequest=BadRequest;var Unauthorized=function(_super){__extends(Unauthorized,_super);function Unauthorized(body,headers,options){var _this=_super.call(this,status.UNAUTHORIZED,body,headers,options)||this;_this.body=body;_this.headers=headers;_this.options=options;return _this}return Unauthorized}(ClientError);exports.Unauthorized=Unauthorized;var Forbidden=function(_super){__extends(Forbidden,_super);function Forbidden(body,headers,options){var _this=_super.call(this,status.FORBIDDEN,body,headers,options)||this;_this.body=body;_this.headers=headers;_this.options=options;return _this}return Forbidden}(ClientError);exports.Forbidden=Forbidden;var NotFound=function(_super){__extends(NotFound,_super);function NotFound(body,headers,options){var _this=_super.call(this,status.NOT_FOUND,body,headers,options)||this;_this.body=body;_this.headers=headers;_this.options=options;return _this}return NotFound}(ClientError);exports.NotFound=NotFound;var Conflict=function(_super){__extends(Conflict,_super);function Conflict(body,headers,options){var _this=_super.call(this,status.CONFLICT,body,headers,options)||this;_this.body=body;_this.headers=headers;_this.options=options;return _this}return Conflict}(ClientError);exports.Conflict=Conflict;var ServerError=function(_super){__extends(ServerError,_super);function ServerError(){return _super!==null&&_super.apply(this,arguments)||this}return ServerError}(GenericResponse);exports.ServerError=ServerError;var InternalServerError=function(_super){__extends(InternalServerError,_super);function InternalServerError(body,headers,options){var _this=_super.call(this,status.INTERNAL_SERVER_ERROR,body,headers,options)||this;_this.body=body;_this.headers=headers;_this.options=options;_this.status=status.INTERNAL_SERVER_ERROR;return _this}return InternalServerError}(ServerError);exports.InternalServerError=InternalServerError;var createResponse=function(code,body,headers,options){switch(code){case status.OK:return new Ok(body,headers,options);case status.ACCEPTED:return new Accepted(body,headers,options);case status.NO_CONTENT:return new NoContent(body,headers,options);case status.CREATED:return new Created(body,headers,options);case status.BAD_REQUEST:return new BadRequest(body,headers,options);case status.BAD_REQUEST:return new BadRequest(body,headers,options);case status.UNAUTHORIZED:return new Unauthorized(body,headers,options);case status.FORBIDDEN:return new Forbidden(body,headers,options);case status.NOT_FOUND:return new NotFound(body,headers,options);case status.CONFLICT:return new Conflict(body,headers,options);case status.INTERNAL_SERVER_ERROR:return new InternalServerError(body,headers,options);default:if(code>=400&&code<=499)return new ClientError(code,body,headers,options);else if(code>=500)return new ServerError(code,body,headers,options);else return new GenericResponse(code,body,headers,options)}};exports.createResponse=createResponse},{"./status":33}],33:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.NOT_IMPLEMENTED=exports.INTERNAL_SERVER_ERROR=exports.UNAVAILABLE_FOR_LEGAL_RREASONS=exports.REQUEST_HEADER_FIELDS_TOO_LARGE=exports.TOO_MANY_REQUESTS=exports.PRECONDITION_REQUIRED=exports.UPGRADE_REQUIRED=exports.FAILED_DEPENDENCY=exports.LOCKED=exports.UNPROCESSABLE_ENTITY=exports.TEAPOT=exports.EXPECTATION_FAILED=exports.REQUESTED_RANGE_NOT_SATISFIABLE=exports.UNSUPPORTED_MEDIA_TYPE=exports.REQUEST_URI_TOO_LONG=exports.REQUEST_ENTITY_TOO_LARGE=exports.PRECONDITION_FAILED=exports.LENGTH_REQUIRED=exports.GONE=exports.CONFLICT=exports.REQUEST_TIMEOUT=exports.PROXY_AUTH_REQUIRED=exports.NOT_ACCEPTABLE=exports.METHOD_NOT_ALLOWED=exports.NOT_FOUND=exports.FORBIDDEN=exports.PAYMENT_REQUIRED=exports.UNAUTHORIZED=exports.BAD_REQUEST=exports.PERMANENT_REDIRECT=exports.TEMPORARY_REDIRECT=exports.USE_PROXY=exports.NOT_MODIFIED=exports.SEE_OTHER=exports.FOUND=exports.MOVED_PERMANENTLY=exports.MULTIPLE_CHOICES=exports.IM_USED=exports.ALREADY_REPORTED=exports.MULTI_STATUS=exports.PARTIAL_CONTENT=exports.RESET_CONTENT=exports.NO_CONTENT=exports.NON_AUTHORITATIV_INFO=exports.ACCEPTED=exports.CREATED=exports.OK=exports.PROCESSING=exports.SWITCHING_PROTOCOLS=exports.CONTINUE=void 0;exports.NETWORK_AUTHENTICATION_REQUIRED=exports.NOT_EXTENDED=exports.LOOP_DETECTED=exports.INSUFFICIENT_STORAGE=exports.VARIANT_ALSO_NEGOTIATES=exports.HTTP_VERSION_NOT_SUPPORTED=exports.GATEWAY_TIMEOUT=exports.SERVICE_UNAVAILABLE=exports.BAD_GATEWAY=void 0;exports.CONTINUE=100;exports.SWITCHING_PROTOCOLS=101;exports.PROCESSING=102;exports.OK=200;exports.CREATED=201;exports.ACCEPTED=202;exports.NON_AUTHORITATIV_INFO=203;exports.NO_CONTENT=204;exports.RESET_CONTENT=205;exports.PARTIAL_CONTENT=206;exports.MULTI_STATUS=207;exports.ALREADY_REPORTED=208;exports.IM_USED=226;exports.MULTIPLE_CHOICES=300;exports.MOVED_PERMANENTLY=301;exports.FOUND=302;exports.SEE_OTHER=303;exports.NOT_MODIFIED=304;exports.USE_PROXY=305;exports.TEMPORARY_REDIRECT=307;exports.PERMANENT_REDIRECT=308;exports.BAD_REQUEST=400;exports.UNAUTHORIZED=401;exports.PAYMENT_REQUIRED=402;exports.FORBIDDEN=403;exports.NOT_FOUND=404;exports.METHOD_NOT_ALLOWED=405;exports.NOT_ACCEPTABLE=406;exports.PROXY_AUTH_REQUIRED=407;exports.REQUEST_TIMEOUT=408;exports.CONFLICT=409;exports.GONE=410;exports.LENGTH_REQUIRED=411;exports.PRECONDITION_FAILED=412;exports.REQUEST_ENTITY_TOO_LARGE=413;exports.REQUEST_URI_TOO_LONG=414;exports.UNSUPPORTED_MEDIA_TYPE=415;exports.REQUESTED_RANGE_NOT_SATISFIABLE=416;exports.EXPECTATION_FAILED=417;exports.TEAPOT=418;exports.UNPROCESSABLE_ENTITY=422;exports.LOCKED=423;exports.FAILED_DEPENDENCY=424;exports.UPGRADE_REQUIRED=426;exports.PRECONDITION_REQUIRED=428;exports.TOO_MANY_REQUESTS=429;exports.REQUEST_HEADER_FIELDS_TOO_LARGE=431;exports.UNAVAILABLE_FOR_LEGAL_RREASONS=451;exports.INTERNAL_SERVER_ERROR=500;exports.NOT_IMPLEMENTED=501;exports.BAD_GATEWAY=502;exports.SERVICE_UNAVAILABLE=503;exports.GATEWAY_TIMEOUT=504;exports.HTTP_VERSION_NOT_SUPPORTED=505;exports.VARIANT_ALSO_NEGOTIATES=506;exports.INSUFFICIENT_STORAGE=507;exports.LOOP_DETECTED=508;exports.NOT_EXTENDED=510;exports.NETWORK_AUTHENTICATION_REQUIRED=511},{}],34:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.urlFromString=exports.isBlob=exports.isFormData=exports.isFile=exports.isObject=void 0;var qs_1=require("./qs");var isObject=function(obj){return typeof obj==="object"};exports.isObject=isObject;var isFile=function(obj){return toString.call(obj)==="[object File]"};exports.isFile=isFile;var isFormData=function(obj){return toString.call(obj)==="[object FormData]"};exports.isFormData=isFormData;var isBlob=function(obj){return toString.call(obj)==="[object Blob]"};exports.isBlob=isBlob;var urlFromString=function(url,params){if(params===void 0){params={}}return url+"?"+(0,qs_1.stringify)(params)};exports.urlFromString=urlFromString},{"./qs":35}],35:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.stringify=exports.formats=void 0;var record_1=require("@quenk/noni/lib/data/record");var percentTwenties=/%20/g;var Format={RFC1738:"RFC1738",RFC3986:"RFC3986"};exports.formats=(0,record_1.assign)({default:Format.RFC3986,formatters:{RFC1738:function(value){return replace.call(value,percentTwenties,"+")},RFC3986:String}},Format);var arrayPrefixGenerators={brackets:function(prefix){return prefix+"[]"},comma:"comma",indices:function(prefix,key){return prefix+"["+key+"]"},repeat:function(prefix){return prefix}};var has=Object.prototype.hasOwnProperty;var replace=String.prototype.replace;var isArray=Array.isArray;var push=Array.prototype.push;var pushToArray=function(arr,valueOrArray){push.apply(arr,isArray(valueOrArray)?valueOrArray:[valueOrArray])};var toISO=Date.prototype.toISOString;var defaultFormat=exports.formats["default"];var hexTable=function(){var array=[];for(var i=0;i<256;++i)array.push("%"+((i<16?"0":"")+i.toString(16)).toUpperCase());return array}();var utilsEncode=function(str,_,charset){if(str.length===0){return str}var string=str;if(typeof str==="symbol"){string=Symbol.prototype.toString.call(str)}else if(typeof str!=="string"){string=String(str)}if(charset==="iso-8859-1"){return escape(string).replace(/%u[0-9a-f]{4}/gi,function($0){return"%26%23"+parseInt($0.slice(2),16)+"%3B"})}var out="";for(var i=0;i<string.length;++i){var c=string.charCodeAt(i);if(c===45||c===46||c===95||c===126||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122){out+=string.charAt(i);continue}if(c<128){out=out+hexTable[c];continue}if(c<2048){out=out+(hexTable[192|c>>6]+hexTable[128|c&63]);continue}if(c<55296||c>=57344){out=out+(hexTable[224|c>>12]+hexTable[128|c>>6&63]+hexTable[128|c&63]);continue}i+=1;c=65536+((c&1023)<<10|string.charCodeAt(i)&1023);out+=hexTable[240|c>>18]+hexTable[128|c>>12&63]+hexTable[128|c>>6&63]+hexTable[128|c&63]}return out};var utilsMaybeMap=function(val,fn){if(isArray(val)){var mapped=[];for(var i=0;i<val.length;i+=1){mapped.push(fn(val[i]))}return mapped}return fn(val)};var utilsIsBuffer=function(obj){if(!obj||typeof obj!=="object"){return false}return!!(obj.constructor&&obj.constructor.isBuffer&&obj.constructor.isBuffer(obj))};var isNonNullishPrimitive=function(v){return typeof v==="string"||typeof v==="number"||typeof v==="boolean"||typeof v==="symbol"||typeof v==="bigint"};var defaults={addQueryPrefix:false,allowDots:false,charset:"utf-8",charsetSentinel:false,delimiter:"&",encode:true,encoder:utilsEncode,encodeValuesOnly:false,format:defaultFormat,formatter:exports.formats.formatters[defaultFormat],indices:false,serializeDate:function(date){return toISO.call(date)},skipNulls:false,strictNullHandling:false};function doStringify(target,prefix,generateArrayPrefix,strictNullHandling,skipNulls,encoder,filter,sort,allowDots,serializeDate,formatter,encodeValuesOnly,charset){var obj=target;if(typeof filter==="function"){obj=filter(prefix,obj)}else if(obj instanceof Date){obj=serializeDate(obj)}else if(generateArrayPrefix==="comma"&&isArray(obj)){obj=utilsMaybeMap(obj,function(value){if(value instanceof Date){return new String(serializeDate(value))}return value})}if(obj===null){if(strictNullHandling){return encoder&&!encodeValuesOnly?encoder(prefix,defaults.encoder,charset,"key"):prefix}obj=""}if(isNonNullishPrimitive(obj)||utilsIsBuffer(obj)){if(encoder){var keyValue=encodeValuesOnly?prefix:encoder(prefix,defaults.encoder,charset,"key");return[formatter(keyValue)+"="+formatter(encoder(obj,defaults.encoder,charset,"value"))]}return[formatter(prefix)+"="+formatter(String(obj))]}var values=[];if(typeof obj==="undefined"){return values}var objKeys;if(generateArrayPrefix==="comma"&&isArray(obj)){objKeys=[{value:obj.length>0?obj.join(",")||null:undefined}]}else if(isArray(filter)){objKeys=filter}else{var keys=Object.keys(obj);objKeys=sort?keys.sort(sort):keys}for(var i=0;i<objKeys.length;++i){var key=objKeys[i];var value=typeof key==="object"&&key.value!==undefined?key.value:obj[key];if(skipNulls&&value===null){continue}var keyPrefix=isArray(obj)?typeof generateArrayPrefix==="function"?generateArrayPrefix(prefix,key):prefix:prefix+(allowDots?"."+key:"["+key+"]");pushToArray(values,doStringify(value,keyPrefix,generateArrayPrefix,strictNullHandling,skipNulls,encoder,filter,sort,allowDots,serializeDate,formatter,encodeValuesOnly,charset))}return values}var normalizeStringifyOptions=function(opts){if(!opts){return defaults}if(opts.encoder!==null&&opts.encoder!==undefined&&typeof opts.encoder!=="function"){throw new TypeError("Encoder has to be a function.")}var charset=opts.charset||defaults.charset;if(typeof opts.charset!=="undefined"&&opts.charset!=="utf-8"&&opts.charset!=="iso-8859-1"){throw new TypeError("The charset option must be either utf-8,"+" iso-8859-1, or undefined")}var format=exports.formats["default"];if(typeof opts.format!=="undefined"){if(!has.call(exports.formats.formatters,opts.format)){throw new TypeError("Unknown format option provided.")}format=opts.format}var formatter=exports.formats.formatters[format];var filter;if(typeof opts.filter==="function"||isArray(opts.filter)){filter=opts.filter}return{addQueryPrefix:typeof opts.addQueryPrefix==="boolean"?opts.addQueryPrefix:defaults.addQueryPrefix,allowDots:typeof opts.allowDots==="undefined"?defaults.allowDots:!!opts.allowDots,charset:charset,charsetSentinel:typeof opts.charsetSentinel==="boolean"?opts.charsetSentinel:defaults.charsetSentinel,delimiter:typeof opts.delimiter==="undefined"?defaults.delimiter:opts.delimiter,encode:typeof opts.encode==="boolean"?opts.encode:defaults.encode,encoder:typeof opts.encoder==="function"?opts.encoder:defaults.encoder,encodeValuesOnly:typeof opts.encodeValuesOnly==="boolean"?opts.encodeValuesOnly:defaults.encodeValuesOnly,filter:filter,formatter:formatter,serializeDate:typeof opts.serializeDate==="function"?opts.serializeDate:defaults.serializeDate,skipNulls:typeof opts.skipNulls==="boolean"?opts.skipNulls:defaults.skipNulls,sort:typeof opts.sort==="function"?opts.sort:undefined,strictNullHandling:typeof opts.strictNullHandling==="boolean"?opts.strictNullHandling:defaults.strictNullHandling}};function stringify(target,opts){if(opts===void 0){opts={}}var obj=target;var options=normalizeStringifyOptions(opts);var objKeys;var filter;if(typeof options.filter==="function"){filter=options.filter;obj=filter("",obj)}else if(isArray(options.filter)){filter=options.filter;objKeys=filter}var keys=[];if(typeof obj!=="object"||obj===null){return""}var arrayFormat;if(opts&&opts.arrayFormat&&opts.arrayFormat in arrayPrefixGenerators){arrayFormat=opts.arrayFormat}else if(opts&&"indices"in opts){arrayFormat=opts.indices?"indices":"repeat"}else{arrayFormat="indices"}var generateArrayPrefix=arrayPrefixGenerators[arrayFormat];if(!objKeys){objKeys=Object.keys(obj)}if(options.sort){objKeys.sort(options.sort)}for(var i=0;i<objKeys.length;++i){var key=objKeys[i];if(options.skipNulls&&obj[key]===null){continue}pushToArray(keys,doStringify(obj[key],key,generateArrayPrefix,options.strictNullHandling,options.skipNulls,options.encode?options.encoder:undefined,options.filter,options.sort,options.allowDots,options.serializeDate,options.formatter,options.encodeValuesOnly,options.charset))}var joined=keys.join(options.delimiter);var prefix=options.addQueryPrefix===true?"?":"";if(options.charsetSentinel){if(options.charset==="iso-8859-1"){prefix+="utf8=%26%2310003%3B&"}else{prefix+="utf8=%E2%9C%93&"}}return joined.length>0?prefix+joined:""}exports.stringify=stringify},{"@quenk/noni/lib/data/record":60}],36:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Proxy=exports.Immutable=exports.Mutable=void 0;const mutable_1=require("@quenk/potoo/lib/actor/resident/mutable");Object.defineProperty(exports,"Mutable",{enumerable:true,get:function(){return mutable_1.Mutable}});const immutable_1=require("@quenk/potoo/lib/actor/resident/immutable");Object.defineProperty(exports,"Immutable",{enumerable:true,get:function(){return immutable_1.Immutable}});class Proxy{constructor(instance){this.instance=instance}self(){return this.instance.self()}spawn(t){return this.instance.spawn(t)}spawnGroup(name,tmpls){return this.instance.spawnGroup(name,tmpls)}tell(actor,m){this.instance.tell(actor,m);return this}select(c){this.instance.select(c);return this}raise(e){this.instance.raise(e);return this}kill(addr){this.instance.kill(addr);return this}wait(ft){return this.instance.wait(ft)}exit(){this.exit()}}exports.Proxy=Proxy},{"@quenk/potoo/lib/actor/resident/immutable":71,"@quenk/potoo/lib/actor/resident/mutable":73}],37:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Jouvert=void 0;const vm_1=require("@quenk/potoo/lib/actor/system/vm");class Jouvert{constructor(conf={accept:m=>this.onMessage(m)}){this.conf=conf;this.vm=vm_1.PVM.create(this,this.conf)}getPlatform(){return this.vm}onMessage(_){}tell(addr,msg){this.vm.tell(addr,msg);return this}spawn(t){return this.vm.spawn(this.vm,t)}}exports.Jouvert=Jouvert},{"@quenk/potoo/lib/actor/system/vm":77}],38:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SeqSendCallback=exports.ParSendCallback=exports.SendCallback=exports.CompositeBatchCompleteHandler=exports.CompositeCompleteHandler=exports.AbstractBatchCompleteHandler=exports.AbstractCompleteHandler=exports.SeqSend=exports.ParSend=exports.Send=void 0;const type_1=require("@quenk/noni/lib/data/type");const case_1=require("@quenk/potoo/lib/actor/resident/case");const callback_1=require("@quenk/potoo/lib/actor/resident/immutable/callback");const _1=require("./");Object.defineProperty(exports,"Send",{enumerable:true,get:function(){return _1.Send}});Object.defineProperty(exports,"ParSend",{enumerable:true,get:function(){return _1.ParSend}});Object.defineProperty(exports,"SeqSend",{enumerable:true,get:function(){return _1.SeqSend}});const typeMatch={code:Number,options:Object,body:type_1.Any,headers:Object};class AbstractCompleteHandler{onError(_){}onClientError(_){}onServerError(_){}onComplete(_){}}exports.AbstractCompleteHandler=AbstractCompleteHandler;class AbstractBatchCompleteHandler extends AbstractCompleteHandler{onBatchComplete(_){}}exports.AbstractBatchCompleteHandler=AbstractBatchCompleteHandler;class CompositeCompleteHandler{constructor(handlers){this.handlers=handlers}onError(e){this.handlers.forEach(h=>h.onError(e))}onClientError(r){this.handlers.forEach(h=>h.onClientError(r))}onServerError(r){this.handlers.forEach(h=>h.onServerError(r))}onComplete(r){this.handlers.forEach(h=>h.onComplete(r))}}exports.CompositeCompleteHandler=CompositeCompleteHandler;class CompositeBatchCompleteHandler{constructor(handlers){this.handlers=handlers}onError(e){this.handlers.forEach(h=>h.onError(e))}onClientError(r){this.handlers.forEach(h=>h.onClientError(r))}onServerError(r){this.handlers.forEach(h=>h.onServerError(r))}onBatchComplete(r){this.handlers.forEach(h=>h.onBatchComplete(r))}}exports.CompositeBatchCompleteHandler=CompositeBatchCompleteHandler;class SendCallback extends callback_1.Callback{constructor(system,remote,request,handler){super(system);this.system=system;this.remote=remote;this.request=request;this.handler=handler}receive(){return[new case_1.Case(_1.TransportErr,e=>{this.handler.onError(e)}),new case_1.Case(typeMatch,r=>{if(r.code>499){this.handler.onServerError(r)}else if(r.code>399){this.handler.onClientError(r)}else{this.handler.onComplete(r)}})]}run(){this.tell(this.remote,new _1.Send(this.self(),this.request))}}exports.SendCallback=SendCallback;class ParSendCallback extends callback_1.Callback{constructor(system,remote,requests,handler){super(system);this.system=system;this.remote=remote;this.requests=requests;this.handler=handler}receive(){return[new case_1.Case(_1.TransportErr,e=>{this.handler.onError(e)}),new case_1.Case(_1.BatchResponse,r=>{let failed=r.value.filter(r=>r.code>299);if(failed.length>0){let res=failed[0];if(res.code>499){this.handler.onServerError(res)}else{this.handler.onClientError(res)}}else{this.handler.onBatchComplete(r)}})]}run(){this.tell(this.remote,new _1.ParSend(this.self(),this.requests))}}exports.ParSendCallback=ParSendCallback;class SeqSendCallback extends ParSendCallback{run(){this.tell(this.remote,new _1.SeqSend(this.self(),this.requests))}}exports.SeqSendCallback=SeqSendCallback},{"./":39,"@quenk/noni/lib/data/type":63,"@quenk/potoo/lib/actor/resident/case":69,"@quenk/potoo/lib/actor/resident/immutable/callback":70}],39:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Remote=exports.BatchResponse=exports.TransportErr=exports.ParSend=exports.SeqSend=exports.Send=void 0;const future_1=require("@quenk/noni/lib/control/monad/future");const case_1=require("@quenk/potoo/lib/actor/resident/case");const actor_1=require("../../actor");class Send{constructor(client,request){this.client=client;this.request=request}}exports.Send=Send;class SeqSend{constructor(client,requests){this.client=client;this.requests=requests}}exports.SeqSend=SeqSend;class ParSend{constructor(client,requests){this.client=client;this.requests=requests}}exports.ParSend=ParSend;class TransportErr{constructor(client,error){this.client=client;this.error=error}get message(){return this.error.message}}exports.TransportErr=TransportErr;class BatchResponse{constructor(value){this.value=value}}exports.BatchResponse=BatchResponse;class Remote extends actor_1.Immutable{constructor(agent,system){super(system);this.agent=agent;this.system=system;this.onUnit=(({client:client,request:request})=>{let onErr=e=>this.tell(client,new TransportErr(client,e));let onSucc=res=>this.tell(client,res);this.agent.send(request).fork(onErr,onSucc)});this.onParallel=(({client:client,requests:requests})=>{let{agent:agent}=this;let onErr=e=>this.tell(client,e);let onSucc=res=>this.tell(client,new BatchResponse(res));let rs=requests.map(r=>agent.send(r).catch(e=>future_1.raise(new TransportErr(client,e))));future_1.parallel(rs).fork(onErr,onSucc)});this.onSequential=(({client:client,requests:requests})=>{let{agent:agent}=this;let onErr=e=>this.tell(client,e);let onSucc=res=>this.tell(client,new BatchResponse(res));let rs=requests.map(r=>agent.send(r).catch(e=>future_1.raise(new TransportErr(client,e))));future_1.sequential(rs).fork(onErr,onSucc)})}receive(){return[new case_1.Case(Send,this.onUnit),new case_1.Case(ParSend,this.onParallel),new case_1.Case(SeqSend,this.onSequential)]}}exports.Remote=Remote},{"../../actor":36,"@quenk/noni/lib/control/monad/future":52,"@quenk/potoo/lib/actor/resident/case":69}],40:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RemoteModelFactory=void 0;const type_1=require("@quenk/noni/lib/data/type");const callback_1=require("../callback");const _1=require("./");class RemoteModelFactory{constructor(spawn,remote){this.spawn=spawn;this.remote=remote}static getInstance(spawn,remote){return new RemoteModelFactory(type_1.isObject(spawn)?spawn.spawn.bind(spawn):spawn,remote)}create(path,handlers){return new _1.RemoteModel(this.remote,path,this.spawn,Array.isArray(handlers)?new callback_1.CompositeCompleteHandler(handlers):handlers)}}exports.RemoteModelFactory=RemoteModelFactory},{"../callback":38,"./":41,"@quenk/noni/lib/data/type":63}],41:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RemoteModel=exports.NotFoundHandler=exports.FutureHandler=void 0;const future_1=require("@quenk/noni/lib/control/monad/future");const maybe_1=require("@quenk/noni/lib/data/maybe");const string_1=require("@quenk/noni/lib/data/string");const request_1=require("@quenk/jhr/lib/request");const callback_1=require("../callback");class DefaultCompleteHandler extends callback_1.AbstractCompleteHandler{}class FutureHandler{constructor(handler,onFailure,onSuccess){this.handler=handler;this.onFailure=onFailure;this.onSuccess=onSuccess}onError(e){this.handler.onError(e);this.onFailure(e.error instanceof Error?e.error:new Error(e.error.message))}onClientError(r){this.handler.onClientError(r);let e=new Error("ClientError");e.code=r.code;this.onFailure(e)}onServerError(r){this.handler.onServerError(r);let e=new Error("ServerError");e.code=r.code;this.onFailure(e)}onComplete(r){this.handler.onComplete(r);this.onSuccess(r)}}exports.FutureHandler=FutureHandler;class NotFoundHandler extends FutureHandler{constructor(handler,onFailure,onNotFound,onSuccess){super(handler,onFailure,onSuccess);this.handler=handler;this.onFailure=onFailure;this.onNotFound=onNotFound;this.onSuccess=onSuccess}onClientError(r){if(r.code===404)this.onNotFound();else super.onClientError(r)}}exports.NotFoundHandler=NotFoundHandler;class RemoteModel{constructor(remote,path,spawn,handler=new DefaultCompleteHandler){this.remote=remote;this.path=path;this.spawn=spawn;this.handler=handler}create(data){return future_1.fromCallback(cb=>{this.spawn(s=>new callback_1.SendCallback(s,this.remote,new request_1.Post(this.path,data),new FutureHandler(this.handler,cb,r=>{cb(null,r.body.data.id)})))})}search(qry){return future_1.fromCallback(cb=>{this.spawn(s=>new callback_1.SendCallback(s,this.remote,new request_1.Get(this.path,qry),new FutureHandler(this.handler,cb,r=>{cb(null,r.code===204?[]:r.body.data)})))})}update(id,changes){return future_1.fromCallback(cb=>{this.spawn(s=>new callback_1.SendCallback(s,this.remote,new request_1.Patch(string_1.interpolate(this.path,{id:id}),changes),new FutureHandler(this.handler,cb,r=>{cb(null,r.code===200?true:false)})))})}get(id){return future_1.fromCallback(cb=>{this.spawn(s=>new callback_1.SendCallback(s,this.remote,new request_1.Get(string_1.interpolate(this.path,{id:id}),{}),new NotFoundHandler(this.handler,cb,()=>{cb(null,maybe_1.nothing())},r=>{cb(null,maybe_1.fromNullable(r.body.data))})))})}remove(id){return future_1.fromCallback(cb=>{this.spawn(s=>new callback_1.SendCallback(s,this.remote,new request_1.Delete(string_1.interpolate(this.path,{id:id}),{}),new FutureHandler(this.handler,cb,r=>{cb(null,r.code===200?true:false)})))})}}exports.RemoteModel=RemoteModel},{"../callback":38,"@quenk/jhr/lib/request":30,"@quenk/noni/lib/control/monad/future":52,"@quenk/noni/lib/data/maybe":59,"@quenk/noni/lib/data/string":62}],42:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ConfirmDialog=exports.DialogConfirmed=void 0;const display_1=require("../../service/display");const _1=require("./");class DialogConfirmed extends _1.DialogEvent{}exports.DialogConfirmed=DialogConfirmed;class ConfirmDialog extends _1.Dialog{constructor(system,display,target="?"){super(system,display,target);this.system=system;this.display=display;this.target=target}confirm(){this.tell(this.display,new display_1.Close(this.name));this.fire(new DialogConfirmed(this.name));this.exit()}}exports.ConfirmDialog=ConfirmDialog},{"../../service/display":50,"./":43}],43:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Dialog=exports.DialogClosed=exports.DialogEvent=void 0;const type_1=require("@quenk/noni/lib/data/type");const display_1=require("../../service/display");const __1=require("../");class DialogEvent{constructor(name){this.name=name}}exports.DialogEvent=DialogEvent;class DialogClosed extends DialogEvent{}exports.DialogClosed=DialogClosed;class Dialog extends __1.BaseAppScene{constructor(system,display,target="?"){super(system);this.system=system;this.display=display;this.target=target}fire(e){if(type_1.isString(this.target)){this.tell(this.target,e)}else if(type_1.isFunction(this.target)){this.target(e)}else if(type_1.isObject(this.target)){this.target.onClose(e)}}close(){this.tell(this.display,new display_1.Close(this.name));this.fire(new DialogClosed(this.name));this.exit()}run(){this.tell(this.display,new display_1.Show(this.name,this.view,this.self()))}}exports.Dialog=Dialog},{"../":47,"../../service/display":50,"@quenk/noni/lib/data/type":63}],44:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.BaseFormScene=exports.SaveOkCase=exports.SaveFailedCase=exports.SaveCase=exports.AbortCase=exports.InputEventCase=exports.FormSaved=exports.FormAborted=exports.SaveFailed=exports.SaveOk=exports.Save=exports.Abort=exports.FormSavedCase=exports.FormAbortedCase=void 0;const record_1=require("@quenk/noni/lib/data/record");const array_1=require("@quenk/noni/lib/data/array");const type_1=require("@quenk/noni/lib/data/type");const future_1=require("@quenk/noni/lib/control/monad/future");const case_1=require("@quenk/potoo/lib/actor/resident/case");const __1=require("../");class FormAbortedCase extends case_1.Case{constructor(listener){super(FormAborted,msg=>future_1.doFuture(function*(){yield future_1.wrap(listener.afterFormAborted(msg));return future_1.voidPure}));this.listener=listener}}exports.FormAbortedCase=FormAbortedCase;class FormSavedCase extends case_1.Case{constructor(listener){super(FormSaved,msg=>future_1.doFuture(function*(){yield future_1.wrap(listener.afterFormSaved(msg));return future_1.voidPure}));this.listener=listener}}exports.FormSavedCase=FormSavedCase;class Abort{}exports.Abort=Abort;class Save{}exports.Save=Save;class SaveOk{}exports.SaveOk=SaveOk;class SaveFailed{constructor(errors={}){this.errors=errors}}exports.SaveFailed=SaveFailed;class FormAborted{constructor(form){this.form=form}}exports.FormAborted=FormAborted;class FormSaved{constructor(form){this.form=form}}exports.FormSaved=FormSaved;class InputEventCase extends case_1.Case{constructor(form){super({name:String,value:type_1.Any},e=>{form.set(e.name,e.value)});this.form=form}}exports.InputEventCase=InputEventCase;class AbortCase extends case_1.Case{constructor(scene){super(Abort,_=>{scene.tell(scene.target,new FormAborted(scene.self()));scene.exit()});this.scene=scene}}exports.AbortCase=AbortCase;class SaveCase extends case_1.Case{constructor(form){super(Save,_=>future_1.wrap(form.save()));this.form=form}}exports.SaveCase=SaveCase;class SaveFailedCase extends case_1.Case{constructor(listener){super(SaveFailed,fail=>future_1.doFuture(function*(){yield future_1.wrap(listener.onSaveFailed(fail));yield future_1.wrap(listener.onSaveFinished());return future_1.voidPure}));this.listener=listener}}exports.SaveFailedCase=SaveFailedCase;class SaveOkCase extends case_1.Case{constructor(form){super(SaveOk,ok=>future_1.doFuture(function*(){yield future_1.wrap(form.onSaveOk(ok));yield future_1.wrap(form.onSaveFinished());form.tell(form.target,new FormSaved(form.self()));form.exit();return future_1.voidPure}));this.form=form}}exports.SaveOkCase=SaveOkCase;class BaseFormScene extends __1.BaseAppScene{constructor(system,target,value={}){super(system);this.system=system;this.target=target;this.value=value;this.fieldsModifed=[]}get display(){return this.target}receive(){return[new AbortCase(this),new SaveCase(this),new SaveFailedCase(this),new SaveOkCase(this),new InputEventCase(this)]}set(name,value){if(!array_1.contains(this.fieldsModifed,name))this.fieldsModifed.push(name);this.value[name]=value;return this}getValues(){return record_1.clone(this.value)}getModifiedValues(){return record_1.filter(this.value,(_,k)=>array_1.contains(this.fieldsModifed,k))}onSaveFailed(){}onSaveOk(){}onSaveFinished(){}abort(){}save(){}}exports.BaseFormScene=BaseFormScene},{"../":47,"@quenk/noni/lib/control/monad/future":52,"@quenk/noni/lib/data/array":55,"@quenk/noni/lib/data/record":60,"@quenk/noni/lib/data/type":63,"@quenk/potoo/lib/actor/resident/case":69}],45:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.BaseValidatorFormScene=exports.InputEventCase=void 0;const type_1=require("@quenk/noni/lib/data/type");const case_1=require("@quenk/potoo/lib/actor/resident/case");const __1=require("../");const strategy_1=require("./strategy");class InputEventCase extends case_1.Case{constructor(form){super({name:String,value:type_1.Any},e=>{return form.strategy.validate(e)});this.form=form}}exports.InputEventCase=InputEventCase;class BaseValidatorFormScene extends __1.BaseFormScene{constructor(){super(...arguments);this.strategy=new strategy_1.NoStrategy(this)}receive(){return[new InputEventCase(this),...super.receive()]}onFieldInvalid(){}onFieldValid(){}onFormInvalid(){}onFormValid(){}}exports.BaseValidatorFormScene=BaseValidatorFormScene},{"../":44,"./strategy":46,"@quenk/noni/lib/data/type":63,"@quenk/potoo/lib/actor/resident/case":69}],46:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ModifiedAllForOneStrategy=exports.AllForOneStrategy=exports.OneForOneStrategy=exports.NoStrategy=void 0;class NoStrategy{constructor(form){this.form=form}validate({name:name,value:value}){this.form.set(name,value)}}exports.NoStrategy=NoStrategy;class OneForOneStrategy{constructor(form,validator){this.form=form;this.validator=validator}validate({name:name,value:value}){let{form:form,validator:validator}=this;let eResult=validator.validate(name,value);if(eResult.isLeft()){form.onFieldInvalid(name,value,eResult.takeLeft())}else{let value=eResult.takeRight();form.set(name,value);form.onFieldValid(name,value)}}}exports.OneForOneStrategy=OneForOneStrategy;class AllForOneStrategy{constructor(form,validator){this.form=form;this.validator=validator}getValues(){return this.form.getValues()}validate({name:name,value:value}){let{form:form,validator:validator}=this;let eResult=validator.validate(name,value);if(eResult.isLeft()){form.onFieldInvalid(name,value,eResult.takeLeft());form.onFormInvalid()}else{let value=eResult.takeRight();form.set(name,value);form.onFieldValid(name,value);let eAllResult=validator.validateAll(this.getValues());if(eAllResult.isRight())form.onFormValid();else form.onFormInvalid()}}}exports.AllForOneStrategy=AllForOneStrategy;class ModifiedAllForOneStrategy extends AllForOneStrategy{getValues(){return this.form.getModifiedValues()}}exports.ModifiedAllForOneStrategy=ModifiedAllForOneStrategy},{}],47:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.BaseAppScene=void 0;const actor_1=require("../../actor");const display_1=require("../service/display");class BaseAppScene extends actor_1.Immutable{show(){this.tell(this.display,new display_1.Show(this.name,this.view,this.self()))}run(){this.show()}}exports.BaseAppScene=BaseAppScene},{"../../actor":36,"../service/display":50}],48:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MainScene=void 0;const case_1=require("@quenk/potoo/lib/actor/resident/case");const director_1=require("../service/director");const display_1=require("../service/display");const _1=require("./");class MainScene extends _1.BaseAppScene{constructor(system,resume){super(system);this.system=system;this.resume=resume}get display(){return this.resume.director}receive(){return[new director_1.SuspendCase(this,this.resume.director),new case_1.Case(display_1.Show,msg=>void this.tell(this.display,msg)),new case_1.Case(display_1.Push,msg=>void this.tell(this.display,msg)),new case_1.Case(display_1.Pop,msg=>void this.tell(this.display,msg)),new case_1.Case(display_1.Close,msg=>void this.tell(this.display,msg))]}beforeSuspended(_){}reload(){this.tell(this.resume.director,new director_1.Reload(this.self()))}}exports.MainScene=MainScene},{"../service/director":49,"../service/display":50,"./":47,"@quenk/potoo/lib/actor/resident/case":69}],49:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Director=exports.ActorSuspended=exports.RouteChanged=exports.Supervisor=exports.SuspendActor=exports.SuspendTimer=exports.CancelTimer=exports.Suspended=exports.Suspend=exports.Reload=exports.Resume=exports.SuspendCase=exports.DEFAULT_TIMEOUT=void 0;const record_1=require("@quenk/noni/lib/data/record");const type_1=require("@quenk/noni/lib/data/type");const future_1=require("@quenk/noni/lib/control/monad/future");const case_1=require("@quenk/potoo/lib/actor/resident/case");const actor_1=require("../../actor");exports.DEFAULT_TIMEOUT=1e3;class SuspendCase extends case_1.Case{constructor(listener,director){super(Suspend,s=>future_1.doFuture(function*(){yield future_1.wrap(listener.beforeSuspended(s));listener.tell(director,new Suspended(listener.self()));return future_1.voidPure}));this.listener=listener;this.director=director}}exports.SuspendCase=SuspendCase;class Resume{constructor(director,request){this.director=director;this.request=request}}exports.Resume=Resume;class Reload{constructor(target){this.target=target}}exports.Reload=Reload;class Suspend{constructor(director){this.director=director}}exports.Suspend=Suspend;class Suspended{constructor(actor){this.actor=actor}}exports.Suspended=Suspended;class CancelTimer{}exports.CancelTimer=CancelTimer;class SuspendTimer extends actor_1.Immutable{constructor(director,timeout,system,onExpire,onFinish){super(system);this.director=director;this.timeout=timeout;this.system=system;this.onExpire=onExpire;this.onFinish=onFinish;this.timer=-1;this.onCancelTimer=(_=>{clearTimeout(this.timer);this.onFinish();this.exit()})}receive(){return[new case_1.Case(CancelTimer,this.onCancelTimer)]}run(){this.timer=setTimeout(()=>{this.onExpire();this.exit()},this.timeout)}}exports.SuspendTimer=SuspendTimer;class SuspendActor{}exports.SuspendActor=SuspendActor;class Supervisor extends actor_1.Immutable{constructor(director,display,info,system){super(system);this.director=director;this.display=display;this.info=info;this.system=system;this.actor="?"}receive(){return[new case_1.Case(SuspendActor,()=>{this.tell(this.actor,new Suspend(this.self()))}),new case_1.Case(Reload,()=>{this.tell(this.director,this.info)}),new case_1.Case(Suspended,()=>{this.tell(this.director,new ActorSuspended)}),new case_1.Default(m=>{this.tell(this.display,m)})]}run(){let{request:request,spec:spec}=this.info;let r=new Resume(this.self(),request);let candidate=type_1.isFunction(spec)?spec(r):spec;if(type_1.isObject(candidate)){let tmpl=candidate;let args=tmpl.args?tmpl.args:[];tmpl=record_1.merge(tmpl,{args:[r,...args]});this.actor=this.spawn(tmpl)}else{this.actor=candidate}this.tell(this.actor,r)}}exports.Supervisor=Supervisor;class RouteChanged{constructor(route,spec,request){this.route=route;this.spec=spec;this.request=request}}exports.RouteChanged=RouteChanged;class ActorSuspended{}exports.ActorSuspended=ActorSuspended;class Director extends actor_1.Immutable{constructor(display,router,conf,routes,system){super(system);this.display=display;this.router=router;this.conf=conf;this.routes=routes;this.system=system;this.current=["","?","?"];this.config=defaultConfig(this.conf);this.onRouteChanged=(msg=>{let self=this.self();let{display:display,routes:routes,current:current,config:config}=this;let[route,supervisor]=current;let onFinish=()=>{if(supervisor!="?")this.kill(supervisor);this.current=[msg.route,this.spawn(s=>new Supervisor(self,display,msg,s)),"?"]};if(supervisor!="?"){let{timeout:timeout}=config;let onExpire=()=>{this.routes=record_1.exclude(routes,route);onFinish()};this.current=[route,supervisor,this.spawn(s=>new SuspendTimer(self,timeout,s,onExpire,onFinish))];this.tell(supervisor,new SuspendActor)}else{onFinish()}});this.onActorSuspended=(_=>{this.tell(this.current[2],new CancelTimer)})}receive(){return[new case_1.Case(RouteChanged,this.onRouteChanged),new case_1.Case(ActorSuspended,this.onActorSuspended)]}run(){record_1.forEach(this.routes,(spec,route)=>{this.router.add(route,r=>future_1.fromCallback(cb=>{if(!this.routes.hasOwnProperty(route)){return cb(new Error(`${route}: not responding!`))}else{this.tell(this.self(),new RouteChanged(route,spec,r));cb(null)}}))})}}exports.Director=Director;const defaultConfig=c=>record_1.merge({timeout:exports.DEFAULT_TIMEOUT},c)},{"../../actor":36,"@quenk/noni/lib/control/monad/future":52,"@quenk/noni/lib/data/record":60,"@quenk/noni/lib/data/type":63,"@quenk/potoo/lib/actor/resident/case":69}],50:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Display=exports.ViewRemoved=exports.ViewStackEmpty=exports.ViewShown=exports.Close=exports.Pop=exports.Push=exports.Show=exports.WMLLayoutViewDelegate=exports.HTMLElementViewDelegate=void 0;const array_1=require("@quenk/noni/lib/data/array");const immutable_1=require("@quenk/potoo/lib/actor/resident/immutable");const case_1=require("@quenk/potoo/lib/actor/resident/case");class HTMLElementViewDelegate{constructor(node){this.node=node}set(view){this.unset();this.node.appendChild(view.render())}unset(){let{node:node}=this;while(node.firstChild!=null)node.removeChild(node.firstChild)}}exports.HTMLElementViewDelegate=HTMLElementViewDelegate;class WMLLayoutViewDelegate{constructor(layout){this.layout=layout}set(view){this.unset();this.layout.setContent(view.render())}unset(){this.layout.removeContent()}}exports.WMLLayoutViewDelegate=WMLLayoutViewDelegate;class Show{constructor(name,view,source){this.name=name;this.view=view;this.source=source}}exports.Show=Show;class Push extends Show{}exports.Push=Push;class Pop{constructor(source){this.source=source}}exports.Pop=Pop;class Close{constructor(source){this.source=source}}exports.Close=Close;class ViewShown{constructor(name){this.name=name}}exports.ViewShown=ViewShown;class ViewStackEmpty{}exports.ViewStackEmpty=ViewStackEmpty;class ViewRemoved{constructor(name){this.name=name}}exports.ViewRemoved=ViewRemoved;class Display extends immutable_1.Immutable{constructor(delegate,system){super(system);this.delegate=delegate;this.system=system;this.stack=[]}receive(){return[new case_1.Case(Show,m=>this.show(m)),new case_1.Case(Push,m=>this.push(m)),new case_1.Case(Pop,m=>this.pop(m)),new case_1.Case(Close,()=>this.close())]}show(m){if(!array_1.empty(this.stack))this.close();this.push(m)}push(m){this.stack.push(m);this.delegate.set(m.view);this.tell(m.source,new ViewShown(m.name))}pop(m){if(array_1.empty(this.stack)){this.tell(m.source,new ViewStackEmpty)}else{let current=this.stack.pop();this.delegate.unset();this.tell(current.source,new ViewRemoved(current.name));if(!array_1.empty(this.stack)){this.push(this.stack.pop())}}}close(){this.delegate.unset();this.stack.forEach(m=>{this.tell(m.source,new ViewRemoved(m.name))});this.stack=[]}run(){}}exports.Display=Display},{"@quenk/noni/lib/data/array":55,"@quenk/potoo/lib/actor/resident/case":69,"@quenk/potoo/lib/actor/resident/immutable":71}],51:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.attempt=exports.raise=exports.convert=void 0;var either_1=require("../data/either");var convert=function(e){return e instanceof Error?e:new Error(e?e.message?e.message:undefined:undefined)};exports.convert=convert;var raise=function(e){if(e instanceof Error){throw e}else{throw new Error(e.message)}};exports.raise=raise;var attempt=function(f){try{return(0,either_1.right)(f())}catch(e){return(0,either_1.left)(e)}};exports.attempt=attempt},{"../data/either":57}],52:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var __generator=this&&this.__generator||function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=op[0]&2?y["return"]:op[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}};Object.defineProperty(exports,"__esModule",{value:true});exports.doFuture=exports.liftP=exports.fromExcept=exports.toPromise=exports.race=exports.reduce=exports.sequential=exports.parallel=exports.batch=exports.fromCallback=exports.fromAbortable=exports.wait=exports.delay=exports.attempt=exports.raise=exports.run=exports.wrap=exports.voidPure=exports.pure=exports.Run=exports.Raise=exports.Trap=exports.Finally=exports.Catch=exports.Call=exports.Bind=exports.Pure=exports.Future=void 0;var function_1=require("../../data/function");var timer_1=require("../timer");var error_1=require("../error");var _1=require("./");var array_1=require("../../data/array");var Future=function(){function Future(){this.tag="Future"}Object.defineProperty(Future.prototype,Symbol.toStringTag,{get:function(){return"Future"},enumerable:false,configurable:true});Future.prototype.of=function(a){return new Pure(a)};Future.prototype.map=function(f){return new Bind(this,function(value){return new Pure(f(value))})};Future.prototype.ap=function(ft){return new Bind(this,function(value){return ft.map(function(f){return f(value)})})};Future.prototype.chain=function(f){return new Bind(this,f)};Future.prototype.trap=function(f){return new Catch(this,f)};Future.prototype.catch=function(f){return new Catch(this,function(e){return(0,exports.run)(function(onError,onSuccess){if(f){var result=f(e);switch(Object.prototype.toString.call(result)){case"[object Future]":var asFuture=result;asFuture.fork(function(e){return onError(e)},function(v){return onSuccess(v)});break;case"[object Promise]":var asPromise=result;asPromise.then(function(v){return onSuccess(v)},function(e){return onError(e)});break;default:onSuccess(result);break}}else{onSuccess(undefined)}return function_1.noop})})};Future.prototype.finally=function(f){return new Finally(this,f)};Future.prototype.then=function(onResolve,onReject){var _this=this;return new Promise(function(resolve,reject){_this.fork(reject,resolve)}).then(onResolve,onReject)};Future.prototype._fork=function(value,stack,onError,onSuccess){var _this=this;var pending=true;var failure=function(e){if(pending){stack.push(new Raise(e));pending=false;_this._fork(value,stack,onError,onSuccess)}else{console.warn(_this.tag+": onError called after task completed");console.trace()}};var success=function(val){if(pending){pending=false;if((0,array_1.empty)(stack))onSuccess(val);else _this._fork(val,stack,onError,onSuccess)}else{console.warn(_this.tag+": onSuccess called after task completed");console.trace()}};var _loop_1=function(){var next=stack.pop();if(next.tag==="Pure"){(0,timer_1.tick)(function(){return success(next.value)});return{value:function_1.noop}}else if(next.tag==="Bind"){var future=next;stack.push(new Call(future.func));stack.push(future.target)}else if(next.tag==="Call"){var future=next;stack.push(future.target(value))}else if(next.tag==="Catch"){var future=next;stack.push(new Trap(future.func));stack.push(future.target)}else if(next.tag==="Finally"){var future=next;stack.push(new Trap(future.func));stack.push(new Call(future.func));stack.push(future.target)}else if(next.tag==="Trap"){if((0,array_1.empty)(stack))onSuccess(value)}else if(next.tag==="Raise"){var future=next;var err=(0,error_1.convert)(future.value);while(!(0,array_1.empty)(stack)&&(0,array_1.tail)(stack).tag!=="Trap")stack.pop();if((0,array_1.empty)(stack)){onError(err);return{value:function_1.noop}}else{stack.push(stack.pop().func(err))}}else if(next.tag==="Run"){return{value:next.task(failure,success)}}};while(!(0,array_1.empty)(stack)){var state_1=_loop_1();if(typeof state_1==="object")return state_1.value}return function_1.noop};Future.prototype.fork=function(onError,onSuccess){if(onError===void 0){onError=function_1.noop}if(onSuccess===void 0){onSuccess=function_1.noop}return this._fork(undefined,[this],onError,onSuccess)};return Future}();exports.Future=Future;var Pure=function(_super){__extends(Pure,_super);function Pure(value){var _this=_super.call(this)||this;_this.value=value;_this.tag="Pure";return _this}Pure.prototype.map=function(f){return new Pure(f(this.value))};Pure.prototype.ap=function(ft){var _this=this;return ft.map(function(f){return f(_this.value)})};return Pure}(Future);exports.Pure=Pure;var Bind=function(_super){__extends(Bind,_super);function Bind(target,func){var _this=_super.call(this)||this;_this.target=target;_this.func=func;_this.tag="Bind";return _this}return Bind}(Future);exports.Bind=Bind;var Call=function(_super){__extends(Call,_super);function Call(target){var _this=_super.call(this)||this;_this.target=target;_this.tag="Call";return _this}return Call}(Future);exports.Call=Call;var Catch=function(_super){__extends(Catch,_super);function Catch(target,func){var _this=_super.call(this)||this;_this.target=target;_this.func=func;_this.tag="Catch";return _this}return Catch}(Future);exports.Catch=Catch;var Finally=function(_super){__extends(Finally,_super);function Finally(target,func){var _this=_super.call(this)||this;_this.target=target;_this.func=func;_this.tag="Finally";return _this}return Finally}(Future);exports.Finally=Finally;var Trap=function(_super){__extends(Trap,_super);function Trap(func){var _this=_super.call(this)||this;_this.func=func;_this.tag="Trap";return _this}return Trap}(Future);exports.Trap=Trap;var Raise=function(_super){__extends(Raise,_super);function Raise(value){var _this=_super.call(this)||this;_this.value=value;_this.tag="Raise";return _this}Raise.prototype.map=function(_){return new Raise(this.value)};Raise.prototype.ap=function(_){return new Raise(this.value)};Raise.prototype.chain=function(_){return new Raise(this.value)};return Raise}(Future);exports.Raise=Raise;var Run=function(_super){__extends(Run,_super);function Run(task){var _this=_super.call(this)||this;_this.task=task;_this.tag="Run";return _this}return Run}(Future);exports.Run=Run;var pure=function(a){return new Pure(a)};exports.pure=pure;exports.voidPure=new Pure(undefined);var wrap=function(a){return a instanceof Future?a:(0,exports.pure)(a)};exports.wrap=wrap;var run=function(task){return new Run(task)};exports.run=run;var raise=function(e){return new Raise(e)};exports.raise=raise;var attempt=function(f){return(0,exports.run)(function(onError,onSuccess){(0,timer_1.tick)(function(){try{onSuccess(f())}catch(e){onError(e)}});return function_1.noop})};exports.attempt=attempt;var delay=function(f,n){if(n===void 0){n=0}return(0,exports.run)(function(onError,onSuccess){setTimeout(function(){try{onSuccess(f())}catch(e){onError(e)}},n);return function_1.noop})};exports.delay=delay;var wait=function(n){return(0,exports.run)(function(_,onSuccess){setTimeout(function(){onSuccess(undefined)},n);return function_1.noop})};exports.wait=wait;var fromAbortable=function(abort){return function(f){return(0,exports.run)(function(onError,onSuccess){f(function(err,a){return err!=null?onError(err):onSuccess(a)});return abort})}};exports.fromAbortable=fromAbortable;var fromCallback=function(f){return(0,exports.fromAbortable)(function_1.noop)(f)};exports.fromCallback=fromCallback;var Tag=function(){function Tag(index,value){this.index=index;this.value=value}return Tag}();var batch=function(list){return(0,exports.sequential)(list.map(function(w){return(0,exports.parallel)(w)}))};exports.batch=batch;var parallel=function(list){return(0,exports.run)(function(onError,onSuccess){var completed=[];var finished=false;var aborters=[];var indexCmp=function(a,b){return a.index-b.index};var abortAll=function(){finished=true;aborters.map(function(f){return f()})};var onErr=function(e){if(!finished){abortAll();onError(e)}};var reconcile=function(){return completed.sort(indexCmp).map(function(t){return t.value})};var onSucc=function(t){if(!finished){completed.push(t);if(completed.length===list.length)onSuccess(reconcile())}};aborters.push.apply(aborters,list.map(function(f,i){return f.map(function(value){return new Tag(i,value)}).fork(onErr,onSucc)}));if((0,array_1.empty)(aborters))onSuccess([]);return function(){return abortAll()}})};exports.parallel=parallel;var sequential=function(list){return(0,exports.run)(function(onError,onSuccess){var i=0;var r=[];var onErr=function(e){return onError(e)};var success=function(a){r.push(a);next()};var abort;var next=function(){if(i<list.length)abort=list[i].fork(onErr,success);else onSuccess(r);i++};next();return function(){if(abort)abort()}})};exports.sequential=sequential;var reduce=function(list,initValue,f){return(0,exports.doFuture)(function(){var accumValue,i;return __generator(this,function(_a){switch(_a.label){case 0:accumValue=initValue;i=0;_a.label=1;case 1:if(!(i<list.length))return[3,4];return[4,f(accumValue,list[i],i)];case 2:accumValue=_a.sent();_a.label=3;case 3:i++;return[3,1];case 4:return[2,(0,exports.pure)(accumValue)]}})})};exports.reduce=reduce;var race=function(list){return(0,exports.run)(function(onError,onSuccess){var aborters=[];var finished=false;var abortAll=function(){finished=true;aborters.map(function(f){return f()})};var onErr=function(e){if(!finished){finished=true;abortAll();onError(e)}};var onSucc=function(t){if(!finished){finished=true;aborters.map(function(f,i){return i!==t.index?f():undefined});onSuccess(t.value)}};aborters.push.apply(aborters,list.map(function(f,i){return f.map(function(value){return new Tag(i,value)}).fork(onErr,onSucc)}));if(aborters.length===0)onError(new Error("race(): Cannot race an empty list!"));return function(){return abortAll()}})};exports.race=race;var toPromise=function(ft){return new Promise(function(yes,no){return ft.fork(no,yes)})};exports.toPromise=toPromise;var fromExcept=function(e){return e.fold(function(e){return(0,exports.raise)(e)},function(a){return(0,exports.pure)(a)})};exports.fromExcept=fromExcept;var liftP=function(f){return(0,exports.run)(function(onError,onSuccess){f().then(function(a){return onSuccess(a)}).catch(function(e){return onError(e)});return function_1.noop})};exports.liftP=liftP;var doFuture=function(f){return(0,_1.doN)(f)};exports.doFuture=doFuture},{"../../data/array":55,"../../data/function":58,"../error":51,"../timer":54,"./":53}],53:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.doMonad=exports.doN=exports.pipeN=exports.pipe=exports.compose=exports.join=void 0;var join=function(outer){return outer.chain(function(x){return x})};exports.join=join;var compose=function(g,f){return(0,exports.pipe)(f,g)};exports.compose=compose;var pipe=function(f,g){return function(value){return f(value).chain(function(b){return g(b)})}};exports.pipe=pipe;var pipeN=function(f){var list=[];for(var _i=1;_i<arguments.length;_i++){list[_i-1]=arguments[_i]}return function(value){return list.reduce(function(p,c){return p.chain(function(v){return c(v)})},f(value))}};exports.pipeN=pipeN;var doN=function(f){var gen=f();var next=function(val){var r=gen.next(val);if(r.done)return r.value;else return r.value.chain(next)};return next()};exports.doN=doN;exports.doMonad=exports.doN},{}],54:[function(require,module,exports){(function(process){(function(){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.throttle=exports.debounce=exports.tick=void 0;var tick=function(f){return typeof window=="undefined"?setTimeout(f,0):process.nextTick(f)};exports.tick=tick;var debounce=function(f,delay){var id=-1;return function(a){if(id===-1){id=setTimeout(function(){return f(a)},delay)}else{clearTimeout(id);id=setTimeout(function(){return f(a)},delay)}}};exports.debounce=debounce;var throttle=function(f,duration){var wait=false;return function(a){if(wait===false){f(a);wait=true;setTimeout(function(){return wait=false},duration)}}};exports.throttle=throttle}).call(this)}).call(this,require("_process"))},{_process:172}],55:[function(require,module,exports){"use strict";var __spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||arguments.length===2)for(var i=0,l=from.length,ar;i<l;i++){if(ar||!(i in from)){if(!ar)ar=Array.prototype.slice.call(from,0,i);ar[i]=from[i]}}return to.concat(ar||Array.prototype.slice.call(from))};Object.defineProperty(exports,"__esModule",{value:true});exports.compact=exports.flatten=exports.combine=exports.make=exports.removeAt=exports.remove=exports.dedupe=exports.distribute=exports.group=exports.partition=exports.concat=exports.flatMap=exports.map=exports.contains=exports.empty=exports.tail=exports.head=void 0;var record_1=require("../record");var math_1=require("../../math");var head=function(list){return list[0]};exports.head=head;var tail=function(list){return list[list.length-1]};exports.tail=tail;var empty=function(list){return list.length===0};exports.empty=empty;var contains=function(list,a){return list.indexOf(a)>-1};exports.contains=contains;var map=function(list){return function(f){return list.map(f)}};exports.map=map;var flatMap=function(list,f){return list.reduce(function(p,c,i){return p.concat(f(c,i,list))},[])};exports.flatMap=flatMap;var concat=function(list){var items=[];for(var _i=1;_i<arguments.length;_i++){items[_i-1]=arguments[_i]}return __spreadArray(__spreadArray([],list,true),items.filter(function(item){return item!=null}),true)};exports.concat=concat;var partition=function(list,f){return(0,exports.empty)(list)?[[],[]]:list.reduce(function(_a,c,i){var yes=_a[0],no=_a[1];return f(c,i,list)?[(0,exports.concat)(yes,c),no]:[yes,(0,exports.concat)(no,c)]},[[],[]])};exports.partition=partition;var group=function(list,f){return list.reduce(function(p,c,i){var _a;var g=f(c,i,list);return(0,record_1.merge)(p,(_a={},_a[g]=Array.isArray(p[g])?(0,exports.concat)(p[g],c):[c],_a))},{})};exports.group=group;var distribute=function(list,size){var r=list.reduce(function(p,c,i){return(0,math_1.isMultipleOf)(size,i+1)?[(0,exports.concat)(p[0],(0,exports.concat)(p[1],c)),[]]:[p[0],(0,exports.concat)(p[1],c)]},[[],[]]);return r[1].length===0?r[0]:(0,exports.concat)(r[0],r[1])};exports.distribute=distribute;var dedupe=function(list){return list.filter(function(e,i,l){return l.indexOf(e)===i})};exports.dedupe=dedupe;var remove=function(list,target){var idx=list.indexOf(target);if(idx===-1){return list.slice()}else{var a=list.slice();a.splice(idx,1);return a}};exports.remove=remove;var removeAt=function(list,idx){if(list.length>idx&&idx>-1){var a=list.slice();a.splice(idx,1);return a}else{return list.slice()}};exports.removeAt=removeAt;var make=function(size,f){var a=new Array(size);for(var i=0;i<size;i++)a[i]=f(i);return a};exports.make=make;var combine=function(list){return list.reduce(function(p,c){return p.concat(c)},[])};exports.combine=combine;var flatten=function(list){return list.reduce(function(p,c){return p.concat(Array.isArray(c)?(0,exports.flatten)(c):c)},[])};exports.flatten=flatten;var compact=function(list){return list.filter(function(v){return v!=null})};exports.compact=compact},{"../../math":64,"../record":60}],56:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.natural=exports.number=exports.string=exports.date=void 0;var date=function(a,b){var na=new Date(a).getTime();var nb=new Date(b).getTime();return na>nb?-1:na<nb?1:0};exports.date=date;var string=function(a,b){var la=String(a).replace(/\s+/,"").toLowerCase();var lb=String(b).replace(/\s+/,"").toLowerCase();return la>lb?-1:la<lb?1:0};exports.string=string;var number=function(a,b){var na=parseFloat(a);var nb=parseFloat(b);na=isNaN(a)?-Infinity:a;nb=isNaN(b)?-Infinity:b;return na>nb?-1:na<nb?1:0};exports.number=number;var natural=function(a,b){if(a===void 0){a=""}if(b===void 0){b=""}var reA=/[^a-zA-Z]/g;var reN=/[^0-9]/g;var aInt=parseInt(a,10);var bInt=parseInt(b,10);if(isNaN(aInt)&&isNaN(bInt)){var aA=String(a).replace(reA,"");var bA=String(b).replace(reA,"");if(aA===bA){var aN=parseInt(String(a).replace(reN,""),10);var bN=parseInt(String(b).replace(reN,""),10);return aN===bN?0:aN>bN?-1:1}else{return aA>bA?-1:1}}else if(isNaN(aInt)){return-1}else if(isNaN(bInt)){return 1}else{return aInt>bInt?-1:1}};exports.natural=natural},{}],57:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.either=exports.fromBoolean=exports.right=exports.left=exports.Right=exports.Left=exports.Either=void 0;var maybe_1=require("./maybe");var Either=function(){function Either(){}Either.prototype.of=function(value){return new Right(value)};return Either}();exports.Either=Either;var Left=function(_super){__extends(Left,_super);function Left(value){var _this=_super.call(this)||this;_this.value=value;return _this}Left.prototype.map=function(_){return new Left(this.value)};Left.prototype.lmap=function(f){return new Left(f(this.value))};Left.prototype.bimap=function(f,_){return new Left(f(this.value))};Left.prototype.alt=function(a){return a};Left.prototype.chain=function(_){return new Left(this.value)};Left.prototype.ap=function(_){return new Left(this.value)};Left.prototype.extend=function(_){return new Left(this.value)};Left.prototype.fold=function(f,_){return f(this.value)};Left.prototype.eq=function(m){return m instanceof Left&&m.value===this.value};Left.prototype.orElse=function(f){return f(this.value)};Left.prototype.orRight=function(f){return new Right(f(this.value))};Left.prototype.isLeft=function(){return true};Left.prototype.isRight=function(){return false};Left.prototype.takeLeft=function(){return this.value};Left.prototype.takeRight=function(){throw new TypeError("Not right!")};Left.prototype.toMaybe=function(){return(0,maybe_1.nothing)()};return Left}(Either);exports.Left=Left;var Right=function(_super){__extends(Right,_super);function Right(value){var _this=_super.call(this)||this;_this.value=value;return _this}Right.prototype.map=function(f){return new Right(f(this.value))};Right.prototype.lmap=function(_){return new Right(this.value)};Right.prototype.bimap=function(_,g){return new Right(g(this.value))};Right.prototype.alt=function(_){return this};Right.prototype.chain=function(f){return f(this.value)};Right.prototype.ap=function(e){var _this=this;return e.map(function(f){return f(_this.value)})};Right.prototype.extend=function(f){return new Right(f(this))};Right.prototype.eq=function(m){return m instanceof Right&&m.value===this.value};Right.prototype.fold=function(_,g){return g(this.value)};Right.prototype.orElse=function(_){return this};Right.prototype.orRight=function(_){return this};Right.prototype.isLeft=function(){return false};Right.prototype.isRight=function(){return true};Right.prototype.takeLeft=function(){throw new TypeError("Not left!")};Right.prototype.takeRight=function(){return this.value};Right.prototype.toMaybe=function(){return(0,maybe_1.just)(this.value)};return Right}(Either);exports.Right=Right;var left=function(a){return new Left(a)};exports.left=left;var right=function(b){return new Right(b)};exports.right=right;var fromBoolean=function(b){return b?(0,exports.right)(true):(0,exports.left)(false)};exports.fromBoolean=fromBoolean;var either=function(f){return function(g){return function(e){return e instanceof Right?g(e.takeRight()):f(e.takeLeft())}}};exports.either=either},{"./maybe":59}],58:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.noop=exports.curry5=exports.curry4=exports.curry3=exports.curry=exports.id=exports.identity=exports.flip=exports.cons=exports.compose5=exports.compose4=exports.compose3=exports.compose=void 0;var compose=function(f,g){return function(a){return g(f(a))}};exports.compose=compose;var compose3=function(f,g,h){return function(a){return h(g(f(a)))}};exports.compose3=compose3;var compose4=function(f,g,h,i){return function(a){return i(h(g(f(a))))}};exports.compose4=compose4;var compose5=function(f,g,h,i,j){return function(a){return j(i(h(g(f(a)))))}};exports.compose5=compose5;var cons=function(a){return function(_){return a}};exports.cons=cons;var flip=function(f){return function(b){return function(a){return f(a)(b)}}};exports.flip=flip;var identity=function(a){return a};exports.identity=identity;exports.id=exports.identity;var curry=function(f){return function(a){return function(b){return f(a,b)}}};exports.curry=curry;var curry3=function(f){return function(a){return function(b){return function(c){return f(a,b,c)}}}};exports.curry3=curry3;var curry4=function(f){return function(a){return function(b){return function(c){return function(d){return f(a,b,c,d)}}}}};exports.curry4=curry4;var curry5=function(f){return function(a){return function(b){return function(c){return function(d){return function(e){return f(a,b,c,d,e)}}}}}};exports.curry5=curry5;var noop=function(){};exports.noop=noop},{}],59:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.fromNaN=exports.fromNumber=exports.fromBoolean=exports.fromString=exports.fromObject=exports.fromArray=exports.fromNullable=exports.just=exports.nothing=exports.of=exports.Just=exports.Nothing=void 0;var Nothing=function(){function Nothing(){}Nothing.prototype.map=function(_){return new Nothing};Nothing.prototype.ap=function(_){return new Nothing};Nothing.prototype.of=function(a){return new Just(a)};Nothing.prototype.chain=function(_){return new Nothing};Nothing.prototype.alt=function(a){return a};Nothing.prototype.empty=function(){return new Nothing};Nothing.prototype.extend=function(_){return new Nothing};Nothing.prototype.eq=function(m){return m instanceof Nothing};Nothing.prototype.orJust=function(f){return new Just(f())};Nothing.prototype.orElse=function(f){return f()};Nothing.prototype.isNothing=function(){return true};Nothing.prototype.isJust=function(){return false};Nothing.prototype.get=function(){throw new TypeError("Cannot get a value from Nothing!")};return Nothing}();exports.Nothing=Nothing;var Just=function(){function Just(value){this.value=value}Just.prototype.map=function(f){return new Just(f(this.value))};Just.prototype.ap=function(mb){var _this=this;return mb.map(function(f){return f(_this.value)})};Just.prototype.of=function(a){return new Just(a)};Just.prototype.chain=function(f){return f(this.value)};Just.prototype.alt=function(_){return this};Just.prototype.empty=function(){return new Nothing};Just.prototype.extend=function(f){return new Just(f(this))};Just.prototype.eq=function(m){return m instanceof Just&&m.value===this.value};Just.prototype.orJust=function(_){return this};Just.prototype.orElse=function(_){return this};Just.prototype.isNothing=function(){return false};Just.prototype.isJust=function(){return true};Just.prototype.get=function(){return this.value};return Just}();exports.Just=Just;var of=function(a){return new Just(a)};exports.of=of;var nothing=function(){return new Nothing};exports.nothing=nothing;var just=function(a){return new Just(a)};exports.just=just;var fromNullable=function(a){return a==null?new Nothing:new Just(a)};exports.fromNullable=fromNullable;var fromArray=function(a){return a.length===0?new Nothing:new Just(a)};exports.fromArray=fromArray;var fromObject=function(o){return Object.keys(o).length===0?new Nothing:new Just(o)};exports.fromObject=fromObject;var fromString=function(s){return s===""?new Nothing:new Just(s)};exports.fromString=fromString;var fromBoolean=function(b){return b===false?new Nothing:new Just(b)};exports.fromBoolean=fromBoolean;var fromNumber=function(n){return n===0?new Nothing:new Just(n)};exports.fromNumber=fromNumber;var fromNaN=function(n){return isNaN(n)?new Nothing:new Just(n)};exports.fromNaN=fromNaN},{}],60:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.pickValue=exports.pickKey=exports.make=exports.rcompact=exports.compact=exports.isBadKey=exports.set=exports.every=exports.some=exports.empty=exports.count=exports.clone=exports.hasKey=exports.values=exports.group=exports.partition=exports.exclude=exports.rmerge5=exports.rmerge4=exports.rmerge3=exports.rmerge=exports.merge5=exports.merge4=exports.merge3=exports.merge=exports.filter=exports.reduce=exports.forEach=exports.mapTo=exports.map=exports.keys=exports.isRecord=exports.assign=exports.badKeys=void 0;var array_1=require("../array");var type_1=require("../type");var maybe_1=require("../maybe");exports.badKeys=["__proto__"];function assign(target){var _varArgs=[];for(var _i=1;_i<arguments.length;_i++){_varArgs[_i-1]=arguments[_i]}var to=Object(target);for(var index=1;index<arguments.length;index++){var nextSource=arguments[index];if(nextSource!=null)for(var nextKey in nextSource)if(Object.prototype.hasOwnProperty.call(nextSource,nextKey))(0,exports.set)(to,nextKey,nextSource[nextKey])}return to}exports.assign=assign;var isRecord=function(value){return typeof value==="object"&&value!=null&&!Array.isArray(value)&&!(value instanceof Date)&&!(value instanceof RegExp)};exports.isRecord=isRecord;var keys=function(obj){return Object.keys(obj)};exports.keys=keys;var map=function(rec,f){return(0,exports.keys)(rec).reduce(function(p,k){return(0,exports.merge)(p,(0,exports.set)({},k,f(rec[k],k,rec)))},{})};exports.map=map;var mapTo=function(rec,f){return(0,exports.keys)(rec).map(function(k){return f(rec[k],k,rec)})};exports.mapTo=mapTo;var forEach=function(rec,f){return(0,exports.keys)(rec).forEach(function(k){return f(rec[k],k,rec)})};exports.forEach=forEach;var reduce=function(rec,accum,f){return(0,exports.keys)(rec).reduce(function(p,k){return f(p,rec[k],k)},accum)};exports.reduce=reduce;var filter=function(rec,f){return(0,exports.keys)(rec).reduce(function(p,k){return f(rec[k],k,rec)?(0,exports.merge)(p,(0,exports.set)({},k,rec[k])):p},{})};exports.filter=filter;var merge=function(left,right){return assign({},left,right)};exports.merge=merge;var merge3=function(a,b,c){return assign({},a,b,c)};exports.merge3=merge3;var merge4=function(a,b,c,d){return assign({},a,b,c,d)};exports.merge4=merge4;var merge5=function(a,b,c,d,e){return assign({},a,b,c,d,e)};exports.merge5=merge5;var rmerge=function(left,right){return(0,exports.reduce)(right,left,deepMerge)};exports.rmerge=rmerge;var rmerge3=function(r,s,t){return[s,t].reduce(function(p,c){return(0,exports.reduce)(c,p,deepMerge)},r)};exports.rmerge3=rmerge3;var rmerge4=function(r,s,t,u){return[s,t,u].reduce(function(p,c){return(0,exports.reduce)(c,p,deepMerge)},r)};exports.rmerge4=rmerge4;var rmerge5=function(r,s,t,u,v){return[s,t,u,v].reduce(function(p,c){return(0,exports.reduce)(c,p,deepMerge)},r)};exports.rmerge5=rmerge5;var deepMerge=function(pre,curr,key){return(0,exports.isRecord)(curr)?(0,exports.merge)(pre,(0,exports.set)({},key,(0,exports.isRecord)(pre[key])?(0,exports.rmerge)(pre[key],curr):(0,exports.merge)({},curr))):(0,exports.merge)(pre,(0,exports.set)({},key,curr))};var exclude=function(rec,keys){var list=Array.isArray(keys)?keys:[keys];return(0,exports.reduce)(rec,{},function(p,c,k){return list.indexOf(k)>-1?p:(0,exports.merge)(p,(0,exports.set)({},k,c))})};exports.exclude=exclude;var partition=function(r,f){return(0,exports.reduce)(r,[{},{}],function(_a,c,k){var yes=_a[0],no=_a[1];return f(c,k,r)?[(0,exports.merge)(yes,(0,exports.set)({},k,c)),no]:[yes,(0,exports.merge)(no,(0,exports.set)({},k,c))]})};exports.partition=partition;var group=function(rec,f){return(0,exports.reduce)(rec,{},function(prev,curr,key){var category=f(curr,key,rec);var value=(0,exports.isRecord)(prev[category])?(0,exports.merge)(prev[category],(0,exports.set)({},key,curr)):(0,exports.set)({},key,curr);return(0,exports.merge)(prev,(0,exports.set)({},category,value))})};exports.group=group;var values=function(r){return(0,exports.reduce)(r,[],function(p,c){return(0,array_1.concat)(p,c)})};exports.values=values;var hasKey=function(r,key){return Object.hasOwnProperty.call(r,key)};exports.hasKey=hasKey;var clone=function(r){return(0,exports.reduce)(r,{},function(p,c,k){(0,exports.set)(p,k,_clone(c));return p})};exports.clone=clone;var _clone=function(a){if((0,type_1.isArray)(a))return a.map(_clone);else if((0,exports.isRecord)(a))return(0,exports.clone)(a);else return a};var count=function(r){return(0,exports.keys)(r).length};exports.count=count;var empty=function(r){return(0,exports.count)(r)===0};exports.empty=empty;var some=function(o,f){return(0,exports.keys)(o).some(function(k){return f(o[k],k,o)})};exports.some=some;var every=function(o,f){return(0,exports.keys)(o).every(function(k){return f(o[k],k,o)})};exports.every=every;var set=function(r,k,value){if(!(0,exports.isBadKey)(k))r[k]=value;return r};exports.set=set;var isBadKey=function(key){return exports.badKeys.indexOf(key)!==-1};exports.isBadKey=isBadKey;var compact=function(rec){var result={};for(var key in rec)if(rec.hasOwnProperty(key))if(rec[key]!=null)result=(0,exports.set)(result,key,rec[key]);return result};exports.compact=compact;var rcompact=function(rec){return(0,exports.compact)((0,exports.map)(rec,function(val){return(0,exports.isRecord)(val)?(0,exports.rcompact)(val):val}))};exports.rcompact=rcompact;var make=function(init){if(init===void 0){init={}}var rec={};Object.defineProperty(rec,"__proto__",{configurable:false,enumerable:false,set:function(){}});for(var key in init)if(init.hasOwnProperty(key))rec[key]=init[key];return rec};exports.make=make;var pickKey=function(rec,test){return(0,exports.reduce)(rec,(0,maybe_1.nothing)(),function(p,c,k){return p.isJust()?p:test(c,k,rec)?(0,maybe_1.just)(k):p})};exports.pickKey=pickKey;var pickValue=function(rec,test){return(0,exports.reduce)(rec,(0,maybe_1.nothing)(),function(p,c,k){return p.isJust()?p:test(c,k,rec)?(0,maybe_1.just)(c):p})};exports.pickValue=pickValue},{"../array":55,"../maybe":59,"../type":63}],61:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.project=exports.unflatten=exports.flatten=exports.unescapeRecord=exports.escapeRecord=exports.unescape=exports.escape=exports.set=exports.getString=exports.getDefault=exports.get=exports.unsafeGet=exports.tokenize=void 0;var maybe_1=require("../maybe");var _1=require("./");var TOKEN_DOT=".";var TOKEN_BRACKET_LEFT="[";var TOKEN_BRACKET_RIGHT="]";var TOKEN_ESCAPE="\\";var tokenize=function(str){var i=0;var buf="";var curr="";var next="";var tokens=[];while(i<str.length){curr=str[i];next=str[i+1];if(curr===TOKEN_ESCAPE){buf=""+buf+next;i++}else if(curr===TOKEN_DOT){if(buf!=="")tokens.push(buf);buf=""}else if(curr===TOKEN_BRACKET_LEFT&&next===TOKEN_BRACKET_RIGHT){i++}else if(curr===TOKEN_BRACKET_LEFT){var bracketBuf="";var firstDot=-1;var firstDotBuf="";i++;while(true){curr=str[i];next=str[i+1];if(curr===TOKEN_BRACKET_RIGHT&&next===TOKEN_BRACKET_RIGHT){bracketBuf=""+bracketBuf+TOKEN_BRACKET_RIGHT;i++}else if(curr===TOKEN_BRACKET_RIGHT){if(buf!=="")tokens.push(buf);tokens.push(bracketBuf);buf="";break}else if(curr==null){if(firstDot!==-1){i=firstDot;tokens.push(""+buf+TOKEN_BRACKET_LEFT+firstDotBuf);buf="";break}else{buf=""+buf+TOKEN_BRACKET_LEFT+bracketBuf;break}}if(curr===TOKEN_DOT&&firstDot===-1){firstDot=i;firstDotBuf=bracketBuf}bracketBuf=""+bracketBuf+curr;i++}}else{buf=""+buf+curr}i++}if(buf.length>0)tokens.push(buf);return tokens};exports.tokenize=tokenize;var unsafeGet=function(path,src){if(src==null)return undefined;var toks=(0,exports.tokenize)(path);var head=src[toks.shift()];return toks.reduce(function(p,c){return p==null?p:p[c]},head)};exports.unsafeGet=unsafeGet;var get=function(path,src){return(0,maybe_1.fromNullable)((0,exports.unsafeGet)(path,src))};exports.get=get;var getDefault=function(path,src,def){return(0,exports.get)(path,src).orJust(function(){return def}).get()};exports.getDefault=getDefault;var getString=function(path,src){return(0,exports.get)(path,src).map(function(v){return String(v)}).orJust(function(){return""}).get()};exports.getString=getString;var set=function(p,v,r){var toks=(0,exports.tokenize)(p);return _set(r,v,toks)};exports.set=set;var _set=function(r,value,toks){var o;if(toks.length===0)return value;o=(0,_1.isRecord)(r)?(0,_1.clone)(r):{};o=(0,_1.set)(o,toks[0],_set(o[toks[0]],value,toks.slice(1)));return o};var escape=function(p){var i=0;var buf="";var curr="";while(i<p.length){curr=p[i];if(curr===TOKEN_ESCAPE||curr===TOKEN_DOT)buf=""+buf+TOKEN_ESCAPE+curr;else buf=""+buf+curr;i++}return buf};exports.escape=escape;var unescape=function(p){var i=0;var curr="";var next="";var buf="";while(i<p.length){curr=p[i];next=p[i+1];if(curr===TOKEN_ESCAPE){buf=""+buf+next;i++}else{buf=""+buf+curr}i++}return buf};exports.unescape=unescape;var escapeRecord=function(r){return(0,_1.reduce)(r,{},function(p,c,k){if(typeof c==="object")p=(0,_1.set)(p,(0,exports.escape)(k),(0,exports.escapeRecord)(c));else p=(0,_1.set)(p,(0,exports.escape)(k),c);return p})};exports.escapeRecord=escapeRecord;var unescapeRecord=function(r){return(0,_1.reduce)(r,{},function(p,c,k){if((0,_1.isRecord)(c))p=(0,_1.set)(p,(0,exports.unescape)(k),(0,exports.unescapeRecord)(c));else p=(0,_1.set)(p,(0,exports.unescape)(k),c);return p})};exports.unescapeRecord=unescapeRecord;var flatten=function(r){return flatImpl("")({})(r)};exports.flatten=flatten;var flatImpl=function(pfix){return function(prev){return function(r){return(0,_1.reduce)(r,prev,function(p,c,k){return(0,_1.isRecord)(c)?flatImpl(prefix(pfix,k))(p)(c):(0,_1.merge)(p,(0,_1.set)({},prefix(pfix,k),c))})}}};var prefix=function(pfix,key){return pfix===""?(0,exports.escape)(key):pfix+"."+(0,exports.escape)(key)};var unflatten=function(r){return(0,_1.reduce)(r,{},function(p,c,k){return(0,exports.set)(k,c,p)})};exports.unflatten=unflatten;var project=function(spec,rec){return(0,_1.reduce)(spec,{},function(p,c,k){return c===true?(0,exports.set)(k,(0,exports.unsafeGet)(k,rec),p):p})};exports.project=project},{"../maybe":59,"./":60}],62:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.alphanumeric=exports.numeric=exports.alpha=exports.interpolate=exports.uncapitalize=exports.capitalize=exports.propercase=exports.modulecase=exports.classcase=exports.camelcase=exports.contains=exports.endsWith=exports.startsWith=void 0;var path_1=require("../record/path");var record_1=require("../record");var startsWith=function(str,search,pos){if(pos===void 0){pos=0}return str.substr(!pos||pos<0?0:+pos,search.length)===search};exports.startsWith=startsWith;var endsWith=function(str,search,this_len){if(this_len===void 0){this_len=str.length}return this_len===undefined||this_len>str.length?this_len=str.length:str.substring(this_len-search.length,this_len)===search};exports.endsWith=endsWith;var contains=function(str,match){return str.indexOf(match)>-1};exports.contains=contains;var seperator=/([\\\/._-]|\s)+/g;var camelcase=function(str){var i=0;var curr="";var prev="";var buf="";while(true){if(i===str.length)return buf;curr=i===0?str[i].toLowerCase():str[i];if(curr.match(seperator)){prev="-"}else{buf=buf.concat(prev==="-"?curr.toUpperCase():curr.toLowerCase());prev=""}i++}};exports.camelcase=camelcase;var classcase=function(str){return str===""?"":str[0].toUpperCase().concat((0,exports.camelcase)(str).slice(1))};exports.classcase=classcase;var modulecase=function(str){var i=0;var prev="";var curr="";var next="";var buf="";while(true){if(i===str.length)return buf;curr=str[i];next=str[i+1];if(curr.match(/[A-Z]/)&&i>0){if(prev!=="-")buf=buf.concat("-");prev=curr.toLowerCase();buf=buf.concat(prev)}else if(curr.match(seperator)){if(prev!=="-"&&next&&!seperator.test(next)){prev="-";buf=buf.concat(prev)}}else{prev=curr.toLowerCase();buf=buf.concat(prev)}i++}};exports.modulecase=modulecase;var propercase=function(str){return str.trim().toLowerCase().split(" ").map(function(tok){return tok.length>0?""+tok[0].toUpperCase()+tok.slice(1):tok}).join(" ")};exports.propercase=propercase;var capitalize=function(str){return str===""?"":""+str[0].toUpperCase()+str.slice(1)};exports.capitalize=capitalize;var uncapitalize=function(str){return str===""?"":""+str[0].toLowerCase()+str.slice(1)};exports.uncapitalize=uncapitalize;var interpolateDefaults={start:"{",end:"}",regex:"([\\w$.-]+)",leaveMissing:true,applyFunctions:false};var interpolate=function(str,data,opts){if(opts===void 0){opts={}}var options=(0,record_1.assign)({},interpolateDefaults,opts);var reg=new RegExp(""+options.start+options.regex+options.end,"g");return str.replace(reg,function(_,k){return(0,path_1.get)(k,data).map(function(v){if(typeof v==="function")return v(k);else return""+v}).orJust(function(){if(opts.leaveMissing)return k;else return""}).get()})};exports.interpolate=interpolate;var alpha=function(str){return str.replace(/[^a-zA-Z]/g,"")};exports.alpha=alpha;var numeric=function(str){return str.replace(/[^0-9]/g,"")};exports.numeric=numeric;var alphanumeric=function(str){return str.replace(/[\W]|[_]/g,"")};exports.alphanumeric=alphanumeric},{"../record":60,"../record/path":61}],63:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.toString=exports.show=exports.test=exports.is=exports.isPrim=exports.isFunction=exports.isBoolean=exports.isNumber=exports.isString=exports.isArray=exports.isObject=exports.Any=void 0;var prims=["string","number","boolean"];var Any=function(){function Any(){}return Any}();exports.Any=Any;var isObject=function(value){return typeof value==="object"&&!(0,exports.isArray)(value)};exports.isObject=isObject;exports.isArray=Array.isArray;var isString=function(value){return typeof value==="string"};exports.isString=isString;var isNumber=function(value){return typeof value==="number"&&!isNaN(value)};exports.isNumber=isNumber;var isBoolean=function(value){return typeof value==="boolean"};exports.isBoolean=isBoolean;var isFunction=function(value){return typeof value==="function"};exports.isFunction=isFunction;var isPrim=function(value){return!((0,exports.isObject)(value)||(0,exports.isArray)(value)||(0,exports.isFunction)(value))};exports.isPrim=isPrim;var is=function(expected){return function(value){return typeof value===expected}};exports.is=is;var test=function(value,t){if(prims.indexOf(typeof t)>-1&&value===t)return true;else if(typeof t==="function"&&(t===String&&typeof value==="string"||t===Number&&typeof value==="number"||t===Boolean&&typeof value==="boolean"||t===Array&&Array.isArray(value)||t===Any||value instanceof t))return true;else if(t instanceof RegExp&&(typeof value==="string"&&t.test(value)))return true;else if(typeof t==="object"&&typeof value==="object")return Object.keys(t).every(function(k){return Object.hasOwnProperty.call(value,k)?(0,exports.test)(value[k],t[k]):false});return false};exports.test=test;var show=function(value){if(typeof value==="object"){if(Array.isArray(value))return"["+value.map(exports.show)+"];";else if(value.constructor!==Object)return value.constructor.name||value.constructor;else return JSON.stringify(value)}else{return""+value}};exports.show=show;var toString=function(val){return val==null?"":String(val)};exports.toString=toString},{}],64:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.round=exports.isMultipleOf=void 0;var isMultipleOf=function(x,y){return y%x===0};exports.isMultipleOf=isMultipleOf;var round=function(x,n){if(n===void 0){n=0}var exp=Math.pow(10,n);var sign=x>=0?1:-1;var offset=n>0?1/Math.pow(10,n+1):0;return sign*(Math.round(Math.abs(x)*exp+offset)/exp)};exports.round=round},{}],65:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.isGroup=exports.isChild=exports.getId=exports.getParent=exports.make=exports.isRestricted=exports.ADDRESS_RESTRICTED=exports.ADDRESS_EMPTY=exports.ADDRESS_SYSTEM=exports.ADDRESS_DISCARD=exports.SEPERATOR=void 0;const array_1=require("@quenk/noni/lib/data/array");const string_1=require("@quenk/noni/lib/data/string");exports.SEPERATOR="/";exports.ADDRESS_DISCARD="?";exports.ADDRESS_SYSTEM="$";exports.ADDRESS_EMPTY="";exports.ADDRESS_RESTRICTED=[exports.ADDRESS_DISCARD,exports.ADDRESS_SYSTEM,exports.SEPERATOR];const isRestricted=id=>exports.ADDRESS_RESTRICTED.some(a=>id.indexOf(a)>-1)&&id!==exports.SEPERATOR;exports.isRestricted=isRestricted;const make=(parent,id)=>parent===exports.SEPERATOR||parent===exports.ADDRESS_EMPTY?`${parent}${id}`:parent===exports.ADDRESS_SYSTEM?id:`${parent}${exports.SEPERATOR}${id}`;exports.make=make;const getParent=addr=>{if(addr===exports.ADDRESS_SYSTEM||addr===exports.ADDRESS_EMPTY||addr===exports.ADDRESS_DISCARD||addr===exports.SEPERATOR){return exports.ADDRESS_SYSTEM}else{let b4=addr.split(exports.SEPERATOR);if(b4.length===2&&b4[0]===""){return exports.SEPERATOR}else{let a=b4.reverse().slice(1).reverse().join(exports.SEPERATOR);return a===exports.ADDRESS_EMPTY?exports.ADDRESS_SYSTEM:a}}};exports.getParent=getParent;const getId=addr=>addr===exports.ADDRESS_SYSTEM||addr===exports.ADDRESS_DISCARD||addr===exports.ADDRESS_EMPTY||addr===exports.SEPERATOR?addr:(0,array_1.tail)(addr.split(exports.SEPERATOR));exports.getId=getId;const isChild=(parent,child)=>parent===exports.ADDRESS_SYSTEM||parent!==child&&(0,string_1.startsWith)(child,parent);exports.isChild=isChild;const isGroup=addr=>addr[0]==="$"&&addr!=="$";exports.isGroup=isGroup},{"@quenk/noni/lib/data/array":55,"@quenk/noni/lib/data/string":62}],66:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.isResident=exports.isRouter=exports.isBuffered=exports.isImmutable=exports.FLAG_EXIT_AFTER_RUN=exports.FLAG_RESIDENT=exports.FLAG_ROUTER=exports.FLAG_EXIT_AFTER_RECEIVE=exports.FLAG_BUFFERED=exports.FLAG_IMMUTABLE=void 0;exports.FLAG_IMMUTABLE=1;exports.FLAG_BUFFERED=2;exports.FLAG_EXIT_AFTER_RECEIVE=4;exports.FLAG_ROUTER=8;exports.FLAG_RESIDENT=16;exports.FLAG_EXIT_AFTER_RUN=32;const isImmutable=f=>(f&exports.FLAG_IMMUTABLE)===exports.FLAG_IMMUTABLE;exports.isImmutable=isImmutable;const isBuffered=f=>(f&exports.FLAG_BUFFERED)===exports.FLAG_BUFFERED;exports.isBuffered=isBuffered;const isRouter=f=>(f&exports.FLAG_ROUTER)===exports.FLAG_ROUTER;exports.isRouter=isRouter;const isResident=f=>(f&exports.FLAG_RESIDENT)===exports.FLAG_RESIDENT;exports.isResident=isResident},{}],67:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Envelope=void 0;class Envelope{constructor(to,from,message){this.to=to;this.from=from;this.message=message}}exports.Envelope=Envelope},{}],68:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CaseFunction=void 0;class CaseFunction{constructor(cases){this.cases=cases}test(msg){return this.cases.some(kase=>kase.test(msg))}apply(msg){let kase=this.cases.find(kase=>kase.test(msg));if(!kase)throw new Error(`CaseFunction: No Case patterns match!`);return kase.apply(msg)}}exports.CaseFunction=CaseFunction},{}],69:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Default=exports.caseOf=exports.Case=void 0;const type_1=require("@quenk/noni/lib/data/type");class Case{constructor(pattern,handler){this.pattern=pattern;this.handler=handler}test(m){return(0,type_1.test)(m,this.pattern)}apply(m){return this.handler(m)}}exports.Case=Case;function caseOf(pattern,handler){return new Case(pattern,handler)}exports.caseOf=caseOf;class Default extends Case{constructor(handler){super(Object,handler);this.handler=handler}test(_){return true}apply(m){return this.handler(m)}}exports.Default=Default},{"@quenk/noni/lib/data/type":63}],70:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Callback=void 0;const _1=require("./");class Callback extends _1.Immutable{}exports.Callback=Callback},{"./":71}],71:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Immutable=void 0;const flags_1=require("../../flags");const function_1=require("../case/function");const __1=require("../");class Immutable extends __1.AbstractResident{get $receiver(){return new function_1.CaseFunction(this.receive())}init(c){c.flags=c.flags|flags_1.FLAG_IMMUTABLE|flags_1.FLAG_BUFFERED;return c}receive(){return[]}}exports.Immutable=Immutable},{"../":72,"../../flags":66,"../case/function":68}],72:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ref=exports.AbstractResident=void 0;const record_1=require("@quenk/noni/lib/data/record");const type_1=require("@quenk/noni/lib/data/type");const error_1=require("../system/vm/runtime/error");class AbstractResident{constructor(system){this.system=system;this.self=getSelf(this)}get platform(){return this.system.getPlatform()}notify(){this.platform.exec(this,"notify")}accept(_){}spawn(t){return this.system.getPlatform().spawn(this,t)}spawnGroup(group,tmpls){return(0,record_1.map)(tmpls,t=>this.spawn((0,type_1.isObject)(t)?(0,record_1.merge)(t,{group:group}):{group:group,create:t}))}tell(ref,msg){let{heap:heap}=this.platform;this.exec("tell",[heap.string(ref),heap.object(msg)]);return this}raise(e){this.system.getPlatform().raise(this,e);return this}kill(addr){let{heap:heap}=this.platform;this.exec("kill",[heap.string(addr)]);return this}exit(){this.kill(this.self())}start(addr){this.self=(()=>addr);return this.run()}run(){}stop(){}wait(ft){let mthread=this.platform.getThread(this.self());if(mthread.isJust())mthread.get().wait(ft);else this.raise(new error_1.UnknownInstanceErr(this))}exec(fname,args){this.platform.exec(this,fname,args)}}exports.AbstractResident=AbstractResident;const ref=(res,addr)=>m=>res.tell(addr,m);exports.ref=ref;const getSelf=actor=>{let _self="?";return()=>{if(_self==="?")_self=actor.system.getPlatform().identify(actor).orJust(()=>"?").get();return _self}}},{"../system/vm/runtime/error":80,"@quenk/noni/lib/data/record":60,"@quenk/noni/lib/data/type":63}],73:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Mutable=void 0;const flags_1=require("../../flags");const __1=require("../");const function_1=require("../case/function");class Mutable extends __1.AbstractResident{constructor(){super(...arguments);this.$receivers=[]}init(c){c.flags=c.flags|flags_1.FLAG_BUFFERED;return c}select(cases){this.$receivers.push(new function_1.CaseFunction(cases));this.notify();return this}}exports.Mutable=Mutable},{"../":72,"../../flags":66,"../case/function":68}],74:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TaskActorScript=exports.MutableActorScript=exports.CallbackActorScript=exports.ImmutableActorScript=exports.GenericResidentScript=void 0;const op=require("../system/vm/runtime/op");const events=require("../system/vm/event");const errors=require("../system/vm/runtime/error");const array_1=require("@quenk/noni/lib/data/array");const info_1=require("../system/vm/script/info");const scripts_1=require("../system/vm/scripts");const receiveIdx=scripts_1.commonFunctions.length+2;const residentCommonFunctions=[...scripts_1.commonFunctions,new info_1.NewFunInfo("notify",0,[op.MAILCOUNT,op.IFZJMP|5,op.MAILDQ,op.LDN|receiveIdx,op.CALL|1,op.NOP]),new info_1.NewForeignFunInfo("kill",1,(thr,addr)=>{thr.wait(thr.vm.kill(thr.context.actor,addr));return 0})];class GenericResidentScript extends scripts_1.BaseScript{constructor(){super(...arguments);this.info=residentCommonFunctions}}exports.GenericResidentScript=GenericResidentScript;class ImmutableActorScript extends scripts_1.BaseScript{constructor(actor){super();this.actor=actor;this.info=[...residentCommonFunctions,new info_1.NewForeignFunInfo("receive",1,(thr,msg)=>immutableExec(this.actor,thr,msg))];this.code=[]}}exports.ImmutableActorScript=ImmutableActorScript;class CallbackActorScript extends scripts_1.BaseScript{constructor(actor){super();this.actor=actor;this.info=[...residentCommonFunctions,new info_1.NewForeignFunInfo("receive",1,(thr,msg)=>{let result=immutableExec(this.actor,thr,msg);this.actor.exit();return result})];this.code=[]}}exports.CallbackActorScript=CallbackActorScript;class MutableActorScript extends scripts_1.BaseScript{constructor(actor){super();this.actor=actor;this.info=[...residentCommonFunctions,new info_1.NewForeignFunInfo("receive",1,(thr,msg)=>{let{actor:actor}=this;let vm=actor.system.getPlatform();if((0,array_1.empty)(actor.$receivers)){thr.raise(new errors.NoReceiverErr(thr.context.address));return 0}if(actor.$receivers[0].test(msg)){let receiver=actor.$receivers.shift();let future=receiver.apply(msg);if(future)thr.wait(future);vm.trigger(thr.context.address,events.EVENT_MESSAGE_READ,msg);return 1}else{vm.trigger(thr.context.address,events.EVENT_MESSAGE_DROPPED,msg);return 0}}),new info_1.NewFunInfo("notify",0,[op.MAILCOUNT,op.IFZJMP|4,op.MAILDQ,op.CALL|receiveIdx,op.NOP])];this.code=[]}}exports.MutableActorScript=MutableActorScript;class TaskActorScript extends scripts_1.BaseScript{constructor(){super(...arguments);this.info=scripts_1.commonFunctions}}exports.TaskActorScript=TaskActorScript;const immutableExec=(actor,thr,msg)=>{let vm=actor.system.getPlatform();if(actor.$receiver.test(msg)){let future=actor.$receiver.apply(msg);if(future)thr.wait(future);vm.trigger(thr.context.address,events.EVENT_MESSAGE_READ,msg);return 1}else{vm.trigger(thr.context.address,events.EVENT_MESSAGE_DROPPED,msg);return 0}}},{"../system/vm/event":76,"../system/vm/runtime/error":80,"../system/vm/runtime/op":85,"../system/vm/script/info":89,"../system/vm/scripts":91,"@quenk/noni/lib/data/array":55}],75:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.defaults=void 0;const log_1=require("./log");const defaults=()=>({log:{level:log_1.LOG_LEVEL_ERROR,logger:console},on:{},accept:()=>{}});exports.defaults=defaults},{"./log":78}],76:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getLevel=exports.events=exports.EVENT_ACTOR_STOPPED=exports.EVENT_ACTOR_STARTED=exports.EVENT_ACTOR_CREATED=exports.EVENT_MESSAGE_DROPPED=exports.EVENT_MESSAGE_READ=exports.EVENT_EXEC_ACTOR_CHANGED=exports.EVENT_EXEC_ACTOR_GONE=exports.EVENT_EXEC_INSTANCE_STALE=exports.EVENT_SEND_FAILED=exports.EVENT_SEND_OK=void 0;const log_1=require("./log");exports.EVENT_SEND_OK="message-send-ok";exports.EVENT_SEND_FAILED="message-send-failed";exports.EVENT_EXEC_INSTANCE_STALE="exec-instance-stale";exports.EVENT_EXEC_ACTOR_GONE="exec-actor-gone";exports.EVENT_EXEC_ACTOR_CHANGED="exec-actor-changed";exports.EVENT_MESSAGE_READ="message-read";exports.EVENT_MESSAGE_DROPPED="message-dropped";exports.EVENT_ACTOR_CREATED="actor-created";exports.EVENT_ACTOR_STARTED="actor-started";exports.EVENT_ACTOR_STOPPED="actor-stopped";exports.events={[exports.EVENT_ACTOR_CREATED]:{level:log_1.LOG_LEVEL_INFO},[exports.EVENT_ACTOR_STARTED]:{level:log_1.LOG_LEVEL_INFO},[exports.EVENT_SEND_OK]:{level:log_1.LOG_LEVEL_INFO},[exports.EVENT_MESSAGE_READ]:{level:log_1.LOG_LEVEL_INFO},[exports.EVENT_SEND_FAILED]:{level:log_1.LOG_LEVEL_WARN},[exports.EVENT_MESSAGE_DROPPED]:{level:log_1.LOG_LEVEL_WARN},[exports.EVENT_EXEC_INSTANCE_STALE]:{level:log_1.LOG_LEVEL_WARN},[exports.EVENT_EXEC_ACTOR_GONE]:{level:log_1.LOG_LEVEL_WARN},[exports.EVENT_EXEC_ACTOR_CHANGED]:{level:log_1.LOG_LEVEL_WARN},[exports.EVENT_ACTOR_STOPPED]:{level:log_1.LOG_LEVEL_WARN}};const getLevel=e=>exports.events.hasOwnProperty(e)?exports.events[e].level:log_1.LOG_LEVEL_DEBUG;exports.getLevel=getLevel},{"./log":78}],77:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.PVM=exports.MAX_WORK_LOAD=void 0;const template=require("../../template");const errors=require("./runtime/error");const events=require("./event");const future_1=require("@quenk/noni/lib/control/monad/future");const maybe_1=require("@quenk/noni/lib/data/maybe");const type_1=require("@quenk/noni/lib/data/type");const either_1=require("@quenk/noni/lib/data/either");const array_1=require("@quenk/noni/lib/data/array");const record_1=require("@quenk/noni/lib/data/record");const address_1=require("../../address");const flags_1=require("../../flags");const message_1=require("../../message");const scheduler_1=require("./thread/shared/scheduler");const shared_1=require("./thread/shared");const state_1=require("./state");const context_1=require("./runtime/context");const op_1=require("./runtime/op");const conf_1=require("./conf");const log_1=require("./log");const ledger_1=require("./runtime/heap/ledger");const factory_1=require("./scripts/factory");const event_1=require("./event");const ID_RANDOM=`#?POTOORAND?#${Date.now()}`;exports.MAX_WORK_LOAD=25;class PVM{constructor(system,conf=(0,conf_1.defaults)()){this.system=system;this.conf=conf;this._actorIdCounter=-1;this.heap=new ledger_1.DefaultHeapLedger;this.threadRunner=new scheduler_1.SharedScheduler(this);this.state={threads:{$:new shared_1.SharedThread(this,factory_1.ScriptFactory.getScript(this),this.threadRunner,(0,context_1.newContext)(this._actorIdCounter++,this,"$",{create:()=>this,trap:()=>template.ACTION_RAISE}))},routers:{},groups:{},pendingMessages:{}}}static create(s,conf={}){return new PVM(s,(0,record_1.rmerge)((0,conf_1.defaults)(),conf))}init(c){return c}accept(m){return this.conf.accept(m)}start(){}notify(){}stop(){return this.kill(this,address_1.ADDRESS_SYSTEM)}identify(inst){return(0,state_1.getAddress)(this.state,inst)}spawn(parent,tmpl){let mparentAddr=this.identify(parent);if(mparentAddr.isNothing()){this.raise(this,new errors.UnknownInstanceErr(parent));return"?"}return this._spawn(mparentAddr.get(),normalize(tmpl))}_spawn(parent,tmpl){let eresult=this.allocate(parent,tmpl);if(eresult.isLeft()){this.raise(this.state.threads[parent].context.actor,eresult.takeLeft());return"?"}let result=eresult.takeRight();this.runActor(result);if(Array.isArray(tmpl.children))tmpl.children.forEach(tmp=>this._spawn(result,tmp));return result}allocate(parent,tmpl){if(tmpl.id===ID_RANDOM){let rtime=(0,state_1.get)(this.state,parent).get();let prefix=rtime.context.actor.constructor.name.toLowerCase();tmpl.id=`actor::${this._actorIdCounter+1}~${prefix}`}if((0,address_1.isRestricted)(tmpl.id))return(0,either_1.left)(new errors.InvalidIdErr(tmpl.id));let addr=(0,address_1.make)(parent,tmpl.id);if(this.getThread(addr).isJust())return(0,either_1.left)(new errors.DuplicateAddressErr(addr));let args=Array.isArray(tmpl.args)?tmpl.args:[];let act=tmpl.create(this.system,tmpl,...args);let thr=new shared_1.SharedThread(this,factory_1.ScriptFactory.getScript(act),this.threadRunner,act.init((0,context_1.newContext)(this._actorIdCounter++,act,addr,tmpl)));this.putThread(addr,thr);this.trigger(addr,events.EVENT_ACTOR_CREATED);if((0,flags_1.isRouter)(thr.context.flags))this.putRoute(addr,addr);if(tmpl.group){let groups=typeof tmpl.group==="string"?[tmpl.group]:tmpl.group;groups.forEach(g=>this.putMember(g,addr))}return(0,either_1.right)(addr)}runActor(target){let mthread=this.getThread(target);if(mthread.isNothing())return(0,future_1.raise)(new errors.UnknownAddressErr(target));let rtime=mthread.get();let ft=rtime.context.actor.start(target);if(ft)rtime.wait(ft);if(rtime.context.flags&flags_1.FLAG_EXIT_AFTER_RUN)rtime.wait(this.kill(rtime.context.actor,target));this.trigger(rtime.context.address,events.EVENT_ACTOR_STARTED)}sendMessage(to,from,msg){let mRouter=this.getRouter(to);let mctx=mRouter.isJust()?mRouter:this.getThread(to).map(r=>r.context);let actualMessage=mRouter.isJust()?new message_1.Envelope(to,from,msg):msg;if(mctx.isJust()){let ctx=mctx.get();if((0,flags_1.isBuffered)(ctx.flags)){ctx.mailbox.push(actualMessage);ctx.actor.notify()}else{ctx.actor.accept(actualMessage)}this.trigger(from,events.EVENT_SEND_OK,to,msg);return true}else{this.trigger(from,events.EVENT_SEND_FAILED,to,msg);return false}}getThread(addr){return(0,state_1.get)(this.state,addr)}getRouter(addr){return(0,state_1.getRouter)(this.state,addr).map(r=>r.context)}getGroup(name){return(0,state_1.getGroup)(this.state,name.split("$").join(""))}getChildren(addr){return(0,maybe_1.fromNullable)((0,state_1.getChildren)(this.state,addr))}putThread(addr,r){this.state=(0,state_1.put)(this.state,addr,r);return this}putMember(group,addr){(0,state_1.putMember)(this.state,group,addr);return this}putRoute(target,router){(0,state_1.putRoute)(this.state,target,router);return this}remove(addr){this.state=(0,state_1.remove)(this.state,addr);(0,record_1.map)(this.state.routers,(r,k)=>{if(r===addr)delete this.state.routers[k]});return this}removeRoute(target){(0,state_1.removeRoute)(this.state,target);return this}raise(src,err){let maddr=this.identify(src);if(maddr.isNothing())return;let addr=maddr.get();let next=addr;loop:while(true){let mrtime=this.getThread(next);if(mrtime.isNothing())return;let rtime=mrtime.get();let trap=rtime.context.template.trap||(()=>template.ACTION_RAISE);switch(trap(err)){case template.ACTION_IGNORE:break loop;case template.ACTION_RESTART:let maddr=(0,state_1.get)(this.state,next);if(maddr.isJust())this.kill(maddr.get().context.actor,next).chain(()=>{let eRes=this.allocate((0,address_1.getParent)(next),rtime.context.template);if(eRes.isLeft())return(0,future_1.raise)(new Error(eRes.takeLeft().message));this.runActor(eRes.takeRight());return future_1.voidPure}).fork(e=>this.raise(this,e));break loop;case template.ACTION_STOP:let smaddr=(0,state_1.get)(this.state,next);if(smaddr.isJust())this.kill(smaddr.get().context.actor,next).fork(e=>this.raise(this,e));break loop;default:if(next===address_1.ADDRESS_SYSTEM){if(err instanceof Error)throw err;throw new Error(err.message)}else{next=(0,address_1.getParent)(next)}break}}}trigger(addr,evt,...args){let elvl=(0,event_1.getLevel)(evt);let{level:level,logger:logger}=this.conf.log;if(level>=elvl){switch(elvl){case log_1.LOG_LEVEL_DEBUG:logger.debug(addr,evt,args);break;case log_1.LOG_LEVEL_INFO:logger.info(addr,evt,args);break;case log_1.LOG_LEVEL_NOTICE:case log_1.LOG_LEVEL_WARN:logger.warn(addr,evt,args);break;case log_1.LOG_LEVEL_ERROR:logger.error(addr,evt,args);break;default:break}}if(this.conf.on[evt]!=null)this.conf.on[evt].apply(null,[addr,evt,...args])}logOp(r,f,op,oper){this.conf.log.logger.debug.apply(null,[`[${r.context.address}]`,`(${f.script.name})`,...(0,op_1.toLog)(op,r,f,oper)])}kill(parent,target){let that=this;return(0,future_1.doFuture)(function*(){let mparentAddr=that.identify(parent);if(mparentAddr.isNothing())return(0,future_1.pure)(undefined);let parentAddr=mparentAddr.get();let addrs=(0,address_1.isGroup)(target)?that.getGroup(target).orJust(()=>[]).get():[target];return runBatch(addrs.map(addr=>(0,future_1.doFuture)(function*(){if(!(0,address_1.isChild)(parentAddr,target)&&target!==parentAddr){let err=new Error(`IllegalStopErr: Actor "${parentAddr}" `+`cannot kill non-child "${addr}"!`);that.raise(parent,err);return(0,future_1.raise)(err)}let mthread=that.getThread(addr);if(mthread.isNothing())return(0,future_1.pure)(undefined);let thread=mthread.get();let mchilds=that.getChildren(target);let childs=mchilds.isJust()?mchilds.get():{};let killChild=(child,addr)=>(0,future_1.doFuture)(function*(){yield child.die();that.remove(addr);that.trigger(addr,events.EVENT_ACTOR_STOPPED);return future_1.voidPure});yield runBatch((0,record_1.mapTo)((0,record_1.map)(childs,killChild),f=>f));if(addr!==address_1.ADDRESS_SYSTEM)yield killChild(thread,addr);return future_1.voidPure})))})}tell(ref,msg){this.exec(this,"tell",[this.heap.string(ref),this.heap.object(msg)]);return this}exec(actor,funName,args=[]){let mAddress=this.identify(actor);if(mAddress.isNothing())return this.raise(this,new errors.UnknownInstanceErr(actor));let thread=this.state.threads[mAddress.get()];thread.exec(funName,args)}}exports.PVM=PVM;const runBatch=work=>(0,future_1.doFuture)(function*(){yield(0,future_1.batch)((0,array_1.distribute)(work,exports.MAX_WORK_LOAD));return future_1.voidPure});const normalize=spawnable=>{let tmpl=(0,type_1.isFunction)(spawnable)?{create:spawnable}:spawnable;tmpl.id=tmpl.id?tmpl.id:ID_RANDOM;return(0,record_1.merge)(tmpl,{children:(0,record_1.isRecord)(tmpl.children)?(0,record_1.mapTo)(tmpl.children,(c,k)=>(0,record_1.merge)(c,{id:k})):tmpl.children?tmpl.children:[]})}},{"../../address":65,"../../flags":66,"../../message":67,"../../template":97,"./conf":75,"./event":76,"./log":78,"./runtime/context":79,"./runtime/error":80,"./runtime/heap/ledger":81,"./runtime/op":85,"./scripts/factory":90,"./state":92,"./thread/shared":94,"./thread/shared/scheduler":95,"@quenk/noni/lib/control/monad/future":52,"@quenk/noni/lib/data/array":55,"@quenk/noni/lib/data/either":57,"@quenk/noni/lib/data/maybe":59,"@quenk/noni/lib/data/record":60,"@quenk/noni/lib/data/type":63}],78:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.LOG_LEVEL_ERROR=exports.LOG_LEVEL_WARN=exports.LOG_LEVEL_NOTICE=exports.LOG_LEVEL_INFO=exports.LOG_LEVEL_DEBUG=void 0;exports.LOG_LEVEL_DEBUG=7;exports.LOG_LEVEL_INFO=6;exports.LOG_LEVEL_NOTICE=5;exports.LOG_LEVEL_WARN=4;exports.LOG_LEVEL_ERROR=3},{}],79:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.newContext=void 0;const newContext=(aid,actor,address,template)=>({aid:aid,mailbox:[],actor:actor,receivers:[],flags:0,address:address,template:template});exports.newContext=newContext},{}],80:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.UnknownFunErr=exports.UnknownInstanceErr=exports.InvalidFunctionErr=exports.InvalidConstructorErr=exports.MissingInfoErr=exports.InvalidPropertyIndex=exports.StackEmptyErr=exports.IntegerOverflowErr=exports.MissingSymbolErr=exports.UnknownAddressErr=exports.EmptyMailboxErr=exports.NoMailboxErr=exports.NoReceiverErr=exports.IllegalStopErr=exports.UnexpectedDataType=exports.NullPointerErr=exports.JumpOutOfBoundsErr=exports.NullFunctionPointerErr=exports.NullTemplatePointerErr=exports.DuplicateAddressErr=exports.UnknownParentAddressErr=exports.InvalidIdErr=exports.Error=void 0;const address_1=require("../../../address");const frame_1=require("./stack/frame");class Error{constructor(message){this.message=message}}exports.Error=Error;class InvalidIdErr extends Error{constructor(id){super(`The id "${id} must not contain`+`${address_1.ADDRESS_RESTRICTED} or be an empty string!`);this.id=id}}exports.InvalidIdErr=InvalidIdErr;class UnknownParentAddressErr extends Error{constructor(address){super(`The parent address "${address}" is not part of the system!`);this.address=address}}exports.UnknownParentAddressErr=UnknownParentAddressErr;class DuplicateAddressErr extends Error{constructor(address){super(`Duplicate address "${address}" detected!`);this.address=address}}exports.DuplicateAddressErr=DuplicateAddressErr;class NullTemplatePointerErr extends Error{constructor(index){super(`The index "${index}" does not exist in the Template table!`);this.index=index}}exports.NullTemplatePointerErr=NullTemplatePointerErr;class NullFunctionPointerErr extends Error{constructor(index){super(`The index "${index}" does not exist in the function table!`);this.index=index}}exports.NullFunctionPointerErr=NullFunctionPointerErr;class JumpOutOfBoundsErr extends Error{constructor(location,size){super(`Cannot jump to location "${location}"! Max location: ${size}!`);this.location=location;this.size=size}}exports.JumpOutOfBoundsErr=JumpOutOfBoundsErr;class NullPointerErr extends Error{constructor(data){super(`Value: [${data.toString(16)}]`);this.data=data}}exports.NullPointerErr=NullPointerErr;class UnexpectedDataType extends Error{constructor(expected,got){super(`Expected: ${expected.toString(16)}, `+`Received: ${got.toString(16)}`);this.expected=expected;this.got=got}}exports.UnexpectedDataType=UnexpectedDataType;class IllegalStopErr extends Error{constructor(parent,child){super(`The actor at address "${parent}" can not kill "${child}"!`);this.parent=parent;this.child=child}}exports.IllegalStopErr=IllegalStopErr;class NoReceiverErr extends Error{constructor(actor){super(`Actor ${actor} tried to read a message without a receiver!`);this.actor=actor}}exports.NoReceiverErr=NoReceiverErr;class NoMailboxErr extends Error{constructor(actor){super(`Actor ${actor} has no mailbox!`);this.actor=actor}}exports.NoMailboxErr=NoMailboxErr;class EmptyMailboxErr extends Error{constructor(){super("Mailbox empty.")}}exports.EmptyMailboxErr=EmptyMailboxErr;class UnknownAddressErr extends Error{constructor(actor){super(`The system has no actor for address "${actor}"!`);this.actor=actor}}exports.UnknownAddressErr=UnknownAddressErr;class MissingSymbolErr extends Error{constructor(index){super(`Cannot locate symbol at index 0x${index.toString(16)}`);this.index=index}}exports.MissingSymbolErr=MissingSymbolErr;class IntegerOverflowErr extends Error{constructor(){super(`DATA_MAX_SAFE_UINT32=${frame_1.DATA_MAX_SAFE_UINT32}`)}}exports.IntegerOverflowErr=IntegerOverflowErr;class StackEmptyErr extends Error{constructor(){super("Stack is empty.")}}exports.StackEmptyErr=StackEmptyErr;class InvalidPropertyIndex extends Error{constructor(cons,idx){super(`Constructor: ${cons.name}, index: ${idx}`);this.cons=cons;this.idx=idx}}exports.InvalidPropertyIndex=InvalidPropertyIndex;class MissingInfoErr extends Error{constructor(idx){super(`No info object index: ${idx}!`);this.idx=idx}}exports.MissingInfoErr=MissingInfoErr;class InvalidConstructorErr extends Error{constructor(name){super(`Named object "${name}" cannot be used as a constructor!`);this.name=name}}exports.InvalidConstructorErr=InvalidConstructorErr;class InvalidFunctionErr extends Error{constructor(name){super(`Named object "${name}" cannot be used as a function!`);this.name=name}}exports.InvalidFunctionErr=InvalidFunctionErr;class UnknownInstanceErr extends Error{constructor(instance){super("The instance provided with constructor "+(instance?instance.constructor.name||instance:instance)+'" is not in the system!');this.instance=instance}}exports.UnknownInstanceErr=UnknownInstanceErr;class UnknownFunErr extends Error{constructor(name){super(`The function '${name}' does not exist and cannot be executed!`);this.name=name}}exports.UnknownFunErr=UnknownFunErr},{"../../../address":65,"./stack/frame":87}],81:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.isHeapAddress=exports.DefaultHeapLedger=void 0;const maybe_1=require("@quenk/noni/lib/data/maybe");const record_1=require("@quenk/noni/lib/data/record");const type_1=require("@quenk/noni/lib/data/type");const info_1=require("../../script/info");const frame_1=require("../stack/frame");class DefaultHeapLedger{constructor(objects={},owners={}){this.objects=objects;this.owners=owners;this.counter=0}_addItem(name,value,flag){let addr=this.counter++|flag;this.objects[addr]=value;if(name!=="")this.owners[addr]=name;return addr}string(value){return this._addItem("",value,frame_1.DATA_TYPE_HEAP_STRING)}object(value){return this._addItem("",value,frame_1.DATA_TYPE_HEAP_OBJECT)}fun(value){return this._addItem("",value,frame_1.DATA_TYPE_HEAP_FUN)}addString(frame,value){return this._addItem(frame.name,value,frame_1.DATA_TYPE_HEAP_STRING)}addObject(frame,obj){return this._addItem(frame.name,obj,frame_1.DATA_TYPE_HEAP_OBJECT)}addFun(frame,obj){return this._addItem(frame.name,obj,frame_1.DATA_TYPE_HEAP_FUN)}getString(ref){let value=this.objects[ref];return value!=null?value:""}getObject(ref){return(0,maybe_1.fromNullable)(this.objects[ref])}getFrameRefs(frame){return(0,record_1.mapTo)((0,record_1.filter)(this.owners,owner=>owner===frame.name),(_,k)=>Number(k))}getThreadRefs(thread){return(0,record_1.mapTo)((0,record_1.filter)(this.owners,owner=>threadId(owner)===thread.context.aid),(_,k)=>Number(k))}intern(frame,value){let maddr=(0,record_1.pickKey)(this.objects,val=>val===value);if(maddr.isJust())return Number(maddr.get());if((0,type_1.isNumber)(value))return value;else if((0,type_1.isString)(value))return this.addString(frame,value);else if((0,type_1.isObject)(value))return value instanceof info_1.NewFunInfo||value instanceof info_1.NewForeignFunInfo?this.addFun(frame,value):this.addObject(frame,value);else return 0}move(ref,newOwner){this.owners[ref]=newOwner;return ref}frameExit(frame){if(frame.parent.isJust()&&(0,exports.isHeapAddress)(frame.thread.rp))this.move(frame.thread.rp,frame.parent.get().name);this.getFrameRefs(frame).forEach(ref=>{if(ref!==frame.thread.rp){delete this.objects[ref];delete this.owners[ref]}})}threadExit(thread){this.getThreadRefs(thread).forEach(ref=>{delete this.objects[ref];delete this.owners[ref]})}}exports.DefaultHeapLedger=DefaultHeapLedger;const isHeapAddress=ref=>{let kind=ref&frame_1.DATA_MASK_TYPE;return kind===frame_1.DATA_TYPE_HEAP_STRING||kind===frame_1.DATA_TYPE_HEAP_OBJECT};exports.isHeapAddress=isHeapAddress;const threadId=name=>Number(name.split("@")[1].split("#")[0])},{"../../script/info":89,"../stack/frame":87,"@quenk/noni/lib/data/maybe":59,"@quenk/noni/lib/data/record":60,"@quenk/noni/lib/data/type":63}],82:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MAX_INSTRUCTION=exports.OPERAND_RANGE_END=exports.OPERAND_RANGE_START=exports.OPCODE_RANGE_END=exports.OPCODE_RANGE_START=exports.OPERAND_MASK=exports.OPCODE_MASK=void 0;exports.OPCODE_MASK=4278190080;exports.OPERAND_MASK=16777215;exports.OPCODE_RANGE_START=16777216;exports.OPCODE_RANGE_END=4278190080;exports.OPERAND_RANGE_START=0;exports.OPERAND_RANGE_END=16777215;exports.MAX_INSTRUCTION=4294967295},{}],83:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.stop=exports.maildq=exports.mailcount=exports.recvcount=exports.recv=exports.send=exports.self=exports.alloc=void 0;const alloc=(r,f,_)=>{let eTemp=f.popObject();if(eTemp.isLeft())return r.raise(eTemp.takeLeft());let temp=eTemp.takeRight().promote();let eParent=f.popString();if(eParent.isLeft())return r.raise(eParent.takeLeft());let eresult=r.vm.allocate(eParent.takeRight(),temp);if(eresult.isLeft()){r.raise(eresult.takeLeft())}else{f.push(r.vm.heap.addString(f,eresult.takeRight()))}};exports.alloc=alloc;const self=(_,f,__)=>{f.pushSelf()};exports.self=self;const send=(r,f,_)=>{let eMsg=f.popValue();if(eMsg.isLeft())return r.raise(eMsg.takeLeft());let eAddr=f.popString();if(eAddr.isLeft())return r.raise(eAddr.takeLeft());if(r.vm.sendMessage(eAddr.takeRight(),r.context.address,eMsg.takeRight()))f.pushUInt8(1);else f.pushUInt8(0)};exports.send=send;const recv=(r,f,_)=>{let einfo=f.popFunction();if(einfo.isLeft())return r.raise(einfo.takeLeft());r.context.receivers.push(einfo.takeRight());if(r.context.mailbox.length>0)r.context.actor.notify()};exports.recv=recv;const recvcount=(r,f,_)=>{f.push(r.context.receivers.length)};exports.recvcount=recvcount;const mailcount=(r,f,_)=>{f.push(r.context.mailbox.length)};exports.mailcount=mailcount;const maildq=(_,f,__)=>{f.pushMessage()};exports.maildq=maildq;const stop=(r,f,_)=>{let eaddr=f.popString();if(eaddr.isLeft())return r.raise(eaddr.takeLeft());r.wait(r.vm.kill(r.context.actor,eaddr.takeRight()))};exports.stop=stop},{}],84:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ifneqjmp=exports.ifeqjmp=exports.ifnzjmp=exports.ifzjmp=exports.jmp=exports.raise=exports.call=exports.addui32=exports.ceq=exports.load=exports.store=exports.dup=exports.ldn=exports.lds=exports.pushui32=exports.pushui16=exports.pushui8=exports.nop=void 0;const error=require("../error");const array_1=require("@quenk/noni/lib/data/array");const frame_1=require("../stack/frame");const nop=(_,__,___)=>{};exports.nop=nop;const pushui8=(_,f,oper)=>{f.pushUInt8(oper)};exports.pushui8=pushui8;const pushui16=(_,f,oper)=>{f.pushUInt16(oper)};exports.pushui16=pushui16;const pushui32=(_,f,oper)=>{f.pushUInt32(oper)};exports.pushui32=pushui32;const lds=(_,f,idx)=>{f.pushString(idx)};exports.lds=lds;const ldn=(_,f,idx)=>{f.pushName(idx)};exports.ldn=ldn;const dup=(_,f,__)=>{f.duplicate()};exports.dup=dup;const store=(_,f,idx)=>{f.locals[idx]=f.pop()};exports.store=store;const load=(_,f,idx)=>{let d=f.locals[idx];f.push(d==null?0:d)};exports.load=load;const ceq=(r,f,__)=>{let eLhs=f.popValue();let eRhs=f.popValue();if(eLhs.isLeft())return r.raise(eLhs.takeLeft());if(eRhs.isLeft())return r.raise(eRhs.takeLeft());if(eLhs.takeRight()===eRhs.takeRight())f.push(1);else f.push(0)};exports.ceq=ceq;const addui32=(r,f,_)=>{let val=f.pop()+f.pop();if(val>frame_1.DATA_MAX_SAFE_UINT32)return r.raise(new error.IntegerOverflowErr);f.push(val)};exports.addui32=addui32;const call=(r,f,_)=>{let einfo=f.popFunction();if(einfo.isLeft())return r.raise(einfo.takeLeft());let fn=einfo.takeRight();if(fn.foreign===true){let args=(0,array_1.make)(fn.argc||0,()=>f.popValue().takeRight());r.invokeForeign(f,fn,args)}else{r.invokeVM(f,fn)}};exports.call=call;const raise=(r,f,_)=>{let emsg=f.popString();r.raise(new Error(emsg.takeRight()))};exports.raise=raise;const jmp=(_,f,oper)=>{f.seek(oper)};exports.jmp=jmp;const ifzjmp=(_,f,oper)=>{let eValue=f.popValue();if(eValue.isLeft()||eValue.takeRight()===0)f.seek(oper)};exports.ifzjmp=ifzjmp;const ifnzjmp=(_,f,oper)=>{let eValue=f.popValue();if(eValue.isRight()&&eValue.takeRight()!==0)f.seek(oper)};exports.ifnzjmp=ifnzjmp;const ifeqjmp=(r,f,oper)=>{let eLhs=f.popValue();let eRhs=f.popValue();if(eLhs.isLeft())r.raise(eLhs.takeLeft());else if(eRhs.isLeft())r.raise(eRhs.takeLeft());else if(eLhs.takeRight()===eRhs.takeRight())f.seek(oper)};exports.ifeqjmp=ifeqjmp;const ifneqjmp=(r,f,oper)=>{let eLhs=f.popValue();let eRhs=f.popValue();if(eLhs.isLeft())r.raise(eLhs.takeLeft());else if(eRhs.isLeft())r.raise(eRhs.takeLeft());else if(eLhs.takeRight()!==eRhs.takeRight())f.seek(oper)};exports.ifneqjmp=ifneqjmp},{"../error":80,"../stack/frame":87,"@quenk/noni/lib/data/array":55}],85:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.toLog=exports.toName=exports.handlers=exports.opcodes=exports.ARELM=exports.ARLENGTH=exports.GETPROP=exports.STOP=exports.SELF=exports.MAILDQ=exports.MAILCOUNT=exports.RECVCOUNT=exports.RECV=exports.SEND=exports.ALLOC=exports.IFNEQJMP=exports.IFEQJMP=exports.IFNZJMP=exports.IFZJMP=exports.JMP=exports.RAISE=exports.CALL=exports.ADDUI32=exports.CEQ=exports.LOAD=exports.STORE=exports.DUP=exports.LDN=exports.LDS=exports.PUSHUI32=exports.PUSHUI16=exports.PUSHUI8=exports.NOP=exports.OP_CODE_RANGE_STEP=exports.OP_CODE_RANGE_HIGH=exports.OP_CODE_RANGE_LOW=void 0;const base=require("./base");const actor=require("./actor");const obj=require("./object");const record_1=require("@quenk/noni/lib/data/record");const frame_1=require("../stack/frame");exports.OP_CODE_RANGE_LOW=16777216;exports.OP_CODE_RANGE_HIGH=4278190080;exports.OP_CODE_RANGE_STEP=16777216;exports.NOP=exports.OP_CODE_RANGE_STEP;exports.PUSHUI8=exports.OP_CODE_RANGE_STEP*2;exports.PUSHUI16=exports.OP_CODE_RANGE_STEP*3;exports.PUSHUI32=exports.OP_CODE_RANGE_STEP*4;exports.LDS=exports.OP_CODE_RANGE_STEP*5;exports.LDN=exports.OP_CODE_RANGE_STEP*6;exports.DUP=exports.OP_CODE_RANGE_STEP*15;exports.STORE=exports.OP_CODE_RANGE_STEP*16;exports.LOAD=exports.OP_CODE_RANGE_STEP*20;exports.CEQ=exports.OP_CODE_RANGE_STEP*42;exports.ADDUI32=exports.OP_CODE_RANGE_STEP*52;exports.CALL=exports.OP_CODE_RANGE_STEP*62;exports.RAISE=exports.OP_CODE_RANGE_STEP*63;exports.JMP=exports.OP_CODE_RANGE_STEP*72;exports.IFZJMP=exports.OP_CODE_RANGE_STEP*73;exports.IFNZJMP=exports.OP_CODE_RANGE_STEP*80;exports.IFEQJMP=exports.OP_CODE_RANGE_STEP*81;exports.IFNEQJMP=exports.OP_CODE_RANGE_STEP*82;exports.ALLOC=exports.OP_CODE_RANGE_STEP*92;exports.SEND=exports.OP_CODE_RANGE_STEP*94;exports.RECV=exports.OP_CODE_RANGE_STEP*95;exports.RECVCOUNT=exports.OP_CODE_RANGE_STEP*96;exports.MAILCOUNT=exports.OP_CODE_RANGE_STEP*97;exports.MAILDQ=exports.OP_CODE_RANGE_STEP*98;exports.SELF=exports.OP_CODE_RANGE_STEP*99;exports.STOP=exports.OP_CODE_RANGE_STEP*101;exports.GETPROP=exports.OP_CODE_RANGE_STEP*110;exports.ARLENGTH=exports.OP_CODE_RANGE_STEP*111;exports.ARELM=exports.OP_CODE_RANGE_STEP*112;exports.opcodes={[exports.NOP]:{name:"nop",handler:base.nop,log:()=>["nop"]},[exports.PUSHUI8]:{name:"pushui8",handler:base.pushui8,log:(_,__,oper)=>["pushui8",oper]},[exports.PUSHUI16]:{name:"pushui16",handler:base.pushui16,log:(_,__,oper)=>["pushui16",oper]},[exports.PUSHUI32]:{name:"pushui32",handler:base.pushui32,log:(_,__,oper)=>["pushui32",oper]},[exports.LDS]:{name:"lds",handler:base.lds,log:(_,f,oper)=>["lds",oper,eToLog(f.resolve(frame_1.DATA_TYPE_STRING|oper))]},[exports.LDN]:{name:"ldn",handler:base.ldn,log:(_,f,oper)=>["ldn",oper,eToLog(f.resolve(frame_1.DATA_TYPE_INFO|oper))]},[exports.DUP]:{name:"dup",handler:base.dup,log:(_,__,___)=>["dup"]},[exports.STORE]:{name:"store",handler:base.store,log:(_,__,oper)=>["store",oper]},[exports.LOAD]:{name:"load",handler:base.load,log:(_,f,oper)=>["load",oper,eToLog(f.resolve(frame_1.DATA_TYPE_LOCAL|oper))]},[exports.CEQ]:{name:"ceq",handler:base.ceq,log:(_,__,___)=>["ceq"]},[exports.ADDUI32]:{name:"addui32",handler:base.addui32,log:(_,__,___)=>["addui32"]},[exports.CALL]:{name:"call",handler:base.call,log:(_,__,___)=>["call"]},[exports.RAISE]:{name:"raise",handler:base.raise,log:(_,__,___)=>["raise"]},[exports.JMP]:{name:"jmp",handler:base.jmp,log:(_,__,oper)=>["jmp",oper]},[exports.IFZJMP]:{name:"ifzjmp",handler:base.ifzjmp,log:(_,__,oper)=>["ifzjmp",oper]},[exports.IFNZJMP]:{name:"ifnzjmp",handler:base.ifnzjmp,log:(_,__,oper)=>["ifnzjmp",oper]},[exports.IFEQJMP]:{name:"ifeqjmp",handler:base.ifeqjmp,log:(_,__,oper)=>["ifeqjmp",oper]},[exports.IFNEQJMP]:{name:"ifneqjmp",handler:base.ifneqjmp,log:(_,__,oper)=>["ifneqjmp",oper]},[exports.ALLOC]:{name:"alloc",handler:actor.alloc,log:(_,__,___)=>["alloc"]},[exports.SEND]:{name:"send",handler:actor.send,log:(_,__,___)=>["send"]},[exports.RECV]:{name:"recv",handler:actor.recv,log:(_,f,oper)=>["recv",oper,eToLog(f.resolve(frame_1.DATA_TYPE_INFO|oper))]},[exports.RECVCOUNT]:{name:"recvcount",handler:actor.recvcount,log:(_,__,___)=>["recvcount"]},[exports.MAILCOUNT]:{name:"mailcount",handler:actor.mailcount,log:(_,__,___)=>["mailcount"]},[exports.MAILDQ]:{name:"maildq",handler:actor.maildq,log:(_,__,___)=>["maildq"]},[exports.SELF]:{name:"self",handler:actor.self,log:(_,__,___)=>["self"]},[exports.STOP]:{name:"stop",handler:actor.stop,log:(_,__,___)=>["stop"]},[exports.GETPROP]:{name:"getprop",handler:obj.getprop,log:(_,__,oper)=>["getprop",oper]},[exports.ARELM]:{name:"arelm",handler:obj.arelm,log:(_,__,oper)=>["arelm",oper]},[exports.ARLENGTH]:{name:"arlength",handler:obj.arlength,log:(_,__,___)=>["arlength"]}};const eToLog=e=>e.isLeft()?e.takeLeft().message:e.takeRight();exports.handlers=(0,record_1.map)(exports.opcodes,i=>i.handler);const toName=op=>exports.opcodes.hasOwnProperty(op)?exports.opcodes[op].name:"<unknown>";exports.toName=toName;const toLog=(op,r,f,oper)=>exports.opcodes.hasOwnProperty(op)?exports.opcodes[op].log(r,f,oper):[];exports.toLog=toLog},{"../stack/frame":87,"./actor":83,"./base":84,"./object":86,"@quenk/noni/lib/data/record":60}],86:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.arelm=exports.arlength=exports.getprop=void 0;const getprop=(r,f,idx)=>{let eobj=f.popObject();if(eobj.isLeft())return r.raise(eobj.takeLeft());let obj=eobj.takeRight();let mval=obj.get(idx);if(mval.isJust()){f.push(r.vm.heap.intern(f,mval.get()))}else{f.push(0)}};exports.getprop=getprop;const arlength=(r,f,_)=>{let eobj=f.popObject();if(eobj.isLeft())return r.raise(eobj.takeLeft());let obj=eobj.takeRight();f.push(obj.getCount())};exports.arlength=arlength;const arelm=(r,f,_)=>{let earr=f.popObject();if(earr.isLeft())return r.raise(earr.takeLeft());let arr=earr.takeRight();let melm=arr.get(f.pop());if(melm.isJust()){f.push(r.vm.heap.intern(f,melm.get()))}else{f.push(0)}};exports.arelm=arelm},{}],87:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.StackFrame=exports.BYTE_CONSTANT_INFO=exports.BYTE_CONSTANT_STR=exports.BYTE_CONSTANT_NUM=exports.DATA_TYPE_SELF=exports.DATA_TYPE_MAILBOX=exports.DATA_TYPE_LOCAL=exports.DATA_TYPE_HEAP_FUN=exports.DATA_TYPE_HEAP_FOREIGN=exports.DATA_TYPE_HEAP_OBJECT=exports.DATA_TYPE_HEAP_STRING=exports.DATA_TYPE_INFO=exports.DATA_TYPE_STRING=exports.DATA_MAX_SAFE_UINT32=exports.DATA_MAX_SIZE=exports.DATA_MASK_VALUE32=exports.DATA_MASK_VALUE24=exports.DATA_MASK_VALUE16=exports.DATA_MASK_VALUE8=exports.DATA_MASK_TYPE=exports.DATA_RANGE_TYPE_STEP=exports.DATA_RANGE_TYPE_LOW=exports.DATA_RANGE_TYPE_HIGH=void 0;const indexes=require("../../script");const error=require("../error");const either_1=require("@quenk/noni/lib/data/either");const maybe_1=require("@quenk/noni/lib/data/maybe");const type_1=require("../../type");exports.DATA_RANGE_TYPE_HIGH=4026531840;exports.DATA_RANGE_TYPE_LOW=16777216;exports.DATA_RANGE_TYPE_STEP=16777216;exports.DATA_MASK_TYPE=4278190080;exports.DATA_MASK_VALUE8=255;exports.DATA_MASK_VALUE16=65535;exports.DATA_MASK_VALUE24=16777215;exports.DATA_MASK_VALUE32=4294967295;exports.DATA_MAX_SIZE=4294967295;exports.DATA_MAX_SAFE_UINT32=2147483647;exports.DATA_TYPE_STRING=exports.DATA_RANGE_TYPE_STEP*3;exports.DATA_TYPE_INFO=exports.DATA_RANGE_TYPE_STEP*4;exports.DATA_TYPE_HEAP_STRING=exports.DATA_RANGE_TYPE_STEP*6;exports.DATA_TYPE_HEAP_OBJECT=exports.DATA_RANGE_TYPE_STEP*7;exports.DATA_TYPE_HEAP_FOREIGN=exports.DATA_RANGE_TYPE_STEP*8;exports.DATA_TYPE_HEAP_FUN=exports.DATA_RANGE_TYPE_STEP*9;exports.DATA_TYPE_LOCAL=exports.DATA_RANGE_TYPE_STEP*10;exports.DATA_TYPE_MAILBOX=exports.DATA_RANGE_TYPE_STEP*11;exports.DATA_TYPE_SELF=exports.DATA_RANGE_TYPE_STEP*12;exports.BYTE_CONSTANT_NUM=65536;exports.BYTE_CONSTANT_STR=131072;exports.BYTE_CONSTANT_INFO=196608;class StackFrame{constructor(name,script,thread,parent=(0,maybe_1.nothing)(),code=[],data=[],locals=[],ip=0){this.name=name;this.script=script;this.thread=thread;this.parent=parent;this.code=code;this.data=data;this.locals=locals;this.ip=ip}getPosition(){return this.ip}push(d){this.data.push(d);return this}pushUInt8(value){return this.push(value>>>0&exports.DATA_MASK_VALUE8)}pushUInt16(value){return this.push(value>>>0&exports.DATA_MASK_VALUE16)}pushUInt32(value){return this.push(value>>>0)}pushString(idx){return this.push(idx|exports.DATA_TYPE_STRING)}pushName(idx){return this.push(idx|exports.DATA_TYPE_INFO)}pushMessage(){return this.push(0|exports.DATA_TYPE_MAILBOX)}pushSelf(){return this.push(exports.DATA_TYPE_SELF)}peek(n=0){return(0,maybe_1.fromNullable)(this.data.length-(n+1))}resolve(data){let{context:context}=this.thread;let typ=data&exports.DATA_MASK_TYPE;let value=data&exports.DATA_MASK_VALUE24;switch(typ){case exports.DATA_TYPE_STRING:case exports.DATA_TYPE_HEAP_STRING:this.push(data);return this.popString();case exports.DATA_TYPE_HEAP_FUN:this.push(data);return this.popFunction();case exports.DATA_TYPE_HEAP_OBJECT:this.push(data);return this.popObject();case exports.DATA_TYPE_HEAP_FOREIGN:this.push(data);return this.popForeign();case exports.DATA_TYPE_INFO:this.push(data);return this.popName();case exports.DATA_TYPE_LOCAL:let mRef=(0,maybe_1.fromNullable)(this.locals[value]);if(mRef.isNothing())return nullErr(data);return this.resolve(mRef.get());case exports.DATA_TYPE_MAILBOX:if(context.mailbox.length===0)return nullErr(data);return(0,either_1.right)(context.mailbox.shift());case exports.DATA_TYPE_SELF:return(0,either_1.right)(context.address);default:return(0,either_1.right)(value)}}pop(){return this.data.pop()|0}popValue(){return this.data.length===0?(0,either_1.left)(new error.StackEmptyErr):this.resolve(this.pop())}popString(){let data=this.pop();let typ=data&exports.DATA_MASK_TYPE;let idx=data&exports.DATA_MASK_VALUE24;if(typ===exports.DATA_TYPE_STRING){let s=this.script.constants[indexes.CONSTANTS_INDEX_STRING][idx];if(s==null)return missingSymbol(data);return(0,either_1.right)(s)}else if(typ===exports.DATA_TYPE_HEAP_STRING){return(0,either_1.right)(this.thread.vm.heap.getString(data))}else if(typ===exports.DATA_TYPE_SELF){return(0,either_1.right)(this.thread.context.address)}else{return wrongType(exports.DATA_TYPE_STRING,typ)}}popName(){let data=this.pop();let typ=data&exports.DATA_MASK_TYPE;let idx=data&exports.DATA_MASK_VALUE24;if(typ===exports.DATA_TYPE_INFO){let info=this.script.info[idx];if(info==null)return nullErr(data);return(0,either_1.right)(info)}else{return wrongType(exports.DATA_TYPE_INFO,data)}}popFunction(){let data=this.pop();let typ=data&exports.DATA_MASK_TYPE;if(typ===exports.DATA_TYPE_HEAP_FUN){let mFun=this.thread.vm.heap.getObject(data);return mFun.isJust()?(0,either_1.right)(mFun.get()):nullFunPtr(data)}else{this.push(data);return this.popName().chain(nfo=>{if((nfo.descriptor&type_1.BYTE_TYPE)!==type_1.TYPE_FUN)return notAFunction(nfo.name);return(0,either_1.right)(nfo)})}}popObject(){let data=this.pop();let typ=data&exports.DATA_MASK_TYPE;if(typ===exports.DATA_TYPE_HEAP_OBJECT){let mho=this.thread.vm.heap.getObject(data);if(mho.isNothing())return nullErr(data);return(0,either_1.right)(mho.get())}else{return wrongType(exports.DATA_TYPE_HEAP_OBJECT,typ)}}popForeign(){let data=this.pop();let typ=data&exports.DATA_MASK_TYPE;if(typ===exports.DATA_TYPE_HEAP_FOREIGN){let mho=this.thread.vm.heap.getObject(data);if(mho.isNothing())return nullErr(data);return(0,either_1.right)(mho.get())}else{return wrongType(exports.DATA_TYPE_HEAP_FOREIGN,typ)}}duplicate(){let top=this.data.pop();this.data.push(top);this.data.push(top);return this}advance(){this.ip=this.ip+1;return this}seek(loc){this.ip=loc;return this}isFinished(){return this.ip>=this.code.length}}exports.StackFrame=StackFrame;const nullErr=data=>(0,either_1.left)(new error.NullPointerErr(data));const wrongType=(expect,got)=>(0,either_1.left)(new error.UnexpectedDataType(expect,got));const notAFunction=name=>(0,either_1.left)(new error.InvalidFunctionErr(name));const nullFunPtr=addr=>(0,either_1.left)(new error.NullFunctionPointerErr(addr));const missingSymbol=data=>(0,either_1.left)(new error.MissingSymbolErr(data))},{"../../script":88,"../../type":96,"../error":80,"@quenk/noni/lib/data/either":57,"@quenk/noni/lib/data/maybe":59}],88:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getInfo=exports.PScript=exports.CONSTANTS_INDEX_STRING=exports.CONSTANTS_INDEX_NUMBER=void 0;const either_1=require("@quenk/noni/lib/data/either");const error_1=require("../runtime/error");exports.CONSTANTS_INDEX_NUMBER=0;exports.CONSTANTS_INDEX_STRING=1;class PScript{constructor(name,constants=[[],[]],info=[],code=[]){this.name=name;this.constants=constants;this.info=info;this.code=code}}exports.PScript=PScript;const getInfo=(s,idx)=>{if(s.info[idx]==null)return(0,either_1.left)(new error_1.MissingInfoErr(idx));return(0,either_1.right)(s.info[idx])};exports.getInfo=getInfo},{"../runtime/error":80,"@quenk/noni/lib/data/either":57}],89:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.funType=exports.objectType=exports.arrayType=exports.stringType=exports.booleanType=exports.uint32Type=exports.uint16Type=exports.uint8Type=exports.int32Type=exports.int16Type=exports.int8Type=exports.voidType=exports.NewPropInfo=exports.NewArrayTypeInfo=exports.NewTypeInfo=exports.NewForeignFunInfo=exports.NewFunInfo=exports.NewArrayInfo=exports.NewObjectInfo=exports.NewStringInfo=exports.NewBooleanInfo=exports.NewInt32Info=exports.NewInt16Info=exports.NewInt8Info=exports.NewUInt32Info=exports.NewUInt16Info=exports.NewUInt8Info=exports.VoidInfo=exports.NewInfo=void 0;const types=require("../type");class NewInfo{constructor(name){this.name=name}}exports.NewInfo=NewInfo;class VoidInfo extends NewInfo{constructor(){super(...arguments);this.type=exports.voidType;this.descriptor=types.TYPE_VOID}}exports.VoidInfo=VoidInfo;class NewUInt8Info extends NewInfo{constructor(){super(...arguments);this.type=exports.uint8Type;this.descriptor=types.TYPE_UINT8}}exports.NewUInt8Info=NewUInt8Info;class NewUInt16Info extends NewInfo{constructor(){super(...arguments);this.type=exports.uint16Type;this.descriptor=types.TYPE_UINT16}}exports.NewUInt16Info=NewUInt16Info;class NewUInt32Info extends NewInfo{constructor(){super(...arguments);this.type=exports.uint32Type;this.descriptor=types.TYPE_UINT32}}exports.NewUInt32Info=NewUInt32Info;class NewInt8Info extends NewInfo{constructor(){super(...arguments);this.type=exports.int8Type;this.descriptor=types.TYPE_INT8}}exports.NewInt8Info=NewInt8Info;class NewInt16Info extends NewInfo{constructor(){super(...arguments);this.type=exports.int16Type;this.descriptor=types.TYPE_INT16}}exports.NewInt16Info=NewInt16Info;class NewInt32Info extends NewInfo{constructor(){super(...arguments);this.type=exports.int32Type;this.descriptor=types.TYPE_INT32}}exports.NewInt32Info=NewInt32Info;class NewBooleanInfo extends NewInfo{constructor(){super(...arguments);this.type=exports.booleanType;this.descriptor=types.TYPE_BOOLEAN}}exports.NewBooleanInfo=NewBooleanInfo;class NewStringInfo extends NewInfo{constructor(){super(...arguments);this.type=exports.stringType;this.descriptor=types.TYPE_STRING}}exports.NewStringInfo=NewStringInfo;class NewObjectInfo extends NewInfo{constructor(){super(...arguments);this.type=exports.objectType;this.descriptor=types.TYPE_OBJECT}}exports.NewObjectInfo=NewObjectInfo;class NewArrayInfo extends NewInfo{constructor(name,type){super(name);this.name=name;this.type=type;this.descriptor=types.TYPE_ARRAY}}exports.NewArrayInfo=NewArrayInfo;class NewFunInfo extends NewInfo{constructor(name,argc,code){super(name);this.name=name;this.argc=argc;this.code=code;this.type=exports.funType;this.descriptor=types.TYPE_FUN;this.foreign=false}}exports.NewFunInfo=NewFunInfo;class NewForeignFunInfo extends NewInfo{constructor(name,argc,exec){super(name);this.name=name;this.argc=argc;this.exec=exec;this.type=exports.funType;this.descriptor=types.TYPE_FUN;this.foreign=true;this.code=[]}}exports.NewForeignFunInfo=NewForeignFunInfo;class NewTypeInfo extends NewInfo{constructor(name,argc,properties,descriptor=types.TYPE_OBJECT){super(name);this.name=name;this.argc=argc;this.properties=properties;this.descriptor=descriptor;this.type=exports.funType;this.code=[]}}exports.NewTypeInfo=NewTypeInfo;class NewArrayTypeInfo extends NewInfo{constructor(name,elements){super(name);this.name=name;this.elements=elements;this.type=exports.funType;this.argc=0;this.properties=[];this.code=[];this.descriptor=types.TYPE_ARRAY}}exports.NewArrayTypeInfo=NewArrayTypeInfo;class NewPropInfo{constructor(name,type){this.name=name;this.type=type}}exports.NewPropInfo=NewPropInfo;exports.voidType=new NewTypeInfo("void",0,[],types.TYPE_VOID);exports.int8Type=new NewTypeInfo("int8",1,[],types.TYPE_INT8);exports.int16Type=new NewTypeInfo("int16",1,[],types.TYPE_INT16);exports.int32Type=new NewTypeInfo("int32",1,[],types.TYPE_INT32);exports.uint8Type=new NewTypeInfo("uint8",1,[],types.TYPE_UINT8);exports.uint16Type=new NewTypeInfo("uint16",1,[],types.TYPE_UINT16);exports.uint32Type=new NewTypeInfo("uint32",1,[],types.TYPE_UINT32);exports.booleanType=new NewTypeInfo("boolean",1,[],types.TYPE_BOOLEAN);exports.stringType=new NewTypeInfo("string",1,[],types.TYPE_STRING);exports.arrayType=new NewTypeInfo("array",0,[],types.TYPE_ARRAY);exports.objectType=new NewTypeInfo("object",0,[],types.TYPE_OBJECT);exports.funType=new NewTypeInfo("function",0,[],types.TYPE_FUN)},{"../type":96}],90:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ScriptFactory=void 0;const scripts_1=require("../../../resident/scripts");const resident_1=require("../../../resident");const callback_1=require("../../../resident/immutable/callback");const immutable_1=require("../../../resident/immutable");const mutable_1=require("../../../resident/mutable");const scripts_2=require("../scripts");const __1=require("..");class ScriptFactory{static getScript(actor){let script=new scripts_2.NoScript;if(actor instanceof callback_1.Callback){script=new scripts_1.CallbackActorScript(actor)}else if(actor instanceof immutable_1.Immutable){script=new scripts_1.ImmutableActorScript(actor)}else if(actor instanceof mutable_1.Mutable){script=new scripts_1.MutableActorScript(actor)}else if(actor instanceof resident_1.AbstractResident){script=new scripts_1.GenericResidentScript}else if(actor instanceof __1.PVM){script=new scripts_2.VMActorScript}return script}}exports.ScriptFactory=ScriptFactory},{"..":77,"../../../resident":72,"../../../resident/immutable":71,"../../../resident/immutable/callback":70,"../../../resident/mutable":73,"../../../resident/scripts":74,"../scripts":91}],91:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.VMActorScript=exports.NoScript=exports.BaseScript=exports.commonFunctions=void 0;const op=require("../runtime/op");const info_1=require("../script/info");exports.commonFunctions=[new info_1.NewFunInfo("tell",2,[op.SEND])];class BaseScript{constructor(){this.constants=[[],[]];this.name="<main>";this.info=[];this.code=[]}}exports.BaseScript=BaseScript;class NoScript extends BaseScript{}exports.NoScript=NoScript;class VMActorScript extends BaseScript{constructor(){super(...arguments);this.info=exports.commonFunctions}}exports.VMActorScript=VMActorScript},{"../runtime/op":85,"../script/info":89}],92:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.destroyMessageBuffer=exports.createMessageBuffer=exports.removeMember=exports.putMember=exports.getGroup=exports.removeGroup=exports.removeRoute=exports.putRoute=exports.getRouter=exports.getParent=exports.getChildren=exports.getAddress=exports.remove=exports.put=exports.get=exports.exists=void 0;const maybe_1=require("@quenk/noni/lib/data/maybe");const record_1=require("@quenk/noni/lib/data/record");const string_1=require("@quenk/noni/lib/data/string");const address_1=require("../../address");const exists=(s,addr)=>(0,record_1.hasKey)(s.threads,addr);exports.exists=exists;const get=(s,addr)=>(0,maybe_1.fromNullable)(s.threads[addr]);exports.get=get;const put=(s,addr,r)=>{s.threads[addr]=r;return s};exports.put=put;const remove=(s,addr)=>{delete s.threads[addr];return s};exports.remove=remove;const getAddress=(s,actor)=>(0,record_1.reduce)(s.threads,(0,maybe_1.nothing)(),(p,c,k)=>c.context.actor===actor?(0,maybe_1.fromString)(k):p);exports.getAddress=getAddress;const getChildren=(s,addr)=>addr===address_1.ADDRESS_SYSTEM?(0,record_1.exclude)(s.threads,address_1.ADDRESS_SYSTEM):(0,record_1.partition)(s.threads,(_,key)=>(0,string_1.startsWith)(key,addr)&&key!==addr)[0];exports.getChildren=getChildren;const getParent=(s,addr)=>(0,maybe_1.fromNullable)(s.threads[(0,address_1.getParent)(addr)]);exports.getParent=getParent;const getRouter=(s,addr)=>(0,record_1.reduce)(s.routers,(0,maybe_1.nothing)(),(p,k)=>(0,string_1.startsWith)(addr,k)?(0,maybe_1.fromNullable)(s.threads[k]):p);exports.getRouter=getRouter;const putRoute=(s,target,router)=>{s.routers[target]=router;return s};exports.putRoute=putRoute;const removeRoute=(s,target)=>{delete s.routers[target];return s};exports.removeRoute=removeRoute;const removeGroup=(s,target)=>{delete s.groups[target];return s};exports.removeGroup=removeGroup;const getGroup=(s,name)=>s.groups.hasOwnProperty(name)?(0,maybe_1.fromArray)(s.groups[name]):(0,maybe_1.nothing)();exports.getGroup=getGroup;const putMember=(s,group,member)=>{if(s.groups[group]==null)s.groups[group]=[];s.groups[group].push(member);return s};exports.putMember=putMember;const removeMember=(s,group,member)=>{if(s.groups[group]!=null)s.groups[group]=s.groups[group].filter(m=>m!=member);return s};exports.removeMember=removeMember;const createMessageBuffer=(s,addr)=>{s.pendingMessages[addr]=[];return s};exports.createMessageBuffer=createMessageBuffer;const destroyMessageBuffer=(s,addr)=>{delete s.pendingMessages[addr];return s};exports.destroyMessageBuffer=destroyMessageBuffer},{"../../address":65,"@quenk/noni/lib/data/maybe":59,"@quenk/noni/lib/data/record":60,"@quenk/noni/lib/data/string":62}],93:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.THREAD_STATE_INVALID=exports.THREAD_STATE_ERROR=exports.THREAD_STATE_WAIT=exports.THREAD_STATE_RUN=exports.THREAD_STATE_IDLE=void 0;exports.THREAD_STATE_IDLE=0;exports.THREAD_STATE_RUN=1;exports.THREAD_STATE_WAIT=2;exports.THREAD_STATE_ERROR=3;exports.THREAD_STATE_INVALID=4},{}],94:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.makeFrameName=exports.SharedThread=exports.Job=void 0;const errors=require("../../runtime/error");const op=require("../../runtime/op");const future_1=require("@quenk/noni/lib/control/monad/future");const array_1=require("@quenk/noni/lib/data/array");const maybe_1=require("@quenk/noni/lib/data/maybe");const frame_1=require("../../runtime/stack/frame");const ledger_1=require("../../runtime/heap/ledger");const op_1=require("../../runtime/op");const type_1=require("../../type");const __1=require("../");const runtime_1=require("../../runtime");class Job{constructor(thread,fun,args=[]){this.thread=thread;this.fun=fun;this.args=args;this.active=false}}exports.Job=Job;class SharedThread{constructor(vm,script,scheduler,context){this.vm=vm;this.script=script;this.scheduler=scheduler;this.context=context;this.fstack=[];this.fsp=0;this.rp=0;this.state=__1.THREAD_STATE_IDLE}invokeVM(p,f){let frm=new frame_1.StackFrame((0,exports.makeFrameName)(this,f.name),p.script,this,(0,maybe_1.just)(p),f.code.slice());for(let i=0;i<f.argc;i++)frm.push(p.pop());this.fstack.push(frm);this.fsp=this.fstack.length-1;this.scheduler.run()}invokeForeign(frame,fun,args){let val=fun.exec.apply(null,[this,...args]);frame.push(this.vm.heap.intern(frame,val));this.scheduler.run()}wait(task){this.state=__1.THREAD_STATE_WAIT;let onError=e=>{this.state=__1.THREAD_STATE_ERROR;this.raise(e)};let onSuccess=()=>{this.state=__1.THREAD_STATE_IDLE;this.scheduler.run()};task.fork(onError,onSuccess)}raise(e){this.state=__1.THREAD_STATE_ERROR;this.vm.raise(this.context.actor,e)}die(){let that=this;this.state=__1.THREAD_STATE_INVALID;this.scheduler.dequeue(this);return(0,future_1.doFuture)(function*(){let ret=that.context.actor.stop();if(ret)yield ret;that.vm.heap.threadExit(that);return(0,future_1.pure)(undefined)})}resume(job){this.state=__1.THREAD_STATE_RUN;if(!job.active){job.active=true;let{fun:fun,args:args}=job;let frame=new frame_1.StackFrame((0,exports.makeFrameName)(this,fun.name),this.script,this,(0,maybe_1.nothing)(),fun.foreign?[op.LDN|this.script.info.indexOf(fun),op.CALL]:fun.code.slice());frame.data=args.map(arg=>(0,ledger_1.isHeapAddress)(arg)?this.vm.heap.move(arg,frame.name):arg);this.fstack=[frame];this.fsp=0;this.rp=0}while(!(0,array_1.empty)(this.fstack)){let sp=this.fsp;let frame=this.fstack[sp];if(this.rp!=0)frame.data.push(this.rp);while(!frame.isFinished()&&this.state===__1.THREAD_STATE_RUN){let pos=frame.getPosition();let next=frame.code[pos]>>>0;let opcode=next&runtime_1.OPCODE_MASK;let operand=next&runtime_1.OPERAND_MASK;this.vm.logOp(this,frame,opcode,operand);op_1.handlers[opcode](this,frame,operand);if(pos===frame.getPosition())frame.advance();if(sp!==this.fsp)break}if(this.state===__1.THREAD_STATE_WAIT)return;if(sp===this.fsp){this.vm.heap.frameExit(this.fstack.pop());this.fsp--;this.rp=frame.data.pop()}}this.state=__1.THREAD_STATE_IDLE}exec(name,args=[]){let{script:script}=this;let fun=script.info.find(info=>info.name===name&&info.descriptor===type_1.TYPE_FUN);if(!fun)return this.raise(new errors.UnknownFunErr(name));this.scheduler.postJob(new Job(this,fun,args))}}exports.SharedThread=SharedThread;const makeFrameName=(thread,funName)=>(0,array_1.empty)(thread.fstack)?`${thread.context.template.id}@${thread.context.aid}#${funName}`:`${(0,array_1.tail)(thread.fstack).name}/${funName}`;exports.makeFrameName=makeFrameName},{"../":93,"../../runtime":82,"../../runtime/error":80,"../../runtime/heap/ledger":81,"../../runtime/op":85,"../../runtime/stack/frame":87,"../../type":96,"@quenk/noni/lib/control/monad/future":52,"@quenk/noni/lib/data/array":55,"@quenk/noni/lib/data/maybe":59}],95:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SharedScheduler=void 0;const array_1=require("@quenk/noni/lib/data/array");const __1=require("../");class SharedScheduler{constructor(vm,queue=[]){this.vm=vm;this.queue=queue;this._running=false}postJob(job){this.queue.push(job);this.run()}dequeue(thread){this.queue=this.queue.filter(job=>job.thread!==thread)}run(){if(this._running)return;this._running=true;let job;while(job=this.queue.find(({thread:thread})=>thread.state===__1.THREAD_STATE_IDLE)){let{thread:thread}=job;thread.resume(job);if(thread.state!==__1.THREAD_STATE_WAIT)this.queue=(0,array_1.remove)(this.queue,job)}this._running=false}}exports.SharedScheduler=SharedScheduler},{"../":93,"@quenk/noni/lib/data/array":55}],96:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getType=exports.TYPE_CONS=exports.TYPE_FUN=exports.TYPE_ARRAY=exports.TYPE_OBJECT=exports.TYPE_STRING=exports.TYPE_BOOLEAN=exports.TYPE_INT32=exports.TYPE_INT16=exports.TYPE_INT8=exports.TYPE_UINT32=exports.TYPE_UINT16=exports.TYPE_UINT8=exports.TYPE_VOID=exports.BYTE_INDEX=exports.BYTE_TYPE=exports.TYPE_STEP=void 0;exports.TYPE_STEP=16777216;exports.BYTE_TYPE=4278190080;exports.BYTE_INDEX=16777215;exports.TYPE_VOID=0;exports.TYPE_UINT8=exports.TYPE_STEP;exports.TYPE_UINT16=exports.TYPE_STEP*2;exports.TYPE_UINT32=exports.TYPE_STEP*3;exports.TYPE_INT8=exports.TYPE_STEP*4;exports.TYPE_INT16=exports.TYPE_STEP*5;exports.TYPE_INT32=exports.TYPE_STEP*6;exports.TYPE_BOOLEAN=exports.TYPE_STEP*7;exports.TYPE_STRING=exports.TYPE_STEP*8;exports.TYPE_OBJECT=exports.TYPE_STEP*9;exports.TYPE_ARRAY=exports.TYPE_STEP*10;exports.TYPE_FUN=exports.TYPE_STEP*11;exports.TYPE_CONS=exports.TYPE_STEP*12;const getType=d=>d&exports.BYTE_TYPE;exports.getType=getType},{}],97:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ACTION_STOP=exports.ACTION_RESTART=exports.ACTION_IGNORE=exports.ACTION_RAISE=void 0;exports.ACTION_RAISE=-1;exports.ACTION_IGNORE=0;exports.ACTION_RESTART=1;exports.ACTION_STOP=2},{}],98:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Caret=exports.CARET=void 0;var views=require("./wml/caret");var wml_1=require("@quenk/wml");var util_1=require("../../util");exports.CARET="ww-caret";var Caret=function(_super){__extends(Caret,_super);function Caret(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.Main(_this);_this.values={root:{id:_this.attrs.ww&&_this.attrs.ww.id?_this.attrs.ww.id:"",className:util_1.concat(exports.CARET,_this.attrs.ww&&_this.attrs.ww.className?_this.attrs.ww.className:"")}};return _this}return Caret}(wml_1.Component);exports.Caret=Caret},{"../../util":168,"./wml/caret":99,"@quenk/wml":170}],99:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("span",{id:__context.values.root.id,class:__context.values.root.className},[])}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"@quenk/noni/lib/data/maybe":59,"@quenk/wml/lib/dom":169}],100:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Link=exports.LinkClickedEvent=exports.LINK=void 0;var wml=require("@quenk/wml");var views=require("./wml/link");var util_1=require("../../util");var active_1=require("../state/active");exports.LINK="ww-link";var LinkClickedEvent=function(){function LinkClickedEvent(name,href){this.name=name;this.href=href}return LinkClickedEvent}();exports.LinkClickedEvent=LinkClickedEvent;var Link=function(_super){__extends(Link,_super);function Link(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.Main(_this);_this.name=_this.attrs.ww&&_this.attrs.ww.name?_this.attrs.ww.name:"";_this.title=_this.attrs.ww&&_this.attrs.ww.title?_this.attrs.ww.title:"";_this.href=_this.attrs.ww&&_this.attrs.ww.href?_this.attrs.ww.href:"";_this.values={a:{id:_this.attrs.ww&&_this.attrs.ww.id?_this.attrs.ww.id:"",disabled:_this.attrs.ww&&_this.attrs.ww.disabled?_this.attrs.ww.disabled:null,className:util_1.concat(exports.LINK,_this.attrs.ww&&_this.attrs.ww.className?_this.attrs.ww.className:"",_this.attrs.ww&&_this.attrs.ww.active?active_1.ACTIVE:""),title:_this.attrs.ww&&_this.attrs.ww.title?_this.attrs.ww.title:null,name:_this.attrs.ww&&_this.attrs.ww.name?_this.attrs.ww.name:null,href:_this.attrs.ww&&_this.attrs.ww.href?_this.attrs.ww.href:"#",active:_this.attrs.ww&&_this.attrs.ww.active?_this.attrs.ww.active:false,content:_this.attrs.ww&&_this.attrs.ww.text?[document.createTextNode(_this.attrs.ww.text)]:_this.children,clicked:function(e){if(_this.attrs.ww){var _a=_this.attrs.ww,name_1=_a.name,href=_a.href,onClick=_a.onClick;if(!href)e.preventDefault();if(onClick)onClick(new LinkClickedEvent(name_1,href))}}}};return _this}Link.prototype.activate=function(){var m=util_1.getById(this.view,this.values.a.id);if(m.isJust()){var e=m.get();e.classList.remove(active_1.ACTIVE);e.classList.add(active_1.ACTIVE)}return this};Link.prototype.deactivate=function(){var m=util_1.getById(this.view,this.values.a.id);if(m.isJust())m.get().classList.remove(active_1.ACTIVE);return this};return Link}(wml.Component);exports.Link=Link},{"../../util":168,"../state/active":104,"./wml/link":101,"@quenk/wml":170}],101:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("a",{id:__context.values.a.id,class:__context.values.a.className,href:__context.values.a.href,title:__context.values.a.title,disabled:__context.values.a.disabled,onclick:__context.values.a.clicked},__spreadArrays(__context.values.a.content))}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"@quenk/noni/lib/data/maybe":59,"@quenk/wml/lib/dom":169}],102:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getBlockClassName=exports.BOTTOM=exports.MIDDLE=exports.HORIZONTAL=exports.RIGHT=exports.LEFT=exports.JUSTIFIED=exports.CLEARFIX=exports.BLOCK=exports.POSITIONED=exports.PUSHABLE=exports.VERTICAL=void 0;exports.VERTICAL="-vertical";exports.PUSHABLE="-pushable";exports.POSITIONED="-positioned";exports.BLOCK="-block";exports.CLEARFIX="-clearfix";exports.JUSTIFIED="-justified";exports.LEFT="-left";exports.RIGHT="-right";exports.HORIZONTAL="-horizontal";exports.MIDDLE="-middle";exports.BOTTOM="-bottom";exports.getBlockClassName=function(attrs){return attrs.ww&&attrs.ww.block===true?exports.BLOCK:""}},{}],103:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getSizeClassName=exports.Size=exports.EXTRA_LARGE=exports.LARGE=exports.MEDIUM=exports.SMALL=exports.EXTRA_SMALL=void 0;exports.EXTRA_SMALL="-extra-small";exports.SMALL="-small";exports.MEDIUM="-medium";exports.LARGE="-large";exports.EXTRA_LARGE="-extra-large";var Size;(function(Size){Size["ExtraSmall"]="extra-small";Size["Small"]="small";Size["Medium"]="medium";Size["Large"]="large";Size["ExtraLarge"]="extra-large"})(Size=exports.Size||(exports.Size={}));exports.getSizeClassName=function(s){if(s===Size.ExtraSmall)return exports.EXTRA_SMALL;else if(s===Size.Small)return exports.SMALL;else if(s===Size.Medium)return exports.MEDIUM;else if(s===Size.Large)return exports.LARGE;else if(s===Size.ExtraLarge)return exports.EXTRA_LARGE;return""}},{}],104:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.isActive=exports.deactivate=exports.activate=exports.ACTIVE=void 0;var util_1=require("../../util");exports.ACTIVE="-active";exports.activate=function(view,id){return util_1.getById(view,id).map(function(e){e.classList.remove(exports.ACTIVE);e.classList.add(exports.ACTIVE)})};exports.deactivate=function(view,id){return util_1.getById(view,id).map(function(e){return e.classList.remove(exports.ACTIVE)})};exports.isActive=function(view,id){return util_1.getById(view,id).map(function(e){return e.classList.contains(exports.ACTIVE)}).orJust(function(){return false}).get()}},{"../../util":168}],105:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DISABLED=void 0;exports.DISABLED="-disabled"},{}],106:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.toggle=exports.show=exports.hide=exports.isHidden=exports.HIDDEN=void 0;var util_1=require("../../util");exports.HIDDEN="-ww-hidden";exports.isHidden=function(view,id){var m=view.findById(id);if(m.isNothing()){util_1.warnMissing(view,id);return true}else{return m.get().classList.contains(exports.HIDDEN)}};exports.hide=function(view,id){var m=view.findById(id);if(m.isNothing()){return util_1.warnMissing(view,id)}else{var e=m.get();e.classList.remove(exports.HIDDEN);e.classList.add(exports.HIDDEN)}};exports.show=function(view,id){var m=view.findById(id);if(m.isNothing()){return util_1.warnMissing(view,id)}else{m.get().classList.remove(exports.HIDDEN)}};exports.toggle=function(view,id){var m=view.findById(id);if(m.isNothing()){return util_1.warnMissing(view,id)}else{m.get().classList.toggle(exports.HIDDEN)}}},{"../../util":168}],107:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getStyleClassName=exports.styles=exports.Style=exports.OUTLINE=exports.ERROR=exports.WARNING=exports.INFO=exports.SUCCESS=exports.PRIMARY=exports.DEFAULT=void 0;exports.DEFAULT="-default";exports.PRIMARY="-primary";exports.SUCCESS="-success";exports.INFO="-info";exports.WARNING="-warning";exports.ERROR="-error";exports.OUTLINE="-outline";var Style;(function(Style){Style["Default"]="default";Style["Primary"]="primary";Style["Success"]="success";Style["Info"]="info";Style["Warning"]="warning";Style["Error"]="error"})(Style=exports.Style||(exports.Style={}));exports.styles=[Style.Default,Style.Success,Style.Info,Style.Warning,Style.Error];exports.getStyleClassName=function(s){switch(s){case Style.Default:return exports.DEFAULT;case Style.Primary:return exports.PRIMARY;case Style.Success:return exports.SUCCESS;case Style.Info:return exports.INFO;case Style.Warning:return exports.WARNING;case Style.Error:return exports.ERROR}return exports.DEFAULT}},{}],108:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.ButtonGroup=exports.BUTTON_GROUP_COMPAT=exports.BUTTON_GROUP_BUTTON=exports.BUTTON_GROUP=void 0;var views=require("./wml/button-group");var wml_1=require("@quenk/wml");var util_1=require("../../util");var toolbar_1=require("../toolbar");var __1=require("../../");exports.BUTTON_GROUP="ww-button-group";exports.BUTTON_GROUP_BUTTON="ww-button-group__button";exports.BUTTON_GROUP_COMPAT="ww-button-group-compat";var ButtonGroup=function(_super){__extends(ButtonGroup,_super);function ButtonGroup(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.Main(_this);_this.values={root:{id:__1.getId(_this.attrs),className:util_1.concat(exports.BUTTON_GROUP,toolbar_1.TOOLBAR_COMPAT,__1.getClassName(_this.attrs))}};return _this}return ButtonGroup}(wml_1.Component);exports.ButtonGroup=ButtonGroup},{"../../":147,"../../util":168,"../toolbar":138,"./wml/button-group":109,"@quenk/wml":170}],109:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{id:__context.values.root.id,class:__context.values.root.className},__spreadArrays(__context.children))}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"@quenk/noni/lib/data/maybe":59,"@quenk/wml/lib/dom":169}],110:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Button=exports.ButtonClickedEvent=exports.BUTTON=exports.Style=void 0;var views=require("./wml/button");var dom_1=require("@quenk/wml/lib/dom");var toolbar_1=require("../toolbar");var active_1=require("../../content/state/active");var orientation_1=require("../../content/orientation");var style_1=require("../../content/style");Object.defineProperty(exports,"Style",{enumerable:true,get:function(){return style_1.Style}});var size_1=require("../../content/size");var util_1=require("../../util");var __1=require("../../");var __2=require("../");exports.BUTTON="ww-button";var ButtonClickedEvent=function(_super){__extends(ButtonClickedEvent,_super);function ButtonClickedEvent(){return _super!==null&&_super.apply(this,arguments)||this}return ButtonClickedEvent}(__2.Event);exports.ButtonClickedEvent=ButtonClickedEvent;var Button=function(_super){__extends(Button,_super);function Button(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=_this.attrs.ww&&_this.attrs.ww.anchor?new views.AnchorView(_this):new views.ButtonView(_this);_this.values={button:{wml:{id:"button"},id:__1.getId(_this.attrs),className:util_1.concat(exports.BUTTON,__1.getClassName(_this.attrs),toolbar_1.TOOLBAR_COMPAT,_this.attrs.ww&&_this.attrs.ww.style?style_1.getStyleClassName(_this.attrs.ww.style):style_1.DEFAULT,_this.attrs.ww&&_this.attrs.ww.size?size_1.getSizeClassName(_this.attrs.ww.size):"",_this.attrs.ww&&_this.attrs.ww.outline?style_1.OUTLINE:"",_this.attrs.ww&&_this.attrs.ww.block?orientation_1.BLOCK:"",_this.attrs.ww&&_this.attrs.ww.active?active_1.ACTIVE:""),type:_this.attrs.ww&&_this.attrs.ww.type?_this.attrs.ww.type:"button",name:_this.attrs.ww&&_this.attrs.ww.name?_this.attrs.ww.name:"",disabled:_this.attrs.ww&&_this.attrs.ww.disabled?true:null,anchor:_this.attrs.ww&&_this.attrs.ww.anchor?_this.attrs.ww.anchor:false,onclick:function(e){e.preventDefault();_this.attrs.ww&&_this.attrs.ww.onClick&&_this.attrs.ww.onClick(new ButtonClickedEvent(_this.attrs.ww&&_this.attrs.ww.name?_this.attrs.ww.name:"",_this.attrs.ww.value))},content:function(){return _this.attrs.ww&&_this.attrs.ww.text?[dom_1.text(_this.attrs.ww.text)]:_this.children}}};return _this}Button.prototype.disable=function(){util_1.getById(this.view,this.values.button.wml.id).map(function(b){return b.setAttribute("disabled","disabled")})};Button.prototype.enable=function(){util_1.getById(this.view,this.values.button.wml.id).map(function(b){return b.removeAttribute("disabled")})};Button.prototype.toggle=function(){var _this=this;util_1.getById(this.view,this.values.button.wml.id).map(function(b){return b.hasAttribute("disabled")?_this.enable():_this.disable()})};return Button}(__2.AbstractControl);exports.Button=Button},{"../":125,"../../":147,"../../content/orientation":102,"../../content/size":103,"../../content/state/active":104,"../../content/style":107,"../../util":168,"../toolbar":138,"./wml/button":111,"@quenk/wml/lib/dom":169}],111:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.AnchorView=exports.ButtonView=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var ButtonView=function(){function ButtonView(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("button",{wml:{id:__context.values.button.wml.id},id:__context.values.button.id,type:__context.values.button.type,name:__context.values.button.name,disabled:__context.values.button.disabled,class:__context.values.button.className,onclick:__context.values.button.onclick},__spreadArrays(__context.values.button.content()))}}ButtonView.prototype.registerView=function(v){this.views.push(v);return v};ButtonView.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};ButtonView.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};ButtonView.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};ButtonView.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};ButtonView.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};ButtonView.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};ButtonView.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return ButtonView}();exports.ButtonView=ButtonView;var AnchorView=function(){function AnchorView(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("a",{wml:{id:__context.values.button.wml.id},id:__context.values.button.id,type:__context.values.button.type,href:"#",name:__context.values.button.name,disabled:__context.values.button.disabled,class:__context.values.button.className,onclick:__context.values.button.onclick},__spreadArrays(__context.values.button.content()))}}AnchorView.prototype.registerView=function(v){this.views.push(v);return v};AnchorView.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};AnchorView.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};AnchorView.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};AnchorView.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};AnchorView.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};AnchorView.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};AnchorView.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return AnchorView}();exports.AnchorView=AnchorView},{"@quenk/noni/lib/data/maybe":59,"@quenk/wml/lib/dom":169}],112:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Checkbox=exports.CheckChangedEvent=exports.CHECKBOX=void 0;var checkbox_1=require("./wml/checkbox");var util_1=require("../../util");var __1=require("../");var __2=require("../../");exports.CHECKBOX="ww-checkbox";var CheckChangedEvent=function(_super){__extends(CheckChangedEvent,_super);function CheckChangedEvent(){return _super!==null&&_super.apply(this,arguments)||this}return CheckChangedEvent}(__1.Event);exports.CheckChangedEvent=CheckChangedEvent;var Checkbox=function(_super){__extends(Checkbox,_super);function Checkbox(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new checkbox_1.Main(_this);_this.values={root:{id:__2.getId(_this.attrs),className:util_1.concat(exports.CHECKBOX,__2.getClassName(_this.attrs))},input:{name:__1.getName(_this.attrs),value:_this.attrs.ww&&_this.attrs.ww.value?_this.attrs.ww.value:null,onChange:function(){_this.values.input.value=!_this.values.input.value||null;if(_this.attrs.ww&&_this.attrs.ww.onChange)_this.attrs.ww.onChange(new CheckChangedEvent(_this.values.input.name,_this.values.input.value||false))}}};return _this}return Checkbox}(__1.AbstractControl);exports.Checkbox=Checkbox},{"../":125,"../../":147,"../../util":168,"./wml/checkbox":113}],113:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("span",{id:__context.values.root.id,class:__context.values.root.className},[__this.node("label",{},__spreadArrays([__this.node("input",{type:"checkbox",name:__context.values.input.name,checked:__context.values.input.value,onchange:__context.values.input.onChange},[])],__context.children))])}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"@quenk/noni/lib/data/maybe":59,"@quenk/wml/lib/dom":169}],114:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.DisplayField=exports.DISPLAY_FIELD_CONTENT=exports.DISPLAY_FIELD=exports.Style=void 0;var wml_1=require("@quenk/wml");var toolbar_1=require("../toolbar");var orientation_1=require("../../content/orientation");var disabled_1=require("../../content/state/disabled");var style_1=require("../../content/style");Object.defineProperty(exports,"Style",{enumerable:true,get:function(){return style_1.Style}});var size_1=require("../../content/size");var util_1=require("../../util");var __1=require("../../");var display_field_1=require("./wml/display-field");exports.DISPLAY_FIELD="ww-display-field";exports.DISPLAY_FIELD_CONTENT="ww-display-field__content";var DisplayField=function(_super){__extends(DisplayField,_super);function DisplayField(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new display_field_1.Main(_this);_this.values={wml:{id:"display"},id:__1.getId(_this.attrs),disabled:_this.attrs.ww&&_this.attrs.ww.disabled?_this.attrs.ww.disabled:false,className:util_1.concat(exports.DISPLAY_FIELD,__1.getClassName(_this.attrs),toolbar_1.TOOLBAR_COMPAT,_this.attrs.ww&&_this.attrs.ww.style?style_1.getStyleClassName(_this.attrs.ww.style):style_1.DEFAULT,_this.attrs.ww&&_this.attrs.ww.size?size_1.getSizeClassName(_this.attrs.ww.size):"",_this.attrs.ww&&_this.attrs.ww.block?orientation_1.BLOCK:"",_this.attrs.ww&&_this.attrs.ww.disabled?disabled_1.DISABLED:""),onclick:function(e){e.stopPropagation();if(_this.attrs.ww&&_this.attrs.ww.onClick&&!_this.values.disabled)_this.attrs.ww.onClick()},content:{className:exports.DISPLAY_FIELD_CONTENT}};return _this}return DisplayField}(wml_1.Component);exports.DisplayField=DisplayField},{"../../":147,"../../content/orientation":102,"../../content/size":103,"../../content/state/disabled":105,"../../content/style":107,"../../util":168,"../toolbar":138,"./wml/display-field":115,"@quenk/wml":170}],115:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{id:__context.values.id,class:__context.values.className,onclick:__context.values.onclick},[__this.node("div",{class:__context.values.content.className},__spreadArrays(__context.children))])}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"@quenk/noni/lib/data/maybe":59,"@quenk/wml/lib/dom":169}],116:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.DropDown=exports.DROP_DOWN_CONTENT=exports.DROP_DOWN_TOGGLE=exports.DROP_DOWN=void 0;var views=require("./wml/drop-down");var hidden=require("../../content/state/hidden");var style=require("../../content/style");var wml_1=require("@quenk/wml");var button_group_1=require("../button-group");var util_1=require("../../util");var __1=require("../../");exports.DROP_DOWN="ww-drop-down-menu";exports.DROP_DOWN_TOGGLE="ww-drop-down-menu__toggle";exports.DROP_DOWN_CONTENT="ww-drop-down__content";var DropDown=function(_super){__extends(DropDown,_super);function DropDown(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.Main(_this);_this.values={root:{wml:{id:"root"},id:__1.getId(_this.attrs),className:util_1.concat(exports.DROP_DOWN,button_group_1.BUTTON_GROUP_COMPAT,__1.getClassName(_this.attrs))},button:{text:_this.attrs.ww&&_this.attrs.ww.buttonText?_this.attrs.ww.buttonText:"",anchor:_this.attrs.ww&&_this.attrs.ww.anchor?_this.attrs.ww.anchor:false,className:util_1.concat(exports.DROP_DOWN_TOGGLE,style.DEFAULT,_this.attrs.ww&&_this.attrs.ww.buttonClassName?_this.attrs.ww.buttonClassName:""),disabled:_this.attrs.ww&&_this.attrs.ww.disabled?_this.attrs.ww.disabled:undefined,template:function(){return _this.attrs.ww&&_this.attrs.ww.buttonTemplate?_this.attrs.ww.buttonTemplate:views.button},onClick:function(){var mayRoot=util_1.getById(_this.view,_this.values.root.wml.id);if(mayRoot.isJust()){var e=mayRoot.get();if(_this.values.content.autoClose){var hide=_this.values.content.hide;for(var i=0;i<e.children.length;i++){e.children[i].removeEventListener("click",hide);e.children[i].addEventListener("click",hide)}}_this.toggle();window.addEventListener("click",_this)}}},content:{wml:{id:"content"},className:util_1.concat(exports.DROP_DOWN_CONTENT,hidden.HIDDEN),autoClose:_this.attrs.ww&&_this.attrs.ww.autoClose===false?false:true,render:function(){return _this.children},hide:function(){return _this.hide()}}};return _this}DropDown.prototype.isHidden=function(){return hidden.isHidden(this.view,this.values.content.wml.id)};DropDown.prototype.hide=function(){hidden.hide(this.view,this.values.content.wml.id);return this};DropDown.prototype.show=function(){hidden.show(this.view,this.values.content.wml.id);return this};DropDown.prototype.toggle=function(){hidden.toggle(this.view,this.values.content.wml.id);return this};DropDown.prototype.handleEvent=function(e){var _this=this;util_1.getById(this.view,this.values.root.wml.id).map(function(root){if(!document.body.contains(root))document.removeEventListener("click",_this);if(!root.contains(e.target))_this.hide()})};return DropDown}(wml_1.Component);exports.DropDown=DropDown},{"../../":147,"../../content/state/hidden":106,"../../content/style":107,"../../util":168,"../button-group":108,"./wml/drop-down":117,"@quenk/wml":170}],117:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.Main=exports.button=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var button_1=require("../../button");var caret_1=require("../../../content/caret");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};exports.button=function(d){return function(__this){return[__this.widget(new button_1.Button({ww:{className:d.values.button.className,anchor:d.values.button.anchor,disabled:d.values.button.disabled,onClick:d.values.button.onClick}},[text(d.values.button.text+" "),__this.widget(new caret_1.Caret({},[]),{})]),{ww:{className:d.values.button.className,anchor:d.values.button.anchor,disabled:d.values.button.disabled,onClick:d.values.button.onClick}})]}};var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{wml:{id:__context.values.root.wml.id},class:__context.values.root.className},__spreadArrays(__context.values.button.template()(__context)(__this),[__this.node("div",{wml:{id:__context.values.content.wml.id},class:__context.values.content.className},__spreadArrays(__context.values.content.render()))]))}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"../../../content/caret":98,"../../button":110,"@quenk/noni/lib/data/maybe":59,"@quenk/wml/lib/dom":169}],118:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.DropList=exports.DROP_LIST=exports.ItemSelectedEvent=void 0;var views=require("./wml/drop-list");var util_1=require("../../util");var size_1=require("../../content/size");var orientation_1=require("../../content/orientation");var results_menu_1=require("../results-menu");Object.defineProperty(exports,"ItemSelectedEvent",{enumerable:true,get:function(){return results_menu_1.ItemSelectedEvent}});var search_1=require("../search");var __1=require("../../");var __2=require("../");exports.DROP_LIST="ww-drop-list";var DropList=function(_super){__extends(DropList,_super);function DropList(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.Main(_this);_this.values={id:__1.getId(_this.attrs),className:util_1.concat(exports.DROP_LIST,__1.getClassName(_this.attrs),_this.attrs.ww&&_this.attrs.ww.size?size_1.getSizeClassName(_this.attrs.ww.size):"",_this.attrs.ww&&_this.attrs.ww.block?orientation_1.BLOCK:""),name:__2.getName(_this.attrs),value:_this.attrs.ww&&_this.attrs.ww.value,control:{wml:{id:"drop-list"}},messages:{wml:{id:"messages"}},display:{disabled:_this.attrs.ww&&_this.attrs.ww.disabled,placeholder:function(){if(_this.attrs.ww){if(_this.attrs.ww.options&&_this.values.value)return getCurrent(_this.attrs.ww.options,_this.values.value);return _this.attrs.ww.placeholder||"Select one"}},onClick:function(){_this.toggle()}},menu:{wml:{id:"menu"},name:_this.attrs.ww&&_this.attrs.ww.name?_this.attrs.ww.name:"",block:_this.attrs.ww&&_this.attrs.ww.block?_this.attrs.ww.block:false,hidden:true,results:_this.attrs.ww&&_this.attrs.ww.options?_this.attrs.ww.options:[],onSelect:function(e){if(_this.attrs.ww&&_this.attrs.ww.onSelect)_this.attrs.ww.onSelect(new results_menu_1.ItemSelectedEvent(e.name,e.value.value));_this.values.value=e.value.value;_this.view.invalidate()},itemTemplate:_this.attrs.ww&&_this.attrs.ww.itemTemplate?_this.attrs.ww.itemTemplate:undefined,noItemsTemplate:_this.attrs.ww&&_this.attrs.ww.noItemsTemplate?_this.attrs.ww.noItemsTemplate:undefined,stringifier:_this.attrs.ww&&_this.attrs.ww.stringifier?_this.attrs.ww.stringifier:function(v){return v.label}}};return _this}DropList.prototype.update=function(options){this.values.menu.results=options;this.view.invalidate();return this};DropList.prototype.open=function(){search_1.openMenu(this.view,this.values.menu.wml.id);return this};DropList.prototype.close=function(){search_1.closeMenu(this.view,this.values.menu.wml.id);return this};DropList.prototype.toggle=function(){search_1.toggleMenu(this.view,this.values.menu.wml.id);return this};return DropList}(__2.AbstractControl);exports.DropList=DropList;var getCurrent=function(opts,value,text){if(text===void 0){text="Select one"}return opts.reduce(function(p,c){return c.value===value?c.label:p},text)}},{"../":125,"../../":147,"../../content/orientation":102,"../../content/size":103,"../../util":168,"../results-menu":130,"../search":132,"./wml/drop-list":119}],119:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var caret_1=require("../../../content/caret");var results_menu_1=require("../../results-menu");var display_field_1=require("../../display-field");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{id:__context.values.id,class:__context.values.className},[__this.widget(new display_field_1.DisplayField({ww:{onClick:__context.values.display.onClick,disabled:__context.values.display.disabled}},[text(__context.values.display.placeholder()),__this.widget(new caret_1.Caret({},[]),{})]),{ww:{onClick:__context.values.display.onClick,disabled:__context.values.display.disabled}}),__this.widget(new results_menu_1.ResultsMenu({wml:{id:__context.values.menu.wml.id},ww:{block:__context.values.menu.block,name:__context.values.menu.name,hidden:__context.values.menu.hidden,results:__context.values.menu.results,onSelect:__context.values.menu.onSelect,noItemsTemplate:__context.values.menu.noItemsTemplate,itemTemplate:__context.values.menu.itemTemplate,stringifier:__context.values.menu.stringifier}},[]),{wml:{id:__context.values.menu.wml.id},ww:{block:__context.values.menu.block,name:__context.values.menu.name,hidden:__context.values.menu.hidden,results:__context.values.menu.results,onSelect:__context.values.menu.onSelect,noItemsTemplate:__context.values.menu.noItemsTemplate,itemTemplate:__context.values.menu.itemTemplate,stringifier:__context.values.menu.stringifier}})])}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"../../../content/caret":98,"../../display-field":114,"../../results-menu":130,"@quenk/noni/lib/data/maybe":59,"@quenk/wml/lib/dom":169}],120:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.validationState2ClassName=exports.getMessage=exports.getValidityClassName=exports.getValidationState=exports.removeValidationState=exports.setValidationState=exports.removeMessage=exports.setMessage=exports.AbstractFeedbackControl=exports.ValidationState=void 0;var style=require("../content/style");var util_1=require("../util");var control_1=require("../control");var ValidationState;(function(ValidationState){ValidationState["Neutral"]="neutral";ValidationState["Error"]="error";ValidationState["Success"]="success";ValidationState["Warning"]="warning"})(ValidationState=exports.ValidationState||(exports.ValidationState={}));var AbstractFeedbackControl=function(_super){__extends(AbstractFeedbackControl,_super);function AbstractFeedbackControl(){return _super!==null&&_super.apply(this,arguments)||this}AbstractFeedbackControl.prototype.setMessage=function(msg){exports.setMessage(this.view,this.values.messages.wml.id,msg);return this};AbstractFeedbackControl.prototype.removeMessage=function(){exports.removeMessage(this.view,this.values.messages.wml.id);return this};AbstractFeedbackControl.prototype.setValidationState=function(state){exports.setValidationState(this.view,this.values.control.wml.id,state);return this};AbstractFeedbackControl.prototype.removeValidationState=function(){exports.removeValidationState(this.view,this.values.control.wml.id);return this};AbstractFeedbackControl.prototype.getValidationState=function(){return exports.getValidationState(this.view,this.values.control.wml.id)};return AbstractFeedbackControl}(control_1.AbstractControl);exports.AbstractFeedbackControl=AbstractFeedbackControl;exports.setMessage=function(view,id,msg){return util_1.getById(view,id).map(function(messages){var node=document.createTextNode(msg);while(messages.lastChild)messages.removeChild(messages.lastChild);messages.appendChild(node)})};exports.removeMessage=function(view,id){return util_1.getById(view,id).map(function(messages){while(messages.lastChild)messages.removeChild(messages.lastChild)})};exports.setValidationState=function(view,id,state){exports.removeValidationState(view,id);if(state!==ValidationState.Neutral)util_1.getById(view,id).map(function(e){return e.classList.add(exports.validationState2ClassName(state))})};exports.removeValidationState=function(view,id){util_1.getById(view,id).map(function(h){h.classList.remove(style.SUCCESS);h.classList.remove(style.ERROR);h.classList.remove(style.WARNING)})};exports.getValidationState=function(view,id){return util_1.getById(view,id).map(function(h){if(h.classList.contains(style.SUCCESS))return ValidationState.Success;else if(h.classList.contains(style.WARNING))return ValidationState.Warning;else if(h.classList.contains(style.ERROR))return ValidationState.Error;else return ValidationState.Neutral}).get()};exports.getValidityClassName=function(attrs){if(attrs.ww){if(attrs.ww.error&&attrs.ww.error!="")return style.ERROR;if(attrs.ww.warning&&attrs.ww.warning!="")return style.WARNING;if(attrs.ww.success&&attrs.ww.success!="")return style.SUCCESS}return""};exports.getMessage=function(attrs){if(attrs.ww){if(attrs.ww.error&&attrs.ww.error!="")return attrs.ww.error;if(attrs.ww.warning&&attrs.ww.warning!="")return attrs.ww.warning;if(attrs.ww.success&&attrs.ww.success!="")return attrs.ww.success;if(attrs.ww.message&&attrs.ww.message!="")return attrs.ww.message}return""};exports.validationState2ClassName=function(state){if(state===ValidationState.Success)return style.SUCCESS;else if(state===ValidationState.Warning)return style.WARNING;else if(state===ValidationState.Error)return style.ERROR;else return""}},{"../content/style":107,"../control":125,"../util":168}],121:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.focus=exports.FocusLostEvent=exports.FocusGainedEvent=void 0;var util_1=require("../util");var FocusGainedEvent=function(){function FocusGainedEvent(name){this.name=name}return FocusGainedEvent}();exports.FocusGainedEvent=FocusGainedEvent;var FocusLostEvent=function(){function FocusLostEvent(name){this.name=name}return FocusLostEvent}();exports.FocusLostEvent=FocusLostEvent;exports.focus=function(view,id){util_1.getById(view,id).map(function(e){return e.focus()})}},{"../util":168}],122:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.removeMessage=exports.setMessage=exports.getLabel=exports.AbstractFormControl=void 0;var util_1=require("../util");var feedback_1=require("./feedback");var AbstractFormControl=function(_super){__extends(AbstractFormControl,_super);function AbstractFormControl(){return _super!==null&&_super.apply(this,arguments)||this}return AbstractFormControl}(feedback_1.AbstractFeedbackControl);exports.AbstractFormControl=AbstractFormControl;exports.getLabel=function(attrs){return attrs.ww&&attrs.ww.label?attrs.ww.label:""};exports.setMessage=function(view,id,msg){util_1.getById(view,id).map(function(h){h.setMessage(msg)})};exports.removeMessage=function(view,id){util_1.getById(view,id).map(function(h){h.removeMessage()})}},{"../util":168,"./feedback":120}],123:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Help=exports.HELP=void 0;var wml_1=require("@quenk/wml");var util_1=require("../../util");var feedback_1=require("../feedback");var __1=require("../../");var help_1=require("./wml/help");exports.HELP="ww-help";var Help=function(_super){__extends(Help,_super);function Help(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new help_1.Main(_this);_this.values={help:{wml:{id:"help"},id:_this.attrs.ww&&_this.attrs.ww.id?_this.attrs.ww.id:"",className:util_1.concat(exports.HELP,__1.getClassName(_this.attrs)),text:_this.attrs.ww&&_this.attrs.ww.text?[document.createTextNode(_this.attrs.ww.text)]:_this.children}};return _this}Help.prototype.setMessage=function(msg){feedback_1.setMessage(this.view,this.values.help.wml.id,msg);return this};Help.prototype.removeMessage=function(){feedback_1.removeMessage(this.view,this.values.help.wml.id);return this};return Help}(wml_1.Component);exports.Help=Help},{"../../":147,"../../util":168,"../feedback":120,"./wml/help":124,"@quenk/wml":170}],124:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("span",{wml:{id:__context.values.help.wml.id},id:__context.values.help.id,class:__context.values.help.className},__spreadArrays(__context.values.help.text))}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"@quenk/noni/lib/data/maybe":59,"@quenk/wml/lib/dom":169}],125:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.getValue=exports.getDisabled=exports.getName=exports.AbstractControl=exports.Event=void 0;var wml_1=require("@quenk/wml");var maybe_1=require("@quenk/noni/lib/data/maybe");var Event=function(){function Event(name,value){this.name=name;this.value=value}return Event}();exports.Event=Event;var AbstractControl=function(_super){__extends(AbstractControl,_super);function AbstractControl(){return _super!==null&&_super.apply(this,arguments)||this}return AbstractControl}(wml_1.Component);exports.AbstractControl=AbstractControl;exports.getName=function(attrs){return attrs.ww&&attrs.ww.name?attrs.ww.name:""};exports.getDisabled=function(attrs){return attrs.ww&&attrs.ww.disabled?attrs.ww.disabled:undefined};exports.getValue=function(attrs){return attrs.ww&&attrs.ww.value?maybe_1.just(attrs.ww.value):maybe_1.nothing()}},{"@quenk/noni/lib/data/maybe":59,"@quenk/wml":170}],126:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.AddOn=exports.InputGroup=exports.INPUT_GROUP_BUTTON_ADDON=exports.INPUT_GROUP_ADDON=exports.INPUT_GROUP=void 0;var wml_1=require("@quenk/wml");var util_1=require("../../util");var __1=require("../../");var input_group_1=require("./wml/input-group");exports.INPUT_GROUP="ww-input-group";exports.INPUT_GROUP_ADDON="ww-input-group__addon";exports.INPUT_GROUP_BUTTON_ADDON="ww-input-group__button-addon";var InputGroup=function(_super){__extends(InputGroup,_super);function InputGroup(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new input_group_1.InputGroupView(_this);_this.values={id:__1.getId(_this.attrs),className:util_1.concat(exports.INPUT_GROUP,__1.getClassName(_this.attrs))};return _this}return InputGroup}(wml_1.Component);exports.InputGroup=InputGroup;var AddOn=function(_super){__extends(AddOn,_super);function AddOn(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new input_group_1.AddOnView(_this);_this.values={id:__1.getId(_this.attrs),className:util_1.concat(_this.attrs.button?exports.INPUT_GROUP_BUTTON_ADDON:exports.INPUT_GROUP_ADDON,__1.getClassName(_this.attrs))};return _this}return AddOn}(wml_1.Component);exports.AddOn=AddOn},{"../../":147,"../../util":168,"./wml/input-group":127,"@quenk/wml":170}],127:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.AddOnView=exports.InputGroupView=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var InputGroupView=function(){function InputGroupView(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{id:__context.values.id,class:__context.values.className},__spreadArrays(__context.children))}}InputGroupView.prototype.registerView=function(v){this.views.push(v);return v};InputGroupView.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};InputGroupView.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};InputGroupView.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};InputGroupView.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};InputGroupView.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};InputGroupView.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};InputGroupView.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return InputGroupView}();exports.InputGroupView=InputGroupView;var AddOnView=function(){function AddOnView(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{id:__context.values.id,class:__context.values.className},__spreadArrays(__context.children))}}AddOnView.prototype.registerView=function(v){this.views.push(v);return v};AddOnView.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};AddOnView.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};AddOnView.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};AddOnView.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};AddOnView.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};AddOnView.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};AddOnView.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return AddOnView}();exports.AddOnView=AddOnView},{"@quenk/noni/lib/data/maybe":59,"@quenk/wml/lib/dom":169}],128:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Label=exports.LABEL=void 0;var wml_1=require("@quenk/wml");var util_1=require("../../util");var __1=require("../../");var label_1=require("./wml/label");exports.LABEL="ww-label";var Label=function(_super){__extends(Label,_super);function Label(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new label_1.Main(_this);_this.values={label:{className:util_1.concat(exports.LABEL,__1.getClassName(_this.attrs)),for:_this.attrs.ww&&_this.attrs.ww.for?_this.attrs.ww.for:"",text:_this.attrs.ww&&_this.attrs.ww.text?[document.createTextNode(_this.attrs.ww.text)]:_this.children}};return _this}return Label}(wml_1.Component);exports.Label=Label},{"../../":147,"../../util":168,"./wml/label":129,"@quenk/wml":170}],129:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("label",{for:__context.values.label.for,class:__context.values.label.className},__spreadArrays(__context.values.label.text))}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"@quenk/noni/lib/data/maybe":59,"@quenk/wml/lib/dom":169}],130:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.ResultsMenu=exports.ItemSelectedEvent=exports.RESULTS_MENU=void 0;var maybe_1=require("@quenk/noni/lib/data/maybe");var wml_1=require("@quenk/wml");var __1=require("../../");var util_1=require("../../util");var __2=require("../");var results_menu_1=require("./wml/results-menu");exports.RESULTS_MENU="ww-results-menu";var ItemSelectedEvent=function(_super){__extends(ItemSelectedEvent,_super);function ItemSelectedEvent(){return _super!==null&&_super.apply(this,arguments)||this}return ItemSelectedEvent}(__2.Event);exports.ItemSelectedEvent=ItemSelectedEvent;var ResultsMenu=function(_super){__extends(ResultsMenu,_super);function ResultsMenu(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new results_menu_1.Main(_this);_this.values={wml:{id:"menu"},tree:maybe_1.nothing(),results:_this.attrs.ww&&_this.attrs.ww.results?_this.attrs.ww.results:[],name:_this.attrs.ww&&_this.attrs.ww.name?_this.attrs.ww.name:"",className:util_1.concat(exports.RESULTS_MENU,__1.getClassName(_this.attrs)),block:_this.attrs.ww&&_this.attrs.ww.block?_this.attrs.ww.block:false,hidden:_this.attrs.ww&&_this.attrs.ww.hidden?_this.attrs.ww.hidden:false,item:{stringifier:_this.attrs.ww&&_this.attrs.ww.stringifier?_this.attrs.ww.stringifier:function(v){return Object.toString.call(v)},click:function(index){if(_this.attrs.ww&&_this.attrs.ww.onSelect)_this.attrs.ww.onSelect(new ItemSelectedEvent(_this.attrs.ww&&_this.attrs.ww.name||"",_this.values.results[index]))},template:_this.attrs.ww&&_this.attrs.ww.itemTemplate?_this.attrs.ww.itemTemplate:function(option,index){return results_menu_1.itemTemplate(_this,option,index)},noItemsTemplate:function(){return _this.attrs.ww&&_this.attrs.ww.noItemsTemplate?_this.attrs.ww.noItemsTemplate:results_menu_1.noItemsTemplate()}}};return _this}ResultsMenu.prototype.open=function(){util_1.getById(this.view,this.values.wml.id).map(function(m){return m.show()});this.values.hidden=false;if(this.attrs.ww&&this.attrs.ww.onOpen)this.attrs.ww.onOpen();return this};ResultsMenu.prototype.close=function(){util_1.getById(this.view,this.values.wml.id).map(function(m){return m.hide()});this.values.hidden=true;if(this.attrs.ww&&this.attrs.ww.onClose)this.attrs.ww.onClose();return this};ResultsMenu.prototype.toggle=function(){util_1.getById(this.view,this.values.wml.id).map(function(m){return m.toggle()});this.values.hidden=!this.values.hidden;if(this.values.hidden===true&&this.attrs.ww&&this.attrs.ww.onClose)this.attrs.ww.onClose();else if(this.values.hidden===false&&this.attrs.ww&&this.attrs.ww.onOpen)this.attrs.ww.onOpen();return this};ResultsMenu.prototype.handleEvent=function(e){if(this.values.tree.isJust()){var root=this.values.tree.get();if(!document.body.contains(root))document.removeEventListener("click",this);if(!root.contains(e.target))this.close()}};ResultsMenu.prototype.update=function(results){this.values.results=results;this.values.hidden=false;this.view.invalidate();return this};ResultsMenu.prototype.render=function(){this.values.tree=maybe_1.just(this.view.render());window.removeEventListener("click",this);window.addEventListener("click",this);return this.values.tree.get()};return ResultsMenu}(wml_1.Component);exports.ResultsMenu=ResultsMenu},{"../":125,"../../":147,"../../util":168,"./wml/results-menu":131,"@quenk/noni/lib/data/maybe":59,"@quenk/wml":170}],131:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.Main=exports.noItemsTemplate=exports.itemTemplate=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var link_1=require("../../../content/link");var menu_1=require("../../../menu/menu");var item_1=require("../../../menu/item");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};exports.itemTemplate=function(r,option,_index){return function(__this){return[text(r.values.item.stringifier(option))]}};exports.noItemsTemplate=function(){return function(__this){return[__this.node("b",{},[__document.createTextNode("No results to display.")])]}};var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.widget(new menu_1.Menu({wml:{id:__context.values.wml.id},ww:{className:__context.values.className,block:__context.values.block,hidden:__context.values.hidden}},__spreadArrays(__forIn(__context.values.results,function(result,index,_$$all){return[__this.widget(new item_1.Item({ww:{name:""+index}},[__this.widget(new link_1.Link({ww:{onClick:function(){return __context.values.item.click(index)}}},__spreadArrays(__context.values.item.template(result,index)(__this))),{ww:{onClick:function(){return __context.values.item.click(index)}}})]),{ww:{name:""+index}})]},function(){return __spreadArrays(__context.values.item.noItemsTemplate()(__this))}))),{wml:{id:__context.values.wml.id},ww:{className:__context.values.className,block:__context.values.block,hidden:__context.values.hidden}})}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"../../../content/link":100,"../../../menu/item":161,"../../../menu/menu":163,"@quenk/noni/lib/data/maybe":59,"@quenk/wml/lib/dom":169}],132:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.toggleMenu=exports.closeMenu=exports.openMenu=exports.updateMenu=exports.Search=exports.Input=exports.EscapeEvent=exports.FocusLostEvent=exports.FocusGainedEvent=exports.TermChangedEvent=exports.SEARCH_INPUT=exports.SEARCH=exports.ESCAPE=exports.ItemSelectedEvent=void 0;var views=require("./wml/search");var timer_1=require("@quenk/noni/lib/control/timer");var orientation_1=require("../../content/orientation");var util_1=require("../../util");var results_menu_1=require("../results-menu");Object.defineProperty(exports,"ItemSelectedEvent",{enumerable:true,get:function(){return results_menu_1.ItemSelectedEvent}});var __1=require("../../");var __2=require("../");exports.ESCAPE=27;exports.SEARCH="ww-search";exports.SEARCH_INPUT="ww-search__input";var TermChangedEvent=function(_super){__extends(TermChangedEvent,_super);function TermChangedEvent(){return _super!==null&&_super.apply(this,arguments)||this}return TermChangedEvent}(__2.Event);exports.TermChangedEvent=TermChangedEvent;var FocusGainedEvent=function(){function FocusGainedEvent(name){this.name=name}return FocusGainedEvent}();exports.FocusGainedEvent=FocusGainedEvent;var FocusLostEvent=function(){function FocusLostEvent(name){this.name=name}return FocusLostEvent}();exports.FocusLostEvent=FocusLostEvent;var EscapeEvent=function(){function EscapeEvent(name){this.name=name}return EscapeEvent}();exports.EscapeEvent=EscapeEvent;var Input=function(_super){__extends(Input,_super);function Input(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.InputView(_this);_this.values={wml:{id:"root"},className:util_1.concat(exports.SEARCH_INPUT,__1.getClassName(_this.attrs)),placeholder:_this.attrs.ww&&_this.attrs.ww.placeholder?_this.attrs.ww.placeholder:"",readOnly:_this.attrs.ww&&_this.attrs.ww.readOnly||undefined,disabled:_this.attrs.ww&&_this.attrs.ww.disabled||undefined,autocomplete:"do not enable please",autofocus:_this.attrs.ww&&_this.attrs.ww.autofocus?true:undefined,size:String(_this.attrs.ww&&_this.attrs.ww.size?_this.attrs.ww.size:20),value:_this.attrs.ww&&_this.attrs.ww.value?_this.attrs.ww.value:"",onfocus:function(e){var target=e.target;if(_this.attrs.ww&&_this.attrs.ww.onFocus)_this.attrs.ww.onFocus(new FocusGainedEvent(_this.attrs.ww&&_this.attrs.ww.name||""));target.value=target.value},onkeyup:function(e){if(e.keyCode===exports.ESCAPE){if(_this.attrs.ww&&_this.attrs.ww.onEscape)_this.attrs.ww.onEscape(new EscapeEvent(_this.attrs.ww.name||""))}else{_this.fireSearch(e)}},oninput:function(e){e.target.oninput=null;_this.values.onkeyup(e)},onblur:function(){if(_this.attrs.ww&&_this.attrs.ww.onBlur)_this.attrs.ww.onBlur(new FocusLostEvent(_this.attrs.ww&&_this.attrs.ww.name||""))}};return _this}Input.prototype.fireSearch=function(e){if(this.attrs.ww&&this.attrs.ww.onSearch){var name_1=""+this.attrs.ww.name;var value=e.target.value;this.attrs.ww.onSearch(new TermChangedEvent(name_1,value))}};Input.prototype.rendered=function(){if(this.values.autofocus===true)this.focus()};Input.prototype.focus=function(){var _this=this;timer_1.tick(function(){return getInput(_this).map(function(i){return i.focus()})});return this};Input.prototype.setSize=function(n){this.values.size=String(n);getInput(this).map(function(i){return i.setAttribute("size",String(n))});return this};Input.prototype.getSize=function(){return Number(this.values.size)};return Input}(__2.AbstractControl);exports.Input=Input;var Search=function(_super){__extends(Search,_super);function Search(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.Main(_this);_this.values={root:{wml:{id:"root"},id:__1.getId(_this.attrs),className:util_1.concat(exports.SEARCH,__1.getClassName(_this.attrs),orientation_1.getBlockClassName(_this.attrs))},input:{wml:{id:"input"},name:__2.getName(_this.attrs),placeholder:_this.attrs.ww&&_this.attrs.ww.placeholder?_this.attrs.ww.placeholder:"",autofocus:_this.attrs.ww&&_this.attrs.ww.autofocus?true:undefined,readOnly:_this.attrs.ww&&_this.attrs.ww.readOnly||undefined,disabled:_this.attrs.ww&&_this.attrs.ww.disabled||undefined,value:_this.attrs.ww&&_this.attrs.ww.term?_this.attrs.ww.term:_this.attrs.ww&&_this.attrs.ww.stringifier&&_this.attrs.ww.value?_this.attrs.ww.stringifier(_this.attrs.ww.value):"",onFocus:_this.attrs.ww&&_this.attrs.ww.onFocus||undefined,onSearch:_this.attrs.ww&&_this.attrs.ww.onSearch?_this.attrs.ww.onSearch:undefined,onEscape:function(){return _this.close()},onBlur:_this.attrs.ww&&_this.attrs.ww.onBlur?_this.attrs.ww.onBlur:undefined},menu:{wml:{id:"menu"},name:_this.attrs.ww&&_this.attrs.ww.name?_this.attrs.ww.name:"",block:_this.attrs.ww&&_this.attrs.ww.block?_this.attrs.ww.block:false,onSelect:function(e){_this.close();if(_this.attrs.ww&&_this.attrs.ww.onSelect)_this.attrs.ww.onSelect(e)},itemTemplate:_this.attrs.ww&&_this.attrs.ww.itemTemplate?_this.attrs.ww.itemTemplate:undefined,noItemsTemplate:_this.attrs.ww&&_this.attrs.ww.noItemsTemplate?_this.attrs.ww.noItemsTemplate:undefined,stringifier:_this.attrs.ww&&_this.attrs.ww.stringifier?_this.attrs.ww.stringifier:undefined}};return _this}Search.prototype.set=function(value){util_1.getById(this.view,this.values.root.wml.id).map(function(e){e.value=value});return this};Search.prototype.focus=function(){util_1.getById(this.view,this.values.input.wml.id).map(function(i){return i.focus()});return this};Search.prototype.update=function(results){exports.updateMenu(this.view,this.values.menu.wml.id,results);return this};Search.prototype.open=function(){exports.openMenu(this.view,this.values.menu.wml.id);return this};Search.prototype.close=function(){exports.closeMenu(this.view,this.values.menu.wml.id);return this};return Search}(__2.AbstractControl);exports.Search=Search;var getInput=function(i){return util_1.getById(i.view,i.values.wml.id)};exports.updateMenu=function(view,id,results){var mMenu=util_1.getById(view,id);if(mMenu.isJust())mMenu.get().update(results)};exports.openMenu=function(view,id){util_1.getById(view,id).map(function(m){return m.open()})};exports.closeMenu=function(view,id){util_1.getById(view,id).map(function(m){return m.close()})};exports.toggleMenu=function(view,id){util_1.getById(view,id).map(function(m){return m.toggle()})}},{"../":125,"../../":147,"../../content/orientation":102,"../../util":168,"../results-menu":130,"./wml/search":133,"@quenk/noni/lib/control/timer":54}],133:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Main=exports.InputView=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var results_menu_1=require("../../results-menu");var __1=require("../");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var InputView=function(){function InputView(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("input",{wml:{id:__context.values.wml.id},class:__context.values.className,onkeyup:__context.values.onkeyup,oninput:__context.values.oninput,onfocus:__context.values.onfocus,onblur:__context.values.onblur,autofocus:__context.values.autofocus,autocomplete:__context.values.autocomplete,size:__context.values.size,placeholder:__context.values.placeholder,readOnly:__context.values.readOnly,disabled:__context.values.disabled,value:__context.values.value},[])}}InputView.prototype.registerView=function(v){this.views.push(v);return v};InputView.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};InputView.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};InputView.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};InputView.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};InputView.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};InputView.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};InputView.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return InputView}();exports.InputView=InputView;var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{wml:{id:__context.values.root.wml.id},id:__context.values.root.id,class:__context.values.root.className},[__this.widget(new __1.Input({wml:{id:__context.values.input.wml.id},ww:{name:__context.values.input.name,autofocus:__context.values.input.autofocus,onFocus:__context.values.input.onFocus,onSearch:__context.values.input.onSearch,onEscape:__context.values.input.onEscape,onBlur:__context.values.input.onBlur,placeholder:__context.values.input.placeholder,readOnly:__context.values.input.readOnly,disabled:__context.values.input.disabled,value:__context.values.input.value}},[]),{wml:{id:__context.values.input.wml.id},ww:{name:__context.values.input.name,autofocus:__context.values.input.autofocus,onFocus:__context.values.input.onFocus,onSearch:__context.values.input.onSearch,onEscape:__context.values.input.onEscape,onBlur:__context.values.input.onBlur,placeholder:__context.values.input.placeholder,readOnly:__context.values.input.readOnly,disabled:__context.values.input.disabled,value:__context.values.input.value}}),__this.widget(new results_menu_1.ResultsMenu({wml:{id:__context.values.menu.wml.id},ww:{hidden:true,block:__context.values.menu.block,onSelect:__context.values.menu.onSelect,noItemsTemplate:__context.values.menu.noItemsTemplate,itemTemplate:__context.values.menu.itemTemplate,stringifier:__context.values.menu.stringifier}},[]),{wml:{id:__context.values.menu.wml.id},ww:{hidden:true,block:__context.values.menu.block,onSelect:__context.values.menu.onSelect,noItemsTemplate:__context.values.menu.noItemsTemplate,itemTemplate:__context.values.menu.itemTemplate,stringifier:__context.values.menu.stringifier}})])}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"../":132,"../../results-menu":130,"@quenk/noni/lib/data/maybe":59,"@quenk/wml/lib/dom":169}],134:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.TextField=exports.TEXT_FIELD=exports.TextChangedEvent=void 0;var views=require("./wml/text-field");var util_1=require("../../util");var feedback_1=require("../feedback");var form_1=require("../form");var text_input_1=require("../text-input");Object.defineProperty(exports,"TextChangedEvent",{enumerable:true,get:function(){return text_input_1.TextChangedEvent}});var __1=require("../../");var __2=require("../");exports.TEXT_FIELD="ww-text-field";var TextField=function(_super){__extends(TextField,_super);function TextField(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.Main(_this);_this.values={root:{wml:{id:"root"},className:util_1.concat(exports.TEXT_FIELD,__1.getClassName(_this.attrs),feedback_1.getValidityClassName(_this.attrs))},messages:{wml:{id:"message"},text:feedback_1.getMessage(_this.attrs)},label:{id:__2.getName(_this.attrs),text:form_1.getLabel(_this.attrs)},control:{wml:{id:"root"},id:__1.getId(_this.attrs),name:__2.getName(_this.attrs),type:_this.attrs.ww&&_this.attrs.ww.type?_this.attrs.ww.type:"text",min:_this.attrs.ww&&_this.attrs.ww.min?_this.attrs.ww.min:undefined,max:_this.attrs.ww&&_this.attrs.ww.max?_this.attrs.ww.max:undefined,focus:_this.attrs.ww&&_this.attrs.ww.focus?_this.attrs.ww.focus:undefined,placeholder:_this.attrs.ww&&_this.attrs.ww.placeholder?_this.attrs.ww.placeholder:"",match:_this.attrs.ww&&_this.attrs.ww.match?_this.attrs.ww.match:undefined,length:_this.attrs.ww&&_this.attrs.ww.length?_this.attrs.ww.length:undefined,value:_this.attrs.ww&&_this.attrs.ww.value?_this.attrs.ww.value:"",disabled:_this.attrs.ww&&_this.attrs.ww.disabled?true:undefined,readOnly:_this.attrs.ww&&_this.attrs.ww.readOnly?true:undefined,rows:_this.attrs.ww&&_this.attrs.ww.rows?_this.attrs.ww.rows:1,oninput:_this.attrs.ww&&_this.attrs.ww.onChange?oninput(_this):function(){},onChange:_this.attrs.ww&&_this.attrs.ww.onChange?_this.attrs.ww.onChange:function(){}}};return _this}TextField.prototype.setMessage=function(msg){getHelp(this).map(function(h){return h.setMessage(msg)});return this};TextField.prototype.removeMessage=function(){getHelp(this).map(function(h){return h.removeMessage()});return this};return TextField}(form_1.AbstractFormControl);exports.TextField=TextField;var getHelp=function(t){return util_1.getById(t.view,t.values.messages.wml.id)};var oninput=function(f){return function(e){if(f.attrs.ww&&f.attrs.ww&&f.attrs.ww.onChange)f.attrs.ww.onChange(new text_input_1.TextChangedEvent(f.attrs.ww&&f.attrs.ww.name?f.attrs.ww.name:"",e.target.value))}}},{"../":125,"../../":147,"../../util":168,"../feedback":120,"../form":122,"../text-input":136,"./wml/text-field":135}],135:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var label_1=require("../../label");var help_1=require("../../help");var text_input_1=require("../../text-input");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{wml:{id:__context.values.root.wml.id},class:__context.values.root.className},[__this.widget(new label_1.Label({ww:{for:__context.values.control.id,text:__context.values.label.text}},[]),{ww:{for:__context.values.control.id,text:__context.values.label.text}}),__this.widget(new text_input_1.TextInput({ww:{id:__context.values.control.id,name:__context.values.control.name,focus:__context.values.control.focus,placeholder:__context.values.control.placeholder,onChange:__context.values.control.onChange,block:true,type:__context.values.control.type,min:__context.values.control.min,max:__context.values.control.max,match:__context.values.control.match,length:__context.values.control.length,value:__context.values.control.value,rows:__context.values.control.rows,disabled:__context.values.control.disabled,readOnly:__context.values.control.readOnly}},[]),{ww:{id:__context.values.control.id,name:__context.values.control.name,focus:__context.values.control.focus,placeholder:__context.values.control.placeholder,onChange:__context.values.control.onChange,block:true,type:__context.values.control.type,min:__context.values.control.min,max:__context.values.control.max,match:__context.values.control.match,length:__context.values.control.length,value:__context.values.control.value,rows:__context.values.control.rows,disabled:__context.values.control.disabled,readOnly:__context.values.control.readOnly}}),__this.widget(new help_1.Help({wml:{id:__context.values.messages.wml.id},ww:{text:__context.values.messages.text}},[]),{wml:{id:__context.values.messages.wml.id},ww:{text:__context.values.messages.text}})])}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"../../help":123,"../../label":128,"../../text-input":136,"@quenk/noni/lib/data/maybe":59,"@quenk/wml/lib/dom":169}],136:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.TextInput=exports.TextChangedEvent=exports.TEXT_INPUT=void 0;var views=require("./wml/text-input");var timer_1=require("@quenk/noni/lib/control/timer");var util_1=require("../../util");var orientation_1=require("../../content/orientation");var size_1=require("../../content/size");var focus_1=require("../focus");var __1=require("../../");var __2=require("../");exports.TEXT_INPUT="ww-text-input";var TextChangedEvent=function(_super){__extends(TextChangedEvent,_super);function TextChangedEvent(){return _super!==null&&_super.apply(this,arguments)||this}return TextChangedEvent}(__2.Event);exports.TextChangedEvent=TextChangedEvent;var TextInput=function(_super){__extends(TextInput,_super);function TextInput(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=_this.attrs.ww&&_this.attrs.ww.rows&&_this.attrs.ww.rows>1?new views.Textarea(_this):new views.Input(_this);_this.values={control:{wml:{id:"root"}},id:__1.getId(_this.attrs),className:util_1.concat(exports.TEXT_INPUT,__1.getClassName(_this.attrs),_this.attrs.ww&&_this.attrs.ww.size?size_1.getSizeClassName(_this.attrs.ww.size):"",_this.attrs.ww&&_this.attrs.ww.block?orientation_1.BLOCK:""),name:__2.getName(_this.attrs),type:_this.attrs.ww&&_this.attrs.ww.type?_this.attrs.ww.type:"text",min:_this.attrs.ww&&_this.attrs.ww.min?String(_this.attrs.ww.min):null,max:_this.attrs.ww&&_this.attrs.ww.max?String(_this.attrs.ww.max):null,match:new RegExp(_this.attrs.ww&&_this.attrs.ww.match?_this.attrs.ww.match:"."),length:_this.attrs.ww&&_this.attrs.ww.length?_this.attrs.ww.length:Infinity,placeholder:_this.attrs.ww&&_this.attrs.ww.placeholder?_this.attrs.ww.placeholder:"",value:_this.attrs.ww&&_this.attrs.ww.value?_this.attrs.ww.value:"",rows:String(_this.attrs.ww&&_this.attrs.ww.rows?_this.attrs.ww.rows:1),disabled:_this.attrs.ww&&_this.attrs.ww.disabled===true?true:null,readOnly:_this.attrs.ww&&_this.attrs.ww.readOnly===true?true:null,onkeydown:function(e){if(e.key.length===1){var value=e.target.value||"";if(!_this.values.match.test(e.key)||value.length>_this.values.length)e.preventDefault()}},oninput:dispatchInput(_this),autofocus:_this.attrs.ww&&_this.attrs.ww.focus?true:undefined,onfocus:function(){if(_this.attrs.ww&&_this.attrs.ww.onFocusGained)_this.attrs.ww.onFocusGained(new focus_1.FocusGainedEvent(__2.getName(_this.attrs)))},onblur:function(){if(_this.attrs.ww&&_this.attrs.ww.onFocusLost)_this.attrs.ww.onFocusLost(new focus_1.FocusLostEvent(__2.getName(_this.attrs)))}};return _this}TextInput.prototype.rendered=function(){if(this.values.autofocus===true)this.focus()};TextInput.prototype.focus=function(){var _this=this;return timer_1.tick(function(){return focus_1.focus(_this.view,_this.values.control.wml.id)})};return TextInput}(__2.AbstractControl);exports.TextInput=TextInput;var dispatchInput=function(i){return function(e){if(i.attrs.ww&&i.attrs.ww.onChange)i.attrs.ww.onChange(new TextChangedEvent(i.attrs&&i.attrs.ww.name?i.attrs.ww.name:"",e.target.value))}}},{"../":125,"../../":147,"../../content/orientation":102,"../../content/size":103,"../../util":168,"../focus":121,"./wml/text-input":137,"@quenk/noni/lib/control/timer":54}],137:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Input=exports.Textarea=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var Textarea=function(){function Textarea(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("textarea",{wml:{id:__context.values.control.wml.id},id:__context.values.id,name:__context.values.name,placeholder:__context.values.placeholder,oninput:__context.values.oninput,value:__context.values.value,disabled:__context.values.disabled,readonly:__context.values.readOnly,rows:__context.values.rows,class:__context.values.className},[document.createTextNode(__context.values.value)])}}Textarea.prototype.registerView=function(v){this.views.push(v);return v};Textarea.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Textarea.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Textarea.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Textarea.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Textarea.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Textarea.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Textarea.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Textarea}();exports.Textarea=Textarea;var Input=function(){function Input(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("input",{wml:{id:__context.values.control.wml.id},id:__context.values.id,name:__context.values.name,type:__context.values.type,min:__context.values.min,max:__context.values.max,placeholder:__context.values.placeholder,oninput:__context.values.oninput,onkeydown:__context.values.onkeydown,autofocus:__context.values.autofocus,value:__context.values.value,disabled:__context.values.disabled,readonly:__context.values.readOnly,class:__context.values.className},[])}}Input.prototype.registerView=function(v){this.views.push(v);return v};Input.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Input.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Input.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Input.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Input.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Input.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Input.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Input}();exports.Input=Input},{"@quenk/noni/lib/data/maybe":59,"@quenk/wml/lib/dom":169}],138:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Toolbar=exports.TOOLBAR_COMPAT=exports.TOOLBAR=void 0;var views=require("./wml/toolbar");var wml_1=require("@quenk/wml");var util_1=require("../../util");var __1=require("../../");exports.TOOLBAR="ww-toolbar";exports.TOOLBAR_COMPAT="-toolbar-compat";var Toolbar=function(_super){__extends(Toolbar,_super);function Toolbar(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.Main(_this);_this.values={root:{id:__1.getId(_this.attrs),className:util_1.concat(exports.TOOLBAR,__1.getClassName(_this.attrs))}};return _this}return Toolbar}(wml_1.Component);exports.Toolbar=Toolbar},{"../../":147,"../../util":168,"./wml/toolbar":139,"@quenk/wml":170}],139:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{id:__context.values.root.id,class:__context.values.root.className},__spreadArrays(__context.children))}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"@quenk/noni/lib/data/maybe":59,"@quenk/wml/lib/dom":169}],140:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.sortById=exports.SortRequest=void 0;var path_1=require("@quenk/noni/lib/data/record/path");var sort_1=require("@quenk/noni/lib/data/array/sort");var SortRequest=function(){function SortRequest(column,data,key){this.column=column;this.data=data;this.key=key}return SortRequest}();exports.SortRequest=SortRequest;exports.sortById=function(cols,key,data,id){var spec=cols[id];var current=data[0],original=data[1];if(spec===undefined)return[current,key];if(!spec.sort)return[current,key];if(key[0]===id){return[current.reverse(),[key[0],key[1]*-1]]}else{var strategy=getSortStrategy(spec.sort);var alias=spec.alias?spec.alias:spec.name;return[doSort(original.slice(),strategy,alias),[id,-1]]}};var getSortStrategy=function(s){if(typeof s==="function")return s;if(s==="date")return sort_1.date;if(s==="number")return sort_1.number;if(s==="string")return sort_1.string;return sort_1.natural};var doSort=function(data,s,alias){return data.sort(function(a,b){return s(getAny(alias,a),getAny(alias,b))})};var getAny=function(path,src){return path_1.getDefault(path,src,undefined)}},{"@quenk/noni/lib/data/array/sort":56,"@quenk/noni/lib/data/record/path":61}],141:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DataChangedEvent=exports.CellClickedEvent=exports.HeadingClickedEvent=void 0;var HeadingClickedEvent=function(){function HeadingClickedEvent(column){this.column=column}return HeadingClickedEvent}();exports.HeadingClickedEvent=HeadingClickedEvent;var CellClickedEvent=function(){function CellClickedEvent(column,row){this.column=column;this.row=row}return CellClickedEvent}();exports.CellClickedEvent=CellClickedEvent;var DataChangedEvent=function(){function DataChangedEvent(name,data,key){this.name=name;this.data=data;this.key=key}return DataChangedEvent}();exports.DataChangedEvent=DataChangedEvent},{}],142:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.DataTable=exports.NewCellContext=exports.NewBodyContext=exports.NewHeadingContext=exports.NewHeadContext=exports.DESC=exports.ASC=exports.DATA_TABLE_CELL=exports.DATA_TABLE_BODY=exports.DATA_TABLE_HEADING=exports.DATA_TABLE_HEAD=exports.DATA_TABLE=exports.HeadingClickedEvent=exports.CellClickedEvent=exports.DataChangedEvent=exports.SortRequest=void 0;var views=require("./wml/table");var wml_1=require("@quenk/wml");var array_1=require("@quenk/noni/lib/data/array");var path_1=require("@quenk/noni/lib/data/record/path");var util_1=require("../../util");var __1=require("../../");var sort_1=require("./column/sort");Object.defineProperty(exports,"SortRequest",{enumerable:true,get:function(){return sort_1.SortRequest}});var event_1=require("./event");Object.defineProperty(exports,"DataChangedEvent",{enumerable:true,get:function(){return event_1.DataChangedEvent}});Object.defineProperty(exports,"CellClickedEvent",{enumerable:true,get:function(){return event_1.CellClickedEvent}});Object.defineProperty(exports,"HeadingClickedEvent",{enumerable:true,get:function(){return event_1.HeadingClickedEvent}});var range_1=require("./range");exports.DATA_TABLE="ww-data-table";exports.DATA_TABLE_HEAD="ww-data-table__head";exports.DATA_TABLE_HEADING="ww-data-table__heading";exports.DATA_TABLE_BODY="ww-data-table__body";exports.DATA_TABLE_CELL="ww-data-table__cell";exports.ASC="-asc";exports.DESC="-desc";var NewHeadContext=function(){function NewHeadContext(table){var _this=this;this.table=table;this.className=util_1.concat(exports.DATA_TABLE_HEAD,this.table.attrs.ww&&this.table.attrs.ww.headClassName||"");this.columns=this.table.values.columns;this.data=this.table.values.dataset[0];this.heading=function(c,i){return getHeadingView(_this.table,new NewHeadingContext(_this.table,_this,c,i),c).render()}}return NewHeadContext}();exports.NewHeadContext=NewHeadContext;var NewHeadingContext=function(){function NewHeadingContext(table,headContext,column,index){var _this=this;this.table=table;this.headContext=headContext;this.column=column;this.index=index;this.className=util_1.concat(exports.DATA_TABLE_HEADING,this.table.attrs.ww&&this.table.attrs.ww.headingClassName||"",this.column.headingClassName,getSortClassName(this.table.values.sortKey,this.index));this.onclick=function(_){if(_this.column.sort)_this.table.values.sort(_this.index);if(_this.column.onHeadingClicked)_this.column.onHeadingClicked(new event_1.HeadingClickedEvent(_this.index));if(_this.table.attrs.ww&&_this.table.attrs.ww.onHeadingClicked)_this.table.attrs.ww.onHeadingClicked(new event_1.HeadingClickedEvent(_this.index))}}return NewHeadingContext}();exports.NewHeadingContext=NewHeadingContext;var NewBodyContext=function(){function NewBodyContext(table){var _this=this;this.table=table;this.className=util_1.concat(exports.DATA_TABLE_BODY,this.table.attrs.ww&&this.table.attrs.ww.bodyClassName||"");this.columns=this.table.values.columns;this.data=this.table.values.dataset[0];this.cell=function(c,id,row){return getCellView(_this.table,new NewCellContext(_this.table,_this,c,id,row),c).render()}}return NewBodyContext}();exports.NewBodyContext=NewBodyContext;var NewCellContext=function(){function NewCellContext(table,bodyContext,spec,column,row){var _this=this;this.table=table;this.bodyContext=bodyContext;this.spec=spec;this.column=column;this.row=row;this.id=cellId(this.column,this.row);this.className=util_1.concat(exports.DATA_TABLE_CELL,this.table.attrs.ww&&this.table.attrs.ww.cellClassName||"",this.spec.cellClassName,getSortClassName(this.table.values.sortKey,this.column));this.value=path_1.unsafeGet(this.spec.name,this.table.values.dataset[0][this.row]);this.datum=this.table.values.dataset[0][this.row];this.format=this.spec.format?this.spec.format:function(c){return String(c==null?"":c)};this.onclick=function(){if(_this.spec.onCellClicked)_this.spec.onCellClicked(new event_1.CellClickedEvent(_this.column,_this.row));if(_this.table.attrs.ww&&_this.table.attrs.ww.onCellClicked)_this.table.attrs.ww.onCellClicked(new event_1.CellClickedEvent(_this.column,_this.row))}}return NewCellContext}();exports.NewCellContext=NewCellContext;var DataTable=function(_super){__extends(DataTable,_super);function DataTable(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.Main(_this);_this.theadView=new views.EmptyView({});_this.tbodyView=new views.EmptyView({});_this.values={wml:{id:"table"},id:__1.getId(_this.attrs),className:util_1.concat(exports.DATA_TABLE,__1.getClassName(_this.attrs)),name:_this.attrs.ww&&_this.attrs.ww.name||"",sortable:_this.attrs.ww&&_this.attrs.ww.sortable!=null?_this.attrs.ww.sortable:true,sortKey:_this.attrs.ww&&_this.attrs.ww.sortKey?_this.attrs.ww.sortKey:[-1,1],sort:function(col){if(_this.values.sortable)_this.sort(col)},dataset:_this.attrs.ww&&_this.attrs.ww.data?[_this.attrs.ww.data.slice(),_this.attrs.ww.data.slice()]:[[],[]],columns:_this.attrs.ww&&_this.attrs.ww.columns?_this.attrs.ww.columns:[],thead:function(){_this.theadView=getHeadView(_this,new NewHeadContext(_this));return _this.theadView.render()},tbody:function(){_this.tbodyView=getBodyView(_this,new NewBodyContext(_this));return _this.tbodyView.render()}};return _this}DataTable.prototype.fireChange=function(){if(this.attrs.ww&&this.attrs.ww.onChange)this.attrs.ww.onChange(new event_1.DataChangedEvent(this.values.name,this.values.dataset[0].slice(),this.values.sortKey.slice()))};DataTable.prototype.update=function(data){this.values.dataset=[data.slice(),data.slice()];this.view.invalidate();this.fireChange();return this};DataTable.prototype.updateWithSortKey=function(data,key){this.values.sortKey=key;this.update(data);return this};DataTable.prototype.sort=function(id){var _a=this.values,sortKey=_a.sortKey,dataset=_a.dataset;var del=getSortDelegate(this);var _b=del(new sort_1.SortRequest(id,dataset[1],sortKey)),data=_b[0],key=_b[1];this.values.dataset[0]=data;this.values.sortKey=key;this.view.invalidate();this.fireChange();return this};DataTable.prototype.getRow=function(row){var mTr=util_1.getById(this.tbodyView,""+row);if(mTr.isNothing())return new range_1.RangeInstance([]);var tr=mTr.get();return new range_1.RangeInstance(array_1.make(tr.cells.length,function(n){return tr.cells[n]}))};DataTable.prototype.getCell=function(column,row){var cells=this.getRow(row).cells;if(!cells[column])return new range_1.RangeInstance([]);return new range_1.RangeInstance([cells[column]])};return DataTable}(wml_1.Component);exports.DataTable=DataTable;var getHeadView=function(table,ctx){return table.attrs.ww&&table.attrs.ww.headFragment?table.attrs.ww.headFragment(ctx):new views.HeadView(ctx)};var getHeadingView=function(table,ctx,c){return c.headingFragment?c.headingFragment(ctx):table.attrs.ww&&table.attrs.ww.headingFragment?table.attrs.ww.headingFragment(ctx):new views.HeadingView(ctx)};var getBodyView=function(table,ctx){return table.attrs.ww&&table.attrs.ww.bodyFragment?table.attrs.ww.bodyFragment(ctx):new views.BodyView(ctx)};var getCellView=function(table,ctx,c){return c.cellFragment?c.cellFragment(ctx):table.attrs.ww&&table.attrs.ww.cellFragment?table.attrs.ww.cellFragment(ctx):new views.CellView(ctx)};var getSortDelegate=function(table){return table.attrs.ww&&table.attrs.ww.sortDelegate?table.attrs.ww.sortDelegate:function(r){return sort_1.sortById(table.values.columns,r.key,[table.values.dataset[0],r.data],r.column)}};var getSortClassName=function(key,index){return key[0]===index?key[1]===1?exports.ASC:exports.DESC:""};var cellId=function(column,row){return column+","+row}},{"../../":147,"../../util":168,"./column/sort":140,"./event":141,"./range":143,"./wml/table":144,"@quenk/noni/lib/data/array":55,"@quenk/noni/lib/data/record/path":61,"@quenk/wml":170}],143:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RangeInstance=void 0;var RangeInstance=function(){function RangeInstance(cells){this.cells=cells}return RangeInstance}();exports.RangeInstance=RangeInstance},{}],144:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.Main=exports.CellView=exports.BodyView=exports.HeadingView=exports.HeadView=exports.EmptyView=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var table_1=require("../../../layout/table");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var EmptyView=function(){function EmptyView(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{},[])}}EmptyView.prototype.registerView=function(v){this.views.push(v);return v};EmptyView.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};EmptyView.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};EmptyView.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};EmptyView.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};EmptyView.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};EmptyView.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};EmptyView.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return EmptyView}();exports.EmptyView=EmptyView;var HeadView=function(){function HeadView(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("thead",{class:__context.className},[__this.node("tr",{},__spreadArrays(__forIn(__context.columns,function(col,idx,_$$all){return[__context.heading(col,idx)]},function(){return[]})))])}}HeadView.prototype.registerView=function(v){this.views.push(v);return v};HeadView.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};HeadView.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};HeadView.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};HeadView.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};HeadView.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};HeadView.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};HeadView.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return HeadView}();exports.HeadView=HeadView;var HeadingView=function(){function HeadingView(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("th",{class:__context.className,onclick:__context.onclick},[text(__context.column.heading)])}}HeadingView.prototype.registerView=function(v){this.views.push(v);return v};HeadingView.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};HeadingView.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};HeadingView.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};HeadingView.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};HeadingView.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};HeadingView.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};HeadingView.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return HeadingView}();exports.HeadingView=HeadingView;var BodyView=function(){function BodyView(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("tbody",{class:__context.className},__spreadArrays(__forIn(__context.data,function(_,row,_$$all){return[__this.node("tr",{wml:{id:String(row)}},__spreadArrays(__forIn(__context.columns,function(col,idx,_$$all){return[__context.cell(col,idx,row)]},function(){return[]})))]},function(){return[]})))}}BodyView.prototype.registerView=function(v){this.views.push(v);return v};BodyView.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};BodyView.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};BodyView.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};BodyView.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};BodyView.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};BodyView.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};BodyView.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return BodyView}();exports.BodyView=BodyView;var CellView=function(){function CellView(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("td",{wml:{id:__context.id},class:__context.className,onclick:__context.onclick},[text(__context.format(__context.value))])}}CellView.prototype.registerView=function(v){this.views.push(v);return v};CellView.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};CellView.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};CellView.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};CellView.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};CellView.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};CellView.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};CellView.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return CellView}();exports.CellView=CellView;var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.widget(new table_1.TableLayout({wml:{id:__context.values.wml.id},ww:{id:__context.values.id,className:__context.values.className}},[__context.values.thead(),__context.values.tbody()]),{wml:{id:__context.values.wml.id},ww:{id:__context.values.id,className:__context.values.className}})}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"../../../layout/table":159,"@quenk/noni/lib/data/maybe":59,"@quenk/wml/lib/dom":169}],145:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.ModalFooter=exports.ModalBody=exports.ModalHeader=exports.Modal=exports.MODAL_FOOTER=exports.MODAL_BODY=exports.MODAL_HEADER=exports.MODAL_CONTENT=exports.MODAL_POSITION=exports.MODAL=void 0;var views=require("./wml/modal");var wml_1=require("@quenk/wml");var util_1=require("../../util");var __1=require("../../");var layout_1=require("../../layout");exports.MODAL="ww-modal";exports.MODAL_POSITION="ww-modal__position";exports.MODAL_CONTENT="ww-modal__content";exports.MODAL_HEADER="ww-modal__header";exports.MODAL_BODY="ww-modal__body";exports.MODAL_FOOTER="ww-modal__footer";var Modal=function(_super){__extends(Modal,_super);function Modal(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.Modal(_this);_this.values={wml:{id:"root"},id:__1.getId(_this.attrs),className:util_1.concat(exports.MODAL,__1.getClassName(_this.attrs)),content:{className:exports.MODAL_CONTENT},position:{className:exports.MODAL_POSITION}};return _this}Modal.prototype.close=function(){var mO=util_1.getById(this.view,this.values.wml.id);if(mO.isJust()){var n=mO.get();if(n.parentNode)n.parentNode.removeChild(n)}};return Modal}(wml_1.Component);exports.Modal=Modal;var ModalHeader=function(_super){__extends(ModalHeader,_super);function ModalHeader(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.ModalHeader(_this);_this.values={wml:{id:"root"},id:__1.getId(_this.attrs),className:util_1.concat(exports.MODAL_HEADER,__1.getClassName(_this.attrs)),content:{wml:{id:"root"}}};return _this}return ModalHeader}(layout_1.AbstractLayout);exports.ModalHeader=ModalHeader;var ModalBody=function(_super){__extends(ModalBody,_super);function ModalBody(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.ModalBody(_this);_this.values={wml:{id:"root"},id:__1.getId(_this.attrs),className:util_1.concat(exports.MODAL_BODY,__1.getClassName(_this.attrs)),content:{wml:{id:"root"}}};return _this}return ModalBody}(layout_1.AbstractLayout);exports.ModalBody=ModalBody;var ModalFooter=function(_super){__extends(ModalFooter,_super);function ModalFooter(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.ModalFooter(_this);_this.values={wml:{id:"root"},id:__1.getId(_this.attrs),className:util_1.concat(exports.MODAL_FOOTER,__1.getClassName(_this.attrs)),content:{wml:{id:"root"}}};return _this}return ModalFooter}(wml_1.Component);exports.ModalFooter=ModalFooter},{"../../":147,"../../layout":152,"../../util":168,"./wml/modal":146,"@quenk/wml":170}],146:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.ModalFooter=exports.ModalBody=exports.ModalHeader=exports.Modal=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var Modal=function(){function Modal(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{wml:{id:__context.values.wml.id},id:__context.values.id,class:__context.values.className},[__this.node("div",{class:__context.values.position.className},[__this.node("div",{class:__context.values.content.className},__spreadArrays(__context.children))])])}}Modal.prototype.registerView=function(v){this.views.push(v);return v};Modal.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Modal.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Modal.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Modal.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Modal.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Modal.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Modal.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Modal}();exports.Modal=Modal;var ModalHeader=function(){function ModalHeader(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{wml:{id:__context.values.wml.id},id:__context.values.id,class:__context.values.className},__spreadArrays(__context.children))}}ModalHeader.prototype.registerView=function(v){this.views.push(v);return v};ModalHeader.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};ModalHeader.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};ModalHeader.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};ModalHeader.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};ModalHeader.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};ModalHeader.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};ModalHeader.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return ModalHeader}();exports.ModalHeader=ModalHeader;var ModalBody=function(){function ModalBody(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{wml:{id:__context.values.wml.id},id:__context.values.id,class:__context.values.className},__spreadArrays(__context.children))}}ModalBody.prototype.registerView=function(v){this.views.push(v);return v};ModalBody.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};ModalBody.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};ModalBody.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};ModalBody.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};ModalBody.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};ModalBody.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};ModalBody.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return ModalBody}();exports.ModalBody=ModalBody;var ModalFooter=function(){function ModalFooter(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{wml:{id:__context.values.wml.id},id:__context.values.id,class:__context.values.className},__spreadArrays(__context.children))}}ModalFooter.prototype.registerView=function(v){this.views.push(v);return v};ModalFooter.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};ModalFooter.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};ModalFooter.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};ModalFooter.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};ModalFooter.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};ModalFooter.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};ModalFooter.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return ModalFooter}();exports.ModalFooter=ModalFooter},{"@quenk/noni/lib/data/maybe":59,"@quenk/wml/lib/dom":169}],147:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getClassName=exports.getId=void 0;exports.getId=function(attrs){return attrs.ww&&attrs.ww.id?attrs.ww.id:""};exports.getClassName=function(attrs){var asHtmlAttrs=attrs;var asWidgetAttrs=attrs.ww;return asHtmlAttrs.className||asWidgetAttrs&&asWidgetAttrs.className||""}},{}],148:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.ActionBar=exports.ACTION_BAR_CONTENT=exports.ACTION_BAR=void 0;var orientation=require("../../content/orientation");var __1=require("../..");var util_1=require("../../util");var __2=require("../");var action_bar_1=require("./wml/action-bar");exports.ACTION_BAR="ww-action-bar";exports.ACTION_BAR_CONTENT="ww-action-bar__content";var ActionBar=function(_super){__extends(ActionBar,_super);function ActionBar(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new action_bar_1.Main(_this);_this.values={root:{wml:{id:"root"},id:_this.attrs.ww&&_this.attrs.ww.id?_this.attrs.ww.id:"",className:util_1.concat(exports.ACTION_BAR,__2.LAYOUT,orientation.POSITIONED,__1.getClassName(_this.attrs))},content:{wml:{id:"content"},class:exports.ACTION_BAR_CONTENT}};return _this}return ActionBar}(__2.AbstractLayout);exports.ActionBar=ActionBar},{"../":152,"../..":147,"../../content/orientation":102,"../../util":168,"./wml/action-bar":149}],149:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{wml:{id:__context.values.root.wml.id},id:__context.values.root.id,class:__context.values.root.className},[__this.node("div",{wml:{id:__context.values.content.wml.id},class:__context.values.content.class},__spreadArrays(__context.children))])}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"@quenk/noni/lib/data/maybe":59,"@quenk/wml/lib/dom":169}],150:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Column=exports.Row=exports.GridLayout=exports.GRID_LAYOUT_COLUMN=exports.GRID_LAYOUT_ROW=exports.GRID_LAYOUT=void 0;var views=require("./wml/grid");var util_1=require("../../util");var __1=require("../");exports.GRID_LAYOUT="ww-grid-layout";exports.GRID_LAYOUT_ROW="ww-grid-layout__row";exports.GRID_LAYOUT_COLUMN="ww-grid-layout__column";var GridLayout=function(_super){__extends(GridLayout,_super);function GridLayout(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.GridLayout(_this);_this.values={content:{id:_this.attrs.ww&&_this.attrs.ww.id,wml:{id:"root"},className:function(){var c=_this.attrs.ww&&_this.attrs.ww.className?_this.attrs.ww.className:"";return util_1.concat(exports.GRID_LAYOUT,__1.LAYOUT,c)}}};return _this}return GridLayout}(__1.AbstractLayout);exports.GridLayout=GridLayout;var Row=function(_super){__extends(Row,_super);function Row(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.Row(_this);_this.values={content:{id:_this.attrs.ww&&_this.attrs.ww.id,wml:{id:"row"},className:function(){var c=_this.attrs.ww&&_this.attrs.ww.className?_this.attrs.ww.className:"";return util_1.concat(exports.GRID_LAYOUT_ROW,c)}}};return _this}return Row}(__1.AbstractLayout);exports.Row=Row;var Column=function(_super){__extends(Column,_super);function Column(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.Column(_this);_this.values={content:{id:_this.attrs.ww&&_this.attrs.ww.id,wml:{id:"column"},className:function(){if(_this.attrs.ww!=null){return util_1.concat(exports.GRID_LAYOUT_COLUMN,_this.attrs.ww.span?"-span"+_this.attrs.ww.span:"-span12",_this.attrs.ww.offset?"-offset"+_this.attrs.ww.offset:"",_this.attrs.ww.className)}else{return util_1.concat(exports.GRID_LAYOUT_COLUMN,"-span12")}}}};return _this}return Column}(__1.AbstractLayout);exports.Column=Column},{"../":152,"../../util":168,"./wml/grid":151}],151:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.Column=exports.Row=exports.GridLayout=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var GridLayout=function(){function GridLayout(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{wml:{id:__context.values.content.wml.id},id:__context.values.content.id,class:__context.values.content.className()},__spreadArrays(__context.children))}}GridLayout.prototype.registerView=function(v){this.views.push(v);return v};GridLayout.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};GridLayout.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};GridLayout.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};GridLayout.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};GridLayout.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};GridLayout.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};GridLayout.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return GridLayout}();exports.GridLayout=GridLayout;var Row=function(){function Row(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{wml:{id:__context.values.content.wml.id},id:__context.values.content.id,class:__context.values.content.className()},__spreadArrays(__context.children))}}Row.prototype.registerView=function(v){this.views.push(v);return v};Row.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Row.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Row.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Row.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Row.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Row.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Row.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Row}();exports.Row=Row;var Column=function(){function Column(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{wml:{id:__context.values.content.wml.id},id:__context.values.content.id,class:__context.values.content.className()},__spreadArrays(__context.children))}}Column.prototype.registerView=function(v){this.views.push(v);return v};Column.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Column.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Column.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Column.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Column.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Column.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Column.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Column}();exports.Column=Column},{"@quenk/noni/lib/data/maybe":59,"@quenk/wml/lib/dom":169}],152:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.doRemoveContent=exports.doSetContent=exports.AbstractLayout=exports.LAYOUT=void 0;var wml_1=require("@quenk/wml");var util_1=require("../util");exports.LAYOUT="-layout";var AbstractLayout=function(_super){__extends(AbstractLayout,_super);function AbstractLayout(){return _super!==null&&_super.apply(this,arguments)||this}AbstractLayout.prototype.setContent=function(c){exports.doSetContent(this.view,this.values.content.wml.id,c);return this};AbstractLayout.prototype.removeContent=function(){exports.doRemoveContent(this.view,this.values.content.wml.id);return this};return AbstractLayout}(wml_1.Component);exports.AbstractLayout=AbstractLayout;exports.doSetContent=function(view,id,content){var maybeRoot=view.findById(id);if(maybeRoot.isNothing())return util_1.warnMissing(view,id);var n=maybeRoot.get();while(n.firstChild)n.removeChild(n.firstChild);content=Array.isArray(content)?content:[content];for(var i=0;i<content.length;i++)n.appendChild(content[i])};exports.doRemoveContent=function(view,id){var maybeNode=view.findById(id);if(maybeNode.isNothing())return util_1.warnMissing(view,id);var n=maybeNode.get();while(n.firstChild)n.removeChild(n.firstChild)}},{"../util":168,"@quenk/wml":170}],153:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.MainLayout=exports.MAIN_LAYOUT=void 0;var views=require("./wml/main");var util_1=require("../../util");var __1=require("../");exports.MAIN_LAYOUT="ww-main-layout";var MainLayout=function(_super){__extends(MainLayout,_super);function MainLayout(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.Main(_this);_this.values={content:{wml:{id:"main"},id:_this.attrs&&_this.attrs.ww?_this.attrs.ww.id:"",className:util_1.concat(exports.MAIN_LAYOUT,__1.LAYOUT,_this.attrs&&_this.attrs.ww?_this.attrs.ww.className:"")}};return _this}return MainLayout}(__1.AbstractLayout);exports.MainLayout=MainLayout},{"../":152,"../../util":168,"./wml/main":154}],154:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{wml:{id:__context.values.content.wml.id},id:__context.values.content.id,class:__context.values.content.className},__spreadArrays(__context.children))}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"@quenk/noni/lib/data/maybe":59,"@quenk/wml/lib/dom":169}],155:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.NavBar=exports.NAV_BAR=void 0;var wml_1=require("@quenk/wml");var type_1=require("@quenk/noni/lib/data/type");var record_1=require("@quenk/noni/lib/data/record");var __1=require("../..");var util_1=require("../../util");var nav_bar_1=require("./views/nav-bar");exports.NAV_BAR="ww-nav-bar";var NavBar=function(_super){__extends(NavBar,_super);function NavBar(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new nav_bar_1.NavBarView(_this);_this.values={wml:{id:"root"},id:__1.getId(_this.attrs),className:util_1.concat(exports.NAV_BAR,__1.getClassName(_this.attrs)),links:_this.attrs.links?normalize(_this.attrs.links):[]};return _this}return NavBar}(wml_1.Component);exports.NavBar=NavBar;var normalize=function(specs){if(Array.isArray(specs))return specs;else return record_1.mapTo(specs,function(conf,title){if(type_1.isString(conf))return{name:title,title:title,href:conf};else if(type_1.isFunction(conf))return{name:title,title:title,onClick:conf};else return record_1.merge({title:title,name:title},conf)})}},{"../..":147,"../../util":168,"./views/nav-bar":156,"@quenk/noni/lib/data/record":60,"@quenk/noni/lib/data/type":63,"@quenk/wml":170}],156:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.NavBarView=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var item_1=require("../../../menu/item");var nav_1=require("../../../menu/nav");var link_1=require("../../../content/link");var action_bar_1=require("../../action-bar");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var NavBarView=function(){function NavBarView(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.widget(new action_bar_1.ActionBar({ww:{id:__context.values.id,className:__context.values.className}},__spreadArrays([__this.widget(new nav_1.Nav({},__spreadArrays(__forIn(__context.values.links,function(conf,_$$i,_$$all){return[__this.widget(new item_1.Item({},[__this.widget(new link_1.Link({ww:{className:conf.className,name:conf.name,text:conf.title,onClick:function(){return conf.onClick?conf.onClick(conf.name):undefined}}},[]),{ww:{className:conf.className,name:conf.name,text:conf.title,onClick:function(){return conf.onClick?conf.onClick(conf.name):undefined}}})]),{})]},function(){return[]}))),{})],__context.children)),{ww:{id:__context.values.id,className:__context.values.className}})}}NavBarView.prototype.registerView=function(v){this.views.push(v);return v};NavBarView.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};NavBarView.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};NavBarView.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};NavBarView.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};NavBarView.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};NavBarView.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};NavBarView.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return NavBarView}();exports.NavBarView=NavBarView},{"../../../content/link":100,"../../../menu/item":161,"../../../menu/nav":166,"../../action-bar":148,"@quenk/noni/lib/data/maybe":59,"@quenk/wml/lib/dom":169}],157:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.PanelFooter=exports.PanelBody=exports.PanelHeader=exports.Panel=exports.PANEL_FOOTER=exports.PANEL_BODY=exports.PANEL_HEADER=exports.PANEL=void 0;var style=require("../../content/style");var views=require("./wml/panel");var util_1=require("../../util");var __1=require("..");exports.PANEL="ww-panel";exports.PANEL_HEADER="ww-panel__header";exports.PANEL_BODY="ww-panel__body";exports.PANEL_FOOTER="ww-panel__footer";var Panel=function(_super){__extends(Panel,_super);function Panel(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.Panel(_this);_this.values={content:{id:_this.attrs.ww&&_this.attrs.ww.id,wml:{id:"panel"},className:util_1.concat(exports.PANEL,__1.LAYOUT,_this.attrs.ww&&_this.attrs.ww.style?"-"+_this.attrs.ww.style:style.DEFAULT,_this.attrs.ww&&_this.attrs.ww.className?_this.attrs.ww.className:"")}};return _this}return Panel}(__1.AbstractLayout);exports.Panel=Panel;var PanelHeader=function(_super){__extends(PanelHeader,_super);function PanelHeader(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.PanelHeader(_this);_this.values={content:{wml:{id:"header"},id:_this.attrs.ww&&_this.attrs.ww.id,className:util_1.concat(exports.PANEL_HEADER,__1.LAYOUT,_this.attrs.ww&&_this.attrs.ww.className?_this.attrs.ww.className:"")}};return _this}return PanelHeader}(__1.AbstractLayout);exports.PanelHeader=PanelHeader;var PanelBody=function(_super){__extends(PanelBody,_super);function PanelBody(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.PanelBody(_this);_this.values={content:{wml:{id:"body"},id:_this.attrs.ww&&_this.attrs.ww.id,className:util_1.concat(exports.PANEL_BODY,__1.LAYOUT,_this.attrs.ww&&_this.attrs.ww.className?_this.attrs.ww.className:"")}};return _this}return PanelBody}(__1.AbstractLayout);exports.PanelBody=PanelBody;var PanelFooter=function(_super){__extends(PanelFooter,_super);function PanelFooter(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.PanelFooter(_this);_this.values={content:{wml:{id:"footer"},id:_this.attrs.ww&&_this.attrs.ww.id,className:util_1.concat(exports.PANEL_FOOTER,__1.LAYOUT,_this.attrs.ww&&_this.attrs.ww.className?_this.attrs.ww.className:"")}};return _this}return PanelFooter}(__1.AbstractLayout);exports.PanelFooter=PanelFooter},{"..":152,"../../content/style":107,"../../util":168,"./wml/panel":158}],158:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.PanelFooter=exports.PanelBody=exports.PanelHeader=exports.Panel=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var Panel=function(){function Panel(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{wml:{id:__context.values.content.id},class:__context.values.content.className},__spreadArrays(__context.children))}}Panel.prototype.registerView=function(v){this.views.push(v);return v};Panel.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Panel.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Panel.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Panel.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Panel.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Panel.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Panel.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Panel}();exports.Panel=Panel;var PanelHeader=function(){function PanelHeader(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{wml:{id:__context.values.content.id},class:__context.values.content.className},__spreadArrays(__context.children))}}PanelHeader.prototype.registerView=function(v){this.views.push(v);return v};PanelHeader.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};PanelHeader.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};PanelHeader.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};PanelHeader.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};PanelHeader.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};PanelHeader.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};PanelHeader.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return PanelHeader}();exports.PanelHeader=PanelHeader;var PanelBody=function(){function PanelBody(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{wml:{id:__context.values.content.id},class:__context.values.content.className},__spreadArrays(__context.children))}}PanelBody.prototype.registerView=function(v){this.views.push(v);return v};PanelBody.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};PanelBody.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};PanelBody.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};PanelBody.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};PanelBody.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};PanelBody.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};PanelBody.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return PanelBody}();exports.PanelBody=PanelBody;var PanelFooter=function(){function PanelFooter(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{wml:{id:__context.values.content.id},class:__context.values.content.className},__spreadArrays(__context.children))}}PanelFooter.prototype.registerView=function(v){this.views.push(v);return v};PanelFooter.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};PanelFooter.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};PanelFooter.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};PanelFooter.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};PanelFooter.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};PanelFooter.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};PanelFooter.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return PanelFooter}();exports.PanelFooter=PanelFooter},{"@quenk/noni/lib/data/maybe":59,"@quenk/wml/lib/dom":169}],159:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.TableLayout=exports.TableWindow=exports.TableCell=exports.TableHeading=exports.TableRow=exports.TableFooter=exports.TableBody=exports.TableHeader=exports.HOVERABLE=exports.ALTERNATE=exports.COMPACT=exports.BORDERED=exports.TABLE_WINDOW=exports.TABLE_LAYOUT=exports.TABLE_CELL=exports.TABLE_HEADING=exports.TABLE_ROW=exports.TABLE_FOOTER=exports.TABLE_BODY=exports.TABLE_HEADER=void 0;var views=require("./wml/table");var wml_1=require("@quenk/wml");var util_1=require("../../util");var __1=require("../../");exports.TABLE_HEADER="ww-table-layout__header";exports.TABLE_BODY="ww-table-layout__body";exports.TABLE_FOOTER="ww-table-layout__footer";exports.TABLE_ROW="ww-table-layout__row";exports.TABLE_HEADING="ww-table-layout _heading";exports.TABLE_CELL="ww-table-layout__cell";exports.TABLE_LAYOUT="ww-table-layout";exports.TABLE_WINDOW="ww-table-window";exports.BORDERED="-bordered";exports.COMPACT="-compact";exports.ALTERNATE="-alternate";exports.HOVERABLE="-hoverable";var TableHeader=function(_super){__extends(TableHeader,_super);function TableHeader(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.TableHeader(_this);_this.values={id:__1.getId(_this.attrs),className:util_1.concat(exports.TABLE_HEADER,__1.getClassName(_this.attrs))};return _this}return TableHeader}(wml_1.Component);exports.TableHeader=TableHeader;var TableBody=function(_super){__extends(TableBody,_super);function TableBody(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.TableBody(_this);_this.values={id:__1.getId(_this.attrs),className:util_1.concat(exports.TABLE_BODY,__1.getClassName(_this.attrs))};return _this}return TableBody}(wml_1.Component);exports.TableBody=TableBody;var TableFooter=function(_super){__extends(TableFooter,_super);function TableFooter(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.TableFooter(_this);_this.values={id:__1.getId(_this.attrs),className:util_1.concat(exports.TABLE_FOOTER,__1.getClassName(_this.attrs))};return _this}return TableFooter}(wml_1.Component);exports.TableFooter=TableFooter;var TableRow=function(_super){__extends(TableRow,_super);function TableRow(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.TableRow(_this);_this.values={id:__1.getId(_this.attrs),className:util_1.concat(exports.TABLE_ROW,__1.getClassName(_this.attrs)),onclick:_this.attrs.ww&&_this.attrs.ww.onclick?_this.attrs.ww.onclick:undefined};return _this}return TableRow}(wml_1.Component);exports.TableRow=TableRow;var TableHeading=function(_super){__extends(TableHeading,_super);function TableHeading(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.TableHeading(_this);_this.values={id:__1.getId(_this.attrs),className:util_1.concat(exports.TABLE_HEADING,__1.getClassName(_this.attrs)),onclick:_this.attrs.ww&&_this.attrs.ww.onclick?_this.attrs.ww.onclick:undefined};return _this}return TableHeading}(wml_1.Component);exports.TableHeading=TableHeading;var TableCell=function(_super){__extends(TableCell,_super);function TableCell(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.TableCell(_this);_this.values={id:__1.getId(_this.attrs),className:util_1.concat(exports.TABLE_CELL,__1.getClassName(_this.attrs)),colspan:_this.attrs.ww&&_this.attrs.ww.colspan?_this.attrs.ww.colspan:1,rowspan:_this.attrs.ww&&_this.attrs.ww.rowspan?_this.attrs.ww.rowspan:1,onclick:_this.attrs.ww&&_this.attrs.ww.onclick?_this.attrs.ww.onclick:undefined};return _this}return TableCell}(wml_1.Component);exports.TableCell=TableCell;var TableWindow=function(_super){__extends(TableWindow,_super);function TableWindow(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.TableWindow(_this);_this.values={id:__1.getId(_this.attrs),className:util_1.concat(exports.TABLE_WINDOW,__1.getClassName(_this.attrs))};return _this}return TableWindow}(wml_1.Component);exports.TableWindow=TableWindow;var TableLayout=function(_super){__extends(TableLayout,_super);function TableLayout(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.TableLayout(_this);_this.values={wml:{id:"table"},id:__1.getId(_this.attrs),className:util_1.concat(exports.TABLE_LAYOUT,__1.getClassName(_this.attrs),_this.attrs.ww&&_this.attrs.ww.alternate?exports.ALTERNATE:"",_this.attrs.ww&&_this.attrs.ww.bordered?exports.BORDERED:"",_this.attrs.ww&&_this.attrs.ww.compact?exports.COMPACT:"",_this.attrs.ww&&_this.attrs.ww.hoverable?exports.HOVERABLE:"")};return _this}return TableLayout}(wml_1.Component);exports.TableLayout=TableLayout},{"../../":147,"../../util":168,"./wml/table":160,"@quenk/wml":170}],160:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.TableLayout=exports.TableWindow=exports.TableCell=exports.TableHeading=exports.TableRow=exports.TableFooter=exports.TableBody=exports.TableHeader=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var TableHeader=function(){function TableHeader(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("thead",{id:__context.values.id,class:__context.values.className},__spreadArrays(__context.children))}}TableHeader.prototype.registerView=function(v){this.views.push(v);return v};TableHeader.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};TableHeader.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};TableHeader.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};TableHeader.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};TableHeader.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};TableHeader.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};TableHeader.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return TableHeader}();exports.TableHeader=TableHeader;var TableBody=function(){function TableBody(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("tbody",{id:__context.values.id,class:__context.values.className},__spreadArrays(__context.children))}}TableBody.prototype.registerView=function(v){this.views.push(v);return v};TableBody.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};TableBody.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};TableBody.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};TableBody.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};TableBody.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};TableBody.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};TableBody.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return TableBody}();exports.TableBody=TableBody;var TableFooter=function(){function TableFooter(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("tfoot",{id:__context.values.id,class:__context.values.className},__spreadArrays(__context.children))}}TableFooter.prototype.registerView=function(v){this.views.push(v);return v};TableFooter.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};TableFooter.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};TableFooter.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};TableFooter.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};TableFooter.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};TableFooter.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};TableFooter.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return TableFooter}();exports.TableFooter=TableFooter;var TableRow=function(){function TableRow(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("tr",{id:__context.values.id,class:__context.values.className,onclick:__context.values.onclick},__spreadArrays(__context.children))}}TableRow.prototype.registerView=function(v){this.views.push(v);return v};TableRow.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};TableRow.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};TableRow.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};TableRow.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};TableRow.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};TableRow.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};TableRow.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return TableRow}();exports.TableRow=TableRow;var TableHeading=function(){function TableHeading(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("th",{id:__context.values.id,class:__context.values.className,onclick:__context.values.onclick},__spreadArrays(__context.children))}}TableHeading.prototype.registerView=function(v){this.views.push(v);return v};TableHeading.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};TableHeading.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};TableHeading.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};TableHeading.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};TableHeading.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};TableHeading.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};TableHeading.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return TableHeading}();exports.TableHeading=TableHeading;var TableCell=function(){function TableCell(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("td",{id:__context.values.id,class:__context.values.className,colspan:String(__context.values.colspan),rowspan:String(__context.values.rowspan),onclick:__context.values.onclick},__spreadArrays(__context.children))}}TableCell.prototype.registerView=function(v){this.views.push(v);return v};TableCell.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};TableCell.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};TableCell.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};TableCell.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};TableCell.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};TableCell.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};TableCell.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return TableCell}();exports.TableCell=TableCell;var TableWindow=function(){function TableWindow(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{id:__context.values.id,class:__context.values.className},__spreadArrays(__context.children))}}TableWindow.prototype.registerView=function(v){this.views.push(v);return v};TableWindow.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};TableWindow.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};TableWindow.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};TableWindow.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};TableWindow.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};TableWindow.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};TableWindow.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return TableWindow}();exports.TableWindow=TableWindow;var TableLayout=function(){function TableLayout(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("table",{id:__context.values.id,class:__context.values.className},__spreadArrays(__context.children))}}TableLayout.prototype.registerView=function(v){this.views.push(v);return v};TableLayout.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};TableLayout.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};TableLayout.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};TableLayout.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};TableLayout.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};TableLayout.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};TableLayout.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return TableLayout}();exports.TableLayout=TableLayout},{"@quenk/noni/lib/data/maybe":59,"@quenk/wml/lib/dom":169}],161:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Item=exports.ItemClickedEvent=exports.DIVIDER=exports.ITEM=void 0;var wml=require("@quenk/wml");var views=require("./wml/item");var active_1=require("../../content/state/active");var active_2=require("../../content/state/active");var util_1=require("../../util");exports.ITEM="ww-menu-item";exports.DIVIDER="-divider";var ItemClickedEvent=function(){function ItemClickedEvent(name){this.name=name}return ItemClickedEvent}();exports.ItemClickedEvent=ItemClickedEvent;var Item=function(_super){__extends(Item,_super);function Item(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.Main(_this);_this.values={root:{wml:{id:"root"},id:_this.attrs.ww&&_this.attrs.ww.id?_this.attrs.ww.id:"",className:util_1.concat(exports.ITEM,_this.attrs.ww&&_this.attrs.ww.active?active_2.ACTIVE:"",_this.attrs.ww&&_this.attrs.ww.divider?exports.DIVIDER:""),content:{render:function(){if(_this.attrs.ww&&_this.attrs.ww.divider)return[];else if(_this.attrs.ww&&_this.attrs.ww.text)return[document.createTextNode(_this.attrs.ww.text)];else return _this.children}}}};return _this}Item.prototype.activate=function(){active_1.activate(this.view,this.values.root.wml.id);return this};Item.prototype.deactivate=function(){active_1.deactivate(this.view,this.values.root.wml.id);return this};return Item}(wml.Component);exports.Item=Item},{"../../content/state/active":104,"../../util":168,"./wml/item":162,"@quenk/wml":170}],162:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("li",{wml:{id:__context.values.root.wml.id},id:__context.values.root.id,class:__context.values.root.className},__spreadArrays(__context.values.root.content.render()))}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"@quenk/noni/lib/data/maybe":59,"@quenk/wml/lib/dom":169}],163:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Menu=exports.HeaderItem=exports.CONTENT_MODE=exports.NAV_MODE=exports.MENU_HEADER_ITEM=exports.MENU=void 0;var hidden=require("../../content/state/hidden");var headerViews=require("./wml/header");var wml_1=require("@quenk/wml");var dom_1=require("@quenk/wml/lib/dom");var util_1=require("../../util");var orientation_1=require("../../content/orientation");var __1=require("../../");var menu_1=require("./wml/menu");exports.MENU="ww-menu";exports.MENU_HEADER_ITEM="ww-menu__header-item";exports.NAV_MODE="nav";exports.CONTENT_MODE="content";var HeaderItem=function(_super){__extends(HeaderItem,_super);function HeaderItem(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new headerViews.Main(_this);_this.values={root:{className:util_1.concat(exports.MENU_HEADER_ITEM,__1.getClassName(_this.attrs)),content:_this.attrs.ww&&_this.attrs.ww.text?[dom_1.text(_this.attrs.ww.text)]:_this.children}};return _this}return HeaderItem}(wml_1.Component);exports.HeaderItem=HeaderItem;var Menu=function(_super){__extends(Menu,_super);function Menu(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new menu_1.Main(_this);_this.values={root:{wml:{id:"root"},id:__1.getId(_this.attrs),className:util_1.concat(exports.MENU,__1.getClassName(_this.attrs),_this.attrs.ww&&_this.attrs.ww.hidden?hidden.HIDDEN:"",_this.attrs.ww&&_this.attrs.ww.block?orientation_1.BLOCK:"")},menu:{id:"menu"},content:function(){return _this.children}};return _this}Menu.prototype.isHidden=function(){return hidden.isHidden(this.view,this.values.root.wml.id)};Menu.prototype.hide=function(){hidden.hide(this.view,this.values.root.wml.id);return this};Menu.prototype.show=function(){hidden.show(this.view,this.values.root.wml.id);return this};Menu.prototype.toggle=function(){hidden.toggle(this.view,this.values.root.wml.id);return this};Menu.prototype.setContent=function(content){this.values.content=function(){return content};this.view.invalidate();this.show();return this};return Menu}(wml_1.Component);exports.Menu=Menu},{"../../":147,"../../content/orientation":102,"../../content/state/hidden":106,"../../util":168,"./wml/header":164,"./wml/menu":165,"@quenk/wml":170,"@quenk/wml/lib/dom":169}],164:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("li",{class:__context.values.root.className},__spreadArrays(__context.values.root.content))}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"@quenk/noni/lib/data/maybe":59,"@quenk/wml/lib/dom":169}],165:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("ul",{wml:{id:__context.values.root.wml.id},id:__context.values.root.id,class:__context.values.root.className},__spreadArrays(__context.values.content()))}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"@quenk/noni/lib/data/maybe":59,"@quenk/wml/lib/dom":169}],166:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Nav=exports.NAV=void 0;var wml=require("@quenk/wml");var util=require("../../util");var views=require("./wml/nav");var orientation_1=require("../../content/orientation");var item_1=require("../item");Object.defineProperty(exports,"Item",{enumerable:true,get:function(){return item_1.Item}});var link_1=require("../../content/link");Object.defineProperty(exports,"Link",{enumerable:true,get:function(){return link_1.Link}});exports.NAV="ww-nav";var Nav=function(_super){__extends(Nav,_super);function Nav(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.Main(_this);_this.values={root:{id:_this.attrs.ww&&_this.attrs.ww.id?_this.attrs.ww.id:"",className:util.concat(exports.NAV,_this.attrs.ww&&_this.attrs.ww.className?_this.attrs.ww.className:"",_this.attrs.ww&&_this.attrs.ww.vertical?orientation_1.VERTICAL:"")}};return _this}return Nav}(wml.Component);exports.Nav=Nav},{"../../content/link":100,"../../content/orientation":102,"../../util":168,"../item":161,"./wml/nav":167,"@quenk/wml":170}],167:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("ul",{id:__context.values.root.id,class:__context.values.root.className},__spreadArrays(__context.children))}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"@quenk/noni/lib/data/maybe":59,"@quenk/wml/lib/dom":169}],168:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.debounce=exports.replaceContent=exports.noop=exports.concat=exports.combine=exports.warnMissing=exports.getById=void 0;exports.getById=function(view,id){var m=view.findById(id);if(m.isNothing()){exports.warnMissing(view,id)}return m};exports.warnMissing=function(view,id){console.warn("The view ",view,' does not have an id "'+id+'"!')};exports.combine=function(str,joiner){if(joiner===void 0){joiner=" "}return str.filter(function(s){return s!=null||s!=""}).join(joiner)};exports.concat=function(){var str=[];for(var _i=0;_i<arguments.length;_i++){str[_i]=arguments[_i]}return str.filter(function(s){return s==null||s==""?false:true}).map(function(s){return s.trim()}).join(" ")};exports.noop=function(){};exports.replaceContent=function(r,node){while(node.lastChild)node.removeChild(node.lastChild);node.appendChild(r.render())};exports.debounce=function(f,delay){var timer=-1;return delay===0?f:function(a){if(timer===-1){timer=window.setTimeout(function(){return f(a)},delay)}else{clearTimeout(timer);timer=window.setTimeout(function(){return f(a)},delay)}}}},{}],169:[function(require,module,exports){(function(global){(function(){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.createElement=exports.unsafe=exports.text=exports.createUnsafeTextNode=exports.createTextNode=exports.escapeHTML=exports.escapeAttrValue=exports.escapeAttrs=exports.isBrowser=exports.WMLDOMElement=exports.WMLDOMText=exports.WMLDOMNode=exports.WMLNodeList=void 0;var record_1=require("@quenk/noni/lib/data/record");var type_1=require("@quenk/noni/lib/data/type");var window=global;var document=global.document;var DOCTYPE="<!DOCTYPE html>";var ATTR_ESC_MAP={"&":"\\u0026",">":"\\u003e","<":"\\u003c",'"':"\\u0022","=":"\\u003d","\\":"\\u005c","\u2028":"\\u2028","\u2029":"\\u2029"};var attrsEscRegex=new RegExp("["+record_1.mapTo(ATTR_ESC_MAP,function(_,k){return k})+"]","g");var HTML_ENT_MAP={'"':"&quot;","&":"&amp;","'":"&apos;","<":"&lt;",">":"&gt;"};var htmlEscRegex=new RegExp("["+record_1.mapTo(HTML_ENT_MAP,function(_,k){return k})+"]","g");var voidElements=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];var WMLNodeList=function(){function WMLNodeList(){this.length=0}WMLNodeList.prototype.item=function(){return null};WMLNodeList.prototype.forEach=function(){};return WMLNodeList}();exports.WMLNodeList=WMLNodeList;var WMLDOMNode=function(){function WMLDOMNode(nodeName,nodeType){this.nodeName=nodeName;this.nodeType=nodeType;this.ATTRIBUTE_NODE=-1;this.CDATA_SECTION_NODE=-1;this.COMMENT_NODE=-1;this.DOCUMENT_FRAGMENT_NODE=-1;this.DOCUMENT_NODE=-1;this.DOCUMENT_POSITION_CONTAINED_BY=-1;this.DOCUMENT_POSITION_CONTAINS=-1;this.DOCUMENT_POSITION_DISCONNECTED=-1;this.DOCUMENT_POSITION_FOLLOWING=-1;this.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=-1;this.DOCUMENT_POSITION_PRECEDING=-1;this.DOCUMENT_TYPE_NODE=-1;this.ELEMENT_NODE=-1;this.ENTITY_NODE=-1;this.ENTITY_REFERENCE_NODE=-1;this.NOTATION_NODE=-1;this.PROCESSING_INSTRUCTION_NODE=-1;this.TEXT_NODE=-1;this.baseURI="";this.childNodes=new WMLNodeList;this.firstChild=null;this.isConnected=false;this.lastChild=null;this.namespaceURI=null;this.nextSibling=null;this.nodeValue=null;this.ownerDocument=null;this.parentElement=null;this.parentNode=null;this.previousSibling=null}Object.defineProperty(WMLDOMNode.prototype,"textContent",{get:function(){return""},enumerable:false,configurable:true});WMLDOMNode.prototype.addEventListener=function(){};WMLDOMNode.prototype.dispatchEvent=function(){return false};WMLDOMNode.prototype.removeEventListener=function(){};WMLDOMNode.prototype.appendChild=function(newChild){return newChild};WMLDOMNode.prototype.cloneNode=function(){return this};WMLDOMNode.prototype.compareDocumentPosition=function(){return 0};WMLDOMNode.prototype.contains=function(){return false};WMLDOMNode.prototype.getRootNode=function(){return this};WMLDOMNode.prototype.hasChildNodes=function(){return false};WMLDOMNode.prototype.insertBefore=function(newChild){return newChild};WMLDOMNode.prototype.isDefaultNamespace=function(){return false};WMLDOMNode.prototype.isEqualNode=function(){return false};WMLDOMNode.prototype.isSameNode=function(){return false};WMLDOMNode.prototype.lookupNamespaceURI=function(){return null};WMLDOMNode.prototype.lookupPrefix=function(){return null};WMLDOMNode.prototype.normalize=function(){};WMLDOMNode.prototype.remove=function(){};WMLDOMNode.prototype.before=function(){};WMLDOMNode.prototype.after=function(){};WMLDOMNode.prototype.replaceWith=function(){};WMLDOMNode.prototype.removeChild=function(oldChild){return oldChild};WMLDOMNode.prototype.replaceChild=function(_,oldChild){return oldChild};return WMLDOMNode}();exports.WMLDOMNode=WMLDOMNode;var WMLDOMText=function(_super){__extends(WMLDOMText,_super);function WMLDOMText(value,escape){if(escape===void 0){escape=true}var _this=_super.call(this,"#text",-1)||this;_this.value=value;_this.escape=escape;return _this}Object.defineProperty(WMLDOMText.prototype,"textContent",{get:function(){return this.escape?exports.escapeHTML(this.value):this.value},enumerable:false,configurable:true});return WMLDOMText}(WMLDOMNode);exports.WMLDOMText=WMLDOMText;var WMLDOMElement=function(_super){__extends(WMLDOMElement,_super);function WMLDOMElement(tag,attrs,children){if(children===void 0){children=[]}var _this=_super.call(this,tag,-1)||this;_this.tag=tag;_this.attrs=attrs;_this.children=children;return _this}Object.defineProperty(WMLDOMElement.prototype,"innerHTML",{get:function(){return this.children.map(function(c){return c.nodeName==="#text"?c.textContent:c.outerHTML}).join("")},enumerable:false,configurable:true});Object.defineProperty(WMLDOMElement.prototype,"outerHTML",{get:function(){var tag=this.tag;var content=this.innerHTML;var attrs=record_1.mapTo(exports.escapeAttrs(this.attrs),function(value,name){return!value?name:name+'="'+value+'"'}).join(" ");attrs=attrs.trim()!=""?" "+attrs:"";var open="<"+tag+attrs+">";if(tag==="html")open=""+DOCTYPE+open;return voidElements.indexOf(tag)>-1?open:""+open+content+"</"+tag+">"},enumerable:false,configurable:true});WMLDOMElement.prototype.setAttribute=function(key,value){this.attrs[key]=value};WMLDOMElement.prototype.appendChild=function(newChild){this.children.push(newChild);return newChild};return WMLDOMElement}(WMLDOMNode);exports.WMLDOMElement=WMLDOMElement;exports.isBrowser=window!=null&&document!=null;var escapeAttrs=function(attrs){return record_1.map(attrs,function(value){return type_1.isFunction(value)?value:value instanceof WMLDOMText?value.textContent:exports.escapeAttrValue(String(value))})};exports.escapeAttrs=escapeAttrs;var escapeAttrValue=function(value){return value.replace(attrsEscRegex,function(hit){return ATTR_ESC_MAP[hit]})};exports.escapeAttrValue=escapeAttrValue;var escapeHTML=function(value){return value.replace(htmlEscRegex,function(hit){return HTML_ENT_MAP[hit]})};exports.escapeHTML=escapeHTML;var createTextNode=function(txt){var str=String(txt==null?"":txt);return exports.isBrowser?document.createTextNode(str):new WMLDOMText(str)};exports.createTextNode=createTextNode;exports.text=exports.createTextNode;var createUnsafeTextNode=function(txt){var str=String(txt==null?"":txt);return exports.isBrowser?document.createTextNode(str):new WMLDOMText(str,false)};exports.createUnsafeTextNode=createUnsafeTextNode;exports.unsafe=exports.createUnsafeTextNode;var createElement=function(tag,attrs,children){if(attrs===void 0){attrs={}}if(children===void 0){children=[]}if(!exports.isBrowser){return new WMLDOMElement(tag,attrs,children)}else{var e_1=document.createElement(tag);record_1.forEach(attrs,function(value,key){if(typeof value==="function"){e_1[key]=value}else if(typeof value==="string"){if(value!=="")e_1.setAttribute(key,value)}else if(typeof value==="boolean"){e_1.setAttribute(key,"")}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":e_1.appendChild(document.createTextNode(""+c));case"object":e_1.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});return e_1}};exports.createElement=createElement}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"@quenk/noni/lib/data/record":60,"@quenk/noni/lib/data/type":63}],170:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.renderAsNode=exports.Component=void 0;var Component=function(){function Component(attrs,children){this.attrs=attrs;this.children=children}Component.prototype.rendered=function(){};Component.prototype.removed=function(){};Component.prototype.render=function(){return this.view.render()};return Component}();exports.Component=Component;var renderAsNode=function(r){return r.render()};exports.renderAsNode=renderAsNode},{}],171:[function(require,module,exports){(function(global,factory){typeof exports==="object"&&typeof module!=="undefined"?module.exports=factory():typeof define==="function"&&define.amd?define(factory):global.moment=factory()})(this,function(){"use strict";var hookCallback;function hooks(){return hookCallback.apply(null,arguments)}function setHookCallback(callback){hookCallback=callback}function isArray(input){return input instanceof Array||Object.prototype.toString.call(input)==="[object Array]"}function isObject(input){return input!=null&&Object.prototype.toString.call(input)==="[object Object]"}function hasOwnProp(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function isObjectEmpty(obj){if(Object.getOwnPropertyNames){return Object.getOwnPropertyNames(obj).length===0}else{var k;for(k in obj){if(hasOwnProp(obj,k)){return false}}return true}}function isUndefined(input){return input===void 0}function isNumber(input){return typeof input==="number"||Object.prototype.toString.call(input)==="[object Number]"}function isDate(input){return input instanceof Date||Object.prototype.toString.call(input)==="[object Date]"}function map(arr,fn){var res=[],i;for(i=0;i<arr.length;++i){res.push(fn(arr[i],i))}return res}function extend(a,b){for(var i in b){if(hasOwnProp(b,i)){a[i]=b[i]}}if(hasOwnProp(b,"toString")){a.toString=b.toString}if(hasOwnProp(b,"valueOf")){a.valueOf=b.valueOf}return a}function createUTC(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,true).utc()}function defaultParsingFlags(){return{empty:false,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:false,invalidEra:null,invalidMonth:null,invalidFormat:false,userInvalidated:false,iso:false,parsedDateParts:[],era:null,meridiem:null,rfc2822:false,weekdayMismatch:false}}function getParsingFlags(m){if(m._pf==null){m._pf=defaultParsingFlags()}return m._pf}var some;if(Array.prototype.some){some=Array.prototype.some}else{some=function(fun){var t=Object(this),len=t.length>>>0,i;for(i=0;i<len;i++){if(i in t&&fun.call(this,t[i],i,t)){return true}}return false}}function isValid(m){if(m._isValid==null){var flags=getParsingFlags(m),parsedParts=some.call(flags.parsedDateParts,function(i){return i!=null}),isNowValid=!isNaN(m._d.getTime())&&flags.overflow<0&&!flags.empty&&!flags.invalidEra&&!flags.invalidMonth&&!flags.invalidWeekday&&!flags.weekdayMismatch&&!flags.nullInput&&!flags.invalidFormat&&!flags.userInvalidated&&(!flags.meridiem||flags.meridiem&&parsedParts);if(m._strict){isNowValid=isNowValid&&flags.charsLeftOver===0&&flags.unusedTokens.length===0&&flags.bigHour===undefined}if(Object.isFrozen==null||!Object.isFrozen(m)){m._isValid=isNowValid}else{return isNowValid}}return m._isValid}function createInvalid(flags){var m=createUTC(NaN);if(flags!=null){extend(getParsingFlags(m),flags)}else{getParsingFlags(m).userInvalidated=true}return m}var momentProperties=hooks.momentProperties=[],updateInProgress=false;function copyConfig(to,from){var i,prop,val;if(!isUndefined(from._isAMomentObject)){to._isAMomentObject=from._isAMomentObject}if(!isUndefined(from._i)){to._i=from._i}if(!isUndefined(from._f)){to._f=from._f}if(!isUndefined(from._l)){to._l=from._l}if(!isUndefined(from._strict)){to._strict=from._strict}if(!isUndefined(from._tzm)){to._tzm=from._tzm}if(!isUndefined(from._isUTC)){to._isUTC=from._isUTC}if(!isUndefined(from._offset)){to._offset=from._offset}if(!isUndefined(from._pf)){to._pf=getParsingFlags(from)}if(!isUndefined(from._locale)){to._locale=from._locale}if(momentProperties.length>0){for(i=0;i<momentProperties.length;i++){prop=momentProperties[i];val=from[prop];if(!isUndefined(val)){to[prop]=val}}}return to}function Moment(config){copyConfig(this,config);this._d=new Date(config._d!=null?config._d.getTime():NaN);if(!this.isValid()){this._d=new Date(NaN)}if(updateInProgress===false){updateInProgress=true;hooks.updateOffset(this);updateInProgress=false}}function isMoment(obj){return obj instanceof Moment||obj!=null&&obj._isAMomentObject!=null}function warn(msg){if(hooks.suppressDeprecationWarnings===false&&typeof console!=="undefined"&&console.warn){console.warn("Deprecation warning: "+msg)}}function deprecate(msg,fn){var firstTime=true;return extend(function(){if(hooks.deprecationHandler!=null){hooks.deprecationHandler(null,msg)}if(firstTime){var args=[],arg,i,key;for(i=0;i<arguments.length;i++){arg="";if(typeof arguments[i]==="object"){arg+="\n["+i+"] ";for(key in arguments[0]){if(hasOwnProp(arguments[0],key)){arg+=key+": "+arguments[0][key]+", "}}arg=arg.slice(0,-2)}else{arg=arguments[i]}args.push(arg)}warn(msg+"\nArguments: "+Array.prototype.slice.call(args).join("")+"\n"+(new Error).stack);firstTime=false}return fn.apply(this,arguments)},fn)}var deprecations={};function deprecateSimple(name,msg){if(hooks.deprecationHandler!=null){hooks.deprecationHandler(name,msg)}if(!deprecations[name]){warn(msg);deprecations[name]=true}}hooks.suppressDeprecationWarnings=false;hooks.deprecationHandler=null;function isFunction(input){return typeof Function!=="undefined"&&input instanceof Function||Object.prototype.toString.call(input)==="[object Function]"}function set(config){var prop,i;for(i in config){if(hasOwnProp(config,i)){prop=config[i];if(isFunction(prop)){this[i]=prop}else{this["_"+i]=prop}}}this._config=config;this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function mergeConfigs(parentConfig,childConfig){var res=extend({},parentConfig),prop;for(prop in childConfig){if(hasOwnProp(childConfig,prop)){if(isObject(parentConfig[prop])&&isObject(childConfig[prop])){res[prop]={};extend(res[prop],parentConfig[prop]);extend(res[prop],childConfig[prop])}else if(childConfig[prop]!=null){res[prop]=childConfig[prop]}else{delete res[prop]}}}for(prop in parentConfig){if(hasOwnProp(parentConfig,prop)&&!hasOwnProp(childConfig,prop)&&isObject(parentConfig[prop])){res[prop]=extend({},res[prop])}}return res}function Locale(config){if(config!=null){this.set(config)}}var keys;if(Object.keys){keys=Object.keys}else{keys=function(obj){var i,res=[];for(i in obj){if(hasOwnProp(obj,i)){res.push(i)}}return res}}var defaultCalendar={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function calendar(key,mom,now){var output=this._calendar[key]||this._calendar["sameElse"];return isFunction(output)?output.call(mom,now):output}function zeroFill(number,targetLength,forceSign){var absNumber=""+Math.abs(number),zerosToFill=targetLength-absNumber.length,sign=number>=0;return(sign?forceSign?"+":"":"-")+Math.pow(10,Math.max(0,zerosToFill)).toString().substr(1)+absNumber}var formattingTokens=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,formatFunctions={},formatTokenFunctions={};function addFormatToken(token,padded,ordinal,callback){var func=callback;if(typeof callback==="string"){func=function(){return this[callback]()}}if(token){formatTokenFunctions[token]=func}if(padded){formatTokenFunctions[padded[0]]=function(){return zeroFill(func.apply(this,arguments),padded[1],padded[2])}}if(ordinal){formatTokenFunctions[ordinal]=function(){return this.localeData().ordinal(func.apply(this,arguments),token)}}}function removeFormattingTokens(input){if(input.match(/\[[\s\S]/)){return input.replace(/^\[|\]$/g,"")}return input.replace(/\\/g,"")}function makeFormatFunction(format){var array=format.match(formattingTokens),i,length;for(i=0,length=array.length;i<length;i++){if(formatTokenFunctions[array[i]]){array[i]=formatTokenFunctions[array[i]]}else{array[i]=removeFormattingTokens(array[i])}}return function(mom){var output="",i;for(i=0;i<length;i++){output+=isFunction(array[i])?array[i].call(mom,format):array[i]}return output}}function formatMoment(m,format){if(!m.isValid()){return m.localeData().invalidDate()}format=expandFormat(format,m.localeData());formatFunctions[format]=formatFunctions[format]||makeFormatFunction(format);return formatFunctions[format](m)}function expandFormat(format,locale){var i=5;function replaceLongDateFormatTokens(input){return locale.longDateFormat(input)||input}localFormattingTokens.lastIndex=0;while(i>=0&&localFormattingTokens.test(format)){format=format.replace(localFormattingTokens,replaceLongDateFormatTokens);localFormattingTokens.lastIndex=0;i-=1}return format}var defaultLongDateFormat={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function longDateFormat(key){var format=this._longDateFormat[key],formatUpper=this._longDateFormat[key.toUpperCase()];if(format||!formatUpper){return format}this._longDateFormat[key]=formatUpper.match(formattingTokens).map(function(tok){if(tok==="MMMM"||tok==="MM"||tok==="DD"||tok==="dddd"){return tok.slice(1)}return tok}).join("");return this._longDateFormat[key]}var defaultInvalidDate="Invalid date";function invalidDate(){return this._invalidDate}var defaultOrdinal="%d",defaultDayOfMonthOrdinalParse=/\d{1,2}/;function ordinal(number){return this._ordinal.replace("%d",number)}var defaultRelativeTime={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function relativeTime(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return isFunction(output)?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number)}function pastFuture(diff,output){var format=this._relativeTime[diff>0?"future":"past"];return isFunction(format)?format(output):format.replace(/%s/i,output)}var aliases={};function addUnitAlias(unit,shorthand){var lowerCase=unit.toLowerCase();aliases[lowerCase]=aliases[lowerCase+"s"]=aliases[shorthand]=unit}function normalizeUnits(units){return typeof units==="string"?aliases[units]||aliases[units.toLowerCase()]:undefined}function normalizeObjectUnits(inputObject){var normalizedInput={},normalizedProp,prop;for(prop in inputObject){if(hasOwnProp(inputObject,prop)){normalizedProp=normalizeUnits(prop);if(normalizedProp){normalizedInput[normalizedProp]=inputObject[prop]}}}return normalizedInput}var priorities={};function addUnitPriority(unit,priority){priorities[unit]=priority}function getPrioritizedUnits(unitsObj){var units=[],u;for(u in unitsObj){if(hasOwnProp(unitsObj,u)){units.push({unit:u,priority:priorities[u]})}}units.sort(function(a,b){return a.priority-b.priority});return units}function isLeapYear(year){return year%4===0&&year%100!==0||year%400===0}function absFloor(number){if(number<0){return Math.ceil(number)||0}else{return Math.floor(number)}}function toInt(argumentForCoercion){var coercedNumber=+argumentForCoercion,value=0;if(coercedNumber!==0&&isFinite(coercedNumber)){value=absFloor(coercedNumber)}return value}function makeGetSet(unit,keepTime){return function(value){if(value!=null){set$1(this,unit,value);hooks.updateOffset(this,keepTime);return this}else{return get(this,unit)}}}function get(mom,unit){return mom.isValid()?mom._d["get"+(mom._isUTC?"UTC":"")+unit]():NaN}function set$1(mom,unit,value){if(mom.isValid()&&!isNaN(value)){if(unit==="FullYear"&&isLeapYear(mom.year())&&mom.month()===1&&mom.date()===29){value=toInt(value);mom._d["set"+(mom._isUTC?"UTC":"")+unit](value,mom.month(),daysInMonth(value,mom.month()))}else{mom._d["set"+(mom._isUTC?"UTC":"")+unit](value)}}}function stringGet(units){units=normalizeUnits(units);if(isFunction(this[units])){return this[units]()}return this}function stringSet(units,value){if(typeof units==="object"){units=normalizeObjectUnits(units);var prioritized=getPrioritizedUnits(units),i;for(i=0;i<prioritized.length;i++){this[prioritized[i].unit](units[prioritized[i].unit])}}else{units=normalizeUnits(units);if(isFunction(this[units])){return this[units](value)}}return this}var match1=/\d/,match2=/\d\d/,match3=/\d{3}/,match4=/\d{4}/,match6=/[+-]?\d{6}/,match1to2=/\d\d?/,match3to4=/\d\d\d\d?/,match5to6=/\d\d\d\d\d\d?/,match1to3=/\d{1,3}/,match1to4=/\d{1,4}/,match1to6=/[+-]?\d{1,6}/,matchUnsigned=/\d+/,matchSigned=/[+-]?\d+/,matchOffset=/Z|[+-]\d\d:?\d\d/gi,matchShortOffset=/Z|[+-]\d\d(?::?\d\d)?/gi,matchTimestamp=/[+-]?\d+(\.\d{1,3})?/,matchWord=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,regexes;regexes={};function addRegexToken(token,regex,strictRegex){regexes[token]=isFunction(regex)?regex:function(isStrict,localeData){return isStrict&&strictRegex?strictRegex:regex}}function getParseRegexForToken(token,config){if(!hasOwnProp(regexes,token)){return new RegExp(unescapeFormat(token))}return regexes[token](config._strict,config._locale)}function unescapeFormat(s){return regexEscape(s.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(matched,p1,p2,p3,p4){return p1||p2||p3||p4}))}function regexEscape(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var tokens={};function addParseToken(token,callback){var i,func=callback;if(typeof token==="string"){token=[token]}if(isNumber(callback)){func=function(input,array){array[callback]=toInt(input)}}for(i=0;i<token.length;i++){tokens[token[i]]=func}}function addWeekParseToken(token,callback){addParseToken(token,function(input,array,config,token){config._w=config._w||{};callback(input,config._w,config,token)})}function addTimeToArrayFromToken(token,input,config){if(input!=null&&hasOwnProp(tokens,token)){tokens[token](input,config._a,config,token)}}var YEAR=0,MONTH=1,DATE=2,HOUR=3,MINUTE=4,SECOND=5,MILLISECOND=6,WEEK=7,WEEKDAY=8;function mod(n,x){return(n%x+x)%x}var indexOf;if(Array.prototype.indexOf){indexOf=Array.prototype.indexOf}else{indexOf=function(o){var i;for(i=0;i<this.length;++i){if(this[i]===o){return i}}return-1}}function daysInMonth(year,month){if(isNaN(year)||isNaN(month)){return NaN}var modMonth=mod(month,12);year+=(month-modMonth)/12;return modMonth===1?isLeapYear(year)?29:28:31-modMonth%7%2}addFormatToken("M",["MM",2],"Mo",function(){return this.month()+1});addFormatToken("MMM",0,0,function(format){return this.localeData().monthsShort(this,format)});addFormatToken("MMMM",0,0,function(format){return this.localeData().months(this,format)});addUnitAlias("month","M");addUnitPriority("month",8);addRegexToken("M",match1to2);addRegexToken("MM",match1to2,match2);addRegexToken("MMM",function(isStrict,locale){return locale.monthsShortRegex(isStrict)});addRegexToken("MMMM",function(isStrict,locale){return locale.monthsRegex(isStrict)});addParseToken(["M","MM"],function(input,array){array[MONTH]=toInt(input)-1});addParseToken(["MMM","MMMM"],function(input,array,config,token){var month=config._locale.monthsParse(input,token,config._strict);if(month!=null){array[MONTH]=month}else{getParsingFlags(config).invalidMonth=input}});var defaultLocaleMonths="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),defaultLocaleMonthsShort="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),MONTHS_IN_FORMAT=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,defaultMonthsShortRegex=matchWord,defaultMonthsRegex=matchWord;function localeMonths(m,format){if(!m){return isArray(this._months)?this._months:this._months["standalone"]}return isArray(this._months)?this._months[m.month()]:this._months[(this._months.isFormat||MONTHS_IN_FORMAT).test(format)?"format":"standalone"][m.month()]}function localeMonthsShort(m,format){if(!m){return isArray(this._monthsShort)?this._monthsShort:this._monthsShort["standalone"]}return isArray(this._monthsShort)?this._monthsShort[m.month()]:this._monthsShort[MONTHS_IN_FORMAT.test(format)?"format":"standalone"][m.month()]}function handleStrictParse(monthName,format,strict){var i,ii,mom,llc=monthName.toLocaleLowerCase();if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[];for(i=0;i<12;++i){mom=createUTC([2e3,i]);this._shortMonthsParse[i]=this.monthsShort(mom,"").toLocaleLowerCase();this._longMonthsParse[i]=this.months(mom,"").toLocaleLowerCase()}}if(strict){if(format==="MMM"){ii=indexOf.call(this._shortMonthsParse,llc);return ii!==-1?ii:null}else{ii=indexOf.call(this._longMonthsParse,llc);return ii!==-1?ii:null}}else{if(format==="MMM"){ii=indexOf.call(this._shortMonthsParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._longMonthsParse,llc);return ii!==-1?ii:null}else{ii=indexOf.call(this._longMonthsParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._shortMonthsParse,llc);return ii!==-1?ii:null}}}function localeMonthsParse(monthName,format,strict){var i,mom,regex;if(this._monthsParseExact){return handleStrictParse.call(this,monthName,format,strict)}if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[]}for(i=0;i<12;i++){mom=createUTC([2e3,i]);if(strict&&!this._longMonthsParse[i]){this._longMonthsParse[i]=new RegExp("^"+this.months(mom,"").replace(".","")+"$","i");this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(mom,"").replace(".","")+"$","i")}if(!strict&&!this._monthsParse[i]){regex="^"+this.months(mom,"")+"|^"+this.monthsShort(mom,"");this._monthsParse[i]=new RegExp(regex.replace(".",""),"i")}if(strict&&format==="MMMM"&&this._longMonthsParse[i].test(monthName)){return i}else if(strict&&format==="MMM"&&this._shortMonthsParse[i].test(monthName)){return i}else if(!strict&&this._monthsParse[i].test(monthName)){return i}}}function setMonth(mom,value){var dayOfMonth;if(!mom.isValid()){return mom}if(typeof value==="string"){if(/^\d+$/.test(value)){value=toInt(value)}else{value=mom.localeData().monthsParse(value);if(!isNumber(value)){return mom}}}dayOfMonth=Math.min(mom.date(),daysInMonth(mom.year(),value));mom._d["set"+(mom._isUTC?"UTC":"")+"Month"](value,dayOfMonth);return mom}function getSetMonth(value){if(value!=null){setMonth(this,value);hooks.updateOffset(this,true);return this}else{return get(this,"Month")}}function getDaysInMonth(){return daysInMonth(this.year(),this.month())}function monthsShortRegex(isStrict){if(this._monthsParseExact){if(!hasOwnProp(this,"_monthsRegex")){computeMonthsParse.call(this)}if(isStrict){return this._monthsShortStrictRegex}else{return this._monthsShortRegex}}else{if(!hasOwnProp(this,"_monthsShortRegex")){this._monthsShortRegex=defaultMonthsShortRegex}return this._monthsShortStrictRegex&&isStrict?this._monthsShortStrictRegex:this._monthsShortRegex}}function monthsRegex(isStrict){if(this._monthsParseExact){if(!hasOwnProp(this,"_monthsRegex")){computeMonthsParse.call(this)}if(isStrict){return this._monthsStrictRegex}else{return this._monthsRegex}}else{if(!hasOwnProp(this,"_monthsRegex")){this._monthsRegex=defaultMonthsRegex}return this._monthsStrictRegex&&isStrict?this._monthsStrictRegex:this._monthsRegex}}function computeMonthsParse(){function cmpLenRev(a,b){return b.length-a.length}var shortPieces=[],longPieces=[],mixedPieces=[],i,mom;for(i=0;i<12;i++){mom=createUTC([2e3,i]);shortPieces.push(this.monthsShort(mom,""));longPieces.push(this.months(mom,""));mixedPieces.push(this.months(mom,""));mixedPieces.push(this.monthsShort(mom,""))}shortPieces.sort(cmpLenRev);longPieces.sort(cmpLenRev);mixedPieces.sort(cmpLenRev);for(i=0;i<12;i++){shortPieces[i]=regexEscape(shortPieces[i]);longPieces[i]=regexEscape(longPieces[i])}for(i=0;i<24;i++){mixedPieces[i]=regexEscape(mixedPieces[i])}this._monthsRegex=new RegExp("^("+mixedPieces.join("|")+")","i");this._monthsShortRegex=this._monthsRegex;this._monthsStrictRegex=new RegExp("^("+longPieces.join("|")+")","i");this._monthsShortStrictRegex=new RegExp("^("+shortPieces.join("|")+")","i")}addFormatToken("Y",0,0,function(){var y=this.year();return y<=9999?zeroFill(y,4):"+"+y});addFormatToken(0,["YY",2],0,function(){return this.year()%100});addFormatToken(0,["YYYY",4],0,"year");addFormatToken(0,["YYYYY",5],0,"year");addFormatToken(0,["YYYYYY",6,true],0,"year");addUnitAlias("year","y");addUnitPriority("year",1);addRegexToken("Y",matchSigned);addRegexToken("YY",match1to2,match2);addRegexToken("YYYY",match1to4,match4);addRegexToken("YYYYY",match1to6,match6);addRegexToken("YYYYYY",match1to6,match6);addParseToken(["YYYYY","YYYYYY"],YEAR);addParseToken("YYYY",function(input,array){array[YEAR]=input.length===2?hooks.parseTwoDigitYear(input):toInt(input)});addParseToken("YY",function(input,array){array[YEAR]=hooks.parseTwoDigitYear(input)});addParseToken("Y",function(input,array){array[YEAR]=parseInt(input,10)});function daysInYear(year){return isLeapYear(year)?366:365}hooks.parseTwoDigitYear=function(input){return toInt(input)+(toInt(input)>68?1900:2e3)};var getSetYear=makeGetSet("FullYear",true);function getIsLeapYear(){return isLeapYear(this.year())}function createDate(y,m,d,h,M,s,ms){var date;if(y<100&&y>=0){date=new Date(y+400,m,d,h,M,s,ms);if(isFinite(date.getFullYear())){date.setFullYear(y)}}else{date=new Date(y,m,d,h,M,s,ms)}return date}function createUTCDate(y){var date,args;if(y<100&&y>=0){args=Array.prototype.slice.call(arguments);args[0]=y+400;date=new Date(Date.UTC.apply(null,args));if(isFinite(date.getUTCFullYear())){date.setUTCFullYear(y)}}else{date=new Date(Date.UTC.apply(null,arguments))}return date}function firstWeekOffset(year,dow,doy){var fwd=7+dow-doy,fwdlw=(7+createUTCDate(year,0,fwd).getUTCDay()-dow)%7;return-fwdlw+fwd-1}function dayOfYearFromWeeks(year,week,weekday,dow,doy){var localWeekday=(7+weekday-dow)%7,weekOffset=firstWeekOffset(year,dow,doy),dayOfYear=1+7*(week-1)+localWeekday+weekOffset,resYear,resDayOfYear;if(dayOfYear<=0){resYear=year-1;resDayOfYear=daysInYear(resYear)+dayOfYear}else if(dayOfYear>daysInYear(year)){resYear=year+1;resDayOfYear=dayOfYear-daysInYear(year)}else{resYear=year;resDayOfYear=dayOfYear}return{year:resYear,dayOfYear:resDayOfYear}}function weekOfYear(mom,dow,doy){var weekOffset=firstWeekOffset(mom.year(),dow,doy),week=Math.floor((mom.dayOfYear()-weekOffset-1)/7)+1,resWeek,resYear;if(week<1){resYear=mom.year()-1;resWeek=week+weeksInYear(resYear,dow,doy)}else if(week>weeksInYear(mom.year(),dow,doy)){resWeek=week-weeksInYear(mom.year(),dow,doy);resYear=mom.year()+1}else{resYear=mom.year();resWeek=week}return{week:resWeek,year:resYear}}function weeksInYear(year,dow,doy){var weekOffset=firstWeekOffset(year,dow,doy),weekOffsetNext=firstWeekOffset(year+1,dow,doy);return(daysInYear(year)-weekOffset+weekOffsetNext)/7}addFormatToken("w",["ww",2],"wo","week");addFormatToken("W",["WW",2],"Wo","isoWeek");addUnitAlias("week","w");addUnitAlias("isoWeek","W");addUnitPriority("week",5);addUnitPriority("isoWeek",5);addRegexToken("w",match1to2);addRegexToken("ww",match1to2,match2);addRegexToken("W",match1to2);addRegexToken("WW",match1to2,match2);addWeekParseToken(["w","ww","W","WW"],function(input,week,config,token){week[token.substr(0,1)]=toInt(input)});function localeWeek(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week}var defaultLocaleWeek={dow:0,doy:6};function localeFirstDayOfWeek(){return this._week.dow}function localeFirstDayOfYear(){return this._week.doy}function getSetWeek(input){var week=this.localeData().week(this);return input==null?week:this.add((input-week)*7,"d")}function getSetISOWeek(input){var week=weekOfYear(this,1,4).week;return input==null?week:this.add((input-week)*7,"d")}addFormatToken("d",0,"do","day");addFormatToken("dd",0,0,function(format){return this.localeData().weekdaysMin(this,format)});addFormatToken("ddd",0,0,function(format){return this.localeData().weekdaysShort(this,format)});addFormatToken("dddd",0,0,function(format){return this.localeData().weekdays(this,format)});addFormatToken("e",0,0,"weekday");addFormatToken("E",0,0,"isoWeekday");addUnitAlias("day","d");addUnitAlias("weekday","e");addUnitAlias("isoWeekday","E");addUnitPriority("day",11);addUnitPriority("weekday",11);addUnitPriority("isoWeekday",11);addRegexToken("d",match1to2);addRegexToken("e",match1to2);addRegexToken("E",match1to2);addRegexToken("dd",function(isStrict,locale){return locale.weekdaysMinRegex(isStrict)});addRegexToken("ddd",function(isStrict,locale){return locale.weekdaysShortRegex(isStrict)});addRegexToken("dddd",function(isStrict,locale){return locale.weekdaysRegex(isStrict)});addWeekParseToken(["dd","ddd","dddd"],function(input,week,config,token){var weekday=config._locale.weekdaysParse(input,token,config._strict);if(weekday!=null){week.d=weekday}else{getParsingFlags(config).invalidWeekday=input}});addWeekParseToken(["d","e","E"],function(input,week,config,token){week[token]=toInt(input)});function parseWeekday(input,locale){if(typeof input!=="string"){return input}if(!isNaN(input)){return parseInt(input,10)}input=locale.weekdaysParse(input);if(typeof input==="number"){return input}return null}function parseIsoWeekday(input,locale){if(typeof input==="string"){return locale.weekdaysParse(input)%7||7}return isNaN(input)?null:input}function shiftWeekdays(ws,n){return ws.slice(n,7).concat(ws.slice(0,n))}var defaultLocaleWeekdays="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),defaultLocaleWeekdaysShort="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),defaultLocaleWeekdaysMin="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),defaultWeekdaysRegex=matchWord,defaultWeekdaysShortRegex=matchWord,defaultWeekdaysMinRegex=matchWord;function localeWeekdays(m,format){var weekdays=isArray(this._weekdays)?this._weekdays:this._weekdays[m&&m!==true&&this._weekdays.isFormat.test(format)?"format":"standalone"];return m===true?shiftWeekdays(weekdays,this._week.dow):m?weekdays[m.day()]:weekdays}function localeWeekdaysShort(m){return m===true?shiftWeekdays(this._weekdaysShort,this._week.dow):m?this._weekdaysShort[m.day()]:this._weekdaysShort}function localeWeekdaysMin(m){return m===true?shiftWeekdays(this._weekdaysMin,this._week.dow):m?this._weekdaysMin[m.day()]:this._weekdaysMin}function handleStrictParse$1(weekdayName,format,strict){var i,ii,mom,llc=weekdayName.toLocaleLowerCase();if(!this._weekdaysParse){this._weekdaysParse=[];this._shortWeekdaysParse=[];this._minWeekdaysParse=[];for(i=0;i<7;++i){mom=createUTC([2e3,1]).day(i);this._minWeekdaysParse[i]=this.weekdaysMin(mom,"").toLocaleLowerCase();this._shortWeekdaysParse[i]=this.weekdaysShort(mom,"").toLocaleLowerCase();this._weekdaysParse[i]=this.weekdays(mom,"").toLocaleLowerCase()}}if(strict){if(format==="dddd"){ii=indexOf.call(this._weekdaysParse,llc);return ii!==-1?ii:null}else if(format==="ddd"){ii=indexOf.call(this._shortWeekdaysParse,llc);return ii!==-1?ii:null}else{ii=indexOf.call(this._minWeekdaysParse,llc);return ii!==-1?ii:null}}else{if(format==="dddd"){ii=indexOf.call(this._weekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._shortWeekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._minWeekdaysParse,llc);return ii!==-1?ii:null}else if(format==="ddd"){ii=indexOf.call(this._shortWeekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._weekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._minWeekdaysParse,llc);return ii!==-1?ii:null}else{ii=indexOf.call(this._minWeekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._weekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._shortWeekdaysParse,llc);return ii!==-1?ii:null}}}function localeWeekdaysParse(weekdayName,format,strict){var i,mom,regex;if(this._weekdaysParseExact){return handleStrictParse$1.call(this,weekdayName,format,strict)}if(!this._weekdaysParse){this._weekdaysParse=[];this._minWeekdaysParse=[];this._shortWeekdaysParse=[];this._fullWeekdaysParse=[]}for(i=0;i<7;i++){mom=createUTC([2e3,1]).day(i);if(strict&&!this._fullWeekdaysParse[i]){this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(mom,"").replace(".","\\.?")+"$","i");this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(mom,"").replace(".","\\.?")+"$","i");this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(mom,"").replace(".","\\.?")+"$","i")}if(!this._weekdaysParse[i]){regex="^"+this.weekdays(mom,"")+"|^"+this.weekdaysShort(mom,"")+"|^"+this.weekdaysMin(mom,"");this._weekdaysParse[i]=new RegExp(regex.replace(".",""),"i")}if(strict&&format==="dddd"&&this._fullWeekdaysParse[i].test(weekdayName)){return i}else if(strict&&format==="ddd"&&this._shortWeekdaysParse[i].test(weekdayName)){return i}else if(strict&&format==="dd"&&this._minWeekdaysParse[i].test(weekdayName)){return i}else if(!strict&&this._weekdaysParse[i].test(weekdayName)){return i}}}function getSetDayOfWeek(input){if(!this.isValid()){return input!=null?this:NaN}var day=this._isUTC?this._d.getUTCDay():this._d.getDay();if(input!=null){input=parseWeekday(input,this.localeData());return this.add(input-day,"d")}else{return day}}function getSetLocaleDayOfWeek(input){if(!this.isValid()){return input!=null?this:NaN}var weekday=(this.day()+7-this.localeData()._week.dow)%7;return input==null?weekday:this.add(input-weekday,"d")}function getSetISODayOfWeek(input){if(!this.isValid()){return input!=null?this:NaN}if(input!=null){var weekday=parseIsoWeekday(input,this.localeData());return this.day(this.day()%7?weekday:weekday-7)}else{return this.day()||7}}function weekdaysRegex(isStrict){if(this._weekdaysParseExact){if(!hasOwnProp(this,"_weekdaysRegex")){computeWeekdaysParse.call(this)}if(isStrict){return this._weekdaysStrictRegex}else{return this._weekdaysRegex}}else{if(!hasOwnProp(this,"_weekdaysRegex")){this._weekdaysRegex=defaultWeekdaysRegex}return this._weekdaysStrictRegex&&isStrict?this._weekdaysStrictRegex:this._weekdaysRegex}}function weekdaysShortRegex(isStrict){if(this._weekdaysParseExact){if(!hasOwnProp(this,"_weekdaysRegex")){computeWeekdaysParse.call(this)}if(isStrict){return this._weekdaysShortStrictRegex}else{return this._weekdaysShortRegex}}else{if(!hasOwnProp(this,"_weekdaysShortRegex")){this._weekdaysShortRegex=defaultWeekdaysShortRegex}return this._weekdaysShortStrictRegex&&isStrict?this._weekdaysShortStrictRegex:this._weekdaysShortRegex}}function weekdaysMinRegex(isStrict){if(this._weekdaysParseExact){if(!hasOwnProp(this,"_weekdaysRegex")){computeWeekdaysParse.call(this)}if(isStrict){return this._weekdaysMinStrictRegex}else{return this._weekdaysMinRegex}}else{if(!hasOwnProp(this,"_weekdaysMinRegex")){this._weekdaysMinRegex=defaultWeekdaysMinRegex}return this._weekdaysMinStrictRegex&&isStrict?this._weekdaysMinStrictRegex:this._weekdaysMinRegex}}function computeWeekdaysParse(){function cmpLenRev(a,b){return b.length-a.length}var minPieces=[],shortPieces=[],longPieces=[],mixedPieces=[],i,mom,minp,shortp,longp;for(i=0;i<7;i++){mom=createUTC([2e3,1]).day(i);minp=regexEscape(this.weekdaysMin(mom,""));shortp=regexEscape(this.weekdaysShort(mom,""));longp=regexEscape(this.weekdays(mom,""));minPieces.push(minp);shortPieces.push(shortp);longPieces.push(longp);mixedPieces.push(minp);mixedPieces.push(shortp);mixedPieces.push(longp)}minPieces.sort(cmpLenRev);shortPieces.sort(cmpLenRev);longPieces.sort(cmpLenRev);mixedPieces.sort(cmpLenRev);this._weekdaysRegex=new RegExp("^("+mixedPieces.join("|")+")","i");this._weekdaysShortRegex=this._weekdaysRegex;this._weekdaysMinRegex=this._weekdaysRegex;this._weekdaysStrictRegex=new RegExp("^("+longPieces.join("|")+")","i");this._weekdaysShortStrictRegex=new RegExp("^("+shortPieces.join("|")+")","i");this._weekdaysMinStrictRegex=new RegExp("^("+minPieces.join("|")+")","i")}function hFormat(){return this.hours()%12||12}function kFormat(){return this.hours()||24}addFormatToken("H",["HH",2],0,"hour");addFormatToken("h",["hh",2],0,hFormat);addFormatToken("k",["kk",2],0,kFormat);addFormatToken("hmm",0,0,function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)});addFormatToken("hmmss",0,0,function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)});addFormatToken("Hmm",0,0,function(){return""+this.hours()+zeroFill(this.minutes(),2)});addFormatToken("Hmmss",0,0,function(){return""+this.hours()+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)});function meridiem(token,lowercase){addFormatToken(token,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),lowercase)})}meridiem("a",true);meridiem("A",false);addUnitAlias("hour","h");addUnitPriority("hour",13);function matchMeridiem(isStrict,locale){return locale._meridiemParse}addRegexToken("a",matchMeridiem);addRegexToken("A",matchMeridiem);addRegexToken("H",match1to2);addRegexToken("h",match1to2);addRegexToken("k",match1to2);addRegexToken("HH",match1to2,match2);addRegexToken("hh",match1to2,match2);addRegexToken("kk",match1to2,match2);addRegexToken("hmm",match3to4);addRegexToken("hmmss",match5to6);addRegexToken("Hmm",match3to4);addRegexToken("Hmmss",match5to6);addParseToken(["H","HH"],HOUR);addParseToken(["k","kk"],function(input,array,config){var kInput=toInt(input);array[HOUR]=kInput===24?0:kInput});addParseToken(["a","A"],function(input,array,config){config._isPm=config._locale.isPM(input);config._meridiem=input});addParseToken(["h","hh"],function(input,array,config){array[HOUR]=toInt(input);getParsingFlags(config).bigHour=true});addParseToken("hmm",function(input,array,config){var pos=input.length-2;array[HOUR]=toInt(input.substr(0,pos));array[MINUTE]=toInt(input.substr(pos));getParsingFlags(config).bigHour=true});addParseToken("hmmss",function(input,array,config){var pos1=input.length-4,pos2=input.length-2;array[HOUR]=toInt(input.substr(0,pos1));array[MINUTE]=toInt(input.substr(pos1,2));array[SECOND]=toInt(input.substr(pos2));getParsingFlags(config).bigHour=true});addParseToken("Hmm",function(input,array,config){var pos=input.length-2;array[HOUR]=toInt(input.substr(0,pos));array[MINUTE]=toInt(input.substr(pos))});addParseToken("Hmmss",function(input,array,config){var pos1=input.length-4,pos2=input.length-2;array[HOUR]=toInt(input.substr(0,pos1));array[MINUTE]=toInt(input.substr(pos1,2));array[SECOND]=toInt(input.substr(pos2))});function localeIsPM(input){return(input+"").toLowerCase().charAt(0)==="p"}var defaultLocaleMeridiemParse=/[ap]\.?m?\.?/i,getSetHour=makeGetSet("Hours",true);function localeMeridiem(hours,minutes,isLower){if(hours>11){return isLower?"pm":"PM"}else{return isLower?"am":"AM"}}var baseConfig={calendar:defaultCalendar,longDateFormat:defaultLongDateFormat,invalidDate:defaultInvalidDate,ordinal:defaultOrdinal,dayOfMonthOrdinalParse:defaultDayOfMonthOrdinalParse,relativeTime:defaultRelativeTime,months:defaultLocaleMonths,monthsShort:defaultLocaleMonthsShort,week:defaultLocaleWeek,weekdays:defaultLocaleWeekdays,weekdaysMin:defaultLocaleWeekdaysMin,weekdaysShort:defaultLocaleWeekdaysShort,meridiemParse:defaultLocaleMeridiemParse};var locales={},localeFamilies={},globalLocale;function commonPrefix(arr1,arr2){var i,minl=Math.min(arr1.length,arr2.length);for(i=0;i<minl;i+=1){if(arr1[i]!==arr2[i]){return i}}return minl}function normalizeLocale(key){return key?key.toLowerCase().replace("_","-"):key}function chooseLocale(names){var i=0,j,next,locale,split;while(i<names.length){split=normalizeLocale(names[i]).split("-");j=split.length;next=normalizeLocale(names[i+1]);next=next?next.split("-"):null;while(j>0){locale=loadLocale(split.slice(0,j).join("-"));if(locale){return locale}if(next&&next.length>=j&&commonPrefix(split,next)>=j-1){break}j--}i++}return globalLocale}function loadLocale(name){var oldLocale=null,aliasedRequire;if(locales[name]===undefined&&typeof module!=="undefined"&&module&&module.exports){try{oldLocale=globalLocale._abbr;aliasedRequire=require;aliasedRequire("./locale/"+name);getSetGlobalLocale(oldLocale)}catch(e){locales[name]=null}}return locales[name]}function getSetGlobalLocale(key,values){var data;if(key){if(isUndefined(values)){data=getLocale(key)}else{data=defineLocale(key,values)}if(data){globalLocale=data}else{if(typeof console!=="undefined"&&console.warn){console.warn("Locale "+key+" not found. Did you forget to load it?")}}}return globalLocale._abbr}function defineLocale(name,config){if(config!==null){var locale,parentConfig=baseConfig;config.abbr=name;if(locales[name]!=null){deprecateSimple("defineLocaleOverride","use moment.updateLocale(localeName, config) to change "+"an existing locale. moment.defineLocale(localeName, "+"config) should only be used for creating a new locale "+"See http://momentjs.com/guides/#/warnings/define-locale/ for more info.");parentConfig=locales[name]._config}else if(config.parentLocale!=null){if(locales[config.parentLocale]!=null){parentConfig=locales[config.parentLocale]._config}else{locale=loadLocale(config.parentLocale);if(locale!=null){parentConfig=locale._config}else{if(!localeFamilies[config.parentLocale]){localeFamilies[config.parentLocale]=[]}localeFamilies[config.parentLocale].push({name:name,config:config});return null}}}locales[name]=new Locale(mergeConfigs(parentConfig,config));if(localeFamilies[name]){localeFamilies[name].forEach(function(x){defineLocale(x.name,x.config)})}getSetGlobalLocale(name);return locales[name]}else{delete locales[name];return null}}function updateLocale(name,config){if(config!=null){var locale,tmpLocale,parentConfig=baseConfig;if(locales[name]!=null&&locales[name].parentLocale!=null){locales[name].set(mergeConfigs(locales[name]._config,config))}else{tmpLocale=loadLocale(name);if(tmpLocale!=null){parentConfig=tmpLocale._config}config=mergeConfigs(parentConfig,config);if(tmpLocale==null){config.abbr=name}locale=new Locale(config);locale.parentLocale=locales[name];locales[name]=locale}getSetGlobalLocale(name)}else{if(locales[name]!=null){if(locales[name].parentLocale!=null){locales[name]=locales[name].parentLocale;if(name===getSetGlobalLocale()){getSetGlobalLocale(name)}}else if(locales[name]!=null){delete locales[name]}}}return locales[name]}function getLocale(key){var locale;if(key&&key._locale&&key._locale._abbr){key=key._locale._abbr}if(!key){return globalLocale}if(!isArray(key)){locale=loadLocale(key);if(locale){return locale}key=[key]}return chooseLocale(key)}function listLocales(){return keys(locales)}function checkOverflow(m){var overflow,a=m._a;if(a&&getParsingFlags(m).overflow===-2){overflow=a[MONTH]<0||a[MONTH]>11?MONTH:a[DATE]<1||a[DATE]>daysInMonth(a[YEAR],a[MONTH])?DATE:a[HOUR]<0||a[HOUR]>24||a[HOUR]===24&&(a[MINUTE]!==0||a[SECOND]!==0||a[MILLISECOND]!==0)?HOUR:a[MINUTE]<0||a[MINUTE]>59?MINUTE:a[SECOND]<0||a[SECOND]>59?SECOND:a[MILLISECOND]<0||a[MILLISECOND]>999?MILLISECOND:-1;if(getParsingFlags(m)._overflowDayOfYear&&(overflow<YEAR||overflow>DATE)){overflow=DATE}if(getParsingFlags(m)._overflowWeeks&&overflow===-1){overflow=WEEK}if(getParsingFlags(m)._overflowWeekday&&overflow===-1){overflow=WEEKDAY}getParsingFlags(m).overflow=overflow}return m}var extendedIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,basicIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,tzRegex=/Z|[+-]\d\d(?::?\d\d)?/,isoDates=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,false],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,false],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,false],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,false],["YYYY",/\d{4}/,false]],isoTimes=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],aspNetJsonRegex=/^\/?Date\((-?\d+)/i,rfc2822=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,obsOffsets={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function configFromISO(config){var i,l,string=config._i,match=extendedIsoRegex.exec(string)||basicIsoRegex.exec(string),allowTime,dateFormat,timeFormat,tzFormat;if(match){getParsingFlags(config).iso=true;for(i=0,l=isoDates.length;i<l;i++){if(isoDates[i][1].exec(match[1])){dateFormat=isoDates[i][0];allowTime=isoDates[i][2]!==false;break}}if(dateFormat==null){config._isValid=false;return}if(match[3]){for(i=0,l=isoTimes.length;i<l;i++){if(isoTimes[i][1].exec(match[3])){timeFormat=(match[2]||" ")+isoTimes[i][0];break}}if(timeFormat==null){config._isValid=false;return}}if(!allowTime&&timeFormat!=null){config._isValid=false;return}if(match[4]){if(tzRegex.exec(match[4])){tzFormat="Z"}else{config._isValid=false;return}}config._f=dateFormat+(timeFormat||"")+(tzFormat||"");configFromStringAndFormat(config)}else{config._isValid=false}}function extractFromRFC2822Strings(yearStr,monthStr,dayStr,hourStr,minuteStr,secondStr){var result=[untruncateYear(yearStr),defaultLocaleMonthsShort.indexOf(monthStr),parseInt(dayStr,10),parseInt(hourStr,10),parseInt(minuteStr,10)];if(secondStr){result.push(parseInt(secondStr,10))}return result}function untruncateYear(yearStr){var year=parseInt(yearStr,10);if(year<=49){return 2e3+year}else if(year<=999){return 1900+year}return year}function preprocessRFC2822(s){return s.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function checkWeekday(weekdayStr,parsedInput,config){if(weekdayStr){var weekdayProvided=defaultLocaleWeekdaysShort.indexOf(weekdayStr),weekdayActual=new Date(parsedInput[0],parsedInput[1],parsedInput[2]).getDay();if(weekdayProvided!==weekdayActual){getParsingFlags(config).weekdayMismatch=true;config._isValid=false;return false}}return true}function calculateOffset(obsOffset,militaryOffset,numOffset){if(obsOffset){return obsOffsets[obsOffset]}else if(militaryOffset){return 0}else{var hm=parseInt(numOffset,10),m=hm%100,h=(hm-m)/100;return h*60+m}}function configFromRFC2822(config){var match=rfc2822.exec(preprocessRFC2822(config._i)),parsedArray;if(match){parsedArray=extractFromRFC2822Strings(match[4],match[3],match[2],match[5],match[6],match[7]);if(!checkWeekday(match[1],parsedArray,config)){return}config._a=parsedArray;config._tzm=calculateOffset(match[8],match[9],match[10]);config._d=createUTCDate.apply(null,config._a);config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm);getParsingFlags(config).rfc2822=true}else{config._isValid=false}}function configFromString(config){var matched=aspNetJsonRegex.exec(config._i);if(matched!==null){config._d=new Date(+matched[1]);return}configFromISO(config);if(config._isValid===false){delete config._isValid}else{return}configFromRFC2822(config);if(config._isValid===false){delete config._isValid}else{return}if(config._strict){config._isValid=false}else{hooks.createFromInputFallback(config)}}hooks.createFromInputFallback=deprecate("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), "+"which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are "+"discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(config){config._d=new Date(config._i+(config._useUTC?" UTC":""))});function defaults(a,b,c){if(a!=null){return a}if(b!=null){return b}return c}function currentDateArray(config){var nowValue=new Date(hooks.now());if(config._useUTC){return[nowValue.getUTCFullYear(),nowValue.getUTCMonth(),nowValue.getUTCDate()]}return[nowValue.getFullYear(),nowValue.getMonth(),nowValue.getDate()]}function configFromArray(config){var i,date,input=[],currentDate,expectedWeekday,yearToUse;if(config._d){return}currentDate=currentDateArray(config);if(config._w&&config._a[DATE]==null&&config._a[MONTH]==null){dayOfYearFromWeekInfo(config)}if(config._dayOfYear!=null){yearToUse=defaults(config._a[YEAR],currentDate[YEAR]);if(config._dayOfYear>daysInYear(yearToUse)||config._dayOfYear===0){getParsingFlags(config)._overflowDayOfYear=true}date=createUTCDate(yearToUse,0,config._dayOfYear);config._a[MONTH]=date.getUTCMonth();config._a[DATE]=date.getUTCDate()}for(i=0;i<3&&config._a[i]==null;++i){config._a[i]=input[i]=currentDate[i]}for(;i<7;i++){config._a[i]=input[i]=config._a[i]==null?i===2?1:0:config._a[i]}if(config._a[HOUR]===24&&config._a[MINUTE]===0&&config._a[SECOND]===0&&config._a[MILLISECOND]===0){config._nextDay=true;config._a[HOUR]=0}config._d=(config._useUTC?createUTCDate:createDate).apply(null,input);expectedWeekday=config._useUTC?config._d.getUTCDay():config._d.getDay();if(config._tzm!=null){config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm)}if(config._nextDay){config._a[HOUR]=24}if(config._w&&typeof config._w.d!=="undefined"&&config._w.d!==expectedWeekday){getParsingFlags(config).weekdayMismatch=true}}function dayOfYearFromWeekInfo(config){var w,weekYear,week,weekday,dow,doy,temp,weekdayOverflow,curWeek;w=config._w;if(w.GG!=null||w.W!=null||w.E!=null){dow=1;doy=4;weekYear=defaults(w.GG,config._a[YEAR],weekOfYear(createLocal(),1,4).year);week=defaults(w.W,1);weekday=defaults(w.E,1);if(weekday<1||weekday>7){weekdayOverflow=true}}else{dow=config._locale._week.dow;doy=config._locale._week.doy;curWeek=weekOfYear(createLocal(),dow,doy);weekYear=defaults(w.gg,config._a[YEAR],curWeek.year);week=defaults(w.w,curWeek.week);if(w.d!=null){weekday=w.d;if(weekday<0||weekday>6){weekdayOverflow=true}}else if(w.e!=null){weekday=w.e+dow;if(w.e<0||w.e>6){weekdayOverflow=true}}else{weekday=dow}}if(week<1||week>weeksInYear(weekYear,dow,doy)){getParsingFlags(config)._overflowWeeks=true}else if(weekdayOverflow!=null){getParsingFlags(config)._overflowWeekday=true}else{temp=dayOfYearFromWeeks(weekYear,week,weekday,dow,doy);config._a[YEAR]=temp.year;config._dayOfYear=temp.dayOfYear}}hooks.ISO_8601=function(){};hooks.RFC_2822=function(){};function configFromStringAndFormat(config){if(config._f===hooks.ISO_8601){configFromISO(config);return}if(config._f===hooks.RFC_2822){configFromRFC2822(config);return}config._a=[];getParsingFlags(config).empty=true;var string=""+config._i,i,parsedInput,tokens,token,skipped,stringLength=string.length,totalParsedInputLength=0,era;tokens=expandFormat(config._f,config._locale).match(formattingTokens)||[];for(i=0;i<tokens.length;i++){token=tokens[i];parsedInput=(string.match(getParseRegexForToken(token,config))||[])[0];if(parsedInput){skipped=string.substr(0,string.indexOf(parsedInput));if(skipped.length>0){getParsingFlags(config).unusedInput.push(skipped)}string=string.slice(string.indexOf(parsedInput)+parsedInput.length);totalParsedInputLength+=parsedInput.length}if(formatTokenFunctions[token]){if(parsedInput){getParsingFlags(config).empty=false}else{getParsingFlags(config).unusedTokens.push(token)}addTimeToArrayFromToken(token,parsedInput,config)}else if(config._strict&&!parsedInput){getParsingFlags(config).unusedTokens.push(token)}}getParsingFlags(config).charsLeftOver=stringLength-totalParsedInputLength;if(string.length>0){getParsingFlags(config).unusedInput.push(string)}if(config._a[HOUR]<=12&&getParsingFlags(config).bigHour===true&&config._a[HOUR]>0){getParsingFlags(config).bigHour=undefined}getParsingFlags(config).parsedDateParts=config._a.slice(0);getParsingFlags(config).meridiem=config._meridiem;config._a[HOUR]=meridiemFixWrap(config._locale,config._a[HOUR],config._meridiem);era=getParsingFlags(config).era;if(era!==null){config._a[YEAR]=config._locale.erasConvertYear(era,config._a[YEAR])}configFromArray(config);checkOverflow(config)}function meridiemFixWrap(locale,hour,meridiem){var isPm;if(meridiem==null){return hour}if(locale.meridiemHour!=null){return locale.meridiemHour(hour,meridiem)}else if(locale.isPM!=null){isPm=locale.isPM(meridiem);if(isPm&&hour<12){hour+=12}if(!isPm&&hour===12){hour=0}return hour}else{return hour}}function configFromStringAndArray(config){var tempConfig,bestMoment,scoreToBeat,i,currentScore,validFormatFound,bestFormatIsValid=false;if(config._f.length===0){getParsingFlags(config).invalidFormat=true;config._d=new Date(NaN);return}for(i=0;i<config._f.length;i++){currentScore=0;validFormatFound=false;tempConfig=copyConfig({},config);if(config._useUTC!=null){tempConfig._useUTC=config._useUTC}tempConfig._f=config._f[i];configFromStringAndFormat(tempConfig);if(isValid(tempConfig)){validFormatFound=true}currentScore+=getParsingFlags(tempConfig).charsLeftOver;currentScore+=getParsingFlags(tempConfig).unusedTokens.length*10;getParsingFlags(tempConfig).score=currentScore;if(!bestFormatIsValid){if(scoreToBeat==null||currentScore<scoreToBeat||validFormatFound){scoreToBeat=currentScore;bestMoment=tempConfig;if(validFormatFound){bestFormatIsValid=true}}}else{if(currentScore<scoreToBeat){scoreToBeat=currentScore;bestMoment=tempConfig}}}extend(config,bestMoment||tempConfig)}function configFromObject(config){if(config._d){return}var i=normalizeObjectUnits(config._i),dayOrDate=i.day===undefined?i.date:i.day;config._a=map([i.year,i.month,dayOrDate,i.hour,i.minute,i.second,i.millisecond],function(obj){return obj&&parseInt(obj,10)});configFromArray(config)}function createFromConfig(config){var res=new Moment(checkOverflow(prepareConfig(config)));if(res._nextDay){res.add(1,"d");res._nextDay=undefined}return res}function prepareConfig(config){var input=config._i,format=config._f;config._locale=config._locale||getLocale(config._l);if(input===null||format===undefined&&input===""){return createInvalid({nullInput:true})}if(typeof input==="string"){config._i=input=config._locale.preparse(input)}if(isMoment(input)){return new Moment(checkOverflow(input))}else if(isDate(input)){config._d=input}else if(isArray(format)){configFromStringAndArray(config)}else if(format){configFromStringAndFormat(config)}else{configFromInput(config)}if(!isValid(config)){config._d=null}return config}function configFromInput(config){var input=config._i;if(isUndefined(input)){config._d=new Date(hooks.now())}else if(isDate(input)){config._d=new Date(input.valueOf())}else if(typeof input==="string"){configFromString(config)}else if(isArray(input)){config._a=map(input.slice(0),function(obj){return parseInt(obj,10)});configFromArray(config)}else if(isObject(input)){configFromObject(config)}else if(isNumber(input)){config._d=new Date(input)}else{hooks.createFromInputFallback(config)}}function createLocalOrUTC(input,format,locale,strict,isUTC){var c={};if(format===true||format===false){strict=format;format=undefined}if(locale===true||locale===false){strict=locale;locale=undefined}if(isObject(input)&&isObjectEmpty(input)||isArray(input)&&input.length===0){input=undefined}c._isAMomentObject=true;c._useUTC=c._isUTC=isUTC;c._l=locale;c._i=input;c._f=format;c._strict=strict;return createFromConfig(c)}function createLocal(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,false)}var prototypeMin=deprecate("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var other=createLocal.apply(null,arguments);if(this.isValid()&&other.isValid()){return other<this?this:other}else{return createInvalid()}}),prototypeMax=deprecate("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var other=createLocal.apply(null,arguments);if(this.isValid()&&other.isValid()){return other>this?this:other}else{return createInvalid()}});function pickBy(fn,moments){var res,i;if(moments.length===1&&isArray(moments[0])){moments=moments[0]}if(!moments.length){return createLocal()}res=moments[0];for(i=1;i<moments.length;++i){if(!moments[i].isValid()||moments[i][fn](res)){res=moments[i]}}return res}function min(){var args=[].slice.call(arguments,0);return pickBy("isBefore",args)}function max(){var args=[].slice.call(arguments,0);return pickBy("isAfter",args)}var now=function(){return Date.now?Date.now():+new Date};var ordering=["year","quarter","month","week","day","hour","minute","second","millisecond"];function isDurationValid(m){var key,unitHasDecimal=false,i;for(key in m){if(hasOwnProp(m,key)&&!(indexOf.call(ordering,key)!==-1&&(m[key]==null||!isNaN(m[key])))){return false}}for(i=0;i<ordering.length;++i){if(m[ordering[i]]){if(unitHasDecimal){return false}if(parseFloat(m[ordering[i]])!==toInt(m[ordering[i]])){unitHasDecimal=true}}}return true}function isValid$1(){return this._isValid}function createInvalid$1(){return createDuration(NaN)}function Duration(duration){var normalizedInput=normalizeObjectUnits(duration),years=normalizedInput.year||0,quarters=normalizedInput.quarter||0,months=normalizedInput.month||0,weeks=normalizedInput.week||normalizedInput.isoWeek||0,days=normalizedInput.day||0,hours=normalizedInput.hour||0,minutes=normalizedInput.minute||0,seconds=normalizedInput.second||0,milliseconds=normalizedInput.millisecond||0;this._isValid=isDurationValid(normalizedInput);this._milliseconds=+milliseconds+seconds*1e3+minutes*6e4+hours*1e3*60*60;this._days=+days+weeks*7;this._months=+months+quarters*3+years*12;this._data={};this._locale=getLocale();this._bubble()}function isDuration(obj){return obj instanceof Duration}function absRound(number){if(number<0){return Math.round(-1*number)*-1}else{return Math.round(number)}}function compareArrays(array1,array2,dontConvert){var len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0,i;for(i=0;i<len;i++){if(dontConvert&&array1[i]!==array2[i]||!dontConvert&&toInt(array1[i])!==toInt(array2[i])){diffs++}}return diffs+lengthDiff}function offset(token,separator){addFormatToken(token,0,0,function(){var offset=this.utcOffset(),sign="+";if(offset<0){offset=-offset;sign="-"}return sign+zeroFill(~~(offset/60),2)+separator+zeroFill(~~offset%60,2)})}offset("Z",":");offset("ZZ","");addRegexToken("Z",matchShortOffset);addRegexToken("ZZ",matchShortOffset);addParseToken(["Z","ZZ"],function(input,array,config){config._useUTC=true;config._tzm=offsetFromString(matchShortOffset,input)});var chunkOffset=/([\+\-]|\d\d)/gi;function offsetFromString(matcher,string){var matches=(string||"").match(matcher),chunk,parts,minutes;if(matches===null){return null}chunk=matches[matches.length-1]||[];parts=(chunk+"").match(chunkOffset)||["-",0,0];minutes=+(parts[1]*60)+toInt(parts[2]);return minutes===0?0:parts[0]==="+"?minutes:-minutes}function cloneWithOffset(input,model){var res,diff;if(model._isUTC){res=model.clone();diff=(isMoment(input)||isDate(input)?input.valueOf():createLocal(input).valueOf())-res.valueOf();res._d.setTime(res._d.valueOf()+diff);hooks.updateOffset(res,false);return res}else{return createLocal(input).local()}}function getDateOffset(m){return-Math.round(m._d.getTimezoneOffset())}hooks.updateOffset=function(){};function getSetOffset(input,keepLocalTime,keepMinutes){var offset=this._offset||0,localAdjust;if(!this.isValid()){return input!=null?this:NaN}if(input!=null){if(typeof input==="string"){input=offsetFromString(matchShortOffset,input);if(input===null){return this}}else if(Math.abs(input)<16&&!keepMinutes){input=input*60}if(!this._isUTC&&keepLocalTime){localAdjust=getDateOffset(this)}this._offset=input;this._isUTC=true;if(localAdjust!=null){this.add(localAdjust,"m")}if(offset!==input){if(!keepLocalTime||this._changeInProgress){addSubtract(this,createDuration(input-offset,"m"),1,false)}else if(!this._changeInProgress){this._changeInProgress=true;hooks.updateOffset(this,true);this._changeInProgress=null}}return this}else{return this._isUTC?offset:getDateOffset(this)}}function getSetZone(input,keepLocalTime){if(input!=null){if(typeof input!=="string"){input=-input}this.utcOffset(input,keepLocalTime);return this}else{return-this.utcOffset()}}function setOffsetToUTC(keepLocalTime){return this.utcOffset(0,keepLocalTime)}function setOffsetToLocal(keepLocalTime){if(this._isUTC){this.utcOffset(0,keepLocalTime);this._isUTC=false;if(keepLocalTime){this.subtract(getDateOffset(this),"m")}}return this}function setOffsetToParsedOffset(){if(this._tzm!=null){this.utcOffset(this._tzm,false,true)}else if(typeof this._i==="string"){var tZone=offsetFromString(matchOffset,this._i);if(tZone!=null){this.utcOffset(tZone)}else{this.utcOffset(0,true)}}return this}function hasAlignedHourOffset(input){if(!this.isValid()){return false}input=input?createLocal(input).utcOffset():0;return(this.utcOffset()-input)%60===0}function isDaylightSavingTime(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function isDaylightSavingTimeShifted(){if(!isUndefined(this._isDSTShifted)){return this._isDSTShifted}var c={},other;copyConfig(c,this);c=prepareConfig(c);if(c._a){other=c._isUTC?createUTC(c._a):createLocal(c._a);this._isDSTShifted=this.isValid()&&compareArrays(c._a,other.toArray())>0}else{this._isDSTShifted=false}return this._isDSTShifted}function isLocal(){return this.isValid()?!this._isUTC:false}function isUtcOffset(){return this.isValid()?this._isUTC:false}function isUtc(){return this.isValid()?this._isUTC&&this._offset===0:false}var aspNetRegex=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,isoRegex=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function createDuration(input,key){var duration=input,match=null,sign,ret,diffRes;if(isDuration(input)){duration={ms:input._milliseconds,d:input._days,M:input._months}}else if(isNumber(input)||!isNaN(+input)){duration={};if(key){duration[key]=+input}else{duration.milliseconds=+input}}else if(match=aspNetRegex.exec(input)){sign=match[1]==="-"?-1:1;duration={y:0,d:toInt(match[DATE])*sign,h:toInt(match[HOUR])*sign,m:toInt(match[MINUTE])*sign,s:toInt(match[SECOND])*sign,ms:toInt(absRound(match[MILLISECOND]*1e3))*sign}}else if(match=isoRegex.exec(input)){sign=match[1]==="-"?-1:1;duration={y:parseIso(match[2],sign),M:parseIso(match[3],sign),w:parseIso(match[4],sign),d:parseIso(match[5],sign),h:parseIso(match[6],sign),m:parseIso(match[7],sign),s:parseIso(match[8],sign)}}else if(duration==null){duration={}}else if(typeof duration==="object"&&("from"in duration||"to"in duration)){diffRes=momentsDifference(createLocal(duration.from),createLocal(duration.to));duration={};duration.ms=diffRes.milliseconds;duration.M=diffRes.months}ret=new Duration(duration);if(isDuration(input)&&hasOwnProp(input,"_locale")){ret._locale=input._locale}if(isDuration(input)&&hasOwnProp(input,"_isValid")){ret._isValid=input._isValid}return ret}createDuration.fn=Duration.prototype;createDuration.invalid=createInvalid$1;function parseIso(inp,sign){var res=inp&&parseFloat(inp.replace(",","."));return(isNaN(res)?0:res)*sign}function positiveMomentsDifference(base,other){var res={};res.months=other.month()-base.month()+(other.year()-base.year())*12;if(base.clone().add(res.months,"M").isAfter(other)){--res.months}res.milliseconds=+other-+base.clone().add(res.months,"M");return res}function momentsDifference(base,other){var res;if(!(base.isValid()&&other.isValid())){return{milliseconds:0,months:0}}other=cloneWithOffset(other,base);if(base.isBefore(other)){res=positiveMomentsDifference(base,other)}else{res=positiveMomentsDifference(other,base);res.milliseconds=-res.milliseconds;res.months=-res.months}return res}function createAdder(direction,name){return function(val,period){var dur,tmp;if(period!==null&&!isNaN(+period)){deprecateSimple(name,"moment()."+name+"(period, number) is deprecated. Please use moment()."+name+"(number, period). "+"See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info.");tmp=val;val=period;period=tmp}dur=createDuration(val,period);addSubtract(this,dur,direction);return this}}function addSubtract(mom,duration,isAdding,updateOffset){var milliseconds=duration._milliseconds,days=absRound(duration._days),months=absRound(duration._months);if(!mom.isValid()){return}updateOffset=updateOffset==null?true:updateOffset;if(months){setMonth(mom,get(mom,"Month")+months*isAdding)}if(days){set$1(mom,"Date",get(mom,"Date")+days*isAdding)}if(milliseconds){mom._d.setTime(mom._d.valueOf()+milliseconds*isAdding)}if(updateOffset){hooks.updateOffset(mom,days||months)}}var add=createAdder(1,"add"),subtract=createAdder(-1,"subtract");function isString(input){return typeof input==="string"||input instanceof String}function isMomentInput(input){return isMoment(input)||isDate(input)||isString(input)||isNumber(input)||isNumberOrStringArray(input)||isMomentInputObject(input)||input===null||input===undefined}function isMomentInputObject(input){var objectTest=isObject(input)&&!isObjectEmpty(input),propertyTest=false,properties=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,property;for(i=0;i<properties.length;i+=1){property=properties[i];propertyTest=propertyTest||hasOwnProp(input,property)}return objectTest&&propertyTest}function isNumberOrStringArray(input){var arrayTest=isArray(input),dataTypeTest=false;if(arrayTest){dataTypeTest=input.filter(function(item){return!isNumber(item)&&isString(input)}).length===0}return arrayTest&&dataTypeTest}function isCalendarSpec(input){var objectTest=isObject(input)&&!isObjectEmpty(input),propertyTest=false,properties=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,property;for(i=0;i<properties.length;i+=1){property=properties[i];propertyTest=propertyTest||hasOwnProp(input,property)}return objectTest&&propertyTest}function getCalendarFormat(myMoment,now){var diff=myMoment.diff(now,"days",true);return diff<-6?"sameElse":diff<-1?"lastWeek":diff<0?"lastDay":diff<1?"sameDay":diff<2?"nextDay":diff<7?"nextWeek":"sameElse"}function calendar$1(time,formats){if(arguments.length===1){if(!arguments[0]){time=undefined;formats=undefined}else if(isMomentInput(arguments[0])){time=arguments[0];formats=undefined}else if(isCalendarSpec(arguments[0])){formats=arguments[0];time=undefined}}var now=time||createLocal(),sod=cloneWithOffset(now,this).startOf("day"),format=hooks.calendarFormat(this,sod)||"sameElse",output=formats&&(isFunction(formats[format])?formats[format].call(this,now):formats[format]);return this.format(output||this.localeData().calendar(format,this,createLocal(now)))}function clone(){return new Moment(this)}function isAfter(input,units){var localInput=isMoment(input)?input:createLocal(input);if(!(this.isValid()&&localInput.isValid())){return false}units=normalizeUnits(units)||"millisecond";if(units==="millisecond"){return this.valueOf()>localInput.valueOf()}else{return localInput.valueOf()<this.clone().startOf(units).valueOf()}}function isBefore(input,units){var localInput=isMoment(input)?input:createLocal(input);if(!(this.isValid()&&localInput.isValid())){return false}units=normalizeUnits(units)||"millisecond";if(units==="millisecond"){return this.valueOf()<localInput.valueOf()}else{return this.clone().endOf(units).valueOf()<localInput.valueOf()}}function isBetween(from,to,units,inclusivity){var localFrom=isMoment(from)?from:createLocal(from),localTo=isMoment(to)?to:createLocal(to);if(!(this.isValid()&&localFrom.isValid()&&localTo.isValid())){return false}inclusivity=inclusivity||"()";return(inclusivity[0]==="("?this.isAfter(localFrom,units):!this.isBefore(localFrom,units))&&(inclusivity[1]===")"?this.isBefore(localTo,units):!this.isAfter(localTo,units))}function isSame(input,units){var localInput=isMoment(input)?input:createLocal(input),inputMs;if(!(this.isValid()&&localInput.isValid())){return false}units=normalizeUnits(units)||"millisecond";if(units==="millisecond"){return this.valueOf()===localInput.valueOf()}else{inputMs=localInput.valueOf();return this.clone().startOf(units).valueOf()<=inputMs&&inputMs<=this.clone().endOf(units).valueOf()}}function isSameOrAfter(input,units){return this.isSame(input,units)||this.isAfter(input,units)}function isSameOrBefore(input,units){return this.isSame(input,units)||this.isBefore(input,units)}function diff(input,units,asFloat){var that,zoneDelta,output;if(!this.isValid()){return NaN}that=cloneWithOffset(input,this);if(!that.isValid()){return NaN}zoneDelta=(that.utcOffset()-this.utcOffset())*6e4;units=normalizeUnits(units);switch(units){case"year":output=monthDiff(this,that)/12;break;case"month":output=monthDiff(this,that);break;case"quarter":output=monthDiff(this,that)/3;break;case"second":output=(this-that)/1e3;break;case"minute":output=(this-that)/6e4;break;case"hour":output=(this-that)/36e5;break;case"day":output=(this-that-zoneDelta)/864e5;break;case"week":output=(this-that-zoneDelta)/6048e5;break;default:output=this-that}return asFloat?output:absFloor(output)}function monthDiff(a,b){if(a.date()<b.date()){return-monthDiff(b,a)}var wholeMonthDiff=(b.year()-a.year())*12+(b.month()-a.month()),anchor=a.clone().add(wholeMonthDiff,"months"),anchor2,adjust;if(b-anchor<0){anchor2=a.clone().add(wholeMonthDiff-1,"months");adjust=(b-anchor)/(anchor-anchor2)}else{anchor2=a.clone().add(wholeMonthDiff+1,"months");adjust=(b-anchor)/(anchor2-anchor)}return-(wholeMonthDiff+adjust)||0}hooks.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";hooks.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function toString(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function toISOString(keepOffset){if(!this.isValid()){return null}var utc=keepOffset!==true,m=utc?this.clone().utc():this;if(m.year()<0||m.year()>9999){return formatMoment(m,utc?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ")}if(isFunction(Date.prototype.toISOString)){if(utc){return this.toDate().toISOString()}else{return new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",formatMoment(m,"Z"))}}return formatMoment(m,utc?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function inspect(){if(!this.isValid()){return"moment.invalid(/* "+this._i+" */)"}var func="moment",zone="",prefix,year,datetime,suffix;if(!this.isLocal()){func=this.utcOffset()===0?"moment.utc":"moment.parseZone";zone="Z"}prefix="["+func+'("]';year=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY";datetime="-MM-DD[T]HH:mm:ss.SSS";suffix=zone+'[")]';return this.format(prefix+year+datetime+suffix)}function format(inputString){if(!inputString){inputString=this.isUtc()?hooks.defaultFormatUtc:hooks.defaultFormat}var output=formatMoment(this,inputString);return this.localeData().postformat(output)}function from(time,withoutSuffix){if(this.isValid()&&(isMoment(time)&&time.isValid()||createLocal(time).isValid())){return createDuration({to:this,from:time}).locale(this.locale()).humanize(!withoutSuffix)}else{return this.localeData().invalidDate()}}function fromNow(withoutSuffix){return this.from(createLocal(),withoutSuffix)}function to(time,withoutSuffix){if(this.isValid()&&(isMoment(time)&&time.isValid()||createLocal(time).isValid())){return createDuration({from:this,to:time}).locale(this.locale()).humanize(!withoutSuffix)}else{return this.localeData().invalidDate()}}function toNow(withoutSuffix){return this.to(createLocal(),withoutSuffix)}function locale(key){var newLocaleData;if(key===undefined){return this._locale._abbr}else{newLocaleData=getLocale(key);if(newLocaleData!=null){this._locale=newLocaleData}return this}}var lang=deprecate("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(key){if(key===undefined){return this.localeData()}else{return this.locale(key)}});function localeData(){return this._locale}var MS_PER_SECOND=1e3,MS_PER_MINUTE=60*MS_PER_SECOND,MS_PER_HOUR=60*MS_PER_MINUTE,MS_PER_400_YEARS=(365*400+97)*24*MS_PER_HOUR;function mod$1(dividend,divisor){return(dividend%divisor+divisor)%divisor}function localStartOfDate(y,m,d){if(y<100&&y>=0){return new Date(y+400,m,d)-MS_PER_400_YEARS}else{return new Date(y,m,d).valueOf()}}function utcStartOfDate(y,m,d){if(y<100&&y>=0){return Date.UTC(y+400,m,d)-MS_PER_400_YEARS}else{return Date.UTC(y,m,d)}}function startOf(units){var time,startOfDate;units=normalizeUnits(units);if(units===undefined||units==="millisecond"||!this.isValid()){return this}startOfDate=this._isUTC?utcStartOfDate:localStartOfDate;switch(units){case"year":time=startOfDate(this.year(),0,1);break;case"quarter":time=startOfDate(this.year(),this.month()-this.month()%3,1);break;case"month":time=startOfDate(this.year(),this.month(),1);break;case"week":time=startOfDate(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":time=startOfDate(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":time=startOfDate(this.year(),this.month(),this.date());break;case"hour":time=this._d.valueOf();time-=mod$1(time+(this._isUTC?0:this.utcOffset()*MS_PER_MINUTE),MS_PER_HOUR);break;case"minute":time=this._d.valueOf();time-=mod$1(time,MS_PER_MINUTE);break;case"second":time=this._d.valueOf();time-=mod$1(time,MS_PER_SECOND);break}this._d.setTime(time);hooks.updateOffset(this,true);return this}function endOf(units){var time,startOfDate;units=normalizeUnits(units);if(units===undefined||units==="millisecond"||!this.isValid()){return this}startOfDate=this._isUTC?utcStartOfDate:localStartOfDate;switch(units){case"year":time=startOfDate(this.year()+1,0,1)-1;break;case"quarter":time=startOfDate(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":time=startOfDate(this.year(),this.month()+1,1)-1;break;case"week":time=startOfDate(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":time=startOfDate(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":time=startOfDate(this.year(),this.month(),this.date()+1)-1;break;case"hour":time=this._d.valueOf();time+=MS_PER_HOUR-mod$1(time+(this._isUTC?0:this.utcOffset()*MS_PER_MINUTE),MS_PER_HOUR)-1;break;case"minute":time=this._d.valueOf();time+=MS_PER_MINUTE-mod$1(time,MS_PER_MINUTE)-1;break;case"second":time=this._d.valueOf();time+=MS_PER_SECOND-mod$1(time,MS_PER_SECOND)-1;break}this._d.setTime(time);hooks.updateOffset(this,true);return this}function valueOf(){return this._d.valueOf()-(this._offset||0)*6e4}function unix(){return Math.floor(this.valueOf()/1e3)}function toDate(){return new Date(this.valueOf())}function toArray(){var m=this;return[m.year(),m.month(),m.date(),m.hour(),m.minute(),m.second(),m.millisecond()]}function toObject(){var m=this;return{years:m.year(),months:m.month(),date:m.date(),hours:m.hours(),minutes:m.minutes(),seconds:m.seconds(),milliseconds:m.milliseconds()}}function toJSON(){return this.isValid()?this.toISOString():null}function isValid$2(){return isValid(this)}function parsingFlags(){return extend({},getParsingFlags(this))}function invalidAt(){return getParsingFlags(this).overflow}function creationData(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}addFormatToken("N",0,0,"eraAbbr");addFormatToken("NN",0,0,"eraAbbr");addFormatToken("NNN",0,0,"eraAbbr");addFormatToken("NNNN",0,0,"eraName");addFormatToken("NNNNN",0,0,"eraNarrow");addFormatToken("y",["y",1],"yo","eraYear");addFormatToken("y",["yy",2],0,"eraYear");addFormatToken("y",["yyy",3],0,"eraYear");addFormatToken("y",["yyyy",4],0,"eraYear");addRegexToken("N",matchEraAbbr);addRegexToken("NN",matchEraAbbr);addRegexToken("NNN",matchEraAbbr);addRegexToken("NNNN",matchEraName);addRegexToken("NNNNN",matchEraNarrow);addParseToken(["N","NN","NNN","NNNN","NNNNN"],function(input,array,config,token){var era=config._locale.erasParse(input,token,config._strict);if(era){getParsingFlags(config).era=era}else{getParsingFlags(config).invalidEra=input}});addRegexToken("y",matchUnsigned);addRegexToken("yy",matchUnsigned);addRegexToken("yyy",matchUnsigned);addRegexToken("yyyy",matchUnsigned);addRegexToken("yo",matchEraYearOrdinal);addParseToken(["y","yy","yyy","yyyy"],YEAR);addParseToken(["yo"],function(input,array,config,token){var match;if(config._locale._eraYearOrdinalRegex){match=input.match(config._locale._eraYearOrdinalRegex)}if(config._locale.eraYearOrdinalParse){array[YEAR]=config._locale.eraYearOrdinalParse(input,match)}else{array[YEAR]=parseInt(input,10)}});function localeEras(m,format){var i,l,date,eras=this._eras||getLocale("en")._eras;for(i=0,l=eras.length;i<l;++i){switch(typeof eras[i].since){case"string":date=hooks(eras[i].since).startOf("day");eras[i].since=date.valueOf();break}switch(typeof eras[i].until){case"undefined":eras[i].until=+Infinity;break;case"string":date=hooks(eras[i].until).startOf("day").valueOf();eras[i].until=date.valueOf();break}}return eras}function localeErasParse(eraName,format,strict){var i,l,eras=this.eras(),name,abbr,narrow;eraName=eraName.toUpperCase();for(i=0,l=eras.length;i<l;++i){name=eras[i].name.toUpperCase();abbr=eras[i].abbr.toUpperCase();narrow=eras[i].narrow.toUpperCase();if(strict){switch(format){case"N":case"NN":case"NNN":if(abbr===eraName){return eras[i]}break;case"NNNN":if(name===eraName){return eras[i]}break;case"NNNNN":if(narrow===eraName){return eras[i]}break}}else if([name,abbr,narrow].indexOf(eraName)>=0){return eras[i]}}}function localeErasConvertYear(era,year){var dir=era.since<=era.until?+1:-1;if(year===undefined){return hooks(era.since).year()}else{return hooks(era.since).year()+(year-era.offset)*dir}}function getEraName(){var i,l,val,eras=this.localeData().eras();for(i=0,l=eras.length;i<l;++i){val=this.clone().startOf("day").valueOf();if(eras[i].since<=val&&val<=eras[i].until){return eras[i].name}if(eras[i].until<=val&&val<=eras[i].since){return eras[i].name}}return""}function getEraNarrow(){var i,l,val,eras=this.localeData().eras();for(i=0,l=eras.length;i<l;++i){val=this.clone().startOf("day").valueOf();if(eras[i].since<=val&&val<=eras[i].until){return eras[i].narrow}if(eras[i].until<=val&&val<=eras[i].since){return eras[i].narrow}}return""}function getEraAbbr(){var i,l,val,eras=this.localeData().eras();for(i=0,l=eras.length;i<l;++i){val=this.clone().startOf("day").valueOf();if(eras[i].since<=val&&val<=eras[i].until){return eras[i].abbr}if(eras[i].until<=val&&val<=eras[i].since){return eras[i].abbr}}return""}function getEraYear(){var i,l,dir,val,eras=this.localeData().eras();for(i=0,l=eras.length;i<l;++i){dir=eras[i].since<=eras[i].until?+1:-1;val=this.clone().startOf("day").valueOf();if(eras[i].since<=val&&val<=eras[i].until||eras[i].until<=val&&val<=eras[i].since){return(this.year()-hooks(eras[i].since).year())*dir+eras[i].offset}}return this.year()}function erasNameRegex(isStrict){if(!hasOwnProp(this,"_erasNameRegex")){computeErasParse.call(this)}return isStrict?this._erasNameRegex:this._erasRegex}function erasAbbrRegex(isStrict){if(!hasOwnProp(this,"_erasAbbrRegex")){computeErasParse.call(this)}return isStrict?this._erasAbbrRegex:this._erasRegex}function erasNarrowRegex(isStrict){if(!hasOwnProp(this,"_erasNarrowRegex")){computeErasParse.call(this)}return isStrict?this._erasNarrowRegex:this._erasRegex}function matchEraAbbr(isStrict,locale){return locale.erasAbbrRegex(isStrict)}function matchEraName(isStrict,locale){return locale.erasNameRegex(isStrict)}function matchEraNarrow(isStrict,locale){return locale.erasNarrowRegex(isStrict)}function matchEraYearOrdinal(isStrict,locale){return locale._eraYearOrdinalRegex||matchUnsigned}function computeErasParse(){var abbrPieces=[],namePieces=[],narrowPieces=[],mixedPieces=[],i,l,eras=this.eras();for(i=0,l=eras.length;i<l;++i){namePieces.push(regexEscape(eras[i].name));abbrPieces.push(regexEscape(eras[i].abbr));narrowPieces.push(regexEscape(eras[i].narrow));mixedPieces.push(regexEscape(eras[i].name));mixedPieces.push(regexEscape(eras[i].abbr));mixedPieces.push(regexEscape(eras[i].narrow))}this._erasRegex=new RegExp("^("+mixedPieces.join("|")+")","i");this._erasNameRegex=new RegExp("^("+namePieces.join("|")+")","i");this._erasAbbrRegex=new RegExp("^("+abbrPieces.join("|")+")","i");this._erasNarrowRegex=new RegExp("^("+narrowPieces.join("|")+")","i")}addFormatToken(0,["gg",2],0,function(){return this.weekYear()%100});addFormatToken(0,["GG",2],0,function(){return this.isoWeekYear()%100});function addWeekYearFormatToken(token,getter){addFormatToken(0,[token,token.length],0,getter)}addWeekYearFormatToken("gggg","weekYear");addWeekYearFormatToken("ggggg","weekYear");addWeekYearFormatToken("GGGG","isoWeekYear");addWeekYearFormatToken("GGGGG","isoWeekYear");addUnitAlias("weekYear","gg");addUnitAlias("isoWeekYear","GG");addUnitPriority("weekYear",1);addUnitPriority("isoWeekYear",1);addRegexToken("G",matchSigned);addRegexToken("g",matchSigned);addRegexToken("GG",match1to2,match2);addRegexToken("gg",match1to2,match2);addRegexToken("GGGG",match1to4,match4);addRegexToken("gggg",match1to4,match4);addRegexToken("GGGGG",match1to6,match6);addRegexToken("ggggg",match1to6,match6);addWeekParseToken(["gggg","ggggg","GGGG","GGGGG"],function(input,week,config,token){week[token.substr(0,2)]=toInt(input)});addWeekParseToken(["gg","GG"],function(input,week,config,token){week[token]=hooks.parseTwoDigitYear(input)});function getSetWeekYear(input){return getSetWeekYearHelper.call(this,input,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function getSetISOWeekYear(input){return getSetWeekYearHelper.call(this,input,this.isoWeek(),this.isoWeekday(),1,4)}function getISOWeeksInYear(){return weeksInYear(this.year(),1,4)}function getISOWeeksInISOWeekYear(){return weeksInYear(this.isoWeekYear(),1,4)}function getWeeksInYear(){var weekInfo=this.localeData()._week;return weeksInYear(this.year(),weekInfo.dow,weekInfo.doy)}function getWeeksInWeekYear(){var weekInfo=this.localeData()._week;return weeksInYear(this.weekYear(),weekInfo.dow,weekInfo.doy)}function getSetWeekYearHelper(input,week,weekday,dow,doy){var weeksTarget;if(input==null){return weekOfYear(this,dow,doy).year}else{weeksTarget=weeksInYear(input,dow,doy);if(week>weeksTarget){week=weeksTarget}return setWeekAll.call(this,input,week,weekday,dow,doy)}}function setWeekAll(weekYear,week,weekday,dow,doy){var dayOfYearData=dayOfYearFromWeeks(weekYear,week,weekday,dow,doy),date=createUTCDate(dayOfYearData.year,0,dayOfYearData.dayOfYear);this.year(date.getUTCFullYear());this.month(date.getUTCMonth());this.date(date.getUTCDate());return this}addFormatToken("Q",0,"Qo","quarter");addUnitAlias("quarter","Q");addUnitPriority("quarter",7);addRegexToken("Q",match1);addParseToken("Q",function(input,array){array[MONTH]=(toInt(input)-1)*3});function getSetQuarter(input){return input==null?Math.ceil((this.month()+1)/3):this.month((input-1)*3+this.month()%3)}addFormatToken("D",["DD",2],"Do","date");addUnitAlias("date","D");addUnitPriority("date",9);addRegexToken("D",match1to2);addRegexToken("DD",match1to2,match2);addRegexToken("Do",function(isStrict,locale){return isStrict?locale._dayOfMonthOrdinalParse||locale._ordinalParse:locale._dayOfMonthOrdinalParseLenient});addParseToken(["D","DD"],DATE);addParseToken("Do",function(input,array){array[DATE]=toInt(input.match(match1to2)[0])});var getSetDayOfMonth=makeGetSet("Date",true);addFormatToken("DDD",["DDDD",3],"DDDo","dayOfYear");addUnitAlias("dayOfYear","DDD");addUnitPriority("dayOfYear",4);addRegexToken("DDD",match1to3);addRegexToken("DDDD",match3);addParseToken(["DDD","DDDD"],function(input,array,config){config._dayOfYear=toInt(input)});function getSetDayOfYear(input){var dayOfYear=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return input==null?dayOfYear:this.add(input-dayOfYear,"d")}addFormatToken("m",["mm",2],0,"minute");addUnitAlias("minute","m");addUnitPriority("minute",14);addRegexToken("m",match1to2);addRegexToken("mm",match1to2,match2);addParseToken(["m","mm"],MINUTE);var getSetMinute=makeGetSet("Minutes",false);addFormatToken("s",["ss",2],0,"second");addUnitAlias("second","s");addUnitPriority("second",15);addRegexToken("s",match1to2);addRegexToken("ss",match1to2,match2);addParseToken(["s","ss"],SECOND);var getSetSecond=makeGetSet("Seconds",false);addFormatToken("S",0,0,function(){return~~(this.millisecond()/100)});addFormatToken(0,["SS",2],0,function(){return~~(this.millisecond()/10)});addFormatToken(0,["SSS",3],0,"millisecond");addFormatToken(0,["SSSS",4],0,function(){return this.millisecond()*10});addFormatToken(0,["SSSSS",5],0,function(){return this.millisecond()*100});addFormatToken(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});addFormatToken(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});addFormatToken(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});addFormatToken(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});addUnitAlias("millisecond","ms");addUnitPriority("millisecond",16);addRegexToken("S",match1to3,match1);addRegexToken("SS",match1to3,match2);addRegexToken("SSS",match1to3,match3);var token,getSetMillisecond;for(token="SSSS";token.length<=9;token+="S"){addRegexToken(token,matchUnsigned)}function parseMs(input,array){array[MILLISECOND]=toInt(("0."+input)*1e3)}for(token="S";token.length<=9;token+="S"){addParseToken(token,parseMs)}getSetMillisecond=makeGetSet("Milliseconds",false);addFormatToken("z",0,0,"zoneAbbr");addFormatToken("zz",0,0,"zoneName");function getZoneAbbr(){return this._isUTC?"UTC":""}function getZoneName(){return this._isUTC?"Coordinated Universal Time":""}var proto=Moment.prototype;proto.add=add;proto.calendar=calendar$1;proto.clone=clone;proto.diff=diff;proto.endOf=endOf;proto.format=format;proto.from=from;proto.fromNow=fromNow;proto.to=to;proto.toNow=toNow;proto.get=stringGet;proto.invalidAt=invalidAt;proto.isAfter=isAfter;proto.isBefore=isBefore;proto.isBetween=isBetween;proto.isSame=isSame;proto.isSameOrAfter=isSameOrAfter;proto.isSameOrBefore=isSameOrBefore;proto.isValid=isValid$2;proto.lang=lang;proto.locale=locale;proto.localeData=localeData;proto.max=prototypeMax;proto.min=prototypeMin;proto.parsingFlags=parsingFlags;proto.set=stringSet;proto.startOf=startOf;proto.subtract=subtract;proto.toArray=toArray;proto.toObject=toObject;proto.toDate=toDate;proto.toISOString=toISOString;proto.inspect=inspect;if(typeof Symbol!=="undefined"&&Symbol.for!=null){proto[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}}proto.toJSON=toJSON;proto.toString=toString;proto.unix=unix;proto.valueOf=valueOf;proto.creationData=creationData;proto.eraName=getEraName;proto.eraNarrow=getEraNarrow;proto.eraAbbr=getEraAbbr;proto.eraYear=getEraYear;proto.year=getSetYear;proto.isLeapYear=getIsLeapYear;proto.weekYear=getSetWeekYear;proto.isoWeekYear=getSetISOWeekYear;proto.quarter=proto.quarters=getSetQuarter;proto.month=getSetMonth;proto.daysInMonth=getDaysInMonth;proto.week=proto.weeks=getSetWeek;proto.isoWeek=proto.isoWeeks=getSetISOWeek;proto.weeksInYear=getWeeksInYear;proto.weeksInWeekYear=getWeeksInWeekYear;proto.isoWeeksInYear=getISOWeeksInYear;proto.isoWeeksInISOWeekYear=getISOWeeksInISOWeekYear;proto.date=getSetDayOfMonth;proto.day=proto.days=getSetDayOfWeek;proto.weekday=getSetLocaleDayOfWeek;proto.isoWeekday=getSetISODayOfWeek;proto.dayOfYear=getSetDayOfYear;proto.hour=proto.hours=getSetHour;proto.minute=proto.minutes=getSetMinute;proto.second=proto.seconds=getSetSecond;proto.millisecond=proto.milliseconds=getSetMillisecond;proto.utcOffset=getSetOffset;proto.utc=setOffsetToUTC;proto.local=setOffsetToLocal;proto.parseZone=setOffsetToParsedOffset;proto.hasAlignedHourOffset=hasAlignedHourOffset;proto.isDST=isDaylightSavingTime;proto.isLocal=isLocal;proto.isUtcOffset=isUtcOffset;proto.isUtc=isUtc;proto.isUTC=isUtc;proto.zoneAbbr=getZoneAbbr;proto.zoneName=getZoneName;proto.dates=deprecate("dates accessor is deprecated. Use date instead.",getSetDayOfMonth);proto.months=deprecate("months accessor is deprecated. Use month instead",getSetMonth);proto.years=deprecate("years accessor is deprecated. Use year instead",getSetYear);proto.zone=deprecate("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",getSetZone);proto.isDSTShifted=deprecate("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",isDaylightSavingTimeShifted);function createUnix(input){return createLocal(input*1e3)}function createInZone(){return createLocal.apply(null,arguments).parseZone()}function preParsePostFormat(string){return string}var proto$1=Locale.prototype;proto$1.calendar=calendar;proto$1.longDateFormat=longDateFormat;proto$1.invalidDate=invalidDate;proto$1.ordinal=ordinal;proto$1.preparse=preParsePostFormat;proto$1.postformat=preParsePostFormat;proto$1.relativeTime=relativeTime;proto$1.pastFuture=pastFuture;proto$1.set=set;proto$1.eras=localeEras;proto$1.erasParse=localeErasParse;proto$1.erasConvertYear=localeErasConvertYear;proto$1.erasAbbrRegex=erasAbbrRegex;proto$1.erasNameRegex=erasNameRegex;proto$1.erasNarrowRegex=erasNarrowRegex;proto$1.months=localeMonths;proto$1.monthsShort=localeMonthsShort;proto$1.monthsParse=localeMonthsParse;proto$1.monthsRegex=monthsRegex;proto$1.monthsShortRegex=monthsShortRegex;proto$1.week=localeWeek;proto$1.firstDayOfYear=localeFirstDayOfYear;proto$1.firstDayOfWeek=localeFirstDayOfWeek;proto$1.weekdays=localeWeekdays;proto$1.weekdaysMin=localeWeekdaysMin;proto$1.weekdaysShort=localeWeekdaysShort;proto$1.weekdaysParse=localeWeekdaysParse;proto$1.weekdaysRegex=weekdaysRegex;proto$1.weekdaysShortRegex=weekdaysShortRegex;proto$1.weekdaysMinRegex=weekdaysMinRegex;proto$1.isPM=localeIsPM;proto$1.meridiem=localeMeridiem;function get$1(format,index,field,setter){var locale=getLocale(),utc=createUTC().set(setter,index);return locale[field](utc,format)}function listMonthsImpl(format,index,field){if(isNumber(format)){index=format;format=undefined}format=format||"";if(index!=null){return get$1(format,index,field,"month")}var i,out=[];for(i=0;i<12;i++){out[i]=get$1(format,i,field,"month")}return out}function listWeekdaysImpl(localeSorted,format,index,field){if(typeof localeSorted==="boolean"){if(isNumber(format)){index=format;format=undefined}format=format||""}else{format=localeSorted;index=format;localeSorted=false;if(isNumber(format)){index=format;format=undefined}format=format||""}var locale=getLocale(),shift=localeSorted?locale._week.dow:0,i,out=[];if(index!=null){return get$1(format,(index+shift)%7,field,"day")}for(i=0;i<7;i++){out[i]=get$1(format,(i+shift)%7,field,"day")}return out}function listMonths(format,index){return listMonthsImpl(format,index,"months")}function listMonthsShort(format,index){return listMonthsImpl(format,index,"monthsShort")}function listWeekdays(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdays")}function listWeekdaysShort(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdaysShort")}function listWeekdaysMin(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdaysMin")}getSetGlobalLocale("en",{eras:[{since:"0001-01-01",until:+Infinity,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-Infinity,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(number){var b=number%10,output=toInt(number%100/10)===1?"th":b===1?"st":b===2?"nd":b===3?"rd":"th";return number+output}});hooks.lang=deprecate("moment.lang is deprecated. Use moment.locale instead.",getSetGlobalLocale);hooks.langData=deprecate("moment.langData is deprecated. Use moment.localeData instead.",getLocale);var mathAbs=Math.abs;function abs(){var data=this._data;this._milliseconds=mathAbs(this._milliseconds);this._days=mathAbs(this._days);this._months=mathAbs(this._months);data.milliseconds=mathAbs(data.milliseconds);data.seconds=mathAbs(data.seconds);data.minutes=mathAbs(data.minutes);data.hours=mathAbs(data.hours);data.months=mathAbs(data.months);data.years=mathAbs(data.years);return this}function addSubtract$1(duration,input,value,direction){var other=createDuration(input,value);duration._milliseconds+=direction*other._milliseconds;duration._days+=direction*other._days;duration._months+=direction*other._months;return duration._bubble()}function add$1(input,value){return addSubtract$1(this,input,value,1)}function subtract$1(input,value){return addSubtract$1(this,input,value,-1)}function absCeil(number){if(number<0){return Math.floor(number)}else{return Math.ceil(number)}}function bubble(){var milliseconds=this._milliseconds,days=this._days,months=this._months,data=this._data,seconds,minutes,hours,years,monthsFromDays;if(!(milliseconds>=0&&days>=0&&months>=0||milliseconds<=0&&days<=0&&months<=0)){milliseconds+=absCeil(monthsToDays(months)+days)*864e5;days=0;months=0}data.milliseconds=milliseconds%1e3;seconds=absFloor(milliseconds/1e3);data.seconds=seconds%60;minutes=absFloor(seconds/60);data.minutes=minutes%60;hours=absFloor(minutes/60);data.hours=hours%24;days+=absFloor(hours/24);monthsFromDays=absFloor(daysToMonths(days));months+=monthsFromDays;days-=absCeil(monthsToDays(monthsFromDays));years=absFloor(months/12);months%=12;data.days=days;data.months=months;data.years=years;return this}function daysToMonths(days){return days*4800/146097}function monthsToDays(months){return months*146097/4800}function as(units){if(!this.isValid()){return NaN}var days,months,milliseconds=this._milliseconds;units=normalizeUnits(units);if(units==="month"||units==="quarter"||units==="year"){days=this._days+milliseconds/864e5;months=this._months+daysToMonths(days);switch(units){case"month":return months;case"quarter":return months/3;case"year":return months/12}}else{days=this._days+Math.round(monthsToDays(this._months));switch(units){case"week":return days/7+milliseconds/6048e5;case"day":return days+milliseconds/864e5;case"hour":return days*24+milliseconds/36e5;case"minute":return days*1440+milliseconds/6e4;case"second":return days*86400+milliseconds/1e3;case"millisecond":return Math.floor(days*864e5)+milliseconds;default:throw new Error("Unknown unit "+units)}}}function valueOf$1(){if(!this.isValid()){return NaN}return this._milliseconds+this._days*864e5+this._months%12*2592e6+toInt(this._months/12)*31536e6}function makeAs(alias){return function(){return this.as(alias)}}var asMilliseconds=makeAs("ms"),asSeconds=makeAs("s"),asMinutes=makeAs("m"),asHours=makeAs("h"),asDays=makeAs("d"),asWeeks=makeAs("w"),asMonths=makeAs("M"),asQuarters=makeAs("Q"),asYears=makeAs("y");function clone$1(){return createDuration(this)}function get$2(units){units=normalizeUnits(units);return this.isValid()?this[units+"s"]():NaN}function makeGetter(name){return function(){return this.isValid()?this._data[name]:NaN}}var milliseconds=makeGetter("milliseconds"),seconds=makeGetter("seconds"),minutes=makeGetter("minutes"),hours=makeGetter("hours"),days=makeGetter("days"),months=makeGetter("months"),years=makeGetter("years");function weeks(){return absFloor(this.days()/7)}var round=Math.round,thresholds={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function substituteTimeAgo(string,number,withoutSuffix,isFuture,locale){return locale.relativeTime(number||1,!!withoutSuffix,string,isFuture)}function relativeTime$1(posNegDuration,withoutSuffix,thresholds,locale){var duration=createDuration(posNegDuration).abs(),seconds=round(duration.as("s")),minutes=round(duration.as("m")),hours=round(duration.as("h")),days=round(duration.as("d")),months=round(duration.as("M")),weeks=round(duration.as("w")),years=round(duration.as("y")),a=seconds<=thresholds.ss&&["s",seconds]||seconds<thresholds.s&&["ss",seconds]||minutes<=1&&["m"]||minutes<thresholds.m&&["mm",minutes]||hours<=1&&["h"]||hours<thresholds.h&&["hh",hours]||days<=1&&["d"]||days<thresholds.d&&["dd",days];if(thresholds.w!=null){a=a||weeks<=1&&["w"]||weeks<thresholds.w&&["ww",weeks]}a=a||months<=1&&["M"]||months<thresholds.M&&["MM",months]||years<=1&&["y"]||["yy",years];a[2]=withoutSuffix;a[3]=+posNegDuration>0;a[4]=locale;return substituteTimeAgo.apply(null,a)}function getSetRelativeTimeRounding(roundingFunction){if(roundingFunction===undefined){return round}if(typeof roundingFunction==="function"){round=roundingFunction;return true}return false}function getSetRelativeTimeThreshold(threshold,limit){if(thresholds[threshold]===undefined){return false}if(limit===undefined){return thresholds[threshold]}thresholds[threshold]=limit;if(threshold==="s"){thresholds.ss=limit-1}return true}function humanize(argWithSuffix,argThresholds){if(!this.isValid()){return this.localeData().invalidDate()}var withSuffix=false,th=thresholds,locale,output;if(typeof argWithSuffix==="object"){argThresholds=argWithSuffix;argWithSuffix=false}if(typeof argWithSuffix==="boolean"){withSuffix=argWithSuffix}if(typeof argThresholds==="object"){th=Object.assign({},thresholds,argThresholds);if(argThresholds.s!=null&&argThresholds.ss==null){th.ss=argThresholds.s-1}}locale=this.localeData();output=relativeTime$1(this,!withSuffix,th,locale);if(withSuffix){output=locale.pastFuture(+this,output)}return locale.postformat(output)}var abs$1=Math.abs;function sign(x){return(x>0)-(x<0)||+x}function toISOString$1(){if(!this.isValid()){return this.localeData().invalidDate()}var seconds=abs$1(this._milliseconds)/1e3,days=abs$1(this._days),months=abs$1(this._months),minutes,hours,years,s,total=this.asSeconds(),totalSign,ymSign,daysSign,hmsSign;if(!total){return"P0D"}minutes=absFloor(seconds/60);hours=absFloor(minutes/60);seconds%=60;minutes%=60;years=absFloor(months/12);months%=12;s=seconds?seconds.toFixed(3).replace(/\.?0+$/,""):"";totalSign=total<0?"-":"";ymSign=sign(this._months)!==sign(total)?"-":"";daysSign=sign(this._days)!==sign(total)?"-":"";hmsSign=sign(this._milliseconds)!==sign(total)?"-":"";return totalSign+"P"+(years?ymSign+years+"Y":"")+(months?ymSign+months+"M":"")+(days?daysSign+days+"D":"")+(hours||minutes||seconds?"T":"")+(hours?hmsSign+hours+"H":"")+(minutes?hmsSign+minutes+"M":"")+(seconds?hmsSign+s+"S":"")}var proto$2=Duration.prototype;proto$2.isValid=isValid$1;proto$2.abs=abs;proto$2.add=add$1;proto$2.subtract=subtract$1;proto$2.as=as;proto$2.asMilliseconds=asMilliseconds;proto$2.asSeconds=asSeconds;proto$2.asMinutes=asMinutes;proto$2.asHours=asHours;proto$2.asDays=asDays;proto$2.asWeeks=asWeeks;proto$2.asMonths=asMonths;proto$2.asQuarters=asQuarters;proto$2.asYears=asYears;proto$2.valueOf=valueOf$1;proto$2._bubble=bubble;proto$2.clone=clone$1;proto$2.get=get$2;proto$2.milliseconds=milliseconds;proto$2.seconds=seconds;proto$2.minutes=minutes;proto$2.hours=hours;proto$2.days=days;proto$2.weeks=weeks;proto$2.months=months;proto$2.years=years;proto$2.humanize=humanize;proto$2.toISOString=toISOString$1;proto$2.toString=toISOString$1;proto$2.toJSON=toISOString$1;proto$2.locale=locale;proto$2.localeData=localeData;proto$2.toIsoString=deprecate("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",toISOString$1);proto$2.lang=lang;addFormatToken("X",0,0,"unix");addFormatToken("x",0,0,"valueOf");addRegexToken("x",matchSigned);addRegexToken("X",matchTimestamp);addParseToken("X",function(input,array,config){config._d=new Date(parseFloat(input)*1e3)});addParseToken("x",function(input,array,config){config._d=new Date(toInt(input))});hooks.version="2.29.1";setHookCallback(createLocal);hooks.fn=proto;hooks.min=min;hooks.max=max;hooks.now=now;hooks.utc=createUTC;hooks.unix=createUnix;hooks.months=listMonths;hooks.isDate=isDate;hooks.locale=getSetGlobalLocale;hooks.invalid=createInvalid;hooks.duration=createDuration;hooks.isMoment=isMoment;hooks.weekdays=listWeekdays;hooks.parseZone=createInZone;hooks.localeData=getLocale;hooks.isDuration=isDuration;hooks.monthsShort=listMonthsShort;hooks.weekdaysMin=listWeekdaysMin;hooks.defineLocale=defineLocale;hooks.updateLocale=updateLocale;hooks.locales=listLocales;hooks.weekdaysShort=listWeekdaysShort;hooks.normalizeUnits=normalizeUnits;hooks.relativeTimeRounding=getSetRelativeTimeRounding;hooks.relativeTimeThreshold=getSetRelativeTimeThreshold;hooks.calendarFormat=getCalendarFormat;hooks.prototype=proto;hooks.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};return hooks})},{}],172:[function(require,module,exports){var process=module.exports={};var cachedSetTimeout;var cachedClearTimeout;function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){cachedSetTimeout=setTimeout}else{cachedSetTimeout=defaultSetTimout}}catch(e){cachedSetTimeout=defaultSetTimout}try{if(typeof clearTimeout==="function"){cachedClearTimeout=clearTimeout}else{cachedClearTimeout=defaultClearTimeout}}catch(e){cachedClearTimeout=defaultClearTimeout}})();function runTimeout(fun){if(cachedSetTimeout===setTimeout){return setTimeout(fun,0)}if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout){cachedSetTimeout=setTimeout;return setTimeout(fun,0)}try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout){return clearTimeout(marker)}if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout){cachedClearTimeout=clearTimeout;return clearTimeout(marker)}try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}var queue=[];var draining=false;var currentQueue;var queueIndex=-1;function cleanUpNextTick(){if(!draining||!currentQueue){return}draining=false;if(currentQueue.length){queue=currentQueue.concat(queue)}else{queueIndex=-1}if(queue.length){drainQueue()}}function drainQueue(){if(draining){return}var timeout=runTimeout(cleanUpNextTick);draining=true;var len=queue.length;while(len){currentQueue=queue;queue=[];while(++queueIndex<len){if(currentQueue){currentQueue[queueIndex].run()}}queueIndex=-1;len=queue.length}currentQueue=null;draining=false;runClearTimeout(timeout)}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1){for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i]}}queue.push(new Item(fun,args));if(queue.length===1&&!draining){runTimeout(drainQueue)}};function Item(fun,array){this.fun=fun;this.array=array}Item.prototype.run=function(){this.fun.apply(null,this.array)};process.title="browser";process.browser=true;process.env={};process.argv=[];process.version="";process.versions={};function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.prependListener=noop;process.prependOnceListener=noop;process.listeners=function(name){return[]};process.binding=function(name){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported")};process.umask=function(){return 0}},{}],173:[function(require,module,exports){"use strict";var replace=String.prototype.replace;var percentTwenties=/%20/g;var Format={RFC1738:"RFC1738",RFC3986:"RFC3986"};module.exports={default:Format.RFC3986,formatters:{RFC1738:function(value){return replace.call(value,percentTwenties,"+")},RFC3986:function(value){return String(value)}},RFC1738:Format.RFC1738,RFC3986:Format.RFC3986}},{}],174:[function(require,module,exports){"use strict";var stringify=require("./stringify");var parse=require("./parse");var formats=require("./formats");module.exports={formats:formats,parse:parse,stringify:stringify}},{"./formats":173,"./parse":175,"./stringify":176}],175:[function(require,module,exports){"use strict";var utils=require("./utils");var has=Object.prototype.hasOwnProperty;var isArray=Array.isArray;var defaults={allowDots:false,allowPrototypes:false,arrayLimit:20,charset:"utf-8",charsetSentinel:false,comma:false,decoder:utils.decode,delimiter:"&",depth:5,ignoreQueryPrefix:false,interpretNumericEntities:false,parameterLimit:1e3,parseArrays:true,plainObjects:false,strictNullHandling:false};var interpretNumericEntities=function(str){return str.replace(/&#(\d+);/g,function($0,numberStr){return String.fromCharCode(parseInt(numberStr,10))})};var parseArrayValue=function(val,options){if(val&&typeof val==="string"&&options.comma&&val.indexOf(",")>-1){return val.split(",")}return val};var isoSentinel="utf8=%26%2310003%3B";var charsetSentinel="utf8=%E2%9C%93";var parseValues=function parseQueryStringValues(str,options){var obj={};var cleanStr=options.ignoreQueryPrefix?str.replace(/^\?/,""):str;var limit=options.parameterLimit===Infinity?undefined:options.parameterLimit;var parts=cleanStr.split(options.delimiter,limit);var skipIndex=-1;var i;var charset=options.charset;if(options.charsetSentinel){for(i=0;i<parts.length;++i){if(parts[i].indexOf("utf8=")===0){if(parts[i]===charsetSentinel){charset="utf-8"}else if(parts[i]===isoSentinel){charset="iso-8859-1"}skipIndex=i;i=parts.length}}}for(i=0;i<parts.length;++i){if(i===skipIndex){continue}var part=parts[i];var bracketEqualsPos=part.indexOf("]=");var pos=bracketEqualsPos===-1?part.indexOf("="):bracketEqualsPos+1;var key,val;if(pos===-1){key=options.decoder(part,defaults.decoder,charset,"key");val=options.strictNullHandling?null:""}else{key=options.decoder(part.slice(0,pos),defaults.decoder,charset,"key");val=utils.maybeMap(parseArrayValue(part.slice(pos+1),options),function(encodedVal){return options.decoder(encodedVal,defaults.decoder,charset,"value")})}if(val&&options.interpretNumericEntities&&charset==="iso-8859-1"){val=interpretNumericEntities(val)}if(part.indexOf("[]=")>-1){val=isArray(val)?[val]:val}if(has.call(obj,key)){obj[key]=utils.combine(obj[key],val)}else{obj[key]=val}}return obj};var parseObject=function(chain,val,options,valuesParsed){var leaf=valuesParsed?val:parseArrayValue(val,options);for(var i=chain.length-1;i>=0;--i){var obj;var root=chain[i];if(root==="[]"&&options.parseArrays){obj=[].concat(leaf)}else{obj=options.plainObjects?Object.create(null):{};var cleanRoot=root.charAt(0)==="["&&root.charAt(root.length-1)==="]"?root.slice(1,-1):root;var index=parseInt(cleanRoot,10);if(!options.parseArrays&&cleanRoot===""){obj={0:leaf}}else if(!isNaN(index)&&root!==cleanRoot&&String(index)===cleanRoot&&index>=0&&(options.parseArrays&&index<=options.arrayLimit)){obj=[];obj[index]=leaf}else{obj[cleanRoot]=leaf}}leaf=obj}return leaf};var parseKeys=function parseQueryStringKeys(givenKey,val,options,valuesParsed){if(!givenKey){return}var key=options.allowDots?givenKey.replace(/\.([^.[]+)/g,"[$1]"):givenKey;var brackets=/(\[[^[\]]*])/;var child=/(\[[^[\]]*])/g;var segment=options.depth>0&&brackets.exec(key);var parent=segment?key.slice(0,segment.index):key;var keys=[];if(parent){if(!options.plainObjects&&has.call(Object.prototype,parent)){if(!options.allowPrototypes){return}}keys.push(parent)}var i=0;while(options.depth>0&&(segment=child.exec(key))!==null&&i<options.depth){i+=1;if(!options.plainObjects&&has.call(Object.prototype,segment[1].slice(1,-1))){if(!options.allowPrototypes){return}}keys.push(segment[1])}if(segment){keys.push("["+key.slice(segment.index)+"]")}return parseObject(keys,val,options,valuesParsed)};var normalizeParseOptions=function normalizeParseOptions(opts){if(!opts){return defaults}if(opts.decoder!==null&&opts.decoder!==undefined&&typeof opts.decoder!=="function"){throw new TypeError("Decoder has to be a function.")}if(typeof opts.charset!=="undefined"&&opts.charset!=="utf-8"&&opts.charset!=="iso-8859-1"){throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined")}var charset=typeof opts.charset==="undefined"?defaults.charset:opts.charset;return{allowDots:typeof opts.allowDots==="undefined"?defaults.allowDots:!!opts.allowDots,allowPrototypes:typeof opts.allowPrototypes==="boolean"?opts.allowPrototypes:defaults.allowPrototypes,arrayLimit:typeof opts.arrayLimit==="number"?opts.arrayLimit:defaults.arrayLimit,charset:charset,charsetSentinel:typeof opts.charsetSentinel==="boolean"?opts.charsetSentinel:defaults.charsetSentinel,comma:typeof opts.comma==="boolean"?opts.comma:defaults.comma,decoder:typeof opts.decoder==="function"?opts.decoder:defaults.decoder,delimiter:typeof opts.delimiter==="string"||utils.isRegExp(opts.delimiter)?opts.delimiter:defaults.delimiter,depth:typeof opts.depth==="number"||opts.depth===false?+opts.depth:defaults.depth,ignoreQueryPrefix:opts.ignoreQueryPrefix===true,interpretNumericEntities:typeof opts.interpretNumericEntities==="boolean"?opts.interpretNumericEntities:defaults.interpretNumericEntities,parameterLimit:typeof opts.parameterLimit==="number"?opts.parameterLimit:defaults.parameterLimit,parseArrays:opts.parseArrays!==false,plainObjects:typeof opts.plainObjects==="boolean"?opts.plainObjects:defaults.plainObjects,strictNullHandling:typeof opts.strictNullHandling==="boolean"?opts.strictNullHandling:defaults.strictNullHandling}};module.exports=function(str,opts){var options=normalizeParseOptions(opts);if(str===""||str===null||typeof str==="undefined"){return options.plainObjects?Object.create(null):{}}var tempObj=typeof str==="string"?parseValues(str,options):str;var obj=options.plainObjects?Object.create(null):{};var keys=Object.keys(tempObj);for(var i=0;i<keys.length;++i){var key=keys[i];var newObj=parseKeys(key,tempObj[key],options,typeof str==="string");obj=utils.merge(obj,newObj,options)}return utils.compact(obj)}},{"./utils":177}],176:[function(require,module,exports){"use strict";var utils=require("./utils");var formats=require("./formats");var has=Object.prototype.hasOwnProperty;var arrayPrefixGenerators={brackets:function brackets(prefix){return prefix+"[]"},comma:"comma",indices:function indices(prefix,key){return prefix+"["+key+"]"},repeat:function repeat(prefix){return prefix}};var isArray=Array.isArray;var push=Array.prototype.push;var pushToArray=function(arr,valueOrArray){push.apply(arr,isArray(valueOrArray)?valueOrArray:[valueOrArray])};var toISO=Date.prototype.toISOString;var defaultFormat=formats["default"];var defaults={addQueryPrefix:false,allowDots:false,charset:"utf-8",charsetSentinel:false,delimiter:"&",encode:true,encoder:utils.encode,encodeValuesOnly:false,format:defaultFormat,formatter:formats.formatters[defaultFormat],indices:false,serializeDate:function serializeDate(date){return toISO.call(date)},skipNulls:false,strictNullHandling:false};var isNonNullishPrimitive=function isNonNullishPrimitive(v){return typeof v==="string"||typeof v==="number"||typeof v==="boolean"||typeof v==="symbol"||typeof v==="bigint"};var stringify=function stringify(object,prefix,generateArrayPrefix,strictNullHandling,skipNulls,encoder,filter,sort,allowDots,serializeDate,format,formatter,encodeValuesOnly,charset){var obj=object;if(typeof filter==="function"){obj=filter(prefix,obj)}else if(obj instanceof Date){obj=serializeDate(obj)}else if(generateArrayPrefix==="comma"&&isArray(obj)){obj=utils.maybeMap(obj,function(value){if(value instanceof Date){return serializeDate(value)}return value})}if(obj===null){if(strictNullHandling){return encoder&&!encodeValuesOnly?encoder(prefix,defaults.encoder,charset,"key",format):prefix}obj=""}if(isNonNullishPrimitive(obj)||utils.isBuffer(obj)){if(encoder){var keyValue=encodeValuesOnly?prefix:encoder(prefix,defaults.encoder,charset,"key",format);return[formatter(keyValue)+"="+formatter(encoder(obj,defaults.encoder,charset,"value",format))]}return[formatter(prefix)+"="+formatter(String(obj))]}var values=[];if(typeof obj==="undefined"){return values}var objKeys;if(generateArrayPrefix==="comma"&&isArray(obj)){objKeys=[{value:obj.length>0?obj.join(",")||null:undefined}]}else if(isArray(filter)){objKeys=filter}else{var keys=Object.keys(obj);objKeys=sort?keys.sort(sort):keys}for(var i=0;i<objKeys.length;++i){var key=objKeys[i];var value=typeof key==="object"&&key.value!==undefined?key.value:obj[key];if(skipNulls&&value===null){continue}var keyPrefix=isArray(obj)?typeof generateArrayPrefix==="function"?generateArrayPrefix(prefix,key):prefix:prefix+(allowDots?"."+key:"["+key+"]");pushToArray(values,stringify(value,keyPrefix,generateArrayPrefix,strictNullHandling,skipNulls,encoder,filter,sort,allowDots,serializeDate,format,formatter,encodeValuesOnly,charset))}return values};var normalizeStringifyOptions=function normalizeStringifyOptions(opts){if(!opts){return defaults}if(opts.encoder!==null&&opts.encoder!==undefined&&typeof opts.encoder!=="function"){throw new TypeError("Encoder has to be a function.")}var charset=opts.charset||defaults.charset;if(typeof opts.charset!=="undefined"&&opts.charset!=="utf-8"&&opts.charset!=="iso-8859-1"){throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined")}var format=formats["default"];if(typeof opts.format!=="undefined"){if(!has.call(formats.formatters,opts.format)){throw new TypeError("Unknown format option provided.")}format=opts.format}var formatter=formats.formatters[format];var filter=defaults.filter;if(typeof opts.filter==="function"||isArray(opts.filter)){filter=opts.filter}return{addQueryPrefix:typeof opts.addQueryPrefix==="boolean"?opts.addQueryPrefix:defaults.addQueryPrefix,allowDots:typeof opts.allowDots==="undefined"?defaults.allowDots:!!opts.allowDots,charset:charset,charsetSentinel:typeof opts.charsetSentinel==="boolean"?opts.charsetSentinel:defaults.charsetSentinel,delimiter:typeof opts.delimiter==="undefined"?defaults.delimiter:opts.delimiter,encode:typeof opts.encode==="boolean"?opts.encode:defaults.encode,encoder:typeof opts.encoder==="function"?opts.encoder:defaults.encoder,encodeValuesOnly:typeof opts.encodeValuesOnly==="boolean"?opts.encodeValuesOnly:defaults.encodeValuesOnly,filter:filter,format:format,formatter:formatter,serializeDate:typeof opts.serializeDate==="function"?opts.serializeDate:defaults.serializeDate,skipNulls:typeof opts.skipNulls==="boolean"?opts.skipNulls:defaults.skipNulls,sort:typeof opts.sort==="function"?opts.sort:null,strictNullHandling:typeof opts.strictNullHandling==="boolean"?opts.strictNullHandling:defaults.strictNullHandling}};module.exports=function(object,opts){var obj=object;var options=normalizeStringifyOptions(opts);var objKeys;var filter;if(typeof options.filter==="function"){filter=options.filter;obj=filter("",obj)}else if(isArray(options.filter)){filter=options.filter;objKeys=filter}var keys=[];if(typeof obj!=="object"||obj===null){return""}var arrayFormat;if(opts&&opts.arrayFormat in arrayPrefixGenerators){arrayFormat=opts.arrayFormat}else if(opts&&"indices"in opts){arrayFormat=opts.indices?"indices":"repeat"}else{arrayFormat="indices"}var generateArrayPrefix=arrayPrefixGenerators[arrayFormat];if(!objKeys){objKeys=Object.keys(obj)}if(options.sort){objKeys.sort(options.sort)}for(var i=0;i<objKeys.length;++i){var key=objKeys[i];if(options.skipNulls&&obj[key]===null){continue}pushToArray(keys,stringify(obj[key],key,generateArrayPrefix,options.strictNullHandling,options.skipNulls,options.encode?options.encoder:null,options.filter,options.sort,options.allowDots,options.serializeDate,options.format,options.formatter,options.encodeValuesOnly,options.charset))}var joined=keys.join(options.delimiter);var prefix=options.addQueryPrefix===true?"?":"";if(options.charsetSentinel){if(options.charset==="iso-8859-1"){prefix+="utf8=%26%2310003%3B&"}else{prefix+="utf8=%E2%9C%93&"}}return joined.length>0?prefix+joined:""}},{"./formats":173,"./utils":177}],177:[function(require,module,exports){"use strict";var formats=require("./formats");var has=Object.prototype.hasOwnProperty;var isArray=Array.isArray;var hexTable=function(){var array=[];for(var i=0;i<256;++i){array.push("%"+((i<16?"0":"")+i.toString(16)).toUpperCase())}return array}();var compactQueue=function compactQueue(queue){while(queue.length>1){var item=queue.pop();var obj=item.obj[item.prop];if(isArray(obj)){var compacted=[];for(var j=0;j<obj.length;++j){if(typeof obj[j]!=="undefined"){compacted.push(obj[j])}}item.obj[item.prop]=compacted}}};var arrayToObject=function arrayToObject(source,options){var obj=options&&options.plainObjects?Object.create(null):{};for(var i=0;i<source.length;++i){if(typeof source[i]!=="undefined"){obj[i]=source[i]}}return obj};var merge=function merge(target,source,options){if(!source){return target}if(typeof source!=="object"){if(isArray(target)){target.push(source)}else if(target&&typeof target==="object"){if(options&&(options.plainObjects||options.allowPrototypes)||!has.call(Object.prototype,source)){target[source]=true}}else{return[target,source]}return target}if(!target||typeof target!=="object"){return[target].concat(source)}var mergeTarget=target;if(isArray(target)&&!isArray(source)){mergeTarget=arrayToObject(target,options)}if(isArray(target)&&isArray(source)){source.forEach(function(item,i){if(has.call(target,i)){var targetItem=target[i];if(targetItem&&typeof targetItem==="object"&&item&&typeof item==="object"){target[i]=merge(targetItem,item,options)}else{target.push(item)}}else{target[i]=item}});return target}return Object.keys(source).reduce(function(acc,key){var value=source[key];if(has.call(acc,key)){acc[key]=merge(acc[key],value,options)}else{acc[key]=value}return acc},mergeTarget)};var assign=function assignSingleSource(target,source){return Object.keys(source).reduce(function(acc,key){acc[key]=source[key];return acc},target)};var decode=function(str,decoder,charset){var strWithoutPlus=str.replace(/\+/g," ");if(charset==="iso-8859-1"){return strWithoutPlus.replace(/%[0-9a-f]{2}/gi,unescape)}try{return decodeURIComponent(strWithoutPlus)}catch(e){return strWithoutPlus}};var encode=function encode(str,defaultEncoder,charset,kind,format){if(str.length===0){return str}var string=str;if(typeof str==="symbol"){string=Symbol.prototype.toString.call(str)}else if(typeof str!=="string"){string=String(str)}if(charset==="iso-8859-1"){return escape(string).replace(/%u[0-9a-f]{4}/gi,function($0){return"%26%23"+parseInt($0.slice(2),16)+"%3B"})}var out="";for(var i=0;i<string.length;++i){var c=string.charCodeAt(i);if(c===45||c===46||c===95||c===126||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122||format===formats.RFC1738&&(c===40||c===41)){out+=string.charAt(i);continue}if(c<128){out=out+hexTable[c];continue}if(c<2048){out=out+(hexTable[192|c>>6]+hexTable[128|c&63]);continue}if(c<55296||c>=57344){out=out+(hexTable[224|c>>12]+hexTable[128|c>>6&63]+hexTable[128|c&63]);continue}i+=1;c=65536+((c&1023)<<10|string.charCodeAt(i)&1023);out+=hexTable[240|c>>18]+hexTable[128|c>>12&63]+hexTable[128|c>>6&63]+hexTable[128|c&63]}return out};var compact=function compact(value){var queue=[{obj:{o:value},prop:"o"}];var refs=[];for(var i=0;i<queue.length;++i){var item=queue[i];var obj=item.obj[item.prop];var keys=Object.keys(obj);for(var j=0;j<keys.length;++j){var key=keys[j];var val=obj[key];if(typeof val==="object"&&val!==null&&refs.indexOf(val)===-1){queue.push({obj:obj,prop:key});refs.push(val)}}}compactQueue(queue);return value};var isRegExp=function isRegExp(obj){return Object.prototype.toString.call(obj)==="[object RegExp]"};var isBuffer=function isBuffer(obj){if(!obj||typeof obj!=="object"){return false}return!!(obj.constructor&&obj.constructor.isBuffer&&obj.constructor.isBuffer(obj))};var combine=function combine(a,b){return[].concat(a,b)};var maybeMap=function maybeMap(val,fn){if(isArray(val)){var mapped=[];for(var i=0;i<val.length;i+=1){mapped.push(fn(val[i]))}return mapped}return fn(val)};module.exports={arrayToObject:arrayToObject,assign:assign,combine:combine,compact:compact,decode:decode,encode:encode,isBuffer:isBuffer,isRegExp:isRegExp,maybeMap:maybeMap,merge:merge}},{"./formats":173}],178:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.supportedCurrencies=void 0;exports.supportedCurrencies=["USD","EUR","STR","TTD","EC","JMD","GUY"]},{}],179:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.jobStatuses=exports.JOB_STATUS_ARCHIVED=exports.JOB_STATUS_ACTIVE=exports.JOB_STATUS_NEW=void 0;exports.JOB_STATUS_NEW="new";exports.JOB_STATUS_ACTIVE="active";exports.JOB_STATUS_ARCHIVED="archived";exports.jobStatuses=[exports.JOB_STATUS_NEW,exports.JOB_STATUS_ACTIVE,exports.JOB_STATUS_ARCHIVED]},{}],180:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.supportedPaymentFrequencies=void 0;exports.supportedPaymentFrequencies=["Hourly","Daily","Weekly","Fortnightly","Monthly","One-Time"]},{}],181:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.CurrencyMoneyTextField=void 0;var wml_1=require("@quenk/wml");var currency_1=require("@board/common/lib/data/currency");var money_1=require("./money");var CurrencyMoneyTextField=function(_super){__extends(CurrencyMoneyTextField,_super);function CurrencyMoneyTextField(){var _a,_b;var _this=_super.apply(this,arguments)||this;_this.view=new money_1.CurrencyMoneyTextFieldView(_this);_this.values={dropList:{name:(_a=_this.attrs.names)===null||_a===void 0?void 0:_a[0],value:_this.attrs.currency||currency_1.supportedCurrencies[0],options:currency_1.supportedCurrencies.map(function(sym){return{label:sym,value:sym}}),onSelect:_this.attrs.onChange},input:{name:(_b=_this.attrs.names)===null||_b===void 0?void 0:_b[1],value:_this.attrs.value?String(_this.attrs.value):"0",onChange:_this.attrs.onChange}};return _this}return CurrencyMoneyTextField}(wml_1.Component);exports.CurrencyMoneyTextField=CurrencyMoneyTextField},{"./money":182,"@board/common/lib/data/currency":178,"@quenk/wml":170}],182:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CurrencyMoneyTextFieldView=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var input_group_1=require("@quenk/wml-widgets/lib/control/input-group");var text_input_1=require("@quenk/wml-widgets/lib/control/text-input");var drop_list_1=require("@quenk/wml-widgets/lib/control/drop-list");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var CurrencyMoneyTextFieldView=function(){function CurrencyMoneyTextFieldView(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.widget(new input_group_1.InputGroup({className:"board-currency-money-text-field"},[__this.widget(new input_group_1.AddOn({button:true},[__this.widget(new drop_list_1.DropList({ww:{name:__context.values.dropList.name,options:__context.values.dropList.options,value:__context.values.dropList.value,onSelect:__context.values.dropList.onSelect}},[]),{ww:{name:__context.values.dropList.name,options:__context.values.dropList.options,value:__context.values.dropList.value,onSelect:__context.values.dropList.onSelect}})]),{button:true}),__this.widget(new text_input_1.TextInput({ww:{name:__context.values.input.name,value:__context.values.input.value,type:"number",min:0,onChange:__context.values.input.onChange}},[]),{ww:{name:__context.values.input.name,value:__context.values.input.value,type:"number",min:0,onChange:__context.values.input.onChange}})]),{className:"board-currency-money-text-field"})}}CurrencyMoneyTextFieldView.prototype.registerView=function(v){this.views.push(v);return v};CurrencyMoneyTextFieldView.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '".concat(id,"' detected!"));this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};CurrencyMoneyTextFieldView.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child ".concat(c," of type ").concat(typeof c))}});this.register(e,attrs);return e};CurrencyMoneyTextFieldView.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};CurrencyMoneyTextFieldView.prototype.findById=function(id){var mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};CurrencyMoneyTextFieldView.prototype.findByGroup=function(name){var mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};CurrencyMoneyTextFieldView.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};CurrencyMoneyTextFieldView.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return CurrencyMoneyTextFieldView}();exports.CurrencyMoneyTextFieldView=CurrencyMoneyTextFieldView},{"@quenk/noni/lib/data/maybe":59,"@quenk/wml-widgets/lib/control/drop-list":118,"@quenk/wml-widgets/lib/control/input-group":126,"@quenk/wml-widgets/lib/control/text-input":136,"@quenk/wml/lib/dom":169}],183:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.truncate=exports.timefromnow=exports.timestamp=void 0;var moment=require("moment");var timestamp=function(str){var stamp=moment(str);if(str===""||!stamp.isValid())return"";return stamp.format("MMMM Do YYYY")};exports.timestamp=timestamp;var timefromnow=function(str){var date=moment(str);if(str===""||!date.isValid())return"";return date.fromNow()};exports.timefromnow=timefromnow;var truncate=function(limit){return function(str){if(str===void 0){str=""}return str.length>limit?"".concat(str.substr(0,limit),"..."):str}};exports.truncate=truncate},{moment:171}],184:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobFormCompanyFieldsView=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var grid_1=require("@quenk/wml-widgets/lib/layout/grid");var text_field_1=require("@quenk/wml-widgets/lib/control/text-field");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var JobFormCompanyFieldsView=function(){function JobFormCompanyFieldsView(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.widget(new grid_1.GridLayout({},[__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new text_field_1.TextField({wml:{id:"company"},ww:{name:"company",label:"Company Name*",value:__context.data.company,onChange:__context.onChange}},[]),{wml:{id:"company"},ww:{name:"company",label:"Company Name*",value:__context.data.company,onChange:__context.onChange}})]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new text_field_1.TextField({wml:{id:"company_logo"},ww:{name:"company_logo",label:"Logo",placeholder:"Please provide a url to a png image with resolution 400 x 400",value:__context.data.company_logo,onChange:__context.onChange}},[]),{wml:{id:"company_logo"},ww:{name:"company_logo",label:"Logo",placeholder:"Please provide a url to a png image with resolution 400 x 400",value:__context.data.company_logo,onChange:__context.onChange}})]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new text_field_1.TextField({wml:{id:"company_email"},ww:{name:"company_email",label:"Email*",value:__context.data.company_email,onChange:__context.onChange}},[]),{wml:{id:"company_email"},ww:{name:"company_email",label:"Email*",value:__context.data.company_email,onChange:__context.onChange}})]),{})]),{})]),{})}}JobFormCompanyFieldsView.prototype.registerView=function(v){this.views.push(v);return v};JobFormCompanyFieldsView.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '".concat(id,"' detected!"));this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};JobFormCompanyFieldsView.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child ".concat(c," of type ").concat(typeof c))}});this.register(e,attrs);return e};JobFormCompanyFieldsView.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};JobFormCompanyFieldsView.prototype.findById=function(id){var mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};JobFormCompanyFieldsView.prototype.findByGroup=function(name){var mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};JobFormCompanyFieldsView.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};JobFormCompanyFieldsView.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return JobFormCompanyFieldsView}();exports.JobFormCompanyFieldsView=JobFormCompanyFieldsView},{"@quenk/noni/lib/data/maybe":59,"@quenk/wml-widgets/lib/control/text-field":134,"@quenk/wml-widgets/lib/layout/grid":150,"@quenk/wml/lib/dom":169}],185:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobFormJobFieldsView=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var grid_1=require("@quenk/wml-widgets/lib/layout/grid");var text_field_1=require("@quenk/wml-widgets/lib/control/text-field");var drop_list_1=require("@quenk/wml-widgets/lib/control/drop-list");var checkbox_1=require("@quenk/wml-widgets/lib/control/checkbox");var money_1=require("@devcarib/widgets/lib/control/input/money");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var JobFormJobFieldsView=function(){function JobFormJobFieldsView(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.widget(new grid_1.GridLayout({},[__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new text_field_1.TextField({wml:{id:"title"},ww:{name:"title",label:"Title*",placeholder:"Example: Fintech Software Engineer Needed",value:__context.data.title,onChange:__context.onChange}},[]),{wml:{id:"title"},ww:{name:"title",label:"Title*",placeholder:"Example: Fintech Software Engineer Needed",value:__context.data.title,onChange:__context.onChange}})]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({ww:{span:6}},[__this.widget(new text_field_1.TextField({wml:{id:"location"},ww:{name:"location",label:"Location*",value:__context.data.location,onChange:__context.onChange}},[]),{wml:{id:"location"},ww:{name:"location",label:"Location*",value:__context.data.location,onChange:__context.onChange}})]),{ww:{span:6}}),__this.widget(new grid_1.Column({ww:{span:6}},[__this.node("label",{class:"ww-label"},[__document.createTextNode("Select A Job Type*")]),__this.widget(new drop_list_1.DropList({wml:{id:"type"},ww:{className:"board-job-type-dropdown -block",name:"type",value:__context.data.type,options:__context.type.options,onSelect:__context.onSelect}},[]),{wml:{id:"type"},ww:{className:"board-job-type-dropdown -block",name:"type",value:__context.data.type,options:__context.type.options,onSelect:__context.onSelect}})]),{ww:{span:6}})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new text_field_1.TextField({wml:{id:"apply_url"},ww:{name:"apply_url",label:"Apply Link",placeholder:"Specify a url or email address applicants can use to apply",value:__context.data.apply_url,onChange:__context.onChange}},[]),{wml:{id:"apply_url"},ww:{name:"apply_url",label:"Apply Link",placeholder:"Specify a url or email address applicants can use to apply",value:__context.data.apply_url,onChange:__context.onChange}})]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.node("b",{},[__document.createTextNode("\n         Is this a remote position? \n         "),__this.widget(new checkbox_1.Checkbox({ww:{name:"remote",value:__context.data.remote,onChange:__context.onSelect}},[]),{ww:{name:"remote",value:__context.data.remote,onChange:__context.onSelect}})])]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({ww:{span:6}},[__this.node("b",{},[__document.createTextNode("Payment")]),__this.widget(new money_1.CurrencyMoneyTextField({names:["payment_currency","payment_amount"],onChange:__context.onChange},[]),{names:["payment_currency","payment_amount"],onChange:__context.onChange})]),{ww:{span:6}}),__this.widget(new grid_1.Column({ww:{span:6}},[__this.node("label",{class:"ww-label"},[__document.createTextNode("Payment Frequency")]),__this.widget(new drop_list_1.DropList({wml:{id:"payment_frequency"},ww:{className:"-block board-job-payment-frequency",name:"payment_frequency",value:__context.data.payment_frequency,options:__context.payment_frequency.options,onSelect:__context.onSelect}},[]),{wml:{id:"payment_frequency"},ww:{className:"-block board-job-payment-frequency",name:"payment_frequency",value:__context.data.payment_frequency,options:__context.payment_frequency.options,onSelect:__context.onSelect}})]),{ww:{span:6}})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new text_field_1.TextField({wml:{id:"description"},ww:{name:"description",placeholder:"Provide full details of the job. Markdown is supported",rows:12,value:__context.data.description,onChange:__context.onChange}},[]),{wml:{id:"description"},ww:{name:"description",placeholder:"Provide full details of the job. Markdown is supported",rows:12,value:__context.data.description,onChange:__context.onChange}})]),{})]),{})]),{})}}JobFormJobFieldsView.prototype.registerView=function(v){this.views.push(v);return v};JobFormJobFieldsView.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '".concat(id,"' detected!"));this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};JobFormJobFieldsView.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child ".concat(c," of type ").concat(typeof c))}});this.register(e,attrs);return e};JobFormJobFieldsView.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};JobFormJobFieldsView.prototype.findById=function(id){var mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};JobFormJobFieldsView.prototype.findByGroup=function(name){var mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};JobFormJobFieldsView.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};JobFormJobFieldsView.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return JobFormJobFieldsView}();exports.JobFormJobFieldsView=JobFormJobFieldsView},{"@devcarib/widgets/lib/control/input/money":181,"@quenk/noni/lib/data/maybe":59,"@quenk/wml-widgets/lib/control/checkbox":112,"@quenk/wml-widgets/lib/control/drop-list":118,"@quenk/wml-widgets/lib/control/text-field":134,"@quenk/wml-widgets/lib/layout/grid":150,"@quenk/wml/lib/dom":169}],186:[function(require,module,exports){"use strict";var __spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||arguments.length===2)for(var i=0,l=from.length,ar;i<l;i++){if(ar||!(i in from)){if(!ar)ar=Array.prototype.slice.call(from,0,i);ar[i]=from[i]}}return to.concat(ar||Array.prototype.slice.call(from))};Object.defineProperty(exports,"__esModule",{value:true});exports.JobFeaturesView=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var filters_1=require("../../filters");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var JobFeaturesView=function(){function JobFeaturesView(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{class:"board-job-features"},__spreadArray(__spreadArray(__spreadArray(__spreadArray([],__context.type!=null?function(){return[__this.node("span",{class:"ww-tag -default"},[text(__context.type)])]}():function(){return[]}(),true),__context.location!=null?function(){return[__this.node("span",{class:"ww-tag -default"},[text((0,filters_1.truncate)(60)(__context.location))])]}():function(){return[]}(),true),__context.remote!=null?function(){return[__this.node("span",{class:"ww-tag -default"},[__document.createTextNode("Remote")])]}():function(){return[]}(),true),__context.salary_range!=null?function(){return[__this.node("span",{class:"ww-tag -default"},[__document.createTextNode("$"),text(__context.salary_range)])]}():function(){return[]}(),true))}}JobFeaturesView.prototype.registerView=function(v){this.views.push(v);return v};JobFeaturesView.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '".concat(id,"' detected!"));this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};JobFeaturesView.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child ".concat(c," of type ").concat(typeof c))}});this.register(e,attrs);return e};JobFeaturesView.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};JobFeaturesView.prototype.findById=function(id){var mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};JobFeaturesView.prototype.findByGroup=function(name){var mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};JobFeaturesView.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};JobFeaturesView.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return JobFeaturesView}();exports.JobFeaturesView=JobFeaturesView},{"../../filters":183,"@quenk/noni/lib/data/maybe":59,"@quenk/wml/lib/dom":169}]},{},[17]);
