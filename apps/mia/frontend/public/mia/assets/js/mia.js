(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.events=exports.users=exports.jobs=void 0;exports.jobs={create:"/mia/r/jobs",search:"/mia/r/jobs",update:"/mia/r/jobs/{id}",get:"/mia/r/jobs/{id}",remove:"/mia/r/jobs/{id}"};exports.users={create:"/mia/r/users",search:"/mia/r/users",update:"/mia/r/users/{id}",get:"/mia/r/users/{id}",remove:"/mia/r/users/{id}"};exports.events={create:"/mia/r/events",search:"/mia/r/events",update:"/mia/r/events/{id}",get:"/mia/r/events/{id}",remove:"/mia/r/events/{id}"}},{}],2:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ActionColumn=void 0;const columns_1=require("./columns/views/columns");class ActionColumn{constructor(actions){this.actions=actions;this.name="";this.heading="Actions";this.cellFragment=(c=>new columns_1.ActionColumnView({actions:this.actions,data:c.datum}))}}exports.ActionColumn=ActionColumn},{"./columns/views/columns":3}],3:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ActionColumnView=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const drop_down_1=require("@quenk/wml-widgets/lib/control/drop-down");const menu_1=require("@quenk/wml-widgets/lib/menu/menu");const item_1=require("@quenk/wml-widgets/lib/menu/item");const link_1=require("@quenk/wml-widgets/lib/content/link");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class ActionColumnView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("td",{},[__this.widget(new drop_down_1.DropDown({className:"-left",buttonText:"Action"},[__this.widget(new menu_1.Menu({},[...__forIn(__context.actions,(spec,_$$i,_$$all)=>[...spec.divider?(()=>[__this.widget(new item_1.Divider({},[]),{})])():(()=>[])(),__this.widget(new item_1.Item({},[__this.widget(new link_1.Link({text:spec.text,onClick:()=>spec.onClick(__context.data)},[]),{text:spec.text,onClick:()=>spec.onClick(__context.data)})]),{})],()=>[])]),{})]),{className:"-left",buttonText:"Action"})])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.ActionColumnView=ActionColumnView},{"@quenk/noni/lib/data/maybe":77,"@quenk/wml-widgets/lib/content/link":118,"@quenk/wml-widgets/lib/control/drop-down":138,"@quenk/wml-widgets/lib/menu/item":181,"@quenk/wml-widgets/lib/menu/menu":183,"@quenk/wml/lib/dom":189}],4:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MiaScene=void 0;const main_1=require("@quenk/jouvert/lib/app/scene/main");class MiaScene extends main_1.MainScene{constructor(app,resume){super(app,resume);this.app=app;this.resume=resume}}exports.MiaScene=MiaScene},{"@quenk/jouvert/lib/app/scene/main":65}],5:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.defaultHandlers=exports.MiaManager=void 0;const handlers_1=require("@quenk/jouvert/lib/app/scene/remote/handlers");const form_1=require("@quenk/jouvert/lib/app/scene/form");const __1=require("../");class MiaManager extends __1.MiaScene{receive(){return[new form_1.FormSavedCase(this),...super.receive()]}search(qry){return this.model.search(qry)}afterFormSaved(){return this.search({}).map(()=>{})}run(){return this.search({})}}exports.MiaManager=MiaManager;const defaultHandlers=mgr=>[new handlers_1.AfterSearchSetData(data=>{mgr.values.table.data=data}),new handlers_1.AfterSearchSetPagination(mgr.values.table),new handlers_1.ShiftingOnComplete([new handlers_1.OnCompleteShowData(mgr),new handlers_1.AfterSearchUpdateWidget(mgr.view,mgr.values.table.id)])];exports.defaultHandlers=defaultHandlers},{"../":4,"@quenk/jouvert/lib/app/scene/form":61,"@quenk/jouvert/lib/app/scene/remote/handlers":66}],6:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ManagerHeader=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const button_1=require("@quenk/wml-widgets/lib/control/button");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class ManagerHeader{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("div",{class:"mia-manager-header"},[__this.node("h1",{},[text(__context.title)]),...__context.add?(()=>[__this.widget(new button_1.Button({text:"Add",className:"-primary",onClick:__context.add},[]),{text:"Add",className:"-primary",onClick:__context.add})])():(()=>[])()])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.ManagerHeader=ManagerHeader},{"@quenk/noni/lib/data/maybe":77,"@quenk/wml-widgets/lib/control/button":130,"@quenk/wml/lib/dom":189}],7:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ActionColumn=exports.HostColumn=exports.EndColumn=exports.StartColumn=exports.TitleColumn=void 0;const moment=require("moment");const views_1=require("./views");class TitleColumn{constructor(action){this.action=action;this.name="title";this.heading="Title";this.cellFragment=(c=>new views_1.TitleColumnView({event:c.datum,onClick:()=>this.action(c.datum)}))}}exports.TitleColumn=TitleColumn;class StartColumn{constructor(){this.name="start";this.heading="Start";this.format=(val=>moment.utc(val).calendar());this.sort="start"}}exports.StartColumn=StartColumn;class EndColumn{constructor(){this.name="end";this.heading="End";this.format=(val=>val?moment.utc(val).calendar():"");this.sort="event"}}exports.EndColumn=EndColumn;class HostColumn{constructor(){this.name="host";this.heading="Host"}}exports.HostColumn=HostColumn;class ActionColumn{constructor(actions){this.actions=actions;this.name="";this.heading="Actions";this.cellFragment=(c=>new views_1.ActionColumnView({actions:this.actions,event:c.datum}))}}exports.ActionColumn=ActionColumn},{"./views":8,moment:200}],8:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ActionColumnView=exports.TitleColumnView=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const drop_down_1=require("@quenk/wml-widgets/lib/control/drop-down");const menu_1=require("@quenk/wml-widgets/lib/menu/menu");const item_1=require("@quenk/wml-widgets/lib/menu/item");const link_1=require("@quenk/wml-widgets/lib/content/link");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class TitleColumnView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("td",{},[__this.widget(new link_1.Link({text:__context.event.title,onClick:__context.onClick},[]),{text:__context.event.title,onClick:__context.onClick})])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.TitleColumnView=TitleColumnView;class ActionColumnView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("td",{},[__this.widget(new drop_down_1.DropDown({className:"-left",buttonText:"Action"},[__this.widget(new menu_1.Menu({},[...__forIn(__context.actions,(spec,_$$i,_$$all)=>[...spec.divider?(()=>[__this.widget(new item_1.Divider({},[]),{})])():(()=>[])(),__this.widget(new item_1.Item({},[__this.widget(new link_1.Link({text:spec.text,onClick:()=>spec.onClick(__context.event)},[]),{text:spec.text,onClick:()=>spec.onClick(__context.event)})]),{})],()=>[])]),{})]),{className:"-left",buttonText:"Action"})])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.ActionColumnView=ActionColumnView},{"@quenk/noni/lib/data/maybe":77,"@quenk/wml-widgets/lib/content/link":118,"@quenk/wml-widgets/lib/control/drop-down":138,"@quenk/wml-widgets/lib/menu/item":181,"@quenk/wml-widgets/lib/menu/menu":183,"@quenk/wml/lib/dom":189}],9:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AddEventDialog=void 0;const moment=require("moment");const api=require("../../../api");const record_1=require("@quenk/noni/lib/data/record");const dialog_1=require("@devcarib/frontend/lib/app/scene/form/remote/dialog");const views_1=require("./views");const getTimes=()=>{let mins=["00","15","30","45"];let hrs=["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"];return hrs.reduce((res,hr)=>res.concat(mins.map(min=>{let label=`${hr}:${min}`;let value=label;return{label:label,value:value}})),[])};const now=()=>moment.utc().startOf("day").add(9,"hours").add(15,"minutes");class AddEventDialog extends dialog_1.DevCaribDialogRemoteForm{constructor(){super(...arguments);this.name="Add Event";this.view=new views_1.AddEventDialogView(this);this.model=this.getModel(api.events);this.value=(0,record_1.merge)({start:now().toISOString()},this.value);this.values={data:this.value,errors:{},start:{date:()=>moment.utc(this.values.data.start).format("YYYY-MM-DD"),time:()=>moment.utc(this.values.data.start).format("hh:mm"),timeOptions:getTimes(),onChange:({name:name,value:value})=>{if(name==="endDate"){let start=moment.utc(this.values.data.start);let newStart=moment.utc(value);newStart.hour(start.hour());newStart.minute(start.minute());newStart.seconds(start.seconds());this.set("start",newStart.toISOString())}else if(name==="startTime"){let start=moment.utc(this.values.data.start);let newStart=moment.utc(value);newStart.year(start.year());newStart.month(start.month());newStart.date(start.date());this.set("start",newStart.toISOString())}}},end:{date:()=>moment.utc(this.values.data.end).format("YYYY-MM-DD"),time:()=>moment.utc(this.values.data.end).format("hh:mm"),timeOptions:getTimes(),onChange:({name:name,value:value})=>{if(name==="endDate"){let end=moment.utc(this.values.data.end);let newStart=moment.utc(value);newStart.hour(end.hour());newStart.minute(end.minute());newStart.seconds(end.seconds());this.set("end",newStart.toISOString())}else if(name==="endTime"){let end=moment.utc(this.values.data.end);let newStart=moment.utc(value);newStart.year(end.year());newStart.month(end.month());newStart.date(end.date());this.set("end",newStart.toISOString())}}},onSelect:e=>{this.tell(this.self(),e)},onChange:e=>{this.tell(this.self(),e)},close:()=>{this.close();this.abort()},save:()=>{this.save()}}}}exports.AddEventDialog=AddEventDialog},{"../../../api":1,"./views":10,"@devcarib/frontend/lib/app/scene/form/remote/dialog":215,"@quenk/noni/lib/data/record":78,moment:200}],10:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AddEventDialogView=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const grid_1=require("@quenk/wml-widgets/lib/layout/grid");const text_field_1=require("@quenk/wml-widgets/lib/control/text-field");const date_field_1=require("@quenk/wml-widgets/lib/control/date-field");const drop_list_1=require("@quenk/wml-widgets/lib/control/drop-list");const label_1=require("@quenk/wml-widgets/lib/control/label");const checkbox_1=require("@quenk/wml-widgets/lib/control/checkbox");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class AddEventDialogView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.widget(new grid_1.GridLayout({},[__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new text_field_1.TextField({wml:{id:"title"},name:"title",label:"Title*",error:__context.values.errors.title,value:__context.values.data.title,onChange:__context.values.onChange},[]),{wml:{id:"title"},name:"title",label:"Title*",error:__context.values.errors.title,value:__context.values.data.title,onChange:__context.values.onChange})]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new label_1.Label({},[__document.createTextNode("Starts")]),{})]),{}),__this.widget(new grid_1.Column({span:8},[__this.widget(new date_field_1.DateField({wml:{id:"startDate"},className:"start-date -block",placeholder:"YYYY-MM-DD",name:"startDate",value:__context.values.start.date(),onChange:__context.values.start.onChange},[]),{wml:{id:"startDate"},className:"start-date -block",placeholder:"YYYY-MM-DD",name:"startDate",value:__context.values.start.date(),onChange:__context.values.start.onChange})]),{span:8}),__this.widget(new grid_1.Column({span:4},[__this.widget(new drop_list_1.DropList({wml:{id:"startTime"},name:"startTime",className:"start-time",value:__context.values.start.time(),options:__context.values.start.timeOptions,onSelect:__context.values.start.onChange},[]),{wml:{id:"startTime"},name:"startTime",className:"start-time",value:__context.values.start.time(),options:__context.values.start.timeOptions,onSelect:__context.values.start.onChange})]),{span:4})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new label_1.Label({},[__document.createTextNode("Ends")]),{})]),{}),__this.widget(new grid_1.Column({span:8},[__this.widget(new date_field_1.DateField({wml:{id:"endDate"},className:"start-date -block",placeholder:"YYYY-MM-DD",name:"endDate",value:__context.values.end.date(),onChange:__context.values.end.onChange},[]),{wml:{id:"endDate"},className:"start-date -block",placeholder:"YYYY-MM-DD",name:"endDate",value:__context.values.end.date(),onChange:__context.values.end.onChange})]),{span:8}),__this.widget(new grid_1.Column({span:4},[__this.widget(new drop_list_1.DropList({wml:{id:"endTime"},name:"endTime",className:"start-time",value:__context.values.end.time(),options:__context.values.end.timeOptions,onSelect:__context.values.end.onChange},[]),{wml:{id:"endTime"},name:"endTime",className:"start-time",value:__context.values.end.time(),options:__context.values.end.timeOptions,onSelect:__context.values.end.onChange})]),{span:4}),__this.widget(new grid_1.Column({},[__this.widget(new label_1.Label({},[__document.createTextNode("All day event? ")]),{}),__this.widget(new checkbox_1.Checkbox({wml:{id:"allDay"},name:"allDay",value:__context.values.data.allDay,onChange:__context.values.onChange},[]),{wml:{id:"allDay"},name:"allDay",value:__context.values.data.allDay,onChange:__context.values.onChange})]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new text_field_1.TextField({wml:{id:"host"},name:"host",label:"Host",error:__context.values.errors.host,value:__context.values.data.host,onChange:__context.values.onChange},[]),{wml:{id:"host"},name:"host",label:"Host",error:__context.values.errors.host,value:__context.values.data.host,onChange:__context.values.onChange})]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new text_field_1.TextField({wml:{id:"location"},name:"location",label:"Location",error:__context.values.errors.location,value:__context.values.data.location,onChange:__context.values.onChange},[]),{wml:{id:"location"},name:"location",label:"Location",error:__context.values.errors.location,value:__context.values.data.location,onChange:__context.values.onChange})]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new text_field_1.TextField({wml:{id:"url"},name:"url",label:"Url",error:__context.values.errors.url,value:__context.values.data.url,onChange:__context.values.onChange},[]),{wml:{id:"url"},name:"url",label:"Url",error:__context.values.errors.url,value:__context.values.data.url,onChange:__context.values.onChange})]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[]),{})]),{})]),{})})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.AddEventDialogView=AddEventDialogView},{"@quenk/noni/lib/data/maybe":77,"@quenk/wml-widgets/lib/control/checkbox":132,"@quenk/wml-widgets/lib/control/date-field":134,"@quenk/wml-widgets/lib/control/drop-list":140,"@quenk/wml-widgets/lib/control/label":150,"@quenk/wml-widgets/lib/control/text-field":156,"@quenk/wml-widgets/lib/layout/grid":172,"@quenk/wml/lib/dom":189}],11:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.EditEventDialog=void 0;const remote_1=require("@devcarib/frontend/lib/app/scene/form/remote");const add_1=require("./add");class EditEventDialog extends add_1.AddEventDialog{constructor(){super(...arguments);this.name="Edit";this.mode=remote_1.REMOTE_FORM_MODE_UPDATE}}exports.EditEventDialog=EditEventDialog},{"./add":9,"@devcarib/frontend/lib/app/scene/form/remote":216}],12:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.EventsManager=exports.TIME_SEARCH_DEBOUNCE=void 0;const api=require("../../api");const future_1=require("@quenk/noni/lib/control/monad/future");const timer_1=require("@quenk/noni/lib/control/timer");const handlers_1=require("@quenk/jouvert/lib/app/scene/remote/handlers");const columns_1=require("../columns");const manager_1=require("../../common/scene/manager");const add_1=require("../dialogs/add");const edit_1=require("../dialogs/edit");const views_1=require("./views");exports.TIME_SEARCH_DEBOUNCE=500;class EventsManager extends manager_1.MiaManager{constructor(){super(...arguments);this.name="events";this.view=new views_1.EventsManagerView(this);this.values={search:{onChange:(0,timer_1.debounce)(e=>{let qry=e.value===""?{}:{q:`title:"${e.value}"`};this.search(qry)},exports.TIME_SEARCH_DEBOUNCE)},table:{id:"table",title:"Events",data:[],add:()=>this.spawn(()=>new add_1.AddEventDialog(this.app,this.self())),pagination:{current:{count:0,page:1,limit:50},total:{count:0,pages:0}},columns:[new columns_1.TitleColumn(event=>this.editEvent(event)),new columns_1.HostColumn,new columns_1.StartColumn,new columns_1.EndColumn,new columns_1.ActionColumn([{text:"Edit",divider:false,onClick:data=>this.editEvent(data)},{text:"Remove",divider:true,onClick:data=>this.wait(this.removeEvent(data.id))}])]}};this.model=this.app.getModel(api.events,[new handlers_1.AfterSearchSetData(data=>{this.values.table.data=data}),new handlers_1.AfterSearchSetPagination(this.values.table),new handlers_1.ShiftingOnComplete([new handlers_1.OnCompleteShowData(this),new handlers_1.AfterSearchUpdateWidget(this.view,this.values.table.id)])])}search(qry){return this.model.search(qry)}editEvent(job){this.spawn(()=>{window.x=new edit_1.EditEventDialog(this.app,this.self(),job);return window.x})}removeEvent(id){let that=this;return(0,future_1.doFuture)(function*(){let r=yield that.model.remove(id);if(r.code==200){alert("Event removed!");that.reload()}else{alert("Could not complete request!")}return(0,future_1.pure)(undefined)})}run(){return this.search({})}}exports.EventsManager=EventsManager},{"../../api":1,"../../common/scene/manager":5,"../columns":7,"../dialogs/add":9,"../dialogs/edit":11,"./views":13,"@quenk/jouvert/lib/app/scene/remote/handlers":66,"@quenk/noni/lib/control/monad/future":70,"@quenk/noni/lib/control/timer":72}],13:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.EventsManagerView=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const grid_1=require("@quenk/wml-widgets/lib/layout/grid");const table_1=require("@quenk/wml-widgets/lib/data/table");const text_field_1=require("@quenk/wml-widgets/lib/control/text-field");const header_1=require("../../common/scene/manager/views/header");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class EventsManagerView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.widget(new grid_1.GridLayout({},[__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.registerView(new header_1.ManagerHeader(__context.values.table)).render()]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new text_field_1.TextField({placeholder:"Search",onChange:__context.values.search.onChange},[]),{placeholder:"Search",onChange:__context.values.search.onChange})]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new table_1.DataTable({wml:{id:__context.values.table.id},data:__context.values.table.data,columns:__context.values.table.columns},[]),{wml:{id:__context.values.table.id},data:__context.values.table.data,columns:__context.values.table.columns})]),{})]),{})]),{})})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.EventsManagerView=EventsManagerView},{"../../common/scene/manager/views/header":6,"@quenk/noni/lib/data/maybe":77,"@quenk/wml-widgets/lib/control/text-field":156,"@quenk/wml-widgets/lib/data/table":164,"@quenk/wml-widgets/lib/layout/grid":172,"@quenk/wml/lib/dom":189}],14:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Mia=void 0;const function_1=require("@quenk/noni/lib/data/function");const future_1=require("@quenk/noni/lib/control/monad/future");const app_1=require("@devcarib/frontend/lib/app");const app_2=require("./views/app");const routes_1=require("./routes");class Mia extends app_1.DevCarib{constructor(){super(...arguments);this.view=new app_2.MiaView(this);this.routes=routes_1.routes;this.values={header:{links:{Jobs:"#/jobs",Users:"#/users",Events:"#/events"},logout:()=>this.runFuture(this.logout())}};this.onError=(e=>{console.error(e);alert("An error has occurred! Details have been logged to the console.")})}static create(appNode,dialogNode){return new Mia(appNode,dialogNode)}logout(){return confirm("Do you want to logout now?")?this.agent.post("/mia/logout",{}).chain(()=>{window.location.href="/admin";return(0,future_1.pure)(undefined)}):(0,future_1.pure)(undefined)}runFuture(ft){ft.fork(this.onError,function_1.noop)}}exports.Mia=Mia},{"./routes":23,"./views/app":30,"@devcarib/frontend/lib/app":213,"@quenk/noni/lib/control/monad/future":70,"@quenk/noni/lib/data/function":76}],15:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ActionColumn=exports.StatusColumn=exports.CompanyColumn=exports.TitleColumn=void 0;const views_1=require("./views");class TitleColumn{constructor(action){this.action=action;this.name="title";this.heading="Title";this.cellFragment=(c=>new views_1.TitleColumnView({job:c.datum,onClick:()=>this.action(c.datum)}))}}exports.TitleColumn=TitleColumn;class CompanyColumn{constructor(){this.name="company";this.heading="Company"}}exports.CompanyColumn=CompanyColumn;class StatusColumn{constructor(){this.name="status";this.heading="Status"}}exports.StatusColumn=StatusColumn;class ActionColumn{constructor(actions){this.actions=actions;this.name="";this.heading="Actions";this.cellFragment=(c=>new views_1.ActionColumnView({actions:this.actions,job:c.datum}))}}exports.ActionColumn=ActionColumn},{"./views":16}],16:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ActionColumnView=exports.TitleColumnView=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const drop_down_1=require("@quenk/wml-widgets/lib/control/drop-down");const menu_1=require("@quenk/wml-widgets/lib/menu/menu");const item_1=require("@quenk/wml-widgets/lib/menu/item");const link_1=require("@quenk/wml-widgets/lib/content/link");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class TitleColumnView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("td",{},[__this.widget(new link_1.Link({text:__context.job.title,onClick:__context.onClick},[]),{text:__context.job.title,onClick:__context.onClick})])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.TitleColumnView=TitleColumnView;class ActionColumnView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("td",{},[__this.widget(new drop_down_1.DropDown({className:"-left",buttonText:"Action"},[__this.widget(new menu_1.Menu({},[...__forIn(__context.actions,(spec,_$$i,_$$all)=>[...spec.divider?(()=>[__this.widget(new item_1.Divider({},[]),{})])():(()=>[])(),__this.widget(new item_1.Item({},[__this.widget(new link_1.Link({text:spec.text,onClick:()=>spec.onClick(__context.job)},[]),{text:spec.text,onClick:()=>spec.onClick(__context.job)})]),{})],()=>[])]),{})]),{className:"-left",buttonText:"Action"})])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.ActionColumnView=ActionColumnView},{"@quenk/noni/lib/data/maybe":77,"@quenk/wml-widgets/lib/content/link":118,"@quenk/wml-widgets/lib/control/drop-down":138,"@quenk/wml-widgets/lib/menu/item":181,"@quenk/wml-widgets/lib/menu/menu":183,"@quenk/wml/lib/dom":189}],17:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.EditJobDialog=void 0;const api=require("../../../api");const payment_1=require("@devcarib/common/lib/data/payment");const remote_1=require("@devcarib/frontend/lib/app/scene/form/remote");const dialog_1=require("@devcarib/frontend/lib/app/scene/form/remote/dialog");const edit_1=require("./views/edit");class EditJobDialog extends dialog_1.DevCaribDialogRemoteForm{constructor(){super(...arguments);this.name="Job Edit Dialog";this.view=new edit_1.EditJobDialogView(this);this.model=this.app.getModel(api.jobs);this.mode=remote_1.REMOTE_FORM_MODE_UPDATE;this.values={data:this.value,errors:{},type:{options:[{label:"Full-Time",value:"Full-Time"},{label:"Part-Time",value:"Part-Time"},{label:"Contractor",value:"Contractor"},{label:"Co-Founder",value:"Co-Founder"},{label:"Contributor",value:"Contributor"},{label:"Volunteer",value:"Volunteer"}]},payment_frequency:{options:payment_1.supportedPaymentFrequencies.map(value=>({label:value,value:value}))},onSelect:e=>{this.tell(this.self(),e)},onChange:e=>{this.tell(this.self(),e)},close:()=>{this.close();this.abort()},save:()=>{this.save()}}}}exports.EditJobDialog=EditJobDialog},{"../../../api":1,"./views/edit":18,"@devcarib/common/lib/data/payment":212,"@devcarib/frontend/lib/app/scene/form/remote":216,"@devcarib/frontend/lib/app/scene/form/remote/dialog":215}],18:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.EditJobDialogView=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const grid_1=require("@quenk/wml-widgets/lib/layout/grid");const panel_1=require("@quenk/wml-widgets/lib/layout/panel");const job_1=require("@devcarib/widgets/lib/job/form/fields/job");const company_1=require("@devcarib/widgets/lib/job/form/fields/company");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class EditJobDialogView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.widget(new grid_1.GridLayout({},[__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new panel_1.Panel({},[__this.widget(new panel_1.PanelBody({},[__this.registerView(new job_1.JobFormJobFieldsView(__context.values)).render()]),{})]),{})]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new panel_1.Panel({},[__this.widget(new panel_1.PanelBody({},[__this.registerView(new company_1.JobFormCompanyFieldsView(__context.values)).render()]),{})]),{})]),{})]),{})]),{})})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.EditJobDialogView=EditJobDialogView},{"@devcarib/widgets/lib/job/form/fields/company":222,"@devcarib/widgets/lib/job/form/fields/job":223,"@quenk/noni/lib/data/maybe":77,"@quenk/wml-widgets/lib/layout/grid":172,"@quenk/wml-widgets/lib/layout/panel":175,"@quenk/wml/lib/dom":189}],19:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobPreviewDialog=void 0;const api=require("../../../api");const confirm_1=require("@quenk/jouvert/lib/app/scene/dialog/confirm");const preview_1=require("./views/preview");class JobPreviewDialog extends confirm_1.ConfirmDialog{constructor(app,job,onEdit){super(app,app.services.dialogs,"?");this.app=app;this.job=job;this.onEdit=onEdit;this.name="Job Preview Dialog";this.view=new preview_1.JobPreviewDialogView(this);this.jobModel=this.app.getModel(api.jobs);this.values={data:this.job,frame:{id:"iframe",className:"mia-preview-frame",content:getPreview(this.job)},edit:()=>{this.close();this.onEdit(this.job)},close:()=>this.close()}}}exports.JobPreviewDialog=JobPreviewDialog;const getPreview=({description_html:description_html,title:title})=>`\n<!DOCTYPE html>\n    <html>\n        <head>\n            <meta charset="utf-8">\n            <meta name="viewport" content="width=device-width, initial-scale=1.0">\n            <link rel="stylesheet" href="/assets/css/site.css">\n            <title>${title}</title>\n        </head>\n        <body style="background:#fff">\n            <div class="ww-grid-layout board-job-body">\n                ${description_html}\n            </div>\n        </body>\n    </html>\n`},{"../../../api":1,"./views/preview":20,"@quenk/jouvert/lib/app/scene/dialog/confirm":59}],20:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobPreviewDialogView=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const grid_1=require("@quenk/wml-widgets/lib/layout/grid");const modal_1=require("@quenk/wml-widgets/lib/dialog/modal");const button_1=require("@quenk/wml-widgets/lib/control/button");const features_1=require("@devcarib/widgets/lib/job/panel/features");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class JobPreviewDialogView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.widget(new modal_1.Modal({className:"-large"},[__this.widget(new modal_1.ModalHeader({},[text(__context.values.data.company)]),{}),__this.widget(new modal_1.ModalBody({},[__this.widget(new grid_1.GridLayout({},[__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.node("h1",{},[text(__context.values.data.title)])]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.registerView(new features_1.JobFeaturesView(__context.values.data)).render()]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.node("iframe",{wml:{id:__context.values.frame.id},class:__context.values.frame.className,srcdoc:__context.values.frame.content,sandbox:"",allow:""},[])]),{})]),{})]),{})]),{}),__this.widget(new modal_1.ModalFooter({},[__this.widget(new button_1.Button({className:"-primary",onClick:__context.values.edit,text:"Edit"},[]),{className:"-primary",onClick:__context.values.edit,text:"Edit"}),__this.widget(new button_1.Button({onClick:__context.values.close,text:"Close"},[]),{onClick:__context.values.close,text:"Close"})]),{})]),{className:"-large"})})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.JobPreviewDialogView=JobPreviewDialogView},{"@devcarib/widgets/lib/job/panel/features":224,"@quenk/noni/lib/data/maybe":77,"@quenk/wml-widgets/lib/control/button":130,"@quenk/wml-widgets/lib/dialog/modal":167,"@quenk/wml-widgets/lib/layout/grid":172,"@quenk/wml/lib/dom":189}],21:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobsManager=exports.TIME_SEARCH_DEBOUNCE=void 0;const jobStatus=require("@devcarib/common/lib/data/job");const api=require("../../api");const future_1=require("@quenk/noni/lib/control/monad/future");const timer_1=require("@quenk/noni/lib/control/timer");const handlers_1=require("@quenk/jouvert/lib/app/scene/remote/handlers");const columns_1=require("../columns");const preview_1=require("../dialogs/preview");const manager_1=require("../../common/scene/manager");const edit_1=require("../dialogs/edit");const jobs_1=require("./views/jobs");exports.TIME_SEARCH_DEBOUNCE=500;class JobsManager extends manager_1.MiaManager{constructor(){super(...arguments);this.name="jobs";this.view=new jobs_1.JobsManagerView(this);this.values={search:{onChange:(0,timer_1.debounce)(e=>{let qry=e.value===""?{}:{q:e.value};this.search(qry)},exports.TIME_SEARCH_DEBOUNCE)},table:{id:"table",title:"Jobs",add:()=>{},data:[],pagination:{current:{count:0,page:1,limit:50},total:{count:0,pages:0}},columns:[new columns_1.TitleColumn(job=>this.showJob(job)),new columns_1.CompanyColumn,new columns_1.StatusColumn,new columns_1.ActionColumn([{text:"View",divider:false,onClick:data=>this.showJob(data)},{text:"Approve",divider:false,onClick:data=>this.wait(this.approveJob(data.id))},{text:"Edit",divider:false,onClick:data=>this.editJob(data)},{text:"Remove",divider:true,onClick:data=>this.wait(this.removeJob(data.id))}])]}};this.model=this.app.getModel(api.jobs,[new handlers_1.AfterSearchSetData(data=>{this.values.table.data=data}),new handlers_1.AfterSearchSetPagination(this.values.table),new handlers_1.ShiftingOnComplete([new handlers_1.OnCompleteShowData(this),new handlers_1.AfterSearchUpdateWidget(this.view,this.values.table.id)])])}search(qry){return this.model.search(qry)}showJob(data){this.spawn(()=>new preview_1.JobPreviewDialog(this.app,data,job=>this.editJob(job)))}approveJob(id){let that=this;return(0,future_1.doFuture)(function*(){let change={status:jobStatus.JOB_STATUS_ACTIVE};let r=yield that.model.update(id,change);if(r.code==200){alert("Job approved!");that.reload()}else{alert("Could not complete request!")}return(0,future_1.pure)(undefined)})}editJob(job){this.spawn(()=>{window.x=new edit_1.EditJobDialog(this.app,this.self(),job);return window.x})}removeJob(id){let that=this;return(0,future_1.doFuture)(function*(){let r=yield that.model.remove(id);if(r.code==200){alert("Job removed!");that.reload()}else{alert("Could not complete request!")}return(0,future_1.pure)(undefined)})}run(){return this.search({})}}exports.JobsManager=JobsManager},{"../../api":1,"../../common/scene/manager":5,"../columns":15,"../dialogs/edit":17,"../dialogs/preview":19,"./views/jobs":22,"@devcarib/common/lib/data/job":211,"@quenk/jouvert/lib/app/scene/remote/handlers":66,"@quenk/noni/lib/control/monad/future":70,"@quenk/noni/lib/control/timer":72}],22:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobsManagerView=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const grid_1=require("@quenk/wml-widgets/lib/layout/grid");const table_1=require("@quenk/wml-widgets/lib/data/table");const text_field_1=require("@quenk/wml-widgets/lib/control/text-field");const header_1=require("../../../common/scene/manager/views/header");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class JobsManagerView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.widget(new grid_1.GridLayout({},[__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.registerView(new header_1.ManagerHeader(__context.values.table)).render()]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new text_field_1.TextField({placeholder:"Search",onChange:__context.values.search.onChange},[]),{placeholder:"Search",onChange:__context.values.search.onChange})]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new table_1.DataTable({wml:{id:__context.values.table.id},data:__context.values.table.data,columns:__context.values.table.columns},[]),{wml:{id:__context.values.table.id},data:__context.values.table.data,columns:__context.values.table.columns})]),{})]),{})]),{})})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.JobsManagerView=JobsManagerView},{"../../../common/scene/manager/views/header":6,"@quenk/noni/lib/data/maybe":77,"@quenk/wml-widgets/lib/control/text-field":156,"@quenk/wml-widgets/lib/data/table":164,"@quenk/wml-widgets/lib/layout/grid":172,"@quenk/wml/lib/dom":189}],23:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.routes=void 0;const array_1=require("@quenk/noni/lib/data/array");const template_1=require("@quenk/potoo/lib/actor/template");const manager_1=require("./jobs/manager");const manager_2=require("./users/manager");const manager_3=require("./events/manager");let ignoredErrors=["ClientError","ServerError"];const trap=e=>(0,array_1.contains)(ignoredErrors,e.message)?template_1.ACTION_IGNORE:template_1.ACTION_RAISE;exports.routes={"/":{id:"dashboard",trap:trap,create:(s,_,r)=>new manager_1.JobsManager(s,r)},"/jobs":{id:"dashboard",trap:trap,create:(s,_,r)=>new manager_1.JobsManager(s,r)},"/users":{id:"users",trap:trap,create:(s,_,r)=>new manager_2.UsersManager(s,r)},"/events":{id:"events",trap:trap,create:(s,_,r)=>new manager_3.EventsManager(s,r)}}},{"./events/manager":12,"./jobs/manager":21,"./users/manager":28,"@quenk/noni/lib/data/array":73,"@quenk/potoo/lib/actor/template":115}],24:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.UsernameColumn=void 0;class UsernameColumn{constructor(){this.name="username";this.heading="Username"}}exports.UsernameColumn=UsernameColumn},{}],25:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AddUserDialog=void 0;const api=require("../../../api");const record_1=require("@quenk/noni/lib/data/record");const status_1=require("@devcarib/server/lib/user/status");const dialog_1=require("@devcarib/frontend/lib/app/scene/form/remote/dialog");const add_1=require("./views/add");class AddUserDialog extends dialog_1.DevCaribDialogRemoteForm{constructor(){super(...arguments);this.name="Add User";this.view=new add_1.AddUserDialogView(this);this.model=this.getModel(api.users);this.value=(0,record_1.merge)({status:status_1.USER_STATUS_ACTIVE},this.value);this.values={data:this.value,errors:{},status:{options:[{text:"Active",value:status_1.USER_STATUS_ACTIVE},{text:"Disabled",value:status_1.USER_STATUS_DISABLED}]},onSelect:e=>{this.tell(this.self(),e)},onChange:e=>{this.tell(this.self(),e)},close:()=>{this.close();this.abort()},save:()=>{this.save()}}}}exports.AddUserDialog=AddUserDialog},{"../../../api":1,"./views/add":26,"@devcarib/frontend/lib/app/scene/form/remote/dialog":215,"@devcarib/server/lib/user/status":218,"@quenk/noni/lib/data/record":78}],26:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AddUserDialogView=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const grid_1=require("@quenk/wml-widgets/lib/layout/grid");const text_field_1=require("@quenk/wml-widgets/lib/control/text-field");const button_select_1=require("@quenk/wml-widgets/lib/control/button-select");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class AddUserDialogView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.widget(new grid_1.GridLayout({},[__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new text_field_1.TextField({wml:{id:"name"},name:"name",label:"Name*",error:__context.values.errors.name,value:__context.values.data.name,onChange:__context.values.onChange},[]),{wml:{id:"name"},name:"name",label:"Name*",error:__context.values.errors.name,value:__context.values.data.name,onChange:__context.values.onChange})]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new text_field_1.TextField({wml:{id:"username"},name:"username",label:"Username*",value:__context.values.data.username,error:__context.values.errors.username,onChange:__context.values.onChange},[]),{wml:{id:"username"},name:"username",label:"Username*",value:__context.values.data.username,error:__context.values.errors.username,onChange:__context.values.onChange})]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new text_field_1.TextField({wml:{id:"password"},name:"password",label:"Password*",error:__context.values.errors.password,value:__context.values.data.password,onChange:__context.values.onChange},[]),{wml:{id:"password"},name:"password",label:"Password*",error:__context.values.errors.password,value:__context.values.data.password,onChange:__context.values.onChange})]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.node("p",{},[__this.node("b",{},[__document.createTextNode("Status:")])]),__this.widget(new button_select_1.ButtonSelect({wml:{id:"status"},name:"status",options:__context.values.status.options,value:__context.values.data.status,onChange:__context.values.onChange},[]),{wml:{id:"status"},name:"status",options:__context.values.status.options,value:__context.values.data.status,onChange:__context.values.onChange})]),{})]),{})]),{})})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.AddUserDialogView=AddUserDialogView},{"@quenk/noni/lib/data/maybe":77,"@quenk/wml-widgets/lib/control/button-select":128,"@quenk/wml-widgets/lib/control/text-field":156,"@quenk/wml-widgets/lib/layout/grid":172,"@quenk/wml/lib/dom":189}],27:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.EditUserDialog=void 0;const api=require("../../api");const remote_1=require("@devcarib/frontend/lib/app/scene/form/remote");const add_1=require("./add");class EditUserDialog extends add_1.AddUserDialog{constructor(){super(...arguments);this.name="Edit";this.mode=remote_1.REMOTE_FORM_MODE_UPDATE;this.model=this.app.getModel(api.users)}}exports.EditUserDialog=EditUserDialog},{"../../api":1,"./add":25,"@devcarib/frontend/lib/app/scene/form/remote":216}],28:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.UsersManager=exports.TIME_SEARCH_DEBOUNCE=void 0;const api=require("../../api");const timer_1=require("@quenk/noni/lib/control/timer");const columns_1=require("../../common/columns");const columns_2=require("../columns");const manager_1=require("../../common/scene/manager");const edit_1=require("../dialogs/edit");const users_1=require("./views/users");exports.TIME_SEARCH_DEBOUNCE=500;class UsersManager extends manager_1.MiaManager{constructor(){super(...arguments);this.name="users";this.view=new users_1.UsersManagerView(this);this.values={search:{onChange:(0,timer_1.debounce)(e=>{let qry=e.value===""?{}:{q:e.value};this.search(qry)},exports.TIME_SEARCH_DEBOUNCE)},table:{id:"table",title:"Users",data:[],pagination:{current:{count:0,page:1,limit:50},total:{count:0,pages:0}},columns:[new columns_2.UsernameColumn,new columns_1.ActionColumn([{text:"Edit",onClick:usr=>this.edit(usr)}])]}};this.model=this.app.getModel(api.users,(0,manager_1.defaultHandlers)(this))}edit(usr){this.spawn(()=>new edit_1.EditUserDialog(this.app,this.self(),usr))}}exports.UsersManager=UsersManager},{"../../api":1,"../../common/columns":2,"../../common/scene/manager":5,"../columns":24,"../dialogs/edit":27,"./views/users":29,"@quenk/noni/lib/control/timer":72}],29:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.UsersManagerView=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const grid_1=require("@quenk/wml-widgets/lib/layout/grid");const table_1=require("@quenk/wml-widgets/lib/data/table");const text_field_1=require("@quenk/wml-widgets/lib/control/text-field");const header_1=require("../../../common/scene/manager/views/header");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class UsersManagerView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.widget(new grid_1.GridLayout({},[__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.registerView(new header_1.ManagerHeader(__context.values.table)).render()]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new text_field_1.TextField({placeholder:"Search",onChange:__context.values.search.onChange},[]),{placeholder:"Search",onChange:__context.values.search.onChange})]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new table_1.DataTable({wml:{id:__context.values.table.id},data:__context.values.table.data,columns:__context.values.table.columns},[]),{wml:{id:__context.values.table.id},data:__context.values.table.data,columns:__context.values.table.columns})]),{})]),{})]),{})})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.UsersManagerView=UsersManagerView},{"../../../common/scene/manager/views/header":6,"@quenk/noni/lib/data/maybe":77,"@quenk/wml-widgets/lib/control/text-field":156,"@quenk/wml-widgets/lib/data/table":164,"@quenk/wml-widgets/lib/layout/grid":172,"@quenk/wml/lib/dom":189}],30:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MiaView=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const action_bar_1=require("@quenk/wml-widgets/lib/layout/action-bar");const nav_1=require("@quenk/wml-widgets/lib/menu/nav");const item_1=require("@quenk/wml-widgets/lib/menu/item");const link_1=require("@quenk/wml-widgets/lib/content/link");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class MiaView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("div",{wml:{id:"main"}},[__this.widget(new action_bar_1.ActionBar({className:"mia-navbar-bar"},[__this.widget(new nav_1.NavMenu({className:"mia-logout",items:__context.values.header.links},[__this.widget(new item_1.Item({},[__this.widget(new link_1.Link({text:"Logout",onClick:__context.values.header.logout},[]),{text:"Logout",onClick:__context.values.header.logout})]),{})]),{className:"mia-logout",items:__context.values.header.links})]),{className:"mia-navbar-bar"}),__this.node("div",{wml:{id:"content"},id:"content"},[])])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.MiaView=MiaView},{"@quenk/noni/lib/data/maybe":77,"@quenk/wml-widgets/lib/content/link":118,"@quenk/wml-widgets/lib/layout/action-bar":170,"@quenk/wml-widgets/lib/menu/item":181,"@quenk/wml-widgets/lib/menu/nav":186,"@quenk/wml/lib/dom":189}],31:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});const app_1=require("./app");window.system=app_1.Mia.create(document.getElementById("app"),document.getElementById("dialogs"));window.system.run()},{"./app":14}],32:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.compile=exports.takeHash=exports.HashRouter=exports.DefaultRequest=exports.AbstractHashRouter=exports.Cache=void 0;var qs=require("qs");var toRegex=require("path-to-regexp");var function_1=require("@quenk/noni/lib/data/function");var future_1=require("@quenk/noni/lib/control/monad/future");var record_1=require("@quenk/noni/lib/data/record");var EVENT_HASH_CHANGED="hashchange";var Cache=function(){function Cache(regex,keys,filters,handler){this.regex=regex;this.keys=keys;this.filters=filters;this.handler=handler}return Cache}();exports.Cache=Cache;var AbstractHashRouter=function(){function AbstractHashRouter(window,routes){if(routes===void 0){routes={}}this.window=window;this.routes=routes;this.cache=[];this.keys=[]}AbstractHashRouter.prototype.handleEvent=function(_){var _this=this;var _a=exports.takeHash(this.window),path=_a[0],query=_a[1];var cache=this.cache;var mware=[];var handler=function(){return future_1.pure(undefined)};var keys=[];var r=null;var count=0;while(r==null&&count<cache.length){r=cache[count].regex.exec(path);keys=cache[count].keys;mware=cache[count].filters;handler=cache[count].handler;count=count+1}if(r!=null){var ft=this.createRequest(path,qs.parse(query),parseParams(keys,r));mware.reduce(function(p,c){return p.chain(c)},ft).chain(handler).catch(function(e){return _this.onError(e)}).fork(console.error,function_1.noop)}else{this.onNotFound(path).fork(console.error,function_1.noop)}};AbstractHashRouter.prototype.add=function(path,handler){if(this.routes.hasOwnProperty(path)){this.routes[path][1]=handler}else{this.routes[path]=[[],handler]}this.cache=exports.compile(this.routes);return this};AbstractHashRouter.prototype.use=function(path,mware){if(this.routes.hasOwnProperty(path)){this.routes[path][0].push(mware)}else{this.routes[path]=[[mware],function(){return future_1.pure(undefined)}]}this.cache=exports.compile(this.routes);return this};AbstractHashRouter.prototype.clear=function(){this.cache=[];this.routes={}};AbstractHashRouter.prototype.start=function(){this.window.addEventListener(EVENT_HASH_CHANGED,this);return this};AbstractHashRouter.prototype.stop=function(){this.window.removeEventListener(EVENT_HASH_CHANGED,this);return this};return AbstractHashRouter}();exports.AbstractHashRouter=AbstractHashRouter;var DefaultRequest=function(){function DefaultRequest(path,query,params){this.path=path;this.query=query;this.params=params}return DefaultRequest}();exports.DefaultRequest=DefaultRequest;var HashRouter=function(_super){__extends(HashRouter,_super);function HashRouter(window,routes,error,notFound){if(routes===void 0){routes={}}if(error===void 0){error=function(e){return future_1.raise(e)}}if(notFound===void 0){notFound=function(){return future_1.pure(function_1.noop())}}var _this=_super.call(this,window,routes)||this;_this.window=window;_this.routes=routes;_this.error=error;_this.notFound=notFound;return _this}HashRouter.prototype.createRequest=function(path,query,params){return future_1.pure(new DefaultRequest(path,query,params))};HashRouter.prototype.onError=function(e){return this.error(e)};HashRouter.prototype.onNotFound=function(path){return this.notFound(path)};return HashRouter}(AbstractHashRouter);exports.HashRouter=HashRouter;var parseParams=function(keys,results){var params=Object.create(null);keys.forEach(function(key,index){return params[key.name]=results[index+1]});return params};exports.takeHash=function(w){return w.location.hash!=null&&w.location.hash!=""?w.location.hash.replace(/^#/,"/").replace(/\/\//g,"/").split("?"):["/"]};exports.compile=function(r){return record_1.reduce(r,[],function(p,c,path){var keys=[];return p.concat(new Cache(toRegex.pathToRegexp(path,keys),keys,c[0],c[1]))})}},{"@quenk/noni/lib/control/monad/future":70,"@quenk/noni/lib/data/function":76,"@quenk/noni/lib/data/record":78,"path-to-regexp":202,qs:205}],33:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Agent=exports.defaultOptions=void 0;const util=require("../util");const record_1=require("@quenk/noni/lib/data/record");const future_1=require("@quenk/noni/lib/control/monad/future");const string_1=require("@quenk/noni/lib/data/string");const request_1=require("../request");exports.defaultOptions={ttl:0,tags:{},context:{}};class Agent{constructor(host,cookies,options,transport,plugins){this.host=host;this.cookies=cookies;this.options=options;this.transport=transport;this.plugins=plugins}setTransport(transport,plugins=[]){let{host:host,cookies:cookies,options:options}=this;return new Agent(host,cookies,options,transport,plugins)}head(path,params={},options={}){return this.send(new request_1.Head(path,params,options))}get(path,params={},options={}){return this.send(new request_1.Get(path,params,options))}post(path,body,options={}){return this.send(new request_1.Post(path,body,options))}put(path,body,options={}){return this.send(new request_1.Put(path,body,options))}patch(path,body,options={}){return this.send(new request_1.Patch(path,body,options))}delete(path,body,options={}){return this.send(new request_1.Delete(path,body,options))}send(req){let that=this;return(0,future_1.doFuture)(function*(){let{host:host,cookies:cookies,options:options,transport:transport,plugins:plugins}=that;options=(0,record_1.rmerge3)(exports.defaultOptions,options,req.options);let port=options.port;let{method:method,params:params,body:body}=req;let{tags:tags,context:context={},ttl:ttl,headers:headers={}}=options;let path=util.urlFromString((0,string_1.interpolate)(req.path,context),params);let ctx={host:host,port:port,method:method,path:path,body:body,cookies:cookies,options:{headers:headers,ttl:ttl,tags:tags,context:context}};ctx=yield(0,future_1.reduce)(plugins,ctx,(ctx,plg)=>plg.beforeRequest(ctx));let res=yield transport.send(ctx);return(0,future_1.reduce)(plugins,res,(res,plg)=>plg.afterResponse(res))})}}exports.Agent=Agent},{"../request":43,"../util":47,"@quenk/noni/lib/control/monad/future":70,"@quenk/noni/lib/data/record":78,"@quenk/noni/lib/data/string":80}],34:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JSONParser=void 0;const record_1=require("@quenk/noni/lib/data/record");const error_1=require("@quenk/noni/lib/control/error");const either_1=require("@quenk/noni/lib/data/either");const defaultOptions={prefix:/^\)\]\}',?\n/,lenient:false};class JSONParser{constructor(options={}){this.options=options;this.responseType="";this.accepts="application/json";this.opts=(0,record_1.merge)(defaultOptions,this.options)}apply(body){let{prefix:prefix,lenient:lenient}=this.opts;let str=body.replace(prefix,"");let eresult=(0,error_1.attempt)(()=>JSON.parse(str));return eresult.isLeft()&&lenient?(0,either_1.right)({}):eresult}}exports.JSONParser=JSONParser},{"@quenk/noni/lib/control/error":69,"@quenk/noni/lib/data/either":75,"@quenk/noni/lib/data/record":78}],35:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CSRFProtectionPlugin=exports.DEFAULT_CSRF_HEADER_NAME=exports.DEFAULT_CSRF_COOKIE_NAME=void 0;const future_1=require("@quenk/noni/lib/control/monad/future");const record_1=require("@quenk/noni/lib/data/record");exports.DEFAULT_CSRF_COOKIE_NAME="xsrf-token";exports.DEFAULT_CSRF_HEADER_NAME="x-xsrf-token";class CSRFProtectionPlugin{constructor(cookie=exports.DEFAULT_CSRF_COOKIE_NAME,header=exports.DEFAULT_CSRF_HEADER_NAME){this.cookie=cookie;this.header=header}beforeRequest(ctx){let mvalue=ctx.cookies.getCookie(this.cookie);if(mvalue.isJust())ctx.options.headers=(0,record_1.merge)(ctx.options.headers,{[this.header]:mvalue.get().value});return(0,future_1.pure)(ctx)}afterResponse(r){return(0,future_1.pure)(r)}}exports.CSRFProtectionPlugin=CSRFProtectionPlugin},{"@quenk/noni/lib/control/monad/future":70,"@quenk/noni/lib/data/record":78}],36:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JSONTransform=void 0;const util=require("../../util");const error_1=require("@quenk/noni/lib/control/error");class JSONTransform{constructor(){this.type="application/json;charset=utf-8"}apply(body){return(0,error_1.attempt)(()=>util.isObject(body)&&!util.isFile(body)&&!util.isBlob(body)&&!util.isFormData(body)?JSON.stringify(body):""+body)}}exports.JSONTransform=JSONTransform},{"../../util":47,"@quenk/noni/lib/control/error":69}],37:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.XHRTransport=void 0;const future_1=require("@quenk/noni/lib/control/monad/future");const header_1=require("../../header");const response_1=require("../../response");const method_1=require("../../request/method");const headers_1=require("../../headers");class XHRTransport{constructor(responseType="",transform,parser){this.responseType=responseType;this.transform=transform;this.parser=parser}send(ctx){let{parser:parser,transform:transform}=this;let{host:host,port:port,path:path,method:method,body:body,options:options,cookies:cookies}=ctx;let xhr=new XMLHttpRequest;let portNumer=port&&port!==80&&port!==443?`:${port}`:"";let url=`${host}${portNumer}${path[0]==="/"?"":"/"}${path}`;return new future_1.Run((onError,onSuccess)=>{let transBody=undefined;if(body!=null){let exceptBody=transform.apply(body);if(exceptBody.isLeft()){onError(new Error(exceptBody.takeLeft().message));return()=>{}}else{transBody=exceptBody.takeRight()}}xhr.open(method,url,true);xhr.onload=(()=>{cookies.setCookies(document.cookie.split(";"));if(xhr.status===204){onSuccess((0,response_1.createResponse)(xhr.status,undefined,(0,header_1.fromString)(xhr.getAllResponseHeaders()),ctx))}else{let exceptRes=parser.apply(xhr.response);if(exceptRes.isLeft()){onError(new Error(exceptRes.takeLeft().message))}else{let r=(0,response_1.createResponse)(xhr.status,exceptRes.takeRight(),(0,header_1.fromString)(xhr.getAllResponseHeaders()),ctx);onSuccess(r)}}});xhr.timeout=options.ttl;xhr.responseType=this.responseType;xhr.onerror=(()=>onError(new Error("TransportError")));xhr.onabort=(()=>onError(new Error("AbortError")));Object.keys(options.headers).forEach(k=>{xhr.setRequestHeader(k,options.headers[k])});if(method===method_1.Method.Get||method===method_1.Method.Head)xhr.setRequestHeader(headers_1.ACCEPTS,parser.accepts);else if(transform.type!=="multipart/form-data")xhr.setRequestHeader(headers_1.CONTENT_TYPE,transform.type);xhr.send(transBody);return()=>xhr.abort()})}}exports.XHRTransport=XHRTransport},{"../../header":41,"../../headers":42,"../../request/method":44,"../../response":45,"@quenk/noni/lib/control/monad/future":70}],38:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.get=exports.createAgent=exports.splitUrl=void 0;const document_1=require("./cookie/container/document");const json_1=require("./agent/transform/json");const json_2=require("./agent/parser/json");const xhr_1=require("./agent/transport/xhr");const request_1=require("./request");const csrf_1=require("./agent/plugin/csrf");const agent_1=require("./agent");const HTTP="http://";const HTTPS="https://";const splitUrl=url=>{let split=url.split(HTTP).join("").split(HTTPS).join("").split("/");if(split.length===1||split.length===2&&split[1]==="")return[split[0],"/"];return[split[0],"/"+split.slice(1).join("/")]};exports.splitUrl=splitUrl;const createAgent=(host=getHost(),port=getPort())=>new agent_1.Agent(host,document_1.DocumentContainer.create(),{ttl:0,tags:{},context:{},port:port},new xhr_1.XHRTransport("",new json_1.JSONTransform,new json_2.JSONParser({lenient:true})),[new csrf_1.CSRFProtectionPlugin]);exports.createAgent=createAgent;const getHost=()=>`${window.location.protocol}//${window.location.hostname}`;const getPort=()=>{let port=window.location.port;return Number(port===""||port==null?80:port)};const get=(url,params={},options={})=>{let[host,path]=(0,exports.splitUrl)(url);return(0,exports.createAgent)(host).send(new request_1.Get(path,params,options))};exports.get=get},{"./agent":33,"./agent/parser/json":34,"./agent/plugin/csrf":35,"./agent/transform/json":36,"./agent/transport/xhr":37,"./cookie/container/document":39,"./request":43}],39:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DocumentContainer=void 0;const record_1=require("@quenk/noni/lib/data/record");const __1=require("../");class DocumentContainer{constructor(store=document,cookies={}){this.store=store;this.cookies=cookies}static create(store=document){return new DocumentContainer(store,(0,__1.fromCookieHeader)(store.cookie))}getCookies(){return(0,record_1.make)(this.cookies)}getCookie(name){return(0,__1.getCookieByName)(this.cookies,name)}setCookies(_){this.cookies=(0,__1.fromCookieHeader)(this.store.cookie);return this}}exports.DocumentContainer=DocumentContainer},{"../":40,"@quenk/noni/lib/data/record":78}],40:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.toCookieHeader=exports.getCookieByName=exports.fromList=exports.fromCookieHeader=void 0;const record_1=require("@quenk/noni/lib/data/record");const fromCookieHeader=str=>{let rec=(0,record_1.make)();let cookies=str.split(";");let created=new Date;for(let i=0;i<cookies.length;i++){let cookie=cookies[i];let cookieLength=cookie.length;let delimIdx=cookie.indexOf("=");delimIdx=delimIdx<0?cookieLength:delimIdx;let name=decodeURIComponent(cookie.substring(0,delimIdx).replace(/^\s+|\s+$/g,""));let value=decodeURIComponent(cookie.substring(delimIdx+1,cookieLength));let c={name:name,value:value,created:created};rec[getPath(c)]=c}return rec};exports.fromCookieHeader=fromCookieHeader;const fromList=list=>list.reduce((p,c)=>(0,record_1.merge)(p,{[getPath(c)]:c}),{});exports.fromList=fromList;const getPath=c=>[c.name,c.domain,c.path].join(";;");const getCookieByName=(store,name)=>(0,record_1.pickValue)(store,c=>c.name===name);exports.getCookieByName=getCookieByName;const toCookieHeader=store=>(0,record_1.mapTo)(store,c=>`${c.name}=${c.value}`).join("; ");exports.toCookieHeader=toCookieHeader},{"@quenk/noni/lib/data/record":78}],41:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.set=exports.fromString=void 0;const fromString=headers=>{if(!headers)return{};var result={};headers.trim().split("\n").forEach(row=>{let index=row.indexOf(":");let key=row.slice(0,index).toLowerCase().trim();let value=row.slice(index+1).trim();if(typeof result[key]==="undefined"){result[key]=value}else if(Array.isArray(result[key])){result[key].push(value)}else{result[key]=[result[key],value]}});return result};exports.fromString=fromString;const set=(xhr,...args)=>{let i=args.length;if(args.length>0)while(i--)if(i!==0)Object.keys(args[i]).forEach(k=>{if(args[i][k]!=null)xhr.setRequestHeader(k,args[i][k])})};exports.set=set},{}],42:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ACCEPTS=exports.CONTENT_TYPE=void 0;exports.CONTENT_TYPE="Content-Type";exports.ACCEPTS="Accept"},{}],43:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Delete=exports.Patch=exports.Put=exports.Post=exports.Get=exports.Head=void 0;const method_1=require("./method");const defaultOptions={ttl:0,tags:{},context:{},headers:{}};class Head{constructor(path,params={},options=defaultOptions){this.path=path;this.params=params;this.options=options;this.method=method_1.Method.Head}}exports.Head=Head;class Get extends Head{constructor(){super(...arguments);this.method=method_1.Method.Get}}exports.Get=Get;class Post{constructor(path,body,options=defaultOptions){this.path=path;this.body=body;this.options=options;this.method=method_1.Method.Post}}exports.Post=Post;class Put extends Post{constructor(){super(...arguments);this.method=method_1.Method.Put}}exports.Put=Put;class Patch extends Post{constructor(){super(...arguments);this.method=method_1.Method.Patch}}exports.Patch=Patch;class Delete extends Post{constructor(){super(...arguments);this.method=method_1.Method.Delete}}exports.Delete=Delete},{"./method":44}],44:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Method=void 0;var Method;(function(Method){Method["Head"]="HEAD";Method["Get"]="GET";Method["Put"]="PUT";Method["Post"]="POST";Method["Delete"]="DELETE";Method["Patch"]="PATCH"})(Method=exports.Method||(exports.Method={}))},{}],45:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.createResponse=exports.InternalServerError=exports.ServerError=exports.Conflict=exports.NotFound=exports.Forbidden=exports.Unauthorized=exports.BadRequest=exports.ClientError=exports.Created=exports.NoContent=exports.Accepted=exports.Ok=exports.Success=exports.GenericResponse=void 0;const status=require("./status");class GenericResponse{constructor(code,body,headers,request){this.code=code;this.body=body;this.headers=headers;this.request=request}}exports.GenericResponse=GenericResponse;class Success extends GenericResponse{}exports.Success=Success;class Ok extends Success{constructor(body,headers,request){super(status.OK,body,headers,request);this.body=body;this.headers=headers;this.request=request}}exports.Ok=Ok;class Accepted extends Success{constructor(body,headers,request){super(status.ACCEPTED,body,headers,request);this.body=body;this.headers=headers;this.request=request}}exports.Accepted=Accepted;class NoContent extends Success{constructor(body,headers,request){super(status.NO_CONTENT,body,headers,request);this.body=body;this.headers=headers;this.request=request}}exports.NoContent=NoContent;class Created extends Success{constructor(body,headers,request){super(status.CREATED,body,headers,request);this.body=body;this.headers=headers;this.request=request}}exports.Created=Created;class ClientError extends GenericResponse{}exports.ClientError=ClientError;class BadRequest extends ClientError{constructor(body,headers,request){super(status.BAD_REQUEST,body,headers,request);this.body=body;this.headers=headers;this.request=request}}exports.BadRequest=BadRequest;class Unauthorized extends ClientError{constructor(body,headers,request){super(status.UNAUTHORIZED,body,headers,request);this.body=body;this.headers=headers;this.request=request}}exports.Unauthorized=Unauthorized;class Forbidden extends ClientError{constructor(body,headers,request){super(status.FORBIDDEN,body,headers,request);this.body=body;this.headers=headers;this.request=request}}exports.Forbidden=Forbidden;class NotFound extends ClientError{constructor(body,headers,request){super(status.NOT_FOUND,body,headers,request);this.body=body;this.headers=headers;this.request=request}}exports.NotFound=NotFound;class Conflict extends ClientError{constructor(body,headers,request){super(status.CONFLICT,body,headers,request);this.body=body;this.headers=headers;this.request=request}}exports.Conflict=Conflict;class ServerError extends GenericResponse{}exports.ServerError=ServerError;class InternalServerError extends ServerError{constructor(body,headers,request){super(status.INTERNAL_SERVER_ERROR,body,headers,request);this.body=body;this.headers=headers;this.request=request;this.status=status.INTERNAL_SERVER_ERROR}}exports.InternalServerError=InternalServerError;const createResponse=(code,body,headers,request)=>{switch(code){case status.OK:return new Ok(body,headers,request);case status.ACCEPTED:return new Accepted(body,headers,request);case status.NO_CONTENT:return new NoContent(body,headers,request);case status.CREATED:return new Created(body,headers,request);case status.BAD_REQUEST:return new BadRequest(body,headers,request);case status.BAD_REQUEST:return new BadRequest(body,headers,request);case status.UNAUTHORIZED:return new Unauthorized(body,headers,request);case status.FORBIDDEN:return new Forbidden(body,headers,request);case status.NOT_FOUND:return new NotFound(body,headers,request);case status.CONFLICT:return new Conflict(body,headers,request);case status.INTERNAL_SERVER_ERROR:return new InternalServerError(body,headers,request);default:if(code>=400&&code<=499)return new ClientError(code,body,headers,request);else if(code>=500)return new ServerError(code,body,headers,request);else return new GenericResponse(code,body,headers,request)}};exports.createResponse=createResponse},{"./status":46}],46:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.NOT_IMPLEMENTED=exports.INTERNAL_SERVER_ERROR=exports.UNAVAILABLE_FOR_LEGAL_RREASONS=exports.REQUEST_HEADER_FIELDS_TOO_LARGE=exports.TOO_MANY_REQUESTS=exports.PRECONDITION_REQUIRED=exports.UPGRADE_REQUIRED=exports.FAILED_DEPENDENCY=exports.LOCKED=exports.UNPROCESSABLE_ENTITY=exports.TEAPOT=exports.EXPECTATION_FAILED=exports.REQUESTED_RANGE_NOT_SATISFIABLE=exports.UNSUPPORTED_MEDIA_TYPE=exports.REQUEST_URI_TOO_LONG=exports.REQUEST_ENTITY_TOO_LARGE=exports.PRECONDITION_FAILED=exports.LENGTH_REQUIRED=exports.GONE=exports.CONFLICT=exports.REQUEST_TIMEOUT=exports.PROXY_AUTH_REQUIRED=exports.NOT_ACCEPTABLE=exports.METHOD_NOT_ALLOWED=exports.NOT_FOUND=exports.FORBIDDEN=exports.PAYMENT_REQUIRED=exports.UNAUTHORIZED=exports.BAD_REQUEST=exports.PERMANENT_REDIRECT=exports.TEMPORARY_REDIRECT=exports.USE_PROXY=exports.NOT_MODIFIED=exports.SEE_OTHER=exports.FOUND=exports.MOVED_PERMANENTLY=exports.MULTIPLE_CHOICES=exports.IM_USED=exports.ALREADY_REPORTED=exports.MULTI_STATUS=exports.PARTIAL_CONTENT=exports.RESET_CONTENT=exports.NO_CONTENT=exports.NON_AUTHORITATIV_INFO=exports.ACCEPTED=exports.CREATED=exports.OK=exports.PROCESSING=exports.SWITCHING_PROTOCOLS=exports.CONTINUE=void 0;exports.NETWORK_AUTHENTICATION_REQUIRED=exports.NOT_EXTENDED=exports.LOOP_DETECTED=exports.INSUFFICIENT_STORAGE=exports.VARIANT_ALSO_NEGOTIATES=exports.HTTP_VERSION_NOT_SUPPORTED=exports.GATEWAY_TIMEOUT=exports.SERVICE_UNAVAILABLE=exports.BAD_GATEWAY=void 0;exports.CONTINUE=100;exports.SWITCHING_PROTOCOLS=101;exports.PROCESSING=102;exports.OK=200;exports.CREATED=201;exports.ACCEPTED=202;exports.NON_AUTHORITATIV_INFO=203;exports.NO_CONTENT=204;exports.RESET_CONTENT=205;exports.PARTIAL_CONTENT=206;exports.MULTI_STATUS=207;exports.ALREADY_REPORTED=208;exports.IM_USED=226;exports.MULTIPLE_CHOICES=300;exports.MOVED_PERMANENTLY=301;exports.FOUND=302;exports.SEE_OTHER=303;exports.NOT_MODIFIED=304;exports.USE_PROXY=305;exports.TEMPORARY_REDIRECT=307;exports.PERMANENT_REDIRECT=308;exports.BAD_REQUEST=400;exports.UNAUTHORIZED=401;exports.PAYMENT_REQUIRED=402;exports.FORBIDDEN=403;exports.NOT_FOUND=404;exports.METHOD_NOT_ALLOWED=405;exports.NOT_ACCEPTABLE=406;exports.PROXY_AUTH_REQUIRED=407;exports.REQUEST_TIMEOUT=408;exports.CONFLICT=409;exports.GONE=410;exports.LENGTH_REQUIRED=411;exports.PRECONDITION_FAILED=412;exports.REQUEST_ENTITY_TOO_LARGE=413;exports.REQUEST_URI_TOO_LONG=414;exports.UNSUPPORTED_MEDIA_TYPE=415;exports.REQUESTED_RANGE_NOT_SATISFIABLE=416;exports.EXPECTATION_FAILED=417;exports.TEAPOT=418;exports.UNPROCESSABLE_ENTITY=422;exports.LOCKED=423;exports.FAILED_DEPENDENCY=424;exports.UPGRADE_REQUIRED=426;exports.PRECONDITION_REQUIRED=428;exports.TOO_MANY_REQUESTS=429;exports.REQUEST_HEADER_FIELDS_TOO_LARGE=431;exports.UNAVAILABLE_FOR_LEGAL_RREASONS=451;exports.INTERNAL_SERVER_ERROR=500;exports.NOT_IMPLEMENTED=501;exports.BAD_GATEWAY=502;exports.SERVICE_UNAVAILABLE=503;exports.GATEWAY_TIMEOUT=504;exports.HTTP_VERSION_NOT_SUPPORTED=505;exports.VARIANT_ALSO_NEGOTIATES=506;exports.INSUFFICIENT_STORAGE=507;exports.LOOP_DETECTED=508;exports.NOT_EXTENDED=510;exports.NETWORK_AUTHENTICATION_REQUIRED=511},{}],47:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.urlFromString=exports.isBlob=exports.isFormData=exports.isFile=exports.isObject=void 0;const qs_1=require("./qs");const isObject=obj=>typeof obj==="object";exports.isObject=isObject;const isFile=obj=>toString.call(obj)==="[object File]";exports.isFile=isFile;const isFormData=obj=>toString.call(obj)==="[object FormData]";exports.isFormData=isFormData;const isBlob=obj=>toString.call(obj)==="[object Blob]";exports.isBlob=isBlob;const urlFromString=(url,params={})=>`${url}?${(0,qs_1.stringify)(params)}`;exports.urlFromString=urlFromString},{"./qs":48}],48:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.stringify=exports.formats=void 0;const record_1=require("@quenk/noni/lib/data/record");const percentTwenties=/%20/g;const Format={RFC1738:"RFC1738",RFC3986:"RFC3986"};exports.formats=(0,record_1.assign)({default:Format.RFC3986,formatters:{RFC1738:value=>replace.call(value,percentTwenties,"+"),RFC3986:String}},Format);const arrayPrefixGenerators={brackets:prefix=>prefix+"[]",comma:"comma",indices:(prefix,key)=>prefix+"["+key+"]",repeat:prefix=>prefix};const has=Object.prototype.hasOwnProperty;const replace=String.prototype.replace;const isArray=Array.isArray;const push=Array.prototype.push;const pushToArray=(arr,valueOrArray)=>{push.apply(arr,isArray(valueOrArray)?valueOrArray:[valueOrArray])};const toISO=Date.prototype.toISOString;const defaultFormat=exports.formats["default"];const hexTable=function(){let array=[];for(let i=0;i<256;++i)array.push("%"+((i<16?"0":"")+i.toString(16)).toUpperCase());return array}();const utilsEncode=(str,_,charset)=>{if(str.length===0){return str}let string=str;if(typeof str==="symbol"){string=Symbol.prototype.toString.call(str)}else if(typeof str!=="string"){string=String(str)}if(charset==="iso-8859-1"){return escape(string).replace(/%u[0-9a-f]{4}/gi,function($0){return"%26%23"+parseInt($0.slice(2),16)+"%3B"})}let out="";for(let i=0;i<string.length;++i){let c=string.charCodeAt(i);if(c===45||c===46||c===95||c===126||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122){out+=string.charAt(i);continue}if(c<128){out=out+hexTable[c];continue}if(c<2048){out=out+(hexTable[192|c>>6]+hexTable[128|c&63]);continue}if(c<55296||c>=57344){out=out+(hexTable[224|c>>12]+hexTable[128|c>>6&63]+hexTable[128|c&63]);continue}i+=1;c=65536+((c&1023)<<10|string.charCodeAt(i)&1023);out+=hexTable[240|c>>18]+hexTable[128|c>>12&63]+hexTable[128|c>>6&63]+hexTable[128|c&63]}return out};const utilsMaybeMap=(val,fn)=>{if(isArray(val)){let mapped=[];for(let i=0;i<val.length;i+=1){mapped.push(fn(val[i]))}return mapped}return fn(val)};const utilsIsBuffer=obj=>{if(!obj||typeof obj!=="object"){return false}return!!(obj.constructor&&obj.constructor.isBuffer&&obj.constructor.isBuffer(obj))};const isNonNullishPrimitive=v=>typeof v==="string"||typeof v==="number"||typeof v==="boolean"||typeof v==="symbol"||typeof v==="bigint";const defaults={addQueryPrefix:false,allowDots:false,charset:"utf-8",charsetSentinel:false,delimiter:"&",encode:true,encoder:utilsEncode,encodeValuesOnly:false,format:defaultFormat,formatter:exports.formats.formatters[defaultFormat],indices:false,serializeDate:date=>toISO.call(date),skipNulls:false,strictNullHandling:false};function doStringify(target,prefix,generateArrayPrefix,strictNullHandling,skipNulls,encoder,filter,sort,allowDots,serializeDate,formatter,encodeValuesOnly,charset){let obj=target;if(typeof filter==="function"){obj=filter(prefix,obj)}else if(obj instanceof Date){obj=serializeDate(obj)}else if(generateArrayPrefix==="comma"&&isArray(obj)){obj=utilsMaybeMap(obj,function(value){if(value instanceof Date){return new String(serializeDate(value))}return value})}if(obj===null){if(strictNullHandling){return encoder&&!encodeValuesOnly?encoder(prefix,defaults.encoder,charset,"key"):prefix}obj=""}if(isNonNullishPrimitive(obj)||utilsIsBuffer(obj)){if(encoder){let keyValue=encodeValuesOnly?prefix:encoder(prefix,defaults.encoder,charset,"key");return[formatter(keyValue)+"="+formatter(encoder(obj,defaults.encoder,charset,"value"))]}return[formatter(prefix)+"="+formatter(String(obj))]}let values=[];if(typeof obj==="undefined"){return values}let objKeys;if(generateArrayPrefix==="comma"&&isArray(obj)){objKeys=[{value:obj.length>0?obj.join(",")||null:undefined}]}else if(isArray(filter)){objKeys=filter}else{let keys=Object.keys(obj);objKeys=sort?keys.sort(sort):keys}for(let i=0;i<objKeys.length;++i){let key=objKeys[i];let value=typeof key==="object"&&key.value!==undefined?key.value:obj[key];if(skipNulls&&value===null){continue}let keyPrefix=isArray(obj)?typeof generateArrayPrefix==="function"?generateArrayPrefix(prefix,key):prefix:prefix+(allowDots?"."+key:"["+key+"]");pushToArray(values,doStringify(value,keyPrefix,generateArrayPrefix,strictNullHandling,skipNulls,encoder,filter,sort,allowDots,serializeDate,formatter,encodeValuesOnly,charset))}return values}const normalizeStringifyOptions=opts=>{if(!opts){return defaults}if(opts.encoder!==null&&opts.encoder!==undefined&&typeof opts.encoder!=="function"){throw new TypeError("Encoder has to be a function.")}let charset=opts.charset||defaults.charset;if(typeof opts.charset!=="undefined"&&opts.charset!=="utf-8"&&opts.charset!=="iso-8859-1"){throw new TypeError("The charset option must be either utf-8,"+" iso-8859-1, or undefined")}let format=exports.formats["default"];if(typeof opts.format!=="undefined"){if(!has.call(exports.formats.formatters,opts.format)){throw new TypeError("Unknown format option provided.")}format=opts.format}let formatter=exports.formats.formatters[format];let filter;if(typeof opts.filter==="function"||isArray(opts.filter)){filter=opts.filter}return{addQueryPrefix:typeof opts.addQueryPrefix==="boolean"?opts.addQueryPrefix:defaults.addQueryPrefix,allowDots:typeof opts.allowDots==="undefined"?defaults.allowDots:!!opts.allowDots,charset:charset,charsetSentinel:typeof opts.charsetSentinel==="boolean"?opts.charsetSentinel:defaults.charsetSentinel,delimiter:typeof opts.delimiter==="undefined"?defaults.delimiter:opts.delimiter,encode:typeof opts.encode==="boolean"?opts.encode:defaults.encode,encoder:typeof opts.encoder==="function"?opts.encoder:defaults.encoder,encodeValuesOnly:typeof opts.encodeValuesOnly==="boolean"?opts.encodeValuesOnly:defaults.encodeValuesOnly,filter:filter,formatter:formatter,serializeDate:typeof opts.serializeDate==="function"?opts.serializeDate:defaults.serializeDate,skipNulls:typeof opts.skipNulls==="boolean"?opts.skipNulls:defaults.skipNulls,sort:typeof opts.sort==="function"?opts.sort:undefined,strictNullHandling:typeof opts.strictNullHandling==="boolean"?opts.strictNullHandling:defaults.strictNullHandling}};function stringify(target,opts={}){let obj=target;let options=normalizeStringifyOptions(opts);let objKeys;let filter;if(typeof options.filter==="function"){filter=options.filter;obj=filter("",obj)}else if(isArray(options.filter)){filter=options.filter;objKeys=filter}let keys=[];if(typeof obj!=="object"||obj===null){return""}let arrayFormat;if(opts&&opts.arrayFormat&&opts.arrayFormat in arrayPrefixGenerators){arrayFormat=opts.arrayFormat}else if(opts&&"indices"in opts){arrayFormat=opts.indices?"indices":"repeat"}else{arrayFormat="indices"}let generateArrayPrefix=arrayPrefixGenerators[arrayFormat];if(!objKeys){objKeys=Object.keys(obj)}if(options.sort){objKeys.sort(options.sort)}for(let i=0;i<objKeys.length;++i){let key=objKeys[i];if(options.skipNulls&&obj[key]===null){continue}pushToArray(keys,doStringify(obj[key],key,generateArrayPrefix,options.strictNullHandling,options.skipNulls,options.encode?options.encoder:undefined,options.filter,options.sort,options.allowDots,options.serializeDate,options.formatter,options.encodeValuesOnly,options.charset))}let joined=keys.join(options.delimiter);let prefix=options.addQueryPrefix===true?"?":"";if(options.charsetSentinel){if(options.charset==="iso-8859-1"){prefix+="utf8=%26%2310003%3B&"}else{prefix+="utf8=%E2%9C%93&"}}return joined.length>0?prefix+joined:""}exports.stringify=stringify},{"@quenk/noni/lib/data/record":78}],49:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Proxy=exports.Immutable=exports.Mutable=void 0;const mutable_1=require("@quenk/potoo/lib/actor/resident/mutable");Object.defineProperty(exports,"Mutable",{enumerable:true,get:function(){return mutable_1.Mutable}});const immutable_1=require("@quenk/potoo/lib/actor/resident/immutable");Object.defineProperty(exports,"Immutable",{enumerable:true,get:function(){return immutable_1.Immutable}});class Proxy{constructor(instance){this.instance=instance}self(){return this.instance.self()}spawn(t){return this.instance.spawn(t)}spawnGroup(name,tmpls){return this.instance.spawnGroup(name,tmpls)}tell(actor,m){this.instance.tell(actor,m);return this}select(c){this.instance.select(c);return this}raise(e){this.instance.raise(e);return this}kill(addr){this.instance.kill(addr);return this}wait(ft){return this.instance.wait(ft)}exit(){this.exit()}}exports.Proxy=Proxy},{"@quenk/potoo/lib/actor/resident/immutable":89,"@quenk/potoo/lib/actor/resident/mutable":91}],50:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Jouvert=void 0;const vm_1=require("@quenk/potoo/lib/actor/system/vm");class Jouvert{constructor(conf={accept:m=>this.onMessage(m)}){this.conf=conf;this.vm=vm_1.PVM.create(this,this.conf);this.services={}}getPlatform(){return this.vm}onMessage(_){}tell(addr,msg){this.vm.tell(addr,msg);return this}spawn(tmpl){return this.vm.spawn(this.vm,tmpl)}service(key,tmpl){let addr=this.spawn(tmpl);this.services[key]=addr;return addr}}exports.Jouvert=Jouvert},{"@quenk/potoo/lib/actor/system/vm":95}],51:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SeqSendCallback=exports.ParSendCallback=exports.SendCallback=exports.CompositeBatchCompleteHandler=exports.CompositeCompleteHandler=exports.AbstractBatchCompleteHandler=exports.AbstractCompleteHandler=exports.SeqSend=exports.ParSend=exports.Send=void 0;const type_1=require("@quenk/noni/lib/data/type");const case_1=require("@quenk/potoo/lib/actor/resident/case");const callback_1=require("@quenk/potoo/lib/actor/resident/immutable/callback");const _1=require("./");Object.defineProperty(exports,"Send",{enumerable:true,get:function(){return _1.Send}});Object.defineProperty(exports,"ParSend",{enumerable:true,get:function(){return _1.ParSend}});Object.defineProperty(exports,"SeqSend",{enumerable:true,get:function(){return _1.SeqSend}});const future_1=require("@quenk/noni/lib/control/monad/future");const function_1=require("@quenk/noni/lib/data/function");const typeMatch={code:Number,request:Object,body:type_1.Any,headers:Object};class AbstractCompleteHandler{onError(_){}onClientError(_){}onServerError(_){}onComplete(_){}}exports.AbstractCompleteHandler=AbstractCompleteHandler;class AbstractBatchCompleteHandler extends AbstractCompleteHandler{onBatchComplete(_){}}exports.AbstractBatchCompleteHandler=AbstractBatchCompleteHandler;class CompositeCompleteHandler{constructor(handlers){this.handlers=handlers}onError(e){return(0,future_1.sequential)(this.handlers.map(h=>(0,future_1.wrap)(h.onError(e)))).map(function_1.noop)}onClientError(r){return(0,future_1.sequential)(this.handlers.map(h=>(0,future_1.wrap)(h.onClientError(r)))).map(function_1.noop)}onServerError(r){return(0,future_1.sequential)(this.handlers.map(h=>(0,future_1.wrap)(h.onServerError(r)))).map(function_1.noop)}onComplete(r){return(0,future_1.sequential)(this.handlers.map(h=>(0,future_1.wrap)(h.onComplete(r)))).map(function_1.noop)}}exports.CompositeCompleteHandler=CompositeCompleteHandler;class CompositeBatchCompleteHandler{constructor(handlers){this.handlers=handlers}onError(e){return(0,future_1.sequential)(this.handlers.map(h=>(0,future_1.wrap)(h.onError(e)))).map(function_1.noop)}onClientError(r){return(0,future_1.sequential)(this.handlers.map(h=>(0,future_1.wrap)(h.onClientError(r)))).map(function_1.noop)}onServerError(r){return(0,future_1.sequential)(this.handlers.map(h=>(0,future_1.wrap)(h.onServerError(r)))).map(function_1.noop)}onBatchComplete(r){return(0,future_1.sequential)(this.handlers.map(h=>(0,future_1.wrap)(h.onBatchComplete(r)))).map(function_1.noop)}}exports.CompositeBatchCompleteHandler=CompositeBatchCompleteHandler;class SendCallback extends callback_1.Callback{constructor(system,remote,request,handler){super(system);this.system=system;this.remote=remote;this.request=request;this.handler=handler}receive(){return[new case_1.Case(_1.TransportErr,e=>this.handler.onError(e)),new case_1.Case(typeMatch,r=>{if(r.code>499){return this.handler.onServerError(r)}else if(r.code>399){return this.handler.onClientError(r)}else{return this.handler.onComplete(r)}})]}run(){this.tell(this.remote,new _1.Send(this.self(),this.request))}}exports.SendCallback=SendCallback;class ParSendCallback extends callback_1.Callback{constructor(system,remote,requests,handler){super(system);this.system=system;this.remote=remote;this.requests=requests;this.handler=handler}receive(){return[new case_1.Case(_1.TransportErr,e=>this.handler.onError(e)),new case_1.Case(_1.BatchResponse,r=>{let failed=r.value.filter(r=>r.code>299);if(failed.length>0){let res=failed[0];if(res.code>499){return this.handler.onServerError(res)}else{return this.handler.onClientError(res)}}else{return this.handler.onBatchComplete(r)}})]}run(){this.tell(this.remote,new _1.ParSend(this.self(),this.requests))}}exports.ParSendCallback=ParSendCallback;class SeqSendCallback extends ParSendCallback{run(){this.tell(this.remote,new _1.SeqSend(this.self(),this.requests))}}exports.SeqSendCallback=SeqSendCallback},{"./":52,"@quenk/noni/lib/control/monad/future":70,"@quenk/noni/lib/data/function":76,"@quenk/noni/lib/data/type":81,"@quenk/potoo/lib/actor/resident/case":87,"@quenk/potoo/lib/actor/resident/immutable/callback":88}],52:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Remote=exports.BatchResponse=exports.TransportErr=exports.ParSend=exports.SeqSend=exports.Send=void 0;const future_1=require("@quenk/noni/lib/control/monad/future");const case_1=require("@quenk/potoo/lib/actor/resident/case");const actor_1=require("../../actor");class Send{constructor(client,request){this.client=client;this.request=request}}exports.Send=Send;class SeqSend{constructor(client,requests){this.client=client;this.requests=requests}}exports.SeqSend=SeqSend;class ParSend{constructor(client,requests){this.client=client;this.requests=requests}}exports.ParSend=ParSend;class TransportErr{constructor(client,error){this.client=client;this.error=error}get message(){return this.error.message}}exports.TransportErr=TransportErr;class BatchResponse{constructor(value){this.value=value}}exports.BatchResponse=BatchResponse;class Remote extends actor_1.Immutable{constructor(agent,system){super(system);this.agent=agent;this.system=system;this.onUnit=(({client:client,request:request})=>{let onErr=e=>this.tell(client,new TransportErr(client,e));let onSucc=res=>this.tell(client,res);this.agent.send(request).fork(onErr,onSucc)});this.onParallel=(({client:client,requests:requests})=>{let{agent:agent}=this;let onErr=e=>this.tell(client,e);let onSucc=res=>this.tell(client,new BatchResponse(res));let rs=requests.map(r=>agent.send(r).catch(e=>(0,future_1.raise)(new TransportErr(client,e))));(0,future_1.parallel)(rs).fork(onErr,onSucc)});this.onSequential=(({client:client,requests:requests})=>{let{agent:agent}=this;let onErr=e=>this.tell(client,e);let onSucc=res=>this.tell(client,new BatchResponse(res));let rs=requests.map(r=>agent.send(r).catch(e=>(0,future_1.raise)(new TransportErr(client,e))));(0,future_1.sequential)(rs).fork(onErr,onSucc)})}receive(){return[new case_1.Case(Send,this.onUnit),new case_1.Case(ParSend,this.onParallel),new case_1.Case(SeqSend,this.onSequential)]}}exports.Remote=Remote},{"../../actor":49,"@quenk/noni/lib/control/monad/future":70,"@quenk/potoo/lib/actor/resident/case":87}],53:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RemoteModelFactory=void 0;const record_1=require("@quenk/noni/lib/data/record");const callback_1=require("../callback");const decorators_1=require("../request/decorators");const _1=require("./");class RemoteModelFactory{constructor(remote,actor){this.remote=remote;this.actor=actor}static getInstance(actor,remote){return new RemoteModelFactory(remote,actor)}create(paths,handlers=[],decorator=new decorators_1.RequestPassthrough){return new _1.GenericRemoteModel(this.remote,this.actor,normalize(paths),Array.isArray(handlers)?new callback_1.CompositeCompleteHandler(handlers):handlers,decorator)}}exports.RemoteModelFactory=RemoteModelFactory;const normalize=paths=>(0,record_1.merge)(paths,{create:paths.create||paths.search,search:paths.search||paths.create,update:paths.update||paths.get||paths.remove,get:paths.get||paths.update||paths.remove,remove:paths.remove||paths.update||paths.get})},{"../callback":51,"../request/decorators":58,"./":57,"@quenk/noni/lib/data/record":78}],54:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FutureHandler=void 0;const future_1=require("@quenk/noni/lib/control/monad/future");class FutureHandler{constructor(handler,onFailure,onSuccess){this.handler=handler;this.onFailure=onFailure;this.onSuccess=onSuccess}onError(e){let that=this;return(0,future_1.doFuture)(function*(){yield(0,future_1.wrap)(that.handler.onError(e));that.onFailure(e.error instanceof Error?e.error:new Error(e.error.message));return future_1.voidPure})}onClientError(r){let that=this;return(0,future_1.doFuture)(function*(){yield(0,future_1.wrap)(that.handler.onClientError(r));let e=new Error("ClientError");e.code=r.code;that.onFailure(e);return future_1.voidPure})}onServerError(r){let that=this;return(0,future_1.doFuture)(function*(){yield(0,future_1.wrap)(that.handler.onServerError(r));let e=new Error("ServerError");e.code=r.code;that.onFailure(e);return future_1.voidPure})}onComplete(r){let that=this;return(0,future_1.doFuture)(function*(){yield(0,future_1.wrap)(that.handler.onComplete(r));that.onSuccess(r);return future_1.voidPure})}}exports.FutureHandler=FutureHandler},{"@quenk/noni/lib/control/monad/future":70}],55:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.GetResultHandler=exports.SearchResultHandler=exports.CreateResultHandler=void 0;const callback_1=require("../../callback");class CreateResultHandler extends callback_1.AbstractCompleteHandler{}exports.CreateResultHandler=CreateResultHandler;class SearchResultHandler extends callback_1.AbstractCompleteHandler{}exports.SearchResultHandler=SearchResultHandler;class GetResultHandler extends callback_1.AbstractCompleteHandler{}exports.GetResultHandler=GetResultHandler},{"../../callback":51}],56:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.VoidHandler=void 0;const callback_1=require("../../callback");class VoidHandler extends callback_1.AbstractCompleteHandler{}exports.VoidHandler=VoidHandler},{"../../callback":51}],57:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.GenericRemoteModel=exports.RemoteModel=exports.NO_PATH=void 0;const future_1=require("@quenk/noni/lib/control/monad/future");const maybe_1=require("@quenk/noni/lib/data/maybe");const string_1=require("@quenk/noni/lib/data/string");const record_1=require("@quenk/noni/lib/data/record");const type_1=require("@quenk/noni/lib/data/type");const request_1=require("@quenk/jhr/lib/request");const decorators_1=require("../request/decorators");const callback_1=require("../callback");const void_1=require("./handlers/void");const future_2=require("./handlers/future");exports.NO_PATH="invalid";class RemoteModel{constructor(remote,actor,handler=new void_1.VoidHandler,decorator=new decorators_1.RequestPassthrough){this.remote=remote;this.actor=actor;this.handler=handler;this.decorator=decorator}send(req){return(0,future_1.fromCallback)(cb=>{this.actor.spawn(s=>new callback_1.SendCallback(s,this.remote,this.decorator.decorate(req),new future_2.FutureHandler(this.handler,cb,r=>cb(null,r))))})}create(data){let that=this;return(0,future_1.doFuture)(function*(){let r=yield that.send(new request_1.Post(that.paths.create||exports.NO_PATH,data,{tags:{path:that.paths.create||that.paths.get||exports.NO_PATH,verb:"post",method:"create"}}));return(0,future_1.pure)(r.body.data.id)})}search(qry){let that=this;return(0,future_1.doFuture)(function*(){let r=yield that.send(new request_1.Get(that.paths.search||exports.NO_PATH,qry,{tags:(0,record_1.merge)((0,type_1.isObject)(qry.$tags)?qry.$tags:{},{path:that.paths.search,verb:"get",method:"search"})}));return(0,future_1.pure)(r.code===204?[]:r.body.data)})}update(id,changes){let that=this;return(0,future_1.doFuture)(function*(){let r=yield that.send(new request_1.Patch((0,string_1.interpolate)(that.paths.update||that.paths.get||exports.NO_PATH,{id:id}),changes,{tags:{path:that.paths.update,verb:"patch",method:"update"}}));return(0,future_1.pure)(r.code===200?true:false)})}get(id){let that=this;return(0,future_1.doFuture)(function*(){let req=new request_1.Get((0,string_1.interpolate)(that.paths.get||exports.NO_PATH,{id:id}),{},{tags:{path:that.paths.get,verb:"get",method:"get"}});return that.send(req).chain(res=>(0,future_1.pure)((0,maybe_1.fromNullable)(res.body.data))).catch(e=>e.message=="ClientError"&&e.code==404?(0,future_1.pure)((0,maybe_1.nothing)()):(0,future_1.raise)(e))})}remove(id){let that=this;return(0,future_1.doFuture)(function*(){let r=yield that.send(new request_1.Delete((0,string_1.interpolate)(that.paths.remove||that.paths.get||exports.NO_PATH,{id:id}),{},{tags:{path:that.paths.remove,verb:"delete",method:"remove"}}));return(0,future_1.pure)(r.code===200?true:false)})}}exports.RemoteModel=RemoteModel;class GenericRemoteModel extends RemoteModel{constructor(remote,actor,paths={},handler=new void_1.VoidHandler,decorator=new decorators_1.RequestPassthrough){super(remote,actor,handler,decorator);this.remote=remote;this.actor=actor;this.paths=paths;this.handler=handler;this.decorator=decorator}}exports.GenericRemoteModel=GenericRemoteModel},{"../callback":51,"../request/decorators":58,"./handlers/future":54,"./handlers/void":56,"@quenk/jhr/lib/request":43,"@quenk/noni/lib/control/monad/future":70,"@quenk/noni/lib/data/maybe":77,"@quenk/noni/lib/data/record":78,"@quenk/noni/lib/data/string":80,"@quenk/noni/lib/data/type":81}],58:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RequestPathExpander=exports.RequestPassthrough=void 0;const string_1=require("@quenk/noni/lib/data/string");class RequestPassthrough{decorate(req){return req}}exports.RequestPassthrough=RequestPassthrough;class RequestPathExpander{constructor(contexts){this.contexts=contexts}decorate(req){if(this.contexts.hasOwnProperty(req.path)&&this.contexts[req.path][req.method]){req.path=(0,string_1.interpolate)(req.path,this.contexts[req.path][req.method])}return req}}exports.RequestPathExpander=RequestPathExpander},{"@quenk/noni/lib/data/string":80}],59:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ConfirmDialog=exports.DialogConfirmed=void 0;const display_1=require("../../service/display");const _1=require("./");class DialogConfirmed extends _1.DialogEvent{}exports.DialogConfirmed=DialogConfirmed;class ConfirmDialog extends _1.Dialog{constructor(system,display,target="?"){super(system,display,target);this.system=system;this.display=display;this.target=target}confirm(){this.tell(this.display,new display_1.Close(this.name));this.fire(new DialogConfirmed(this.name));this.exit()}}exports.ConfirmDialog=ConfirmDialog},{"../../service/display":68,"./":60}],60:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Dialog=exports.DialogClosed=exports.DialogEvent=void 0;const type_1=require("@quenk/noni/lib/data/type");const display_1=require("../../service/display");const __1=require("../");class DialogEvent{constructor(name){this.name=name}}exports.DialogEvent=DialogEvent;class DialogClosed extends DialogEvent{}exports.DialogClosed=DialogClosed;class Dialog extends __1.BaseAppScene{constructor(system,display,target="?"){super(system);this.system=system;this.display=display;this.target=target}fire(e){if((0,type_1.isString)(this.target)){this.tell(this.target,e)}else if((0,type_1.isFunction)(this.target)){this.target(e)}else if((0,type_1.isObject)(this.target)){this.target.onClose(e)}}close(){this.tell(this.display,new display_1.Close(this.name));this.fire(new DialogClosed(this.name));this.exit()}run(){this.tell(this.display,new display_1.Show(this.name,this.view,this.self()))}}exports.Dialog=Dialog},{"../":64,"../../service/display":68,"@quenk/noni/lib/data/type":81}],61:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.BaseFormScene=exports.SaveOkCase=exports.SaveFailedCase=exports.SaveCase=exports.AbortCase=exports.InputEventCase=exports.FormSaved=exports.FormAborted=exports.SaveFailed=exports.SaveOk=exports.Save=exports.Abort=exports.FormSavedCase=exports.FormAbortedCase=void 0;const record_1=require("@quenk/noni/lib/data/record");const array_1=require("@quenk/noni/lib/data/array");const type_1=require("@quenk/noni/lib/data/type");const future_1=require("@quenk/noni/lib/control/monad/future");const case_1=require("@quenk/potoo/lib/actor/resident/case");const __1=require("../");class FormAbortedCase extends case_1.Case{constructor(listener){super(FormAborted,msg=>(0,future_1.doFuture)(function*(){yield(0,future_1.wrap)(listener.afterFormAborted(msg));return future_1.voidPure}));this.listener=listener}}exports.FormAbortedCase=FormAbortedCase;class FormSavedCase extends case_1.Case{constructor(listener){super(FormSaved,msg=>(0,future_1.doFuture)(function*(){yield(0,future_1.wrap)(listener.afterFormSaved(msg));return future_1.voidPure}));this.listener=listener}}exports.FormSavedCase=FormSavedCase;class Abort{}exports.Abort=Abort;class Save{}exports.Save=Save;class SaveOk{}exports.SaveOk=SaveOk;class SaveFailed{constructor(errors={}){this.errors=errors}}exports.SaveFailed=SaveFailed;class FormAborted{constructor(form){this.form=form}}exports.FormAborted=FormAborted;class FormSaved{constructor(form){this.form=form}}exports.FormSaved=FormSaved;class InputEventCase extends case_1.Case{constructor(form){super({name:String,value:type_1.Any},e=>{form.set(e.name,e.value)});this.form=form}}exports.InputEventCase=InputEventCase;class AbortCase extends case_1.Case{constructor(scene){super(Abort,_=>{scene.tell(scene.target,new FormAborted(scene.self()));scene.exit()});this.scene=scene}}exports.AbortCase=AbortCase;class SaveCase extends case_1.Case{constructor(form){super(Save,_=>(0,future_1.wrap)(form.save()));this.form=form}}exports.SaveCase=SaveCase;class SaveFailedCase extends case_1.Case{constructor(listener){super(SaveFailed,fail=>(0,future_1.doFuture)(function*(){yield(0,future_1.wrap)(listener.onSaveFailed(fail));yield(0,future_1.wrap)(listener.onSaveFinished());return future_1.voidPure}));this.listener=listener}}exports.SaveFailedCase=SaveFailedCase;class SaveOkCase extends case_1.Case{constructor(form){super(SaveOk,ok=>(0,future_1.doFuture)(function*(){yield(0,future_1.wrap)(form.onSaveOk(ok));yield(0,future_1.wrap)(form.onSaveFinished());form.tell(form.target,new FormSaved(form.self()));form.exit();return future_1.voidPure}));this.form=form}}exports.SaveOkCase=SaveOkCase;class BaseFormScene extends __1.BaseAppScene{constructor(system,target,value={}){super(system);this.system=system;this.target=target;this.value=value;this.fieldsModifed=[]}get display(){return this.target}receive(){return[new AbortCase(this),new SaveCase(this),new SaveFailedCase(this),new SaveOkCase(this),new InputEventCase(this)]}set(name,value){if(!(0,array_1.contains)(this.fieldsModifed,name))this.fieldsModifed.push(name);this.value[name]=value;return this}getValues(){return(0,record_1.clone)(this.value)}getModifiedValues(){return(0,record_1.filter)(this.value,(_,k)=>(0,array_1.contains)(this.fieldsModifed,k))}onSaveFailed(_){}onSaveOk(_){}onSaveFinished(){}abort(){this.tell(this.self(),new Abort)}save(){}}exports.BaseFormScene=BaseFormScene},{"../":64,"@quenk/noni/lib/control/monad/future":70,"@quenk/noni/lib/data/array":73,"@quenk/noni/lib/data/record":78,"@quenk/noni/lib/data/type":81,"@quenk/potoo/lib/actor/resident/case":87}],62:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.BaseValidatorFormScene=exports.InputEventCase=void 0;const type_1=require("@quenk/noni/lib/data/type");const case_1=require("@quenk/potoo/lib/actor/resident/case");const __1=require("../");const strategy_1=require("./strategy");class InputEventCase extends case_1.Case{constructor(form){super({name:String,value:type_1.Any},e=>{return form.strategy.validate(e)});this.form=form}}exports.InputEventCase=InputEventCase;class BaseValidatorFormScene extends __1.BaseFormScene{constructor(){super(...arguments);this.strategy=new strategy_1.NoStrategy(this)}receive(){return[new InputEventCase(this),...super.receive()]}onFieldInvalid(){}onFieldValid(){}onFormInvalid(){}onFormValid(){}}exports.BaseValidatorFormScene=BaseValidatorFormScene},{"../":61,"./strategy":63,"@quenk/noni/lib/data/type":81,"@quenk/potoo/lib/actor/resident/case":87}],63:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ModifiedAllForOneStrategy=exports.AllForOneStrategy=exports.OneForOneStrategy=exports.NoStrategy=void 0;class NoStrategy{constructor(form){this.form=form}validate({name:name,value:value}){this.form.set(name,value)}}exports.NoStrategy=NoStrategy;class OneForOneStrategy{constructor(form,validator){this.form=form;this.validator=validator}validate({name:name,value:value}){let{form:form,validator:validator}=this;let eResult=validator.validate(name,value);if(eResult.isLeft()){form.onFieldInvalid(name,value,eResult.takeLeft())}else{let value=eResult.takeRight();form.set(name,value);form.onFieldValid(name,value)}}}exports.OneForOneStrategy=OneForOneStrategy;class AllForOneStrategy{constructor(form,validator){this.form=form;this.validator=validator}getValues(){return this.form.getValues()}validate({name:name,value:value}){let{form:form,validator:validator}=this;let eResult=validator.validate(name,value);if(eResult.isLeft()){form.onFieldInvalid(name,value,eResult.takeLeft());form.onFormInvalid()}else{let value=eResult.takeRight();form.set(name,value);form.onFieldValid(name,value);let eAllResult=validator.validateAll(this.getValues());if(eAllResult.isRight())form.onFormValid();else form.onFormInvalid()}}}exports.AllForOneStrategy=AllForOneStrategy;class ModifiedAllForOneStrategy extends AllForOneStrategy{getValues(){return this.form.getModifiedValues()}}exports.ModifiedAllForOneStrategy=ModifiedAllForOneStrategy},{}],64:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.BaseAppScene=void 0;const actor_1=require("../../actor");const display_1=require("../service/display");class BaseAppScene extends actor_1.Immutable{show(){this.tell(this.display,new display_1.Show(this.name,this.view,this.self()))}run(){this.show()}}exports.BaseAppScene=BaseAppScene},{"../../actor":49,"../service/display":68}],65:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MainScene=void 0;const case_1=require("@quenk/potoo/lib/actor/resident/case");const director_1=require("../service/director");const display_1=require("../service/display");const form_1=require("./form");const _1=require("./");class MainScene extends _1.BaseAppScene{constructor(system,resume){super(system);this.system=system;this.resume=resume}afterFormAborted(_){return this.show()}afterFormSaved(_){return this.reload()}get display(){return this.resume.director}receive(){return[new director_1.SuspendCase(this,this.resume.director),new form_1.FormAbortedCase(this),new form_1.FormSavedCase(this),new case_1.Case(display_1.Show,msg=>void this.tell(this.display,msg)),new case_1.Case(display_1.Push,msg=>void this.tell(this.display,msg)),new case_1.Case(display_1.Pop,msg=>void this.tell(this.display,msg)),new case_1.Case(display_1.Close,msg=>void this.tell(this.display,msg))]}beforeSuspended(_){}reload(){this.tell(this.resume.director,new director_1.Reload(this.self()))}}exports.MainScene=MainScene},{"../service/director":67,"../service/display":68,"./":64,"./form":61,"@quenk/potoo/lib/actor/resident/case":87}],66:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.OnNotFound=exports.OnSaveFailed=exports.AfterSearchSetPagination=exports.OnCompleteShowData=exports.AfterSearchUpdateWidget=exports.AfterGetSetData=exports.AfterSearchSetData=exports.ShiftingOnClientError=exports.ShiftingOnComplete=void 0;const util_1=require("@quenk/wml-widgets/lib/util");const callback_1=require("../../remote/callback");const result_1=require("../../remote/model/handlers/result");const form_1=require("../form");class ShiftingOnComplete extends callback_1.AbstractCompleteHandler{constructor(handlers){super();this.handlers=handlers;this._handlers=this.handlers.slice()}onComplete(r){let handler=this._handlers.length===1?this._handlers[0]:this._handlers.shift();if(handler)handler.onComplete(r)}}exports.ShiftingOnComplete=ShiftingOnComplete;class ShiftingOnClientError extends callback_1.AbstractCompleteHandler{constructor(handlers){super();this.handlers=handlers;this._handlers=this.handlers.slice()}onClientError(r){let handler=this._handlers.length===1?this._handlers[0]:this._handlers.shift();if(handler)handler.onClientError(r)}}exports.ShiftingOnClientError=ShiftingOnClientError;class AfterSearchSetData extends result_1.SearchResultHandler{constructor(setter){super();this.setter=setter}onComplete(res){return this.setter(res.code===200&&res.request.method==="GET"?res.body.data:[])}}exports.AfterSearchSetData=AfterSearchSetData;class AfterGetSetData extends result_1.GetResultHandler{constructor(setter){super();this.setter=setter}onComplete(res){if(res.code===200&&res.request.method==="GET")return this.setter(res.body.data)}}exports.AfterGetSetData=AfterGetSetData;class AfterSearchUpdateWidget extends result_1.SearchResultHandler{constructor(view,id){super();this.view=view;this.id=id}onComplete(res){if(res.code===200&&res.request.method==="GET"){let mtable=(0,util_1.getById)(this.view,this.id);if(mtable.isJust())mtable.get().update(res.body.data||[])}}}exports.AfterSearchUpdateWidget=AfterSearchUpdateWidget;class OnCompleteShowData extends callback_1.AbstractCompleteHandler{constructor(scene){super();this.scene=scene}onComplete(_){this.scene.show()}}exports.OnCompleteShowData=OnCompleteShowData;class AfterSearchSetPagination extends result_1.SearchResultHandler{constructor(target){super();this.target=target}onComplete(res){if(res.code===200&&res.request.method==="GET")this.target.pagination=res.body.meta.pagination}}exports.AfterSearchSetPagination=AfterSearchSetPagination;class OnSaveFailed extends callback_1.AbstractCompleteHandler{constructor(form){super();this.form=form}onClientError(res){if(res.code===409){this.form.onSaveFailed(new form_1.SaveFailed(res.body.errors))}}}exports.OnSaveFailed=OnSaveFailed;class OnNotFound extends callback_1.AbstractCompleteHandler{constructor(handler){super();this.handler=handler}onClientError(res){if(res.code===404){this.handler()}}}exports.OnNotFound=OnNotFound},{"../../remote/callback":51,"../../remote/model/handlers/result":55,"../form":61,"@quenk/wml-widgets/lib/util":188}],67:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Director=exports.ActorSuspended=exports.RouteChanged=exports.Supervisor=exports.SuspendActor=exports.SuspendTimer=exports.CancelTimer=exports.Suspended=exports.Suspend=exports.Reload=exports.Resume=exports.SuspendCase=exports.DEFAULT_TIMEOUT=void 0;const record_1=require("@quenk/noni/lib/data/record");const type_1=require("@quenk/noni/lib/data/type");const future_1=require("@quenk/noni/lib/control/monad/future");const case_1=require("@quenk/potoo/lib/actor/resident/case");const actor_1=require("../../actor");exports.DEFAULT_TIMEOUT=1e3;class SuspendCase extends case_1.Case{constructor(listener,director){super(Suspend,s=>(0,future_1.doFuture)(function*(){yield(0,future_1.wrap)(listener.beforeSuspended(s));listener.tell(director,new Suspended(listener.self()));return future_1.voidPure}));this.listener=listener;this.director=director}}exports.SuspendCase=SuspendCase;class Resume{constructor(director,request){this.director=director;this.request=request}}exports.Resume=Resume;class Reload{constructor(target){this.target=target}}exports.Reload=Reload;class Suspend{constructor(director){this.director=director}}exports.Suspend=Suspend;class Suspended{constructor(actor){this.actor=actor}}exports.Suspended=Suspended;class CancelTimer{}exports.CancelTimer=CancelTimer;class SuspendTimer extends actor_1.Immutable{constructor(director,timeout,system,onExpire,onFinish){super(system);this.director=director;this.timeout=timeout;this.system=system;this.onExpire=onExpire;this.onFinish=onFinish;this.timer=-1;this.onCancelTimer=(_=>{clearTimeout(this.timer);this.onFinish();this.exit()})}receive(){return[new case_1.Case(CancelTimer,this.onCancelTimer)]}run(){this.timer=setTimeout(()=>{this.onExpire();this.exit()},this.timeout)}}exports.SuspendTimer=SuspendTimer;class SuspendActor{}exports.SuspendActor=SuspendActor;class Supervisor extends actor_1.Immutable{constructor(director,display,info,system){super(system);this.director=director;this.display=display;this.info=info;this.system=system;this.actor="?"}receive(){return[new case_1.Case(SuspendActor,()=>{this.tell(this.actor,new Suspend(this.self()))}),new case_1.Case(Reload,()=>{this.tell(this.director,this.info)}),new case_1.Case(Suspended,()=>{this.tell(this.director,new ActorSuspended)}),new case_1.Default(m=>{this.tell(this.display,m)})]}run(){let{request:request,spec:spec}=this.info;let r=new Resume(this.self(),request);let candidate=(0,type_1.isFunction)(spec)?spec(r):spec;if((0,type_1.isObject)(candidate)){let tmpl=candidate;let args=tmpl.args?tmpl.args:[];tmpl=(0,record_1.merge)(tmpl,{args:[r,...args]});this.actor=this.spawn(tmpl)}else{this.actor=candidate}this.tell(this.actor,r)}}exports.Supervisor=Supervisor;class RouteChanged{constructor(route,spec,request){this.route=route;this.spec=spec;this.request=request}}exports.RouteChanged=RouteChanged;class ActorSuspended{}exports.ActorSuspended=ActorSuspended;class Director extends actor_1.Immutable{constructor(display,router,conf,routes,system){super(system);this.display=display;this.router=router;this.conf=conf;this.routes=routes;this.system=system;this.current=["","?","?"];this.config=defaultConfig(this.conf);this.onRouteChanged=(msg=>{let self=this.self();let{display:display,routes:routes,current:current,config:config}=this;let[route,supervisor]=current;let onFinish=()=>{if(supervisor!="?")this.kill(supervisor);this.current=[msg.route,this.spawn(s=>new Supervisor(self,display,msg,s)),"?"]};if(supervisor!="?"){let{timeout:timeout}=config;let onExpire=()=>{this.routes=(0,record_1.exclude)(routes,route);onFinish()};this.current=[route,supervisor,this.spawn(s=>new SuspendTimer(self,timeout,s,onExpire,onFinish))];this.tell(supervisor,new SuspendActor)}else{onFinish()}});this.onActorSuspended=(_=>{this.tell(this.current[2],new CancelTimer)})}receive(){return[new case_1.Case(RouteChanged,this.onRouteChanged),new case_1.Case(ActorSuspended,this.onActorSuspended)]}run(){(0,record_1.forEach)(this.routes,(spec,route)=>{this.router.add(route,r=>(0,future_1.fromCallback)(cb=>{if(!this.routes.hasOwnProperty(route)){return cb(new Error(`${route}: not responding!`))}else{this.tell(this.self(),new RouteChanged(route,spec,r));cb(null)}}))})}}exports.Director=Director;const defaultConfig=c=>(0,record_1.merge)({timeout:exports.DEFAULT_TIMEOUT},c)},{"../../actor":49,"@quenk/noni/lib/control/monad/future":70,"@quenk/noni/lib/data/record":78,"@quenk/noni/lib/data/type":81,"@quenk/potoo/lib/actor/resident/case":87}],68:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Display=exports.ViewRemoved=exports.ViewStackEmpty=exports.ViewShown=exports.Close=exports.Pop=exports.Push=exports.Show=exports.WMLLayoutViewDelegate=exports.HTMLElementViewDelegate=void 0;const array_1=require("@quenk/noni/lib/data/array");const immutable_1=require("@quenk/potoo/lib/actor/resident/immutable");const case_1=require("@quenk/potoo/lib/actor/resident/case");class HTMLElementViewDelegate{constructor(node){this.node=node}set(view){this.unset();this.node.appendChild(view.render())}unset(){let{node:node}=this;while(node.firstChild!=null)node.removeChild(node.firstChild)}}exports.HTMLElementViewDelegate=HTMLElementViewDelegate;class WMLLayoutViewDelegate{constructor(layout){this.layout=layout}set(view){this.unset();this.layout.setContent(view.render())}unset(){this.layout.removeContent()}}exports.WMLLayoutViewDelegate=WMLLayoutViewDelegate;class Show{constructor(name,view,source){this.name=name;this.view=view;this.source=source}}exports.Show=Show;class Push extends Show{}exports.Push=Push;class Pop{constructor(source){this.source=source}}exports.Pop=Pop;class Close{constructor(source){this.source=source}}exports.Close=Close;class ViewShown{constructor(name){this.name=name}}exports.ViewShown=ViewShown;class ViewStackEmpty{}exports.ViewStackEmpty=ViewStackEmpty;class ViewRemoved{constructor(name){this.name=name}}exports.ViewRemoved=ViewRemoved;class Display extends immutable_1.Immutable{constructor(delegate,system){super(system);this.delegate=delegate;this.system=system;this.stack=[]}receive(){return[new case_1.Case(Show,m=>this.show(m)),new case_1.Case(Push,m=>this.push(m)),new case_1.Case(Pop,m=>this.pop(m)),new case_1.Case(Close,()=>this.close())]}show(m){if(!(0,array_1.empty)(this.stack))this.close();this.push(m)}push(m){this.stack.push(m);this.delegate.set(m.view);this.tell(m.source,new ViewShown(m.name))}pop(m){if((0,array_1.empty)(this.stack)){this.tell(m.source,new ViewStackEmpty)}else{let current=this.stack.pop();this.delegate.unset();this.tell(current.source,new ViewRemoved(current.name));if(!(0,array_1.empty)(this.stack)){this.push(this.stack.pop())}}}close(){this.delegate.unset();this.stack.forEach(m=>{this.tell(m.source,new ViewRemoved(m.name))});this.stack=[]}run(){}}exports.Display=Display},{"@quenk/noni/lib/data/array":73,"@quenk/potoo/lib/actor/resident/case":87,"@quenk/potoo/lib/actor/resident/immutable":89}],69:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.attempt=exports.raise=exports.convert=void 0;const either_1=require("../data/either");const convert=e=>e instanceof Error?e:new Error(e?e.message?e.message:undefined:undefined);exports.convert=convert;const raise=e=>{if(e instanceof Error){throw e}else{throw new Error(e.message)}};exports.raise=raise;const attempt=f=>{try{return(0,either_1.right)(f())}catch(e){return(0,either_1.left)(e)}};exports.attempt=attempt},{"../data/either":75}],70:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.doFuture=exports.liftP=exports.fromExcept=exports.toPromise=exports.some=exports.race=exports.reduce=exports.sequential=exports.parallel=exports.batch=exports.fromCallback=exports.fromAbortable=exports.wait=exports.delay=exports.attempt=exports.raise=exports.run=exports.wrap=exports.voidPure=exports.pure=exports.Run=exports.Raise=exports.Trap=exports.Finally=exports.Catch=exports.Call=exports.Bind=exports.Pure=exports.Future=void 0;const function_1=require("../../data/function");const timer_1=require("../timer");const error_1=require("../error");const _1=require("./");const array_1=require("../../data/array");class Future{constructor(){this.tag="Future"}get[Symbol.toStringTag](){return"Future"}of(a){return new Pure(a)}map(f){return new Bind(this,value=>new Pure(f(value)))}ap(ft){return new Bind(this,value=>ft.map(f=>f(value)))}chain(f){return new Bind(this,f)}trap(f){return new Catch(this,f)}catch(f){return new Catch(this,e=>(0,exports.run)((onError,onSuccess)=>{if(f){let result=f(e);switch(Object.prototype.toString.call(result)){case"[object Future]":let asFuture=result;asFuture.fork(e=>onError(e),v=>onSuccess(v));break;case"[object Promise]":let asPromise=result;asPromise.then(v=>onSuccess(v),e=>onError(e));break;default:onSuccess(result);break}}else{onSuccess(undefined)}return function_1.noop}))}finialize(f){return new Finally(this,f)}finally(f){return this.finialize(()=>{f();return this})}then(onResolve,onReject){return new Promise((resolve,reject)=>{this.fork(reject,resolve)}).then(onResolve,onReject)}_fork(value,stack,onError,onSuccess){let pending=true;let failure=e=>{if(pending){stack.push(new Raise(e));pending=false;this._fork(value,stack,onError,onSuccess)}else{console.warn(`${this.tag}: onError called after task completed`);console.warn(e)}};let success=val=>{if(pending){pending=false;if((0,array_1.empty)(stack))onSuccess(val);else this._fork(val,stack,onError,onSuccess)}else{console.warn(`${this.tag}: onSuccess called after task completed`);console.trace()}};while(!(0,array_1.empty)(stack)){let next=stack.pop();if(next.tag==="Pure"){(0,timer_1.tick)(()=>success(next.value));return function_1.noop}else if(next.tag==="Bind"){let future=next;stack.push(new Call(future.func));stack.push(future.target)}else if(next.tag==="Call"){let future=next;stack.push(future.target(value))}else if(next.tag==="Catch"){let future=next;stack.push(new Trap(future.func));stack.push(future.target)}else if(next.tag==="Finally"){let future=next;stack.push(new Trap(future.func));stack.push(new Call(future.func));stack.push(future.target)}else if(next.tag==="Trap"){if((0,array_1.empty)(stack))onSuccess(value)}else if(next.tag==="Raise"){let future=next;let err=(0,error_1.convert)(future.value);while(!(0,array_1.empty)(stack)&&(0,array_1.tail)(stack).tag!=="Trap")stack.pop();if((0,array_1.empty)(stack)){onError(err);return function_1.noop}else{stack.push(stack.pop().func(err))}}else if(next.tag==="Run"){return next.task(failure,success)}}return function_1.noop}fork(onError=function_1.noop,onSuccess=function_1.noop){return this._fork(undefined,[this],onError,onSuccess)}}exports.Future=Future;class Pure extends Future{constructor(value){super();this.value=value;this.tag="Pure"}map(f){return new Pure(f(this.value))}ap(ft){return ft.map(f=>f(this.value))}}exports.Pure=Pure;class Bind extends Future{constructor(target,func){super();this.target=target;this.func=func;this.tag="Bind"}}exports.Bind=Bind;class Call extends Future{constructor(target){super();this.target=target;this.tag="Call"}}exports.Call=Call;class Catch extends Future{constructor(target,func){super();this.target=target;this.func=func;this.tag="Catch"}}exports.Catch=Catch;class Finally extends Future{constructor(target,func){super();this.target=target;this.func=func;this.tag="Finally"}}exports.Finally=Finally;class Trap extends Future{constructor(func){super();this.func=func;this.tag="Trap"}}exports.Trap=Trap;class Raise extends Future{constructor(value){super();this.value=value;this.tag="Raise"}map(_){return new Raise(this.value)}ap(_){return new Raise(this.value)}chain(_){return new Raise(this.value)}}exports.Raise=Raise;class Run extends Future{constructor(task){super();this.task=task;this.tag="Run"}}exports.Run=Run;const pure=a=>new Pure(a);exports.pure=pure;exports.voidPure=new Pure(undefined);const wrap=a=>String(a)==="[object Future]"?a:(0,exports.pure)(a);exports.wrap=wrap;const run=task=>new Run(task);exports.run=run;const raise=e=>new Raise(e);exports.raise=raise;const attempt=f=>(0,exports.run)((onError,onSuccess)=>{(0,timer_1.tick)(()=>{try{onSuccess(f())}catch(e){onError(e)}});return function_1.noop});exports.attempt=attempt;const delay=(f,n=0)=>(0,exports.run)((onError,onSuccess)=>{setTimeout(()=>{try{onSuccess(f())}catch(e){onError(e)}},n);return function_1.noop});exports.delay=delay;const wait=n=>(0,exports.run)((_,onSuccess)=>{setTimeout(()=>{onSuccess(undefined)},n);return function_1.noop});exports.wait=wait;const fromAbortable=abort=>f=>(0,exports.run)((onError,onSuccess)=>{f((err,a)=>err!=null?onError(err):onSuccess(a));return abort});exports.fromAbortable=fromAbortable;const fromCallback=f=>(0,exports.fromAbortable)(function_1.noop)(f);exports.fromCallback=fromCallback;class Tag{constructor(index,value){this.index=index;this.value=value}}const batch=list=>(0,exports.sequential)(list.map(w=>(0,exports.parallel)(w)));exports.batch=batch;const parallel=list=>(0,exports.run)((onError,onSuccess)=>{let completed=[];let finished=false;let aborters=[];let indexCmp=(a,b)=>a.index-b.index;let abortAll=()=>{finished=true;aborters.map(f=>f())};let onErr=e=>{if(!finished){abortAll();onError(e)}};let reconcile=()=>completed.sort(indexCmp).map(t=>t.value);let onSucc=t=>{if(!finished){completed.push(t);if(completed.length===list.length)onSuccess(reconcile())}};aborters.push.apply(aborters,list.map((f,i)=>f.map(value=>new Tag(i,value)).fork(onErr,onSucc)));if((0,array_1.empty)(aborters))onSuccess([]);return()=>abortAll()});exports.parallel=parallel;const sequential=list=>(0,exports.run)((onError,onSuccess)=>{let i=0;let r=[];let onErr=e=>onError(e);let success=a=>{r.push(a);next()};let abort;let next=()=>{if(i<list.length)abort=list[i].fork(onErr,success);else onSuccess(r);i++};next();return()=>{if(abort)abort()}});exports.sequential=sequential;const reduce=(list,initValue,f)=>(0,exports.doFuture)(function*(){let accumValue=initValue;for(let i=0;i<list.length;i++)accumValue=yield f(accumValue,list[i],i);return(0,exports.pure)(accumValue)});exports.reduce=reduce;const race=list=>(0,exports.run)((onError,onSuccess)=>{let aborters=[];let finished=false;let abortAll=()=>{finished=true;aborters.map(f=>f())};let onErr=e=>{if(!finished){finished=true;abortAll();onError(e)}};let onSucc=t=>{if(!finished){finished=true;aborters.map((f,i)=>i!==t.index?f():undefined);onSuccess(t.value)}};aborters.push.apply(aborters,list.map((f,i)=>f.map(value=>new Tag(i,value)).fork(onErr,onSucc)));if(aborters.length===0)onError(new Error(`race(): Cannot race an empty list!`));return()=>abortAll()});exports.race=race;const some=list=>(0,exports.doFuture)(function*(){let result=undefined;for(let[index,future]of list.entries()){let keepGoing=false;result=yield future.catch(e=>{if(index===list.length-1){return(0,exports.raise)(e)}else{keepGoing=true;return exports.voidPure}});if(!keepGoing)break}return(0,exports.pure)(result)});exports.some=some;const toPromise=ft=>new Promise((yes,no)=>ft.fork(no,yes));exports.toPromise=toPromise;const fromExcept=e=>e.fold(e=>(0,exports.raise)(e),a=>(0,exports.pure)(a));exports.fromExcept=fromExcept;const liftP=f=>(0,exports.run)((onError,onSuccess)=>{f().then(a=>onSuccess(a)).catch(e=>onError(e));return function_1.noop});exports.liftP=liftP;const doFuture=f=>(0,_1.doN)(f);exports.doFuture=doFuture},{"../../data/array":73,"../../data/function":76,"../error":69,"../timer":72,"./":71}],71:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.doMonad=exports.doN=exports.pipeN=exports.pipe=exports.compose=exports.join=void 0;const join=outer=>outer.chain(x=>x);exports.join=join;const compose=(g,f)=>(0,exports.pipe)(f,g);exports.compose=compose;const pipe=(f,g)=>value=>f(value).chain(b=>g(b));exports.pipe=pipe;const pipeN=(f,...list)=>value=>list.reduce((p,c)=>p.chain(v=>c(v)),f(value));exports.pipeN=pipeN;const doN=f=>{let gen=f();let next=val=>{let r=gen.next(val);if(r.done)return r.value;else return r.value.chain(next)};return next()};exports.doN=doN;exports.doMonad=exports.doN},{}],72:[function(require,module,exports){(function(process){(function(){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.throttle=exports.debounce=exports.tick=void 0;const tick=f=>typeof window=="undefined"?setTimeout(f,0):process.nextTick(f);exports.tick=tick;const debounce=(f,delay)=>{let id=-1;return a=>{if(id===-1){id=setTimeout(()=>f(a),delay)}else{clearTimeout(id);id=setTimeout(()=>f(a),delay)}}};exports.debounce=debounce;const throttle=(f,duration)=>{let wait=false;return a=>{if(wait===false){f(a);wait=true;setTimeout(()=>wait=false,duration)}}};exports.throttle=throttle}).call(this)}).call(this,require("_process"))},{_process:203}],73:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.find=exports.compact=exports.flatten=exports.combine=exports.make=exports.removeAt=exports.remove=exports.dedupe=exports.distribute=exports.group=exports.partition=exports.concat=exports.flatMap=exports.map=exports.contains=exports.empty=exports.tail=exports.head=void 0;const record_1=require("../record");const math_1=require("../../math");const maybe_1=require("../maybe");const head=list=>list[0];exports.head=head;const tail=list=>list[list.length-1];exports.tail=tail;const empty=list=>list.length===0;exports.empty=empty;const contains=(list,a)=>list.indexOf(a)>-1;exports.contains=contains;const map=list=>f=>list.map(f);exports.map=map;const flatMap=(list,f)=>list.reduce((p,c,i)=>p.concat(f(c,i,list)),[]);exports.flatMap=flatMap;const concat=(list,...items)=>[...list,...items.filter(item=>item!=null)];exports.concat=concat;const partition=(list,f)=>(0,exports.empty)(list)?[[],[]]:list.reduce(([yes,no],c,i)=>f(c,i,list)?[(0,exports.concat)(yes,c),no]:[yes,(0,exports.concat)(no,c)],[[],[]]);exports.partition=partition;const group=(list,f)=>list.reduce((p,c,i)=>{let g=f(c,i,list);return(0,record_1.merge)(p,{[g]:Array.isArray(p[g])?(0,exports.concat)(p[g],c):[c]})},{});exports.group=group;const distribute=(list,size)=>{let r=list.reduce((p,c,i)=>(0,math_1.isMultipleOf)(size,i+1)?[(0,exports.concat)(p[0],(0,exports.concat)(p[1],c)),[]]:[p[0],(0,exports.concat)(p[1],c)],[[],[]]);return r[1].length===0?r[0]:(0,exports.concat)(r[0],r[1])};exports.distribute=distribute;const dedupe=list=>list.filter((e,i,l)=>l.indexOf(e)===i);exports.dedupe=dedupe;const remove=(list,target)=>{let idx=list.indexOf(target);if(idx===-1){return list.slice()}else{let a=list.slice();a.splice(idx,1);return a}};exports.remove=remove;const removeAt=(list,idx)=>{if(list.length>idx&&idx>-1){let a=list.slice();a.splice(idx,1);return a}else{return list.slice()}};exports.removeAt=removeAt;const make=(size,f)=>{let a=new Array(size);for(let i=0;i<size;i++)a[i]=f(i);return a};exports.make=make;const combine=list=>list.reduce((p,c)=>p.concat(c),[]);exports.combine=combine;const flatten=list=>list.reduce((p,c)=>p.concat(Array.isArray(c)?(0,exports.flatten)(c):c),[]);exports.flatten=flatten;const compact=list=>list.filter(v=>v!=null);exports.compact=compact;const find=(list,cb)=>{for(let i=0;i<list.length;i++)if(cb(list[i]))return(0,maybe_1.just)(list[i]);return(0,maybe_1.nothing)()};exports.find=find},{"../../math":82,"../maybe":77,"../record":78}],74:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.natural=exports.number=exports.string=exports.date=void 0;const date=(a,b)=>{let na=new Date(a).getTime();let nb=new Date(b).getTime();return na>nb?-1:na<nb?1:0};exports.date=date;const string=(a,b)=>{let la=String(a).replace(/\s+/,"").toLowerCase();let lb=String(b).replace(/\s+/,"").toLowerCase();return la>lb?-1:la<lb?1:0};exports.string=string;const number=(a,b)=>{let na=parseFloat(a);let nb=parseFloat(b);na=isNaN(a)?-Infinity:a;nb=isNaN(b)?-Infinity:b;return na>nb?-1:na<nb?1:0};exports.number=number;const natural=(a="",b="")=>{var reA=/[^a-zA-Z]/g;var reN=/[^0-9]/g;var aInt=parseInt(a,10);var bInt=parseInt(b,10);if(isNaN(aInt)&&isNaN(bInt)){var aA=String(a).replace(reA,"");var bA=String(b).replace(reA,"");if(aA===bA){var aN=parseInt(String(a).replace(reN,""),10);var bN=parseInt(String(b).replace(reN,""),10);return aN===bN?0:aN>bN?-1:1}else{return aA>bA?-1:1}}else if(isNaN(aInt)){return-1}else if(isNaN(bInt)){return 1}else{return aInt>bInt?-1:1}};exports.natural=natural},{}],75:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.either=exports.fromBoolean=exports.right=exports.left=exports.Right=exports.Left=exports.Either=void 0;const maybe_1=require("./maybe");class Either{of(value){return new Right(value)}}exports.Either=Either;class Left extends Either{constructor(value){super();this.value=value}map(_){return new Left(this.value)}lmap(f){return new Left(f(this.value))}bimap(f,_){return new Left(f(this.value))}alt(a){return a}chain(_){return new Left(this.value)}ap(_){return new Left(this.value)}extend(_){return new Left(this.value)}fold(f,_){return f(this.value)}eq(m){return m instanceof Left&&m.value===this.value}orElse(f){return f(this.value)}orRight(f){return new Right(f(this.value))}isLeft(){return true}isRight(){return false}takeLeft(){return this.value}takeRight(){throw new TypeError(`Not right!`)}toMaybe(){return(0,maybe_1.nothing)()}}exports.Left=Left;class Right extends Either{constructor(value){super();this.value=value}map(f){return new Right(f(this.value))}lmap(_){return new Right(this.value)}bimap(_,g){return new Right(g(this.value))}alt(_){return this}chain(f){return f(this.value)}ap(e){return e.map(f=>f(this.value))}extend(f){return new Right(f(this))}eq(m){return m instanceof Right&&m.value===this.value}fold(_,g){return g(this.value)}orElse(_){return this}orRight(_){return this}isLeft(){return false}isRight(){return true}takeLeft(){throw new TypeError(`Not left!`)}takeRight(){return this.value}toMaybe(){return(0,maybe_1.just)(this.value)}}exports.Right=Right;const left=a=>new Left(a);exports.left=left;const right=b=>new Right(b);exports.right=right;const fromBoolean=b=>b?(0,exports.right)(true):(0,exports.left)(false);exports.fromBoolean=fromBoolean;const either=f=>g=>e=>e instanceof Right?g(e.takeRight()):f(e.takeLeft());exports.either=either},{"./maybe":77}],76:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.noop=exports.curry5=exports.curry4=exports.curry3=exports.curry=exports.id=exports.identity=exports.flip=exports.cons=exports.compose5=exports.compose4=exports.compose3=exports.compose=void 0;const compose=(f,g)=>a=>g(f(a));exports.compose=compose;const compose3=(f,g,h)=>a=>h(g(f(a)));exports.compose3=compose3;const compose4=(f,g,h,i)=>a=>i(h(g(f(a))));exports.compose4=compose4;const compose5=(f,g,h,i,j)=>a=>j(i(h(g(f(a)))));exports.compose5=compose5;const cons=a=>_=>a;exports.cons=cons;const flip=f=>b=>a=>f(a)(b);exports.flip=flip;const identity=a=>a;exports.identity=identity;exports.id=exports.identity;const curry=f=>a=>b=>f(a,b);exports.curry=curry;const curry3=f=>a=>b=>c=>f(a,b,c);exports.curry3=curry3;const curry4=f=>a=>b=>c=>d=>f(a,b,c,d);exports.curry4=curry4;const curry5=f=>a=>b=>c=>d=>e=>f(a,b,c,d,e);exports.curry5=curry5;const noop=()=>{};exports.noop=noop},{}],77:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.fromNaN=exports.fromNumber=exports.fromBoolean=exports.fromString=exports.fromObject=exports.fromArray=exports.fromNullable=exports.just=exports.nothing=exports.of=exports.Just=exports.Nothing=void 0;class Nothing{map(_){return new Nothing}ap(_){return new Nothing}of(a){return new Just(a)}chain(_){return new Nothing}alt(a){return a}empty(){return new Nothing}extend(_){return new Nothing}eq(m){return m instanceof Nothing}orJust(f){return new Just(f())}orElse(f){return f()}isNothing(){return true}isJust(){return false}get(){throw new TypeError("Cannot get a value from Nothing!")}}exports.Nothing=Nothing;class Just{constructor(value){this.value=value}map(f){return new Just(f(this.value))}ap(mb){return mb.map(f=>f(this.value))}of(a){return new Just(a)}chain(f){return f(this.value)}alt(_){return this}empty(){return new Nothing}extend(f){return new Just(f(this))}eq(m){return m instanceof Just&&m.value===this.value}orJust(_){return this}orElse(_){return this}isNothing(){return false}isJust(){return true}get(){return this.value}}exports.Just=Just;const of=a=>new Just(a);exports.of=of;const nothing=()=>new Nothing;exports.nothing=nothing;const just=a=>new Just(a);exports.just=just;const fromNullable=a=>a==null?new Nothing:new Just(a);exports.fromNullable=fromNullable;const fromArray=a=>a.length===0?new Nothing:new Just(a);exports.fromArray=fromArray;const fromObject=o=>Object.keys(o).length===0?new Nothing:new Just(o);exports.fromObject=fromObject;const fromString=s=>s===""?new Nothing:new Just(s);exports.fromString=fromString;const fromBoolean=b=>b===false?new Nothing:new Just(b);exports.fromBoolean=fromBoolean;const fromNumber=n=>n===0?new Nothing:new Just(n);exports.fromNumber=fromNumber;const fromNaN=n=>isNaN(n)?new Nothing:new Just(n);exports.fromNaN=fromNaN},{}],78:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.pickValue=exports.pickKey=exports.make=exports.rcompact=exports.compact=exports.isBadKey=exports.set=exports.every=exports.some=exports.empty=exports.count=exports.clone=exports.hasKey=exports.values=exports.group=exports.partition=exports.exclude=exports.rmerge5=exports.rmerge4=exports.rmerge3=exports.rmerge=exports.merge5=exports.merge4=exports.merge3=exports.merge=exports.filter=exports.reduce=exports.forEach=exports.mapTo=exports.map=exports.keys=exports.isRecord=exports.assign=exports.badKeys=void 0;const array_1=require("../array");const type_1=require("../type");const maybe_1=require("../maybe");exports.badKeys=["__proto__"];function assign(target,..._varArgs){let to=Object(target);for(let index=1;index<arguments.length;index++){let nextSource=arguments[index];if(nextSource!=null)for(let nextKey in nextSource)if(Object.prototype.hasOwnProperty.call(nextSource,nextKey))(0,exports.set)(to,nextKey,nextSource[nextKey])}return to}exports.assign=assign;const isRecord=value=>typeof value==="object"&&value!=null&&!Array.isArray(value)&&!(value instanceof Date)&&!(value instanceof RegExp);exports.isRecord=isRecord;const keys=obj=>Object.keys(obj);exports.keys=keys;const map=(rec,f)=>(0,exports.keys)(rec).reduce((p,k)=>(0,exports.merge)(p,(0,exports.set)({},k,f(rec[k],k,rec))),{});exports.map=map;const mapTo=(rec,f)=>(0,exports.keys)(rec).map(k=>f(rec[k],k,rec));exports.mapTo=mapTo;const forEach=(rec,f)=>(0,exports.keys)(rec).forEach(k=>f(rec[k],k,rec));exports.forEach=forEach;const reduce=(rec,accum,f)=>(0,exports.keys)(rec).reduce((p,k)=>f(p,rec[k],k),accum);exports.reduce=reduce;const filter=(rec,f)=>(0,exports.keys)(rec).reduce((p,k)=>f(rec[k],k,rec)?(0,exports.merge)(p,(0,exports.set)({},k,rec[k])):p,{});exports.filter=filter;const merge=(left,right)=>assign({},left,right);exports.merge=merge;const merge3=(a,b,c)=>assign({},a,b,c);exports.merge3=merge3;const merge4=(a,b,c,d)=>assign({},a,b,c,d);exports.merge4=merge4;const merge5=(a,b,c,d,e)=>assign({},a,b,c,d,e);exports.merge5=merge5;const rmerge=(left,right)=>(0,exports.reduce)(right,left,deepMerge);exports.rmerge=rmerge;const rmerge3=(r,s,t)=>[s,t].reduce((p,c)=>(0,exports.reduce)(c,p,deepMerge),r);exports.rmerge3=rmerge3;const rmerge4=(r,s,t,u)=>[s,t,u].reduce((p,c)=>(0,exports.reduce)(c,p,deepMerge),r);exports.rmerge4=rmerge4;const rmerge5=(r,s,t,u,v)=>[s,t,u,v].reduce((p,c)=>(0,exports.reduce)(c,p,deepMerge),r);exports.rmerge5=rmerge5;const deepMerge=(pre,curr,key)=>(0,exports.isRecord)(curr)?(0,exports.merge)(pre,(0,exports.set)({},key,(0,exports.isRecord)(pre[key])?(0,exports.rmerge)(pre[key],curr):(0,exports.merge)({},curr))):(0,exports.merge)(pre,(0,exports.set)({},key,curr));const exclude=(rec,keys)=>{let list=Array.isArray(keys)?keys:[keys];return(0,exports.reduce)(rec,{},(p,c,k)=>list.indexOf(k)>-1?p:(0,exports.merge)(p,(0,exports.set)({},k,c)))};exports.exclude=exclude;const partition=(r,f)=>(0,exports.reduce)(r,[{},{}],([yes,no],c,k)=>f(c,k,r)?[(0,exports.merge)(yes,(0,exports.set)({},k,c)),no]:[yes,(0,exports.merge)(no,(0,exports.set)({},k,c))]);exports.partition=partition;const group=(rec,f)=>(0,exports.reduce)(rec,{},(prev,curr,key)=>{let category=f(curr,key,rec);let value=(0,exports.isRecord)(prev[category])?(0,exports.merge)(prev[category],(0,exports.set)({},key,curr)):(0,exports.set)({},key,curr);return(0,exports.merge)(prev,(0,exports.set)({},category,value))});exports.group=group;const values=r=>(0,exports.reduce)(r,[],(p,c)=>(0,array_1.concat)(p,c));exports.values=values;const hasKey=(r,key)=>Object.hasOwnProperty.call(r,key);exports.hasKey=hasKey;const clone=r=>(0,exports.reduce)(r,{},(p,c,k)=>{(0,exports.set)(p,k,_clone(c));return p});exports.clone=clone;const _clone=a=>{if((0,type_1.isArray)(a))return a.map(_clone);else if((0,exports.isRecord)(a))return(0,exports.clone)(a);else return a};const count=r=>(0,exports.keys)(r).length;exports.count=count;const empty=r=>(0,exports.count)(r)===0;exports.empty=empty;const some=(o,f)=>(0,exports.keys)(o).some(k=>f(o[k],k,o));exports.some=some;const every=(o,f)=>(0,exports.keys)(o).every(k=>f(o[k],k,o));exports.every=every;const set=(r,k,value)=>{if(!(0,exports.isBadKey)(k))r[k]=value;return r};exports.set=set;const isBadKey=key=>exports.badKeys.indexOf(key)!==-1;exports.isBadKey=isBadKey;const compact=rec=>{let result={};for(let key in rec)if(rec.hasOwnProperty(key))if(rec[key]!=null)result=(0,exports.set)(result,key,rec[key]);return result};exports.compact=compact;const rcompact=rec=>(0,exports.compact)((0,exports.map)(rec,val=>(0,exports.isRecord)(val)?(0,exports.rcompact)(val):val));exports.rcompact=rcompact;const make=(init={})=>{let rec={};Object.defineProperty(rec,"__proto__",{configurable:false,enumerable:false,set(){}});for(let key in init)if(init.hasOwnProperty(key))rec[key]=init[key];return rec};exports.make=make;const pickKey=(rec,test)=>(0,exports.reduce)(rec,(0,maybe_1.nothing)(),(p,c,k)=>p.isJust()?p:test(c,k,rec)?(0,maybe_1.just)(k):p);exports.pickKey=pickKey;const pickValue=(rec,test)=>(0,exports.reduce)(rec,(0,maybe_1.nothing)(),(p,c,k)=>p.isJust()?p:test(c,k,rec)?(0,maybe_1.just)(c):p);exports.pickValue=pickValue},{"../array":73,"../maybe":77,"../type":81}],79:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.project=exports.unflatten=exports.flatten=exports.unescapeRecord=exports.escapeRecord=exports.unescape=exports.escape=exports.set=exports.getString=exports.getDefault=exports.get=exports.unsafeGet=exports.tokenize=void 0;const maybe_1=require("../maybe");const _1=require("./");const TOKEN_DOT=".";const TOKEN_BRACKET_LEFT="[";const TOKEN_BRACKET_RIGHT="]";const TOKEN_ESCAPE="\\";const tokenize=str=>{let i=0;let buf="";let curr="";let next="";let tokens=[];while(i<str.length){curr=str[i];next=str[i+1];if(curr===TOKEN_ESCAPE){buf=`${buf}${next}`;i++}else if(curr===TOKEN_DOT){if(buf!=="")tokens.push(buf);buf=""}else if(curr===TOKEN_BRACKET_LEFT&&next===TOKEN_BRACKET_RIGHT){i++}else if(curr===TOKEN_BRACKET_LEFT){let bracketBuf="";let firstDot=-1;let firstDotBuf="";i++;while(true){curr=str[i];next=str[i+1];if(curr===TOKEN_BRACKET_RIGHT&&next===TOKEN_BRACKET_RIGHT){bracketBuf=`${bracketBuf}${TOKEN_BRACKET_RIGHT}`;i++}else if(curr===TOKEN_BRACKET_RIGHT){if(buf!=="")tokens.push(buf);tokens.push(bracketBuf);buf="";break}else if(curr==null){if(firstDot!==-1){i=firstDot;tokens.push(`${buf}${TOKEN_BRACKET_LEFT}${firstDotBuf}`);buf="";break}else{buf=`${buf}${TOKEN_BRACKET_LEFT}${bracketBuf}`;break}}if(curr===TOKEN_DOT&&firstDot===-1){firstDot=i;firstDotBuf=bracketBuf}bracketBuf=`${bracketBuf}${curr}`;i++}}else{buf=`${buf}${curr}`}i++}if(buf.length>0)tokens.push(buf);return tokens};exports.tokenize=tokenize;const unsafeGet=(path,src)=>{if(src==null)return undefined;let toks=(0,exports.tokenize)(path);let head=src[toks.shift()];return toks.reduce((p,c)=>p==null?p:p[c],head)};exports.unsafeGet=unsafeGet;const get=(path,src)=>(0,maybe_1.fromNullable)((0,exports.unsafeGet)(path,src));exports.get=get;const getDefault=(path,src,def)=>(0,exports.get)(path,src).orJust(()=>def).get();exports.getDefault=getDefault;const getString=(path,src)=>(0,exports.get)(path,src).map(v=>String(v)).orJust(()=>"").get();exports.getString=getString;const set=(p,v,r)=>{let toks=(0,exports.tokenize)(p);return _set(r,v,toks)};exports.set=set;const _set=(r,value,toks)=>{let o;if(toks.length===0)return value;o=(0,_1.isRecord)(r)?(0,_1.clone)(r):{};o=(0,_1.set)(o,toks[0],_set(o[toks[0]],value,toks.slice(1)));return o};const escape=p=>{let i=0;let buf="";let curr="";while(i<p.length){curr=p[i];if(curr===TOKEN_ESCAPE||curr===TOKEN_DOT)buf=`${buf}${TOKEN_ESCAPE}${curr}`;else buf=`${buf}${curr}`;i++}return buf};exports.escape=escape;const unescape=p=>{let i=0;let curr="";let next="";let buf="";while(i<p.length){curr=p[i];next=p[i+1];if(curr===TOKEN_ESCAPE){buf=`${buf}${next}`;i++}else{buf=`${buf}${curr}`}i++}return buf};exports.unescape=unescape;const escapeRecord=r=>(0,_1.reduce)(r,{},(p,c,k)=>{if(typeof c==="object")p=(0,_1.set)(p,(0,exports.escape)(k),(0,exports.escapeRecord)(c));else p=(0,_1.set)(p,(0,exports.escape)(k),c);return p});exports.escapeRecord=escapeRecord;const unescapeRecord=r=>(0,_1.reduce)(r,{},(p,c,k)=>{if((0,_1.isRecord)(c))p=(0,_1.set)(p,(0,exports.unescape)(k),(0,exports.unescapeRecord)(c));else p=(0,_1.set)(p,(0,exports.unescape)(k),c);return p});exports.unescapeRecord=unescapeRecord;const flatten=r=>flatImpl("")({})(r);exports.flatten=flatten;const flatImpl=pfix=>prev=>r=>(0,_1.reduce)(r,prev,(p,c,k)=>(0,_1.isRecord)(c)?flatImpl(prefix(pfix,k))(p)(c):(0,_1.merge)(p,(0,_1.set)({},prefix(pfix,k),c)));const prefix=(pfix,key)=>pfix===""?(0,exports.escape)(key):`${pfix}.${(0,exports.escape)(key)}`;const unflatten=r=>(0,_1.reduce)(r,{},(p,c,k)=>(0,exports.set)(k,c,p));exports.unflatten=unflatten;const project=(spec,rec)=>(0,_1.reduce)(spec,{},(p,c,k)=>c===true?(0,exports.set)(k,(0,exports.unsafeGet)(k,rec),p):p);exports.project=project},{"../maybe":77,"./":78}],80:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.alphanumeric=exports.numeric=exports.alpha=exports.interp=exports.interpolate=exports.uncapitalize=exports.capitalize=exports.propercase=exports.modulecase=exports.classcase=exports.camelcase=exports.contains=exports.endsWith=exports.startsWith=void 0;const path_1=require("../record/path");const record_1=require("../record");const function_1=require("../function");const startsWith=(str,search,pos=0)=>str.substr(!pos||pos<0?0:+pos,search.length)===search;exports.startsWith=startsWith;const endsWith=(str,search,this_len=str.length)=>this_len===undefined||this_len>str.length?this_len=str.length:str.substring(this_len-search.length,this_len)===search;exports.endsWith=endsWith;const contains=(str,match)=>str.indexOf(match)>-1;exports.contains=contains;const seperator=/([\\\/._-]|\s)+/g;const camelcase=str=>{let i=0;let curr="";let prev="";let buf="";while(true){if(i===str.length)return buf;curr=i===0?str[i].toLowerCase():str[i];if(curr.match(seperator)){prev="-"}else{buf=buf.concat(prev==="-"?curr.toUpperCase():curr.toLowerCase());prev=""}i++}};exports.camelcase=camelcase;const classcase=str=>str===""?"":str[0].toUpperCase().concat((0,exports.camelcase)(str).slice(1));exports.classcase=classcase;const modulecase=str=>{let i=0;let prev="";let curr="";let next="";let buf="";while(true){if(i===str.length)return buf;curr=str[i];next=str[i+1];if(curr.match(/[A-Z]/)&&i>0){if(prev!=="-")buf=buf.concat("-");prev=curr.toLowerCase();buf=buf.concat(prev)}else if(curr.match(seperator)){if(prev!=="-"&&next&&!seperator.test(next)){prev="-";buf=buf.concat(prev)}}else{prev=curr.toLowerCase();buf=buf.concat(prev)}i++}};exports.modulecase=modulecase;const propercase=str=>str.trim().toLowerCase().split(" ").map(tok=>tok.length>0?`${tok[0].toUpperCase()}${tok.slice(1)}`:tok).join(" ");exports.propercase=propercase;const capitalize=str=>str===""?"":`${str[0].toUpperCase()}${str.slice(1)}`;exports.capitalize=capitalize;const uncapitalize=str=>str===""?"":`${str[0].toLowerCase()}${str.slice(1)}`;exports.uncapitalize=uncapitalize;const interpolateDefaults={start:"{",end:"}",regex:"([\\w$.-]+)",leaveMissing:true,applyFunctions:false,transform:function_1.identity,getter:(data,path)=>(0,path_1.unsafeGet)(path,data)};const interpolate=(str,data,opts={})=>{let options=(0,record_1.assign)({},interpolateDefaults,opts);let{getter:getter,transform:transform,start:start,regex:regex,end:end}=options;let reg=new RegExp(`${start}${regex}${end}`,"g");return str.replace(reg,(_,k)=>{let value=getter(data,k);if(value!=null){if(typeof value==="function")value=options.applyFunctions?value(k):opts.leaveMissing?k:"";else value=value+""}else{value=opts.leaveMissing?k:""}return transform(value)})};exports.interpolate=interpolate;exports.interp=exports.interpolate;const alpha=str=>str.replace(/[^a-zA-Z]/g,"");exports.alpha=alpha;const numeric=str=>str.replace(/[^0-9]/g,"");exports.numeric=numeric;const alphanumeric=str=>str.replace(/[\W]|[_]/g,"");exports.alphanumeric=alphanumeric},{"../function":76,"../record":78,"../record/path":79}],81:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.toString=exports.show=exports.test=exports.is=exports.isPrim=exports.isFunction=exports.isBoolean=exports.isNumber=exports.isString=exports.isArray=exports.isObject=exports.Any=void 0;const prims=["string","number","boolean"];class Any{}exports.Any=Any;const isObject=value=>typeof value==="object"&&!(0,exports.isArray)(value);exports.isObject=isObject;exports.isArray=Array.isArray;const isString=value=>typeof value==="string";exports.isString=isString;const isNumber=value=>typeof value==="number"&&!isNaN(value);exports.isNumber=isNumber;const isBoolean=value=>typeof value==="boolean";exports.isBoolean=isBoolean;const isFunction=value=>typeof value==="function";exports.isFunction=isFunction;const isPrim=value=>!((0,exports.isObject)(value)||(0,exports.isArray)(value)||(0,exports.isFunction)(value));exports.isPrim=isPrim;const is=expected=>value=>typeof value===expected;exports.is=is;const test=(value,t)=>{if(prims.indexOf(typeof t)>-1&&value===t)return true;else if(typeof t==="function"&&(t===String&&typeof value==="string"||t===Number&&typeof value==="number"||t===Boolean&&typeof value==="boolean"||t===Array&&Array.isArray(value)||t===Any||value instanceof t))return true;else if(t instanceof RegExp&&(typeof value==="string"&&t.test(value)))return true;else if(typeof t==="object"&&typeof value==="object")return Object.keys(t).every(k=>Object.hasOwnProperty.call(value,k)?(0,exports.test)(value[k],t[k]):false);return false};exports.test=test;const show=value=>{if(typeof value==="object"){if(Array.isArray(value))return`[${value.map(exports.show)}];`;else if(value.constructor!==Object)return value.constructor.name||value.constructor;else return JSON.stringify(value)}else{return""+value}};exports.show=show;const toString=val=>val==null?"":String(val);exports.toString=toString},{}],82:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.round=exports.isMultipleOf=void 0;const isMultipleOf=(x,y)=>y%x===0;exports.isMultipleOf=isMultipleOf;const round=(x,n=0)=>{let exp=Math.pow(10,n);let sign=x>=0?1:-1;let offset=n>0?1/Math.pow(10,n+1):0;return sign*(Math.round(Math.abs(x)*exp+offset)/exp)};exports.round=round},{}],83:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.isGroup=exports.isChild=exports.getId=exports.getParent=exports.make=exports.isRestricted=exports.ADDRESS_RESTRICTED=exports.ADDRESS_EMPTY=exports.ADDRESS_SYSTEM=exports.ADDRESS_DISCARD=exports.SEPERATOR=void 0;const array_1=require("@quenk/noni/lib/data/array");const string_1=require("@quenk/noni/lib/data/string");exports.SEPERATOR="/";exports.ADDRESS_DISCARD="?";exports.ADDRESS_SYSTEM="$";exports.ADDRESS_EMPTY="";exports.ADDRESS_RESTRICTED=[exports.ADDRESS_DISCARD,exports.ADDRESS_SYSTEM,exports.SEPERATOR];const isRestricted=id=>exports.ADDRESS_RESTRICTED.some(a=>id.indexOf(a)>-1)&&id!==exports.SEPERATOR;exports.isRestricted=isRestricted;const make=(parent,id)=>parent===exports.SEPERATOR||parent===exports.ADDRESS_EMPTY?`${parent}${id}`:parent===exports.ADDRESS_SYSTEM?id:`${parent}${exports.SEPERATOR}${id}`;exports.make=make;const getParent=addr=>{if(addr===exports.ADDRESS_SYSTEM||addr===exports.ADDRESS_EMPTY||addr===exports.ADDRESS_DISCARD||addr===exports.SEPERATOR){return exports.ADDRESS_SYSTEM}else{let b4=addr.split(exports.SEPERATOR);if(b4.length===2&&b4[0]===""){return exports.SEPERATOR}else{let a=b4.reverse().slice(1).reverse().join(exports.SEPERATOR);return a===exports.ADDRESS_EMPTY?exports.ADDRESS_SYSTEM:a}}};exports.getParent=getParent;const getId=addr=>addr===exports.ADDRESS_SYSTEM||addr===exports.ADDRESS_DISCARD||addr===exports.ADDRESS_EMPTY||addr===exports.SEPERATOR?addr:(0,array_1.tail)(addr.split(exports.SEPERATOR));exports.getId=getId;const isChild=(parent,child)=>parent===exports.ADDRESS_SYSTEM||parent!==child&&(0,string_1.startsWith)(child,parent);exports.isChild=isChild;const isGroup=addr=>addr[0]==="$"&&addr!=="$";exports.isGroup=isGroup},{"@quenk/noni/lib/data/array":73,"@quenk/noni/lib/data/string":80}],84:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.isResident=exports.isRouter=exports.isBuffered=exports.isImmutable=exports.FLAG_EXIT_AFTER_RUN=exports.FLAG_RESIDENT=exports.FLAG_ROUTER=exports.FLAG_EXIT_AFTER_RECEIVE=exports.FLAG_BUFFERED=exports.FLAG_IMMUTABLE=void 0;exports.FLAG_IMMUTABLE=1;exports.FLAG_BUFFERED=2;exports.FLAG_EXIT_AFTER_RECEIVE=4;exports.FLAG_ROUTER=8;exports.FLAG_RESIDENT=16;exports.FLAG_EXIT_AFTER_RUN=32;const isImmutable=f=>(f&exports.FLAG_IMMUTABLE)===exports.FLAG_IMMUTABLE;exports.isImmutable=isImmutable;const isBuffered=f=>(f&exports.FLAG_BUFFERED)===exports.FLAG_BUFFERED;exports.isBuffered=isBuffered;const isRouter=f=>(f&exports.FLAG_ROUTER)===exports.FLAG_ROUTER;exports.isRouter=isRouter;const isResident=f=>(f&exports.FLAG_RESIDENT)===exports.FLAG_RESIDENT;exports.isResident=isResident},{}],85:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Envelope=void 0;class Envelope{constructor(to,from,message){this.to=to;this.from=from;this.message=message}}exports.Envelope=Envelope},{}],86:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CaseFunction=void 0;class CaseFunction{constructor(cases){this.cases=cases}test(msg){return this.cases.some(kase=>kase.test(msg))}apply(msg){let kase=this.cases.find(kase=>kase.test(msg));if(!kase)throw new Error(`CaseFunction: No Case patterns match!`);return kase.apply(msg)}}exports.CaseFunction=CaseFunction},{}],87:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Default=exports.caseOf=exports.Case=void 0;const type_1=require("@quenk/noni/lib/data/type");class Case{constructor(pattern,handler){this.pattern=pattern;this.handler=handler}test(m){return(0,type_1.test)(m,this.pattern)}apply(m){return this.handler(m)}}exports.Case=Case;function caseOf(pattern,handler){return new Case(pattern,handler)}exports.caseOf=caseOf;class Default extends Case{constructor(handler){super(Object,handler);this.handler=handler}test(_){return true}apply(m){return this.handler(m)}}exports.Default=Default},{"@quenk/noni/lib/data/type":81}],88:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Callback=void 0;const _1=require("./");class Callback extends _1.Immutable{}exports.Callback=Callback},{"./":89}],89:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Immutable=void 0;const flags_1=require("../../flags");const function_1=require("../case/function");const __1=require("../");class Immutable extends __1.AbstractResident{get $receiver(){return new function_1.CaseFunction(this.receive())}init(c){c.flags=c.flags|flags_1.FLAG_IMMUTABLE|flags_1.FLAG_BUFFERED;return c}receive(){return[]}}exports.Immutable=Immutable},{"../":90,"../../flags":84,"../case/function":86}],90:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ref=exports.AbstractResident=void 0;const record_1=require("@quenk/noni/lib/data/record");const type_1=require("@quenk/noni/lib/data/type");const error_1=require("../system/vm/runtime/error");class AbstractResident{constructor(system){this.system=system;this.self=getSelf(this)}get platform(){return this.system.getPlatform()}notify(){this.platform.exec(this,"notify")}accept(_){}spawn(t){return this.system.getPlatform().spawn(this,t)}spawnGroup(group,tmpls){return(0,record_1.map)(tmpls,t=>this.spawn((0,type_1.isObject)(t)?(0,record_1.merge)(t,{group:group}):{group:group,create:t}))}tell(ref,msg){let{heap:heap}=this.platform;this.exec("tell",[heap.string(ref),heap.object(msg)]);return this}raise(e){this.system.getPlatform().raise(this,e);return this}kill(addr){let{heap:heap}=this.platform;this.exec("kill",[heap.string(addr)]);return this}exit(){this.kill(this.self())}start(addr){this.self=(()=>addr);return this.run()}run(){}stop(){}wait(ft){let mthread=this.platform.getThread(this.self());if(mthread.isJust())mthread.get().wait(ft);else this.raise(new error_1.UnknownInstanceErr(this))}exec(fname,args){this.platform.exec(this,fname,args)}}exports.AbstractResident=AbstractResident;const ref=(res,addr)=>m=>res.tell(addr,m);exports.ref=ref;const getSelf=actor=>{let _self="?";return()=>{if(_self==="?")_self=actor.system.getPlatform().identify(actor).orJust(()=>"?").get();return _self}}},{"../system/vm/runtime/error":98,"@quenk/noni/lib/data/record":78,"@quenk/noni/lib/data/type":81}],91:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Mutable=void 0;const flags_1=require("../../flags");const __1=require("../");const function_1=require("../case/function");class Mutable extends __1.AbstractResident{constructor(){super(...arguments);this.$receivers=[]}init(c){c.flags=c.flags|flags_1.FLAG_BUFFERED;return c}select(cases){this.$receivers.push(new function_1.CaseFunction(cases));this.notify();return this}}exports.Mutable=Mutable},{"../":90,"../../flags":84,"../case/function":86}],92:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TaskActorScript=exports.MutableActorScript=exports.CallbackActorScript=exports.ImmutableActorScript=exports.GenericResidentScript=void 0;const op=require("../system/vm/runtime/op");const events=require("../system/vm/event");const errors=require("../system/vm/runtime/error");const array_1=require("@quenk/noni/lib/data/array");const info_1=require("../system/vm/script/info");const scripts_1=require("../system/vm/scripts");const receiveIdx=scripts_1.commonFunctions.length+2;const residentCommonFunctions=[...scripts_1.commonFunctions,new info_1.NewFunInfo("notify",0,[op.MAILCOUNT,op.IFZJMP|5,op.MAILDQ,op.LDN|receiveIdx,op.CALL|1,op.NOP]),new info_1.NewForeignFunInfo("kill",1,(thr,addr)=>{thr.wait(thr.vm.kill(thr.context.actor,addr));return 0})];class GenericResidentScript extends scripts_1.BaseScript{constructor(){super(...arguments);this.info=residentCommonFunctions}}exports.GenericResidentScript=GenericResidentScript;class ImmutableActorScript extends scripts_1.BaseScript{constructor(actor){super();this.actor=actor;this.info=[...residentCommonFunctions,new info_1.NewForeignFunInfo("receive",1,(thr,msg)=>immutableExec(this.actor,thr,msg))];this.code=[]}}exports.ImmutableActorScript=ImmutableActorScript;class CallbackActorScript extends scripts_1.BaseScript{constructor(actor){super();this.actor=actor;this.info=[...residentCommonFunctions,new info_1.NewForeignFunInfo("receive",1,(thr,msg)=>{let result=immutableExec(this.actor,thr,msg);this.actor.exit();return result})];this.code=[]}}exports.CallbackActorScript=CallbackActorScript;class MutableActorScript extends scripts_1.BaseScript{constructor(actor){super();this.actor=actor;this.info=[...residentCommonFunctions,new info_1.NewForeignFunInfo("receive",1,(thr,msg)=>{let{actor:actor}=this;let vm=actor.system.getPlatform();if((0,array_1.empty)(actor.$receivers)){thr.raise(new errors.NoReceiverErr(thr.context.address));return 0}if(actor.$receivers[0].test(msg)){let receiver=actor.$receivers.shift();let future=receiver.apply(msg);if(future)thr.wait(future);vm.trigger(thr.context.address,events.EVENT_MESSAGE_READ,msg);return 1}else{vm.trigger(thr.context.address,events.EVENT_MESSAGE_DROPPED,msg);return 0}}),new info_1.NewFunInfo("notify",0,[op.MAILCOUNT,op.IFZJMP|4,op.MAILDQ,op.CALL|receiveIdx,op.NOP])];this.code=[]}}exports.MutableActorScript=MutableActorScript;class TaskActorScript extends scripts_1.BaseScript{constructor(){super(...arguments);this.info=scripts_1.commonFunctions}}exports.TaskActorScript=TaskActorScript;const immutableExec=(actor,thr,msg)=>{let vm=actor.system.getPlatform();if(actor.$receiver.test(msg)){let future=actor.$receiver.apply(msg);if(future)thr.wait(future);vm.trigger(thr.context.address,events.EVENT_MESSAGE_READ,msg);return 1}else{vm.trigger(thr.context.address,events.EVENT_MESSAGE_DROPPED,msg);return 0}}},{"../system/vm/event":94,"../system/vm/runtime/error":98,"../system/vm/runtime/op":103,"../system/vm/script/info":107,"../system/vm/scripts":109,"@quenk/noni/lib/data/array":73}],93:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.defaults=void 0;const log_1=require("./log");const defaults=()=>({log:{level:log_1.LOG_LEVEL_ERROR,logger:console},on:{},accept:()=>{}});exports.defaults=defaults},{"./log":96}],94:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getLevel=exports.events=exports.EVENT_ACTOR_STOPPED=exports.EVENT_ACTOR_STARTED=exports.EVENT_ACTOR_CREATED=exports.EVENT_MESSAGE_DROPPED=exports.EVENT_MESSAGE_READ=exports.EVENT_EXEC_ACTOR_CHANGED=exports.EVENT_EXEC_ACTOR_GONE=exports.EVENT_EXEC_INSTANCE_STALE=exports.EVENT_SEND_FAILED=exports.EVENT_SEND_OK=void 0;const log_1=require("./log");exports.EVENT_SEND_OK="message-send-ok";exports.EVENT_SEND_FAILED="message-send-failed";exports.EVENT_EXEC_INSTANCE_STALE="exec-instance-stale";exports.EVENT_EXEC_ACTOR_GONE="exec-actor-gone";exports.EVENT_EXEC_ACTOR_CHANGED="exec-actor-changed";exports.EVENT_MESSAGE_READ="message-read";exports.EVENT_MESSAGE_DROPPED="message-dropped";exports.EVENT_ACTOR_CREATED="actor-created";exports.EVENT_ACTOR_STARTED="actor-started";exports.EVENT_ACTOR_STOPPED="actor-stopped";exports.events={[exports.EVENT_ACTOR_CREATED]:{level:log_1.LOG_LEVEL_INFO},[exports.EVENT_ACTOR_STARTED]:{level:log_1.LOG_LEVEL_INFO},[exports.EVENT_SEND_OK]:{level:log_1.LOG_LEVEL_INFO},[exports.EVENT_MESSAGE_READ]:{level:log_1.LOG_LEVEL_INFO},[exports.EVENT_SEND_FAILED]:{level:log_1.LOG_LEVEL_WARN},[exports.EVENT_MESSAGE_DROPPED]:{level:log_1.LOG_LEVEL_WARN},[exports.EVENT_EXEC_INSTANCE_STALE]:{level:log_1.LOG_LEVEL_WARN},[exports.EVENT_EXEC_ACTOR_GONE]:{level:log_1.LOG_LEVEL_WARN},[exports.EVENT_EXEC_ACTOR_CHANGED]:{level:log_1.LOG_LEVEL_WARN},[exports.EVENT_ACTOR_STOPPED]:{level:log_1.LOG_LEVEL_WARN}};const getLevel=e=>exports.events.hasOwnProperty(e)?exports.events[e].level:log_1.LOG_LEVEL_DEBUG;exports.getLevel=getLevel},{"./log":96}],95:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.PVM=exports.MAX_WORK_LOAD=void 0;const template=require("../../template");const errors=require("./runtime/error");const events=require("./event");const future_1=require("@quenk/noni/lib/control/monad/future");const maybe_1=require("@quenk/noni/lib/data/maybe");const type_1=require("@quenk/noni/lib/data/type");const either_1=require("@quenk/noni/lib/data/either");const array_1=require("@quenk/noni/lib/data/array");const record_1=require("@quenk/noni/lib/data/record");const address_1=require("../../address");const flags_1=require("../../flags");const message_1=require("../../message");const scheduler_1=require("./thread/shared/scheduler");const shared_1=require("./thread/shared");const thread_1=require("./thread");const state_1=require("./state");const context_1=require("./runtime/context");const op_1=require("./runtime/op");const conf_1=require("./conf");const log_1=require("./log");const ledger_1=require("./runtime/heap/ledger");const factory_1=require("./scripts/factory");const event_1=require("./event");const ID_RANDOM=`#?POTOORAND?#${Date.now()}`;exports.MAX_WORK_LOAD=25;class PVM{constructor(system,conf=(0,conf_1.defaults)()){this.system=system;this.conf=conf;this._actorIdCounter=-1;this.heap=new ledger_1.DefaultHeapLedger;this.threadRunner=new scheduler_1.SharedScheduler(this);this.state={threads:{$:new shared_1.SharedThread(this,factory_1.ScriptFactory.getScript(this),this.threadRunner,(0,context_1.newContext)(this._actorIdCounter++,this,"$",{create:()=>this,trap:()=>template.ACTION_RAISE}))},routers:{},groups:{},pendingMessages:{}}}static create(s,conf={}){return new PVM(s,(0,record_1.rmerge)((0,conf_1.defaults)(),conf))}init(c){return c}accept(m){return this.conf.accept(m)}start(){}notify(){}stop(){return this.kill(this,address_1.ADDRESS_SYSTEM)}identify(inst){return(0,state_1.getAddress)(this.state,inst)}spawn(parent,tmpl){let mparentAddr=this.identify(parent);if(mparentAddr.isNothing()){this.raise(this,new errors.UnknownInstanceErr(parent));return"?"}return this._spawn(mparentAddr.get(),normalize(tmpl))}_spawn(parent,tmpl){let eresult=this.allocate(parent,tmpl);if(eresult.isLeft()){this.raise(this.state.threads[parent].context.actor,eresult.takeLeft());return"?"}let result=eresult.takeRight();this.runActor(result);if(Array.isArray(tmpl.children))tmpl.children.forEach(tmp=>this._spawn(result,tmp));return result}allocate(parent,tmpl){if(tmpl.id===ID_RANDOM){let rtime=(0,state_1.get)(this.state,parent).get();let prefix=rtime.context.actor.constructor.name.toLowerCase();tmpl.id=`actor::${this._actorIdCounter+1}~${prefix}`}if((0,address_1.isRestricted)(tmpl.id))return(0,either_1.left)(new errors.InvalidIdErr(tmpl.id));let addr=(0,address_1.make)(parent,tmpl.id);if(this.getThread(addr).isJust())return(0,either_1.left)(new errors.DuplicateAddressErr(addr));let args=Array.isArray(tmpl.args)?tmpl.args:[];let act=tmpl.create(this.system,tmpl,...args);let thr=new shared_1.SharedThread(this,factory_1.ScriptFactory.getScript(act),this.threadRunner,act.init((0,context_1.newContext)(this._actorIdCounter++,act,addr,tmpl)));this.putThread(addr,thr);this.trigger(addr,events.EVENT_ACTOR_CREATED);if((0,flags_1.isRouter)(thr.context.flags))this.putRoute(addr,addr);if(tmpl.group){let groups=typeof tmpl.group==="string"?[tmpl.group]:tmpl.group;groups.forEach(g=>this.putMember(g,addr))}return(0,either_1.right)(addr)}runActor(target){let mthread=this.getThread(target);if(mthread.isNothing())return(0,future_1.raise)(new errors.UnknownAddressErr(target));let rtime=mthread.get();let ft=rtime.context.actor.start(target);if(ft)rtime.wait(ft);if(rtime.context.flags&flags_1.FLAG_EXIT_AFTER_RUN)rtime.wait(this.kill(rtime.context.actor,target));this.trigger(rtime.context.address,events.EVENT_ACTOR_STARTED)}sendMessage(to,from,msg){let mRouter=this.getRouter(to);let mctx=mRouter.isJust()?mRouter:this.getThread(to).map(r=>r.context);let actualMessage=mRouter.isJust()?new message_1.Envelope(to,from,msg):msg;if(mctx.isJust()){let ctx=mctx.get();if((0,flags_1.isBuffered)(ctx.flags)){ctx.mailbox.push(actualMessage);ctx.actor.notify()}else{ctx.actor.accept(actualMessage)}this.trigger(from,events.EVENT_SEND_OK,to,msg);return true}else{this.trigger(from,events.EVENT_SEND_FAILED,to,msg);return false}}getThread(addr){return(0,state_1.get)(this.state,addr)}getRouter(addr){return(0,state_1.getRouter)(this.state,addr).map(r=>r.context)}getGroup(name){return(0,state_1.getGroup)(this.state,name.split("$").join(""))}getChildren(addr){return(0,maybe_1.fromNullable)((0,state_1.getChildren)(this.state,addr))}putThread(addr,r){this.state=(0,state_1.put)(this.state,addr,r);return this}putMember(group,addr){(0,state_1.putMember)(this.state,group,addr);return this}putRoute(target,router){(0,state_1.putRoute)(this.state,target,router);return this}remove(addr){this.state=(0,state_1.remove)(this.state,addr);(0,record_1.map)(this.state.routers,(r,k)=>{if(r===addr)delete this.state.routers[k]});return this}removeRoute(target){(0,state_1.removeRoute)(this.state,target);return this}raise(src,err){let maddr=this.identify(src);if(maddr.isNothing())return;let addr=maddr.get();let next=addr;loop:while(true){let mrtime=this.getThread(next);if(mrtime.isNothing())return;let rtime=mrtime.get();let trap=rtime.context.template.trap||(()=>template.ACTION_RAISE);switch(trap(err)){case template.ACTION_IGNORE:this.getThread(addr).map(thr=>{thr.state=thread_1.THREAD_STATE_IDLE});break loop;case template.ACTION_RESTART:let maddr=(0,state_1.get)(this.state,next);if(maddr.isJust())this.kill(maddr.get().context.actor,next).chain(()=>{let eRes=this.allocate((0,address_1.getParent)(next),rtime.context.template);if(eRes.isLeft())return(0,future_1.raise)(new Error(eRes.takeLeft().message));this.runActor(eRes.takeRight());return future_1.voidPure}).fork(e=>this.raise(this,e));break loop;case template.ACTION_STOP:let smaddr=(0,state_1.get)(this.state,next);if(smaddr.isJust())this.kill(smaddr.get().context.actor,next).fork(e=>this.raise(this,e));break loop;default:if(next===address_1.ADDRESS_SYSTEM){if(err instanceof Error)throw err;throw new Error(err.message)}else{next=(0,address_1.getParent)(next)}break}}}trigger(addr,evt,...args){let elvl=(0,event_1.getLevel)(evt);let{level:level,logger:logger}=this.conf.log;if(level>=elvl){switch(elvl){case log_1.LOG_LEVEL_DEBUG:logger.debug(addr,evt,args);break;case log_1.LOG_LEVEL_INFO:logger.info(addr,evt,args);break;case log_1.LOG_LEVEL_NOTICE:case log_1.LOG_LEVEL_WARN:logger.warn(addr,evt,args);break;case log_1.LOG_LEVEL_ERROR:logger.error(addr,evt,args);break;default:break}}if(this.conf.on[evt]!=null)this.conf.on[evt].apply(null,[addr,evt,...args])}logOp(r,f,op,oper){this.conf.log.logger.debug.apply(null,[`[${r.context.address}]`,`(${f.script.name})`,...(0,op_1.toLog)(op,r,f,oper)])}kill(parent,target){let that=this;return(0,future_1.doFuture)(function*(){let mparentAddr=that.identify(parent);if(mparentAddr.isNothing())return(0,future_1.pure)(undefined);let parentAddr=mparentAddr.get();let addrs=(0,address_1.isGroup)(target)?that.getGroup(target).orJust(()=>[]).get():[target];return runBatch(addrs.map(addr=>(0,future_1.doFuture)(function*(){if(!(0,address_1.isChild)(parentAddr,target)&&target!==parentAddr){let err=new Error(`IllegalStopErr: Actor "${parentAddr}" `+`cannot kill non-child "${addr}"!`);that.raise(parent,err);return(0,future_1.raise)(err)}let mthread=that.getThread(addr);if(mthread.isNothing())return(0,future_1.pure)(undefined);let thread=mthread.get();let mchilds=that.getChildren(target);let childs=mchilds.isJust()?mchilds.get():{};let killChild=(child,addr)=>(0,future_1.doFuture)(function*(){yield child.die();that.remove(addr);that.trigger(addr,events.EVENT_ACTOR_STOPPED);return future_1.voidPure});yield runBatch((0,record_1.mapTo)((0,record_1.map)(childs,killChild),f=>f));if(addr!==address_1.ADDRESS_SYSTEM)yield killChild(thread,addr);return future_1.voidPure})))})}tell(ref,msg){this.exec(this,"tell",[this.heap.string(ref),this.heap.object(msg)]);return this}exec(actor,funName,args=[]){let mAddress=this.identify(actor);if(mAddress.isNothing())return this.raise(this,new errors.UnknownInstanceErr(actor));let thread=this.state.threads[mAddress.get()];thread.exec(funName,args)}}exports.PVM=PVM;const runBatch=work=>(0,future_1.doFuture)(function*(){yield(0,future_1.batch)((0,array_1.distribute)(work,exports.MAX_WORK_LOAD));return future_1.voidPure});const normalize=spawnable=>{let tmpl=(0,type_1.isFunction)(spawnable)?{create:spawnable}:spawnable;tmpl.id=tmpl.id?tmpl.id:ID_RANDOM;return(0,record_1.merge)(tmpl,{children:(0,record_1.isRecord)(tmpl.children)?(0,record_1.mapTo)(tmpl.children,(c,k)=>(0,record_1.merge)(c,{id:k})):tmpl.children?tmpl.children:[]})}},{"../../address":83,"../../flags":84,"../../message":85,"../../template":115,"./conf":93,"./event":94,"./log":96,"./runtime/context":97,"./runtime/error":98,"./runtime/heap/ledger":99,"./runtime/op":103,"./scripts/factory":108,"./state":110,"./thread":111,"./thread/shared":112,"./thread/shared/scheduler":113,"@quenk/noni/lib/control/monad/future":70,"@quenk/noni/lib/data/array":73,"@quenk/noni/lib/data/either":75,"@quenk/noni/lib/data/maybe":77,"@quenk/noni/lib/data/record":78,"@quenk/noni/lib/data/type":81}],96:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.LOG_LEVEL_ERROR=exports.LOG_LEVEL_WARN=exports.LOG_LEVEL_NOTICE=exports.LOG_LEVEL_INFO=exports.LOG_LEVEL_DEBUG=void 0;exports.LOG_LEVEL_DEBUG=7;exports.LOG_LEVEL_INFO=6;exports.LOG_LEVEL_NOTICE=5;exports.LOG_LEVEL_WARN=4;exports.LOG_LEVEL_ERROR=3},{}],97:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.newContext=void 0;const newContext=(aid,actor,address,template)=>({aid:aid,mailbox:[],actor:actor,receivers:[],flags:0,address:address,template:template});exports.newContext=newContext},{}],98:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.UnknownFunErr=exports.UnknownInstanceErr=exports.InvalidFunctionErr=exports.InvalidConstructorErr=exports.MissingInfoErr=exports.InvalidPropertyIndex=exports.StackEmptyErr=exports.IntegerOverflowErr=exports.MissingSymbolErr=exports.UnknownAddressErr=exports.EmptyMailboxErr=exports.NoMailboxErr=exports.NoReceiverErr=exports.IllegalStopErr=exports.UnexpectedDataType=exports.NullPointerErr=exports.JumpOutOfBoundsErr=exports.NullFunctionPointerErr=exports.NullTemplatePointerErr=exports.DuplicateAddressErr=exports.UnknownParentAddressErr=exports.InvalidIdErr=exports.Error=void 0;const address_1=require("../../../address");const frame_1=require("./stack/frame");class Error{constructor(message){this.message=message}}exports.Error=Error;class InvalidIdErr extends Error{constructor(id){super(`The id "${id} must not contain`+`${address_1.ADDRESS_RESTRICTED} or be an empty string!`);this.id=id}}exports.InvalidIdErr=InvalidIdErr;class UnknownParentAddressErr extends Error{constructor(address){super(`The parent address "${address}" is not part of the system!`);this.address=address}}exports.UnknownParentAddressErr=UnknownParentAddressErr;class DuplicateAddressErr extends Error{constructor(address){super(`Duplicate address "${address}" detected!`);this.address=address}}exports.DuplicateAddressErr=DuplicateAddressErr;class NullTemplatePointerErr extends Error{constructor(index){super(`The index "${index}" does not exist in the Template table!`);this.index=index}}exports.NullTemplatePointerErr=NullTemplatePointerErr;class NullFunctionPointerErr extends Error{constructor(index){super(`The index "${index}" does not exist in the function table!`);this.index=index}}exports.NullFunctionPointerErr=NullFunctionPointerErr;class JumpOutOfBoundsErr extends Error{constructor(location,size){super(`Cannot jump to location "${location}"! Max location: ${size}!`);this.location=location;this.size=size}}exports.JumpOutOfBoundsErr=JumpOutOfBoundsErr;class NullPointerErr extends Error{constructor(data){super(`Value: [${data.toString(16)}]`);this.data=data}}exports.NullPointerErr=NullPointerErr;class UnexpectedDataType extends Error{constructor(expected,got){super(`Expected: ${expected.toString(16)}, `+`Received: ${got.toString(16)}`);this.expected=expected;this.got=got}}exports.UnexpectedDataType=UnexpectedDataType;class IllegalStopErr extends Error{constructor(parent,child){super(`The actor at address "${parent}" can not kill "${child}"!`);this.parent=parent;this.child=child}}exports.IllegalStopErr=IllegalStopErr;class NoReceiverErr extends Error{constructor(actor){super(`Actor ${actor} tried to read a message without a receiver!`);this.actor=actor}}exports.NoReceiverErr=NoReceiverErr;class NoMailboxErr extends Error{constructor(actor){super(`Actor ${actor} has no mailbox!`);this.actor=actor}}exports.NoMailboxErr=NoMailboxErr;class EmptyMailboxErr extends Error{constructor(){super("Mailbox empty.")}}exports.EmptyMailboxErr=EmptyMailboxErr;class UnknownAddressErr extends Error{constructor(actor){super(`The system has no actor for address "${actor}"!`);this.actor=actor}}exports.UnknownAddressErr=UnknownAddressErr;class MissingSymbolErr extends Error{constructor(index){super(`Cannot locate symbol at index 0x${index.toString(16)}`);this.index=index}}exports.MissingSymbolErr=MissingSymbolErr;class IntegerOverflowErr extends Error{constructor(){super(`DATA_MAX_SAFE_UINT32=${frame_1.DATA_MAX_SAFE_UINT32}`)}}exports.IntegerOverflowErr=IntegerOverflowErr;class StackEmptyErr extends Error{constructor(){super("Stack is empty.")}}exports.StackEmptyErr=StackEmptyErr;class InvalidPropertyIndex extends Error{constructor(cons,idx){super(`Constructor: ${cons.name}, index: ${idx}`);this.cons=cons;this.idx=idx}}exports.InvalidPropertyIndex=InvalidPropertyIndex;class MissingInfoErr extends Error{constructor(idx){super(`No info object index: ${idx}!`);this.idx=idx}}exports.MissingInfoErr=MissingInfoErr;class InvalidConstructorErr extends Error{constructor(name){super(`Named object "${name}" cannot be used as a constructor!`);this.name=name}}exports.InvalidConstructorErr=InvalidConstructorErr;class InvalidFunctionErr extends Error{constructor(name){super(`Named object "${name}" cannot be used as a function!`);this.name=name}}exports.InvalidFunctionErr=InvalidFunctionErr;class UnknownInstanceErr extends Error{constructor(instance){super("The instance provided with constructor "+(instance?instance.constructor.name||instance:instance)+'" is not in the system!');this.instance=instance}}exports.UnknownInstanceErr=UnknownInstanceErr;class UnknownFunErr extends Error{constructor(name){super(`The function '${name}' does not exist and cannot be executed!`);this.name=name}}exports.UnknownFunErr=UnknownFunErr},{"../../../address":83,"./stack/frame":105}],99:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.isHeapAddress=exports.DefaultHeapLedger=void 0;const maybe_1=require("@quenk/noni/lib/data/maybe");const record_1=require("@quenk/noni/lib/data/record");const type_1=require("@quenk/noni/lib/data/type");const info_1=require("../../script/info");const frame_1=require("../stack/frame");class DefaultHeapLedger{constructor(objects={},owners={}){this.objects=objects;this.owners=owners;this.counter=0}_addItem(name,value,flag){let addr=this.counter++|flag;this.objects[addr]=value;if(name!=="")this.owners[addr]=name;return addr}string(value){return this._addItem("",value,frame_1.DATA_TYPE_HEAP_STRING)}object(value){return this._addItem("",value,frame_1.DATA_TYPE_HEAP_OBJECT)}fun(value){return this._addItem("",value,frame_1.DATA_TYPE_HEAP_FUN)}addString(frame,value){return this._addItem(frame.name,value,frame_1.DATA_TYPE_HEAP_STRING)}addObject(frame,obj){return this._addItem(frame.name,obj,frame_1.DATA_TYPE_HEAP_OBJECT)}addFun(frame,obj){return this._addItem(frame.name,obj,frame_1.DATA_TYPE_HEAP_FUN)}getString(ref){let value=this.objects[ref];return value!=null?value:""}getObject(ref){return(0,maybe_1.fromNullable)(this.objects[ref])}getFrameRefs(frame){return(0,record_1.mapTo)((0,record_1.filter)(this.owners,owner=>owner===frame.name),(_,k)=>Number(k))}getThreadRefs(thread){return(0,record_1.mapTo)((0,record_1.filter)(this.owners,owner=>threadId(owner)===thread.context.aid),(_,k)=>Number(k))}intern(frame,value){let maddr=(0,record_1.pickKey)(this.objects,val=>val===value);if(maddr.isJust())return Number(maddr.get());if((0,type_1.isNumber)(value))return value;else if((0,type_1.isString)(value))return this.addString(frame,value);else if((0,type_1.isObject)(value))return value instanceof info_1.NewFunInfo||value instanceof info_1.NewForeignFunInfo?this.addFun(frame,value):this.addObject(frame,value);else return 0}move(ref,newOwner){this.owners[ref]=newOwner;return ref}frameExit(frame){if(frame.parent.isJust()&&(0,exports.isHeapAddress)(frame.thread.rp))this.move(frame.thread.rp,frame.parent.get().name);this.getFrameRefs(frame).forEach(ref=>{if(ref!==frame.thread.rp){delete this.objects[ref];delete this.owners[ref]}})}threadExit(thread){this.getThreadRefs(thread).forEach(ref=>{delete this.objects[ref];delete this.owners[ref]})}}exports.DefaultHeapLedger=DefaultHeapLedger;const isHeapAddress=ref=>{let kind=ref&frame_1.DATA_MASK_TYPE;return kind===frame_1.DATA_TYPE_HEAP_STRING||kind===frame_1.DATA_TYPE_HEAP_OBJECT};exports.isHeapAddress=isHeapAddress;const threadId=name=>Number(name.split("@")[1].split("#")[0])},{"../../script/info":107,"../stack/frame":105,"@quenk/noni/lib/data/maybe":77,"@quenk/noni/lib/data/record":78,"@quenk/noni/lib/data/type":81}],100:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MAX_INSTRUCTION=exports.OPERAND_RANGE_END=exports.OPERAND_RANGE_START=exports.OPCODE_RANGE_END=exports.OPCODE_RANGE_START=exports.OPERAND_MASK=exports.OPCODE_MASK=void 0;exports.OPCODE_MASK=4278190080;exports.OPERAND_MASK=16777215;exports.OPCODE_RANGE_START=16777216;exports.OPCODE_RANGE_END=4278190080;exports.OPERAND_RANGE_START=0;exports.OPERAND_RANGE_END=16777215;exports.MAX_INSTRUCTION=4294967295},{}],101:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.stop=exports.maildq=exports.mailcount=exports.recvcount=exports.recv=exports.send=exports.self=exports.alloc=void 0;const alloc=(r,f,_)=>{let eTemp=f.popObject();if(eTemp.isLeft())return r.raise(eTemp.takeLeft());let temp=eTemp.takeRight().promote();let eParent=f.popString();if(eParent.isLeft())return r.raise(eParent.takeLeft());let eresult=r.vm.allocate(eParent.takeRight(),temp);if(eresult.isLeft()){r.raise(eresult.takeLeft())}else{f.push(r.vm.heap.addString(f,eresult.takeRight()))}};exports.alloc=alloc;const self=(_,f,__)=>{f.pushSelf()};exports.self=self;const send=(r,f,_)=>{let eMsg=f.popValue();if(eMsg.isLeft())return r.raise(eMsg.takeLeft());let eAddr=f.popString();if(eAddr.isLeft())return r.raise(eAddr.takeLeft());if(r.vm.sendMessage(eAddr.takeRight(),r.context.address,eMsg.takeRight()))f.pushUInt8(1);else f.pushUInt8(0)};exports.send=send;const recv=(r,f,_)=>{let einfo=f.popFunction();if(einfo.isLeft())return r.raise(einfo.takeLeft());r.context.receivers.push(einfo.takeRight());if(r.context.mailbox.length>0)r.context.actor.notify()};exports.recv=recv;const recvcount=(r,f,_)=>{f.push(r.context.receivers.length)};exports.recvcount=recvcount;const mailcount=(r,f,_)=>{f.push(r.context.mailbox.length)};exports.mailcount=mailcount;const maildq=(_,f,__)=>{f.pushMessage()};exports.maildq=maildq;const stop=(r,f,_)=>{let eaddr=f.popString();if(eaddr.isLeft())return r.raise(eaddr.takeLeft());r.wait(r.vm.kill(r.context.actor,eaddr.takeRight()))};exports.stop=stop},{}],102:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ifneqjmp=exports.ifeqjmp=exports.ifnzjmp=exports.ifzjmp=exports.jmp=exports.raise=exports.call=exports.addui32=exports.ceq=exports.load=exports.store=exports.dup=exports.ldn=exports.lds=exports.pushui32=exports.pushui16=exports.pushui8=exports.nop=void 0;const error=require("../error");const array_1=require("@quenk/noni/lib/data/array");const frame_1=require("../stack/frame");const nop=(_,__,___)=>{};exports.nop=nop;const pushui8=(_,f,oper)=>{f.pushUInt8(oper)};exports.pushui8=pushui8;const pushui16=(_,f,oper)=>{f.pushUInt16(oper)};exports.pushui16=pushui16;const pushui32=(_,f,oper)=>{f.pushUInt32(oper)};exports.pushui32=pushui32;const lds=(_,f,idx)=>{f.pushString(idx)};exports.lds=lds;const ldn=(_,f,idx)=>{f.pushName(idx)};exports.ldn=ldn;const dup=(_,f,__)=>{f.duplicate()};exports.dup=dup;const store=(_,f,idx)=>{f.locals[idx]=f.pop()};exports.store=store;const load=(_,f,idx)=>{let d=f.locals[idx];f.push(d==null?0:d)};exports.load=load;const ceq=(r,f,__)=>{let eLhs=f.popValue();let eRhs=f.popValue();if(eLhs.isLeft())return r.raise(eLhs.takeLeft());if(eRhs.isLeft())return r.raise(eRhs.takeLeft());if(eLhs.takeRight()===eRhs.takeRight())f.push(1);else f.push(0)};exports.ceq=ceq;const addui32=(r,f,_)=>{let val=f.pop()+f.pop();if(val>frame_1.DATA_MAX_SAFE_UINT32)return r.raise(new error.IntegerOverflowErr);f.push(val)};exports.addui32=addui32;const call=(r,f,_)=>{let einfo=f.popFunction();if(einfo.isLeft())return r.raise(einfo.takeLeft());let fn=einfo.takeRight();if(fn.foreign===true){let args=(0,array_1.make)(fn.argc||0,()=>f.popValue().takeRight());r.invokeForeign(f,fn,args)}else{r.invokeVM(f,fn)}};exports.call=call;const raise=(r,f,_)=>{let emsg=f.popString();r.raise(new Error(emsg.takeRight()))};exports.raise=raise;const jmp=(_,f,oper)=>{f.seek(oper)};exports.jmp=jmp;const ifzjmp=(_,f,oper)=>{let eValue=f.popValue();if(eValue.isLeft()||eValue.takeRight()===0)f.seek(oper)};exports.ifzjmp=ifzjmp;const ifnzjmp=(_,f,oper)=>{let eValue=f.popValue();if(eValue.isRight()&&eValue.takeRight()!==0)f.seek(oper)};exports.ifnzjmp=ifnzjmp;const ifeqjmp=(r,f,oper)=>{let eLhs=f.popValue();let eRhs=f.popValue();if(eLhs.isLeft())r.raise(eLhs.takeLeft());else if(eRhs.isLeft())r.raise(eRhs.takeLeft());else if(eLhs.takeRight()===eRhs.takeRight())f.seek(oper)};exports.ifeqjmp=ifeqjmp;const ifneqjmp=(r,f,oper)=>{let eLhs=f.popValue();let eRhs=f.popValue();if(eLhs.isLeft())r.raise(eLhs.takeLeft());else if(eRhs.isLeft())r.raise(eRhs.takeLeft());else if(eLhs.takeRight()!==eRhs.takeRight())f.seek(oper)};exports.ifneqjmp=ifneqjmp},{"../error":98,"../stack/frame":105,"@quenk/noni/lib/data/array":73}],103:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.toLog=exports.toName=exports.handlers=exports.opcodes=exports.ARELM=exports.ARLENGTH=exports.GETPROP=exports.STOP=exports.SELF=exports.MAILDQ=exports.MAILCOUNT=exports.RECVCOUNT=exports.RECV=exports.SEND=exports.ALLOC=exports.IFNEQJMP=exports.IFEQJMP=exports.IFNZJMP=exports.IFZJMP=exports.JMP=exports.RAISE=exports.CALL=exports.ADDUI32=exports.CEQ=exports.LOAD=exports.STORE=exports.DUP=exports.LDN=exports.LDS=exports.PUSHUI32=exports.PUSHUI16=exports.PUSHUI8=exports.NOP=exports.OP_CODE_RANGE_STEP=exports.OP_CODE_RANGE_HIGH=exports.OP_CODE_RANGE_LOW=void 0;const base=require("./base");const actor=require("./actor");const obj=require("./object");const record_1=require("@quenk/noni/lib/data/record");const frame_1=require("../stack/frame");exports.OP_CODE_RANGE_LOW=16777216;exports.OP_CODE_RANGE_HIGH=4278190080;exports.OP_CODE_RANGE_STEP=16777216;exports.NOP=exports.OP_CODE_RANGE_STEP;exports.PUSHUI8=exports.OP_CODE_RANGE_STEP*2;exports.PUSHUI16=exports.OP_CODE_RANGE_STEP*3;exports.PUSHUI32=exports.OP_CODE_RANGE_STEP*4;exports.LDS=exports.OP_CODE_RANGE_STEP*5;exports.LDN=exports.OP_CODE_RANGE_STEP*6;exports.DUP=exports.OP_CODE_RANGE_STEP*15;exports.STORE=exports.OP_CODE_RANGE_STEP*16;exports.LOAD=exports.OP_CODE_RANGE_STEP*20;exports.CEQ=exports.OP_CODE_RANGE_STEP*42;exports.ADDUI32=exports.OP_CODE_RANGE_STEP*52;exports.CALL=exports.OP_CODE_RANGE_STEP*62;exports.RAISE=exports.OP_CODE_RANGE_STEP*63;exports.JMP=exports.OP_CODE_RANGE_STEP*72;exports.IFZJMP=exports.OP_CODE_RANGE_STEP*73;exports.IFNZJMP=exports.OP_CODE_RANGE_STEP*80;exports.IFEQJMP=exports.OP_CODE_RANGE_STEP*81;exports.IFNEQJMP=exports.OP_CODE_RANGE_STEP*82;exports.ALLOC=exports.OP_CODE_RANGE_STEP*92;exports.SEND=exports.OP_CODE_RANGE_STEP*94;exports.RECV=exports.OP_CODE_RANGE_STEP*95;exports.RECVCOUNT=exports.OP_CODE_RANGE_STEP*96;exports.MAILCOUNT=exports.OP_CODE_RANGE_STEP*97;exports.MAILDQ=exports.OP_CODE_RANGE_STEP*98;exports.SELF=exports.OP_CODE_RANGE_STEP*99;exports.STOP=exports.OP_CODE_RANGE_STEP*101;exports.GETPROP=exports.OP_CODE_RANGE_STEP*110;exports.ARLENGTH=exports.OP_CODE_RANGE_STEP*111;exports.ARELM=exports.OP_CODE_RANGE_STEP*112;exports.opcodes={[exports.NOP]:{name:"nop",handler:base.nop,log:()=>["nop"]},[exports.PUSHUI8]:{name:"pushui8",handler:base.pushui8,log:(_,__,oper)=>["pushui8",oper]},[exports.PUSHUI16]:{name:"pushui16",handler:base.pushui16,log:(_,__,oper)=>["pushui16",oper]},[exports.PUSHUI32]:{name:"pushui32",handler:base.pushui32,log:(_,__,oper)=>["pushui32",oper]},[exports.LDS]:{name:"lds",handler:base.lds,log:(_,f,oper)=>["lds",oper,eToLog(f.resolve(frame_1.DATA_TYPE_STRING|oper))]},[exports.LDN]:{name:"ldn",handler:base.ldn,log:(_,f,oper)=>["ldn",oper,eToLog(f.resolve(frame_1.DATA_TYPE_INFO|oper))]},[exports.DUP]:{name:"dup",handler:base.dup,log:(_,__,___)=>["dup"]},[exports.STORE]:{name:"store",handler:base.store,log:(_,__,oper)=>["store",oper]},[exports.LOAD]:{name:"load",handler:base.load,log:(_,f,oper)=>["load",oper,eToLog(f.resolve(frame_1.DATA_TYPE_LOCAL|oper))]},[exports.CEQ]:{name:"ceq",handler:base.ceq,log:(_,__,___)=>["ceq"]},[exports.ADDUI32]:{name:"addui32",handler:base.addui32,log:(_,__,___)=>["addui32"]},[exports.CALL]:{name:"call",handler:base.call,log:(_,__,___)=>["call"]},[exports.RAISE]:{name:"raise",handler:base.raise,log:(_,__,___)=>["raise"]},[exports.JMP]:{name:"jmp",handler:base.jmp,log:(_,__,oper)=>["jmp",oper]},[exports.IFZJMP]:{name:"ifzjmp",handler:base.ifzjmp,log:(_,__,oper)=>["ifzjmp",oper]},[exports.IFNZJMP]:{name:"ifnzjmp",handler:base.ifnzjmp,log:(_,__,oper)=>["ifnzjmp",oper]},[exports.IFEQJMP]:{name:"ifeqjmp",handler:base.ifeqjmp,log:(_,__,oper)=>["ifeqjmp",oper]},[exports.IFNEQJMP]:{name:"ifneqjmp",handler:base.ifneqjmp,log:(_,__,oper)=>["ifneqjmp",oper]},[exports.ALLOC]:{name:"alloc",handler:actor.alloc,log:(_,__,___)=>["alloc"]},[exports.SEND]:{name:"send",handler:actor.send,log:(_,__,___)=>["send"]},[exports.RECV]:{name:"recv",handler:actor.recv,log:(_,f,oper)=>["recv",oper,eToLog(f.resolve(frame_1.DATA_TYPE_INFO|oper))]},[exports.RECVCOUNT]:{name:"recvcount",handler:actor.recvcount,log:(_,__,___)=>["recvcount"]},[exports.MAILCOUNT]:{name:"mailcount",handler:actor.mailcount,log:(_,__,___)=>["mailcount"]},[exports.MAILDQ]:{name:"maildq",handler:actor.maildq,log:(_,__,___)=>["maildq"]},[exports.SELF]:{name:"self",handler:actor.self,log:(_,__,___)=>["self"]},[exports.STOP]:{name:"stop",handler:actor.stop,log:(_,__,___)=>["stop"]},[exports.GETPROP]:{name:"getprop",handler:obj.getprop,log:(_,__,oper)=>["getprop",oper]},[exports.ARELM]:{name:"arelm",handler:obj.arelm,log:(_,__,oper)=>["arelm",oper]},[exports.ARLENGTH]:{name:"arlength",handler:obj.arlength,log:(_,__,___)=>["arlength"]}};const eToLog=e=>e.isLeft()?e.takeLeft().message:e.takeRight();exports.handlers=(0,record_1.map)(exports.opcodes,i=>i.handler);const toName=op=>exports.opcodes.hasOwnProperty(op)?exports.opcodes[op].name:"<unknown>";exports.toName=toName;const toLog=(op,r,f,oper)=>exports.opcodes.hasOwnProperty(op)?exports.opcodes[op].log(r,f,oper):[];exports.toLog=toLog},{"../stack/frame":105,"./actor":101,"./base":102,"./object":104,"@quenk/noni/lib/data/record":78}],104:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.arelm=exports.arlength=exports.getprop=void 0;const getprop=(r,f,idx)=>{let eobj=f.popObject();if(eobj.isLeft())return r.raise(eobj.takeLeft());let obj=eobj.takeRight();let mval=obj.get(idx);if(mval.isJust()){f.push(r.vm.heap.intern(f,mval.get()))}else{f.push(0)}};exports.getprop=getprop;const arlength=(r,f,_)=>{let eobj=f.popObject();if(eobj.isLeft())return r.raise(eobj.takeLeft());let obj=eobj.takeRight();f.push(obj.getCount())};exports.arlength=arlength;const arelm=(r,f,_)=>{let earr=f.popObject();if(earr.isLeft())return r.raise(earr.takeLeft());let arr=earr.takeRight();let melm=arr.get(f.pop());if(melm.isJust()){f.push(r.vm.heap.intern(f,melm.get()))}else{f.push(0)}};exports.arelm=arelm},{}],105:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.StackFrame=exports.BYTE_CONSTANT_INFO=exports.BYTE_CONSTANT_STR=exports.BYTE_CONSTANT_NUM=exports.DATA_TYPE_SELF=exports.DATA_TYPE_MAILBOX=exports.DATA_TYPE_LOCAL=exports.DATA_TYPE_HEAP_FUN=exports.DATA_TYPE_HEAP_FOREIGN=exports.DATA_TYPE_HEAP_OBJECT=exports.DATA_TYPE_HEAP_STRING=exports.DATA_TYPE_INFO=exports.DATA_TYPE_STRING=exports.DATA_MAX_SAFE_UINT32=exports.DATA_MAX_SIZE=exports.DATA_MASK_VALUE32=exports.DATA_MASK_VALUE24=exports.DATA_MASK_VALUE16=exports.DATA_MASK_VALUE8=exports.DATA_MASK_TYPE=exports.DATA_RANGE_TYPE_STEP=exports.DATA_RANGE_TYPE_LOW=exports.DATA_RANGE_TYPE_HIGH=void 0;const indexes=require("../../script");const error=require("../error");const either_1=require("@quenk/noni/lib/data/either");const maybe_1=require("@quenk/noni/lib/data/maybe");const type_1=require("../../type");exports.DATA_RANGE_TYPE_HIGH=4026531840;exports.DATA_RANGE_TYPE_LOW=16777216;exports.DATA_RANGE_TYPE_STEP=16777216;exports.DATA_MASK_TYPE=4278190080;exports.DATA_MASK_VALUE8=255;exports.DATA_MASK_VALUE16=65535;exports.DATA_MASK_VALUE24=16777215;exports.DATA_MASK_VALUE32=4294967295;exports.DATA_MAX_SIZE=4294967295;exports.DATA_MAX_SAFE_UINT32=2147483647;exports.DATA_TYPE_STRING=exports.DATA_RANGE_TYPE_STEP*3;exports.DATA_TYPE_INFO=exports.DATA_RANGE_TYPE_STEP*4;exports.DATA_TYPE_HEAP_STRING=exports.DATA_RANGE_TYPE_STEP*6;exports.DATA_TYPE_HEAP_OBJECT=exports.DATA_RANGE_TYPE_STEP*7;exports.DATA_TYPE_HEAP_FOREIGN=exports.DATA_RANGE_TYPE_STEP*8;exports.DATA_TYPE_HEAP_FUN=exports.DATA_RANGE_TYPE_STEP*9;exports.DATA_TYPE_LOCAL=exports.DATA_RANGE_TYPE_STEP*10;exports.DATA_TYPE_MAILBOX=exports.DATA_RANGE_TYPE_STEP*11;exports.DATA_TYPE_SELF=exports.DATA_RANGE_TYPE_STEP*12;exports.BYTE_CONSTANT_NUM=65536;exports.BYTE_CONSTANT_STR=131072;exports.BYTE_CONSTANT_INFO=196608;class StackFrame{constructor(name,script,thread,parent=(0,maybe_1.nothing)(),code=[],data=[],locals=[],ip=0){this.name=name;this.script=script;this.thread=thread;this.parent=parent;this.code=code;this.data=data;this.locals=locals;this.ip=ip}getPosition(){return this.ip}push(d){this.data.push(d);return this}pushUInt8(value){return this.push(value>>>0&exports.DATA_MASK_VALUE8)}pushUInt16(value){return this.push(value>>>0&exports.DATA_MASK_VALUE16)}pushUInt32(value){return this.push(value>>>0)}pushString(idx){return this.push(idx|exports.DATA_TYPE_STRING)}pushName(idx){return this.push(idx|exports.DATA_TYPE_INFO)}pushMessage(){return this.push(0|exports.DATA_TYPE_MAILBOX)}pushSelf(){return this.push(exports.DATA_TYPE_SELF)}peek(n=0){return(0,maybe_1.fromNullable)(this.data.length-(n+1))}resolve(data){let{context:context}=this.thread;let typ=data&exports.DATA_MASK_TYPE;let value=data&exports.DATA_MASK_VALUE24;switch(typ){case exports.DATA_TYPE_STRING:case exports.DATA_TYPE_HEAP_STRING:this.push(data);return this.popString();case exports.DATA_TYPE_HEAP_FUN:this.push(data);return this.popFunction();case exports.DATA_TYPE_HEAP_OBJECT:this.push(data);return this.popObject();case exports.DATA_TYPE_HEAP_FOREIGN:this.push(data);return this.popForeign();case exports.DATA_TYPE_INFO:this.push(data);return this.popName();case exports.DATA_TYPE_LOCAL:let mRef=(0,maybe_1.fromNullable)(this.locals[value]);if(mRef.isNothing())return nullErr(data);return this.resolve(mRef.get());case exports.DATA_TYPE_MAILBOX:if(context.mailbox.length===0)return nullErr(data);return(0,either_1.right)(context.mailbox.shift());case exports.DATA_TYPE_SELF:return(0,either_1.right)(context.address);default:return(0,either_1.right)(value)}}pop(){return this.data.pop()|0}popValue(){return this.data.length===0?(0,either_1.left)(new error.StackEmptyErr):this.resolve(this.pop())}popString(){let data=this.pop();let typ=data&exports.DATA_MASK_TYPE;let idx=data&exports.DATA_MASK_VALUE24;if(typ===exports.DATA_TYPE_STRING){let s=this.script.constants[indexes.CONSTANTS_INDEX_STRING][idx];if(s==null)return missingSymbol(data);return(0,either_1.right)(s)}else if(typ===exports.DATA_TYPE_HEAP_STRING){return(0,either_1.right)(this.thread.vm.heap.getString(data))}else if(typ===exports.DATA_TYPE_SELF){return(0,either_1.right)(this.thread.context.address)}else{return wrongType(exports.DATA_TYPE_STRING,typ)}}popName(){let data=this.pop();let typ=data&exports.DATA_MASK_TYPE;let idx=data&exports.DATA_MASK_VALUE24;if(typ===exports.DATA_TYPE_INFO){let info=this.script.info[idx];if(info==null)return nullErr(data);return(0,either_1.right)(info)}else{return wrongType(exports.DATA_TYPE_INFO,data)}}popFunction(){let data=this.pop();let typ=data&exports.DATA_MASK_TYPE;if(typ===exports.DATA_TYPE_HEAP_FUN){let mFun=this.thread.vm.heap.getObject(data);return mFun.isJust()?(0,either_1.right)(mFun.get()):nullFunPtr(data)}else{this.push(data);return this.popName().chain(nfo=>{if((nfo.descriptor&type_1.BYTE_TYPE)!==type_1.TYPE_FUN)return notAFunction(nfo.name);return(0,either_1.right)(nfo)})}}popObject(){let data=this.pop();let typ=data&exports.DATA_MASK_TYPE;if(typ===exports.DATA_TYPE_HEAP_OBJECT){let mho=this.thread.vm.heap.getObject(data);if(mho.isNothing())return nullErr(data);return(0,either_1.right)(mho.get())}else{return wrongType(exports.DATA_TYPE_HEAP_OBJECT,typ)}}popForeign(){let data=this.pop();let typ=data&exports.DATA_MASK_TYPE;if(typ===exports.DATA_TYPE_HEAP_FOREIGN){let mho=this.thread.vm.heap.getObject(data);if(mho.isNothing())return nullErr(data);return(0,either_1.right)(mho.get())}else{return wrongType(exports.DATA_TYPE_HEAP_FOREIGN,typ)}}duplicate(){let top=this.data.pop();this.data.push(top);this.data.push(top);return this}advance(){this.ip=this.ip+1;return this}seek(loc){this.ip=loc;return this}isFinished(){return this.ip>=this.code.length}}exports.StackFrame=StackFrame;const nullErr=data=>(0,either_1.left)(new error.NullPointerErr(data));const wrongType=(expect,got)=>(0,either_1.left)(new error.UnexpectedDataType(expect,got));const notAFunction=name=>(0,either_1.left)(new error.InvalidFunctionErr(name));const nullFunPtr=addr=>(0,either_1.left)(new error.NullFunctionPointerErr(addr));const missingSymbol=data=>(0,either_1.left)(new error.MissingSymbolErr(data))},{"../../script":106,"../../type":114,"../error":98,"@quenk/noni/lib/data/either":75,"@quenk/noni/lib/data/maybe":77}],106:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getInfo=exports.PScript=exports.CONSTANTS_INDEX_STRING=exports.CONSTANTS_INDEX_NUMBER=void 0;const either_1=require("@quenk/noni/lib/data/either");const error_1=require("../runtime/error");exports.CONSTANTS_INDEX_NUMBER=0;exports.CONSTANTS_INDEX_STRING=1;class PScript{constructor(name,constants=[[],[]],info=[],code=[]){this.name=name;this.constants=constants;this.info=info;this.code=code}}exports.PScript=PScript;const getInfo=(s,idx)=>{if(s.info[idx]==null)return(0,either_1.left)(new error_1.MissingInfoErr(idx));return(0,either_1.right)(s.info[idx])};exports.getInfo=getInfo},{"../runtime/error":98,"@quenk/noni/lib/data/either":75}],107:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.funType=exports.objectType=exports.arrayType=exports.stringType=exports.booleanType=exports.uint32Type=exports.uint16Type=exports.uint8Type=exports.int32Type=exports.int16Type=exports.int8Type=exports.voidType=exports.NewPropInfo=exports.NewArrayTypeInfo=exports.NewTypeInfo=exports.NewForeignFunInfo=exports.NewFunInfo=exports.NewArrayInfo=exports.NewObjectInfo=exports.NewStringInfo=exports.NewBooleanInfo=exports.NewInt32Info=exports.NewInt16Info=exports.NewInt8Info=exports.NewUInt32Info=exports.NewUInt16Info=exports.NewUInt8Info=exports.VoidInfo=exports.NewInfo=void 0;const types=require("../type");class NewInfo{constructor(name){this.name=name}}exports.NewInfo=NewInfo;class VoidInfo extends NewInfo{constructor(){super(...arguments);this.type=exports.voidType;this.descriptor=types.TYPE_VOID}}exports.VoidInfo=VoidInfo;class NewUInt8Info extends NewInfo{constructor(){super(...arguments);this.type=exports.uint8Type;this.descriptor=types.TYPE_UINT8}}exports.NewUInt8Info=NewUInt8Info;class NewUInt16Info extends NewInfo{constructor(){super(...arguments);this.type=exports.uint16Type;this.descriptor=types.TYPE_UINT16}}exports.NewUInt16Info=NewUInt16Info;class NewUInt32Info extends NewInfo{constructor(){super(...arguments);this.type=exports.uint32Type;this.descriptor=types.TYPE_UINT32}}exports.NewUInt32Info=NewUInt32Info;class NewInt8Info extends NewInfo{constructor(){super(...arguments);this.type=exports.int8Type;this.descriptor=types.TYPE_INT8}}exports.NewInt8Info=NewInt8Info;class NewInt16Info extends NewInfo{constructor(){super(...arguments);this.type=exports.int16Type;this.descriptor=types.TYPE_INT16}}exports.NewInt16Info=NewInt16Info;class NewInt32Info extends NewInfo{constructor(){super(...arguments);this.type=exports.int32Type;this.descriptor=types.TYPE_INT32}}exports.NewInt32Info=NewInt32Info;class NewBooleanInfo extends NewInfo{constructor(){super(...arguments);this.type=exports.booleanType;this.descriptor=types.TYPE_BOOLEAN}}exports.NewBooleanInfo=NewBooleanInfo;class NewStringInfo extends NewInfo{constructor(){super(...arguments);this.type=exports.stringType;this.descriptor=types.TYPE_STRING}}exports.NewStringInfo=NewStringInfo;class NewObjectInfo extends NewInfo{constructor(){super(...arguments);this.type=exports.objectType;this.descriptor=types.TYPE_OBJECT}}exports.NewObjectInfo=NewObjectInfo;class NewArrayInfo extends NewInfo{constructor(name,type){super(name);this.name=name;this.type=type;this.descriptor=types.TYPE_ARRAY}}exports.NewArrayInfo=NewArrayInfo;class NewFunInfo extends NewInfo{constructor(name,argc,code){super(name);this.name=name;this.argc=argc;this.code=code;this.type=exports.funType;this.descriptor=types.TYPE_FUN;this.foreign=false}}exports.NewFunInfo=NewFunInfo;class NewForeignFunInfo extends NewInfo{constructor(name,argc,exec){super(name);this.name=name;this.argc=argc;this.exec=exec;this.type=exports.funType;this.descriptor=types.TYPE_FUN;this.foreign=true;this.code=[]}}exports.NewForeignFunInfo=NewForeignFunInfo;class NewTypeInfo extends NewInfo{constructor(name,argc,properties,descriptor=types.TYPE_OBJECT){super(name);this.name=name;this.argc=argc;this.properties=properties;this.descriptor=descriptor;this.type=exports.funType;this.code=[]}}exports.NewTypeInfo=NewTypeInfo;class NewArrayTypeInfo extends NewInfo{constructor(name,elements){super(name);this.name=name;this.elements=elements;this.type=exports.funType;this.argc=0;this.properties=[];this.code=[];this.descriptor=types.TYPE_ARRAY}}exports.NewArrayTypeInfo=NewArrayTypeInfo;class NewPropInfo{constructor(name,type){this.name=name;this.type=type}}exports.NewPropInfo=NewPropInfo;exports.voidType=new NewTypeInfo("void",0,[],types.TYPE_VOID);exports.int8Type=new NewTypeInfo("int8",1,[],types.TYPE_INT8);exports.int16Type=new NewTypeInfo("int16",1,[],types.TYPE_INT16);exports.int32Type=new NewTypeInfo("int32",1,[],types.TYPE_INT32);exports.uint8Type=new NewTypeInfo("uint8",1,[],types.TYPE_UINT8);exports.uint16Type=new NewTypeInfo("uint16",1,[],types.TYPE_UINT16);exports.uint32Type=new NewTypeInfo("uint32",1,[],types.TYPE_UINT32);exports.booleanType=new NewTypeInfo("boolean",1,[],types.TYPE_BOOLEAN);exports.stringType=new NewTypeInfo("string",1,[],types.TYPE_STRING);exports.arrayType=new NewTypeInfo("array",0,[],types.TYPE_ARRAY);exports.objectType=new NewTypeInfo("object",0,[],types.TYPE_OBJECT);exports.funType=new NewTypeInfo("function",0,[],types.TYPE_FUN)},{"../type":114}],108:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ScriptFactory=void 0;const scripts_1=require("../../../resident/scripts");const resident_1=require("../../../resident");const callback_1=require("../../../resident/immutable/callback");const immutable_1=require("../../../resident/immutable");const mutable_1=require("../../../resident/mutable");const scripts_2=require("../scripts");const __1=require("..");class ScriptFactory{static getScript(actor){let script=new scripts_2.NoScript;if(actor instanceof callback_1.Callback){script=new scripts_1.CallbackActorScript(actor)}else if(actor instanceof immutable_1.Immutable){script=new scripts_1.ImmutableActorScript(actor)}else if(actor instanceof mutable_1.Mutable){script=new scripts_1.MutableActorScript(actor)}else if(actor instanceof resident_1.AbstractResident){script=new scripts_1.GenericResidentScript}else if(actor instanceof __1.PVM){script=new scripts_2.VMActorScript}return script}}exports.ScriptFactory=ScriptFactory},{"..":95,"../../../resident":90,"../../../resident/immutable":89,"../../../resident/immutable/callback":88,"../../../resident/mutable":91,"../../../resident/scripts":92,"../scripts":109}],109:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.VMActorScript=exports.NoScript=exports.BaseScript=exports.commonFunctions=void 0;const op=require("../runtime/op");const info_1=require("../script/info");exports.commonFunctions=[new info_1.NewFunInfo("tell",2,[op.SEND])];class BaseScript{constructor(){this.constants=[[],[]];this.name="<main>";this.info=[];this.code=[]}}exports.BaseScript=BaseScript;class NoScript extends BaseScript{}exports.NoScript=NoScript;class VMActorScript extends BaseScript{constructor(){super(...arguments);this.info=exports.commonFunctions}}exports.VMActorScript=VMActorScript},{"../runtime/op":103,"../script/info":107}],110:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.destroyMessageBuffer=exports.createMessageBuffer=exports.removeMember=exports.putMember=exports.getGroup=exports.removeGroup=exports.removeRoute=exports.putRoute=exports.getRouter=exports.getParent=exports.getChildren=exports.getAddress=exports.remove=exports.put=exports.get=exports.exists=void 0;const maybe_1=require("@quenk/noni/lib/data/maybe");const record_1=require("@quenk/noni/lib/data/record");const string_1=require("@quenk/noni/lib/data/string");const address_1=require("../../address");const exists=(s,addr)=>(0,record_1.hasKey)(s.threads,addr);exports.exists=exists;const get=(s,addr)=>(0,maybe_1.fromNullable)(s.threads[addr]);exports.get=get;const put=(s,addr,r)=>{s.threads[addr]=r;return s};exports.put=put;const remove=(s,addr)=>{delete s.threads[addr];return s};exports.remove=remove;const getAddress=(s,actor)=>(0,record_1.reduce)(s.threads,(0,maybe_1.nothing)(),(p,c,k)=>c.context.actor===actor?(0,maybe_1.fromString)(k):p);exports.getAddress=getAddress;const getChildren=(s,addr)=>addr===address_1.ADDRESS_SYSTEM?(0,record_1.exclude)(s.threads,address_1.ADDRESS_SYSTEM):(0,record_1.partition)(s.threads,(_,key)=>(0,string_1.startsWith)(key,addr)&&key!==addr)[0];exports.getChildren=getChildren;const getParent=(s,addr)=>(0,maybe_1.fromNullable)(s.threads[(0,address_1.getParent)(addr)]);exports.getParent=getParent;const getRouter=(s,addr)=>(0,record_1.reduce)(s.routers,(0,maybe_1.nothing)(),(p,k)=>(0,string_1.startsWith)(addr,k)?(0,maybe_1.fromNullable)(s.threads[k]):p);exports.getRouter=getRouter;const putRoute=(s,target,router)=>{s.routers[target]=router;return s};exports.putRoute=putRoute;const removeRoute=(s,target)=>{delete s.routers[target];return s};exports.removeRoute=removeRoute;const removeGroup=(s,target)=>{delete s.groups[target];return s};exports.removeGroup=removeGroup;const getGroup=(s,name)=>s.groups.hasOwnProperty(name)?(0,maybe_1.fromArray)(s.groups[name]):(0,maybe_1.nothing)();exports.getGroup=getGroup;const putMember=(s,group,member)=>{if(s.groups[group]==null)s.groups[group]=[];s.groups[group].push(member);return s};exports.putMember=putMember;const removeMember=(s,group,member)=>{if(s.groups[group]!=null)s.groups[group]=s.groups[group].filter(m=>m!=member);return s};exports.removeMember=removeMember;const createMessageBuffer=(s,addr)=>{s.pendingMessages[addr]=[];return s};exports.createMessageBuffer=createMessageBuffer;const destroyMessageBuffer=(s,addr)=>{delete s.pendingMessages[addr];return s};exports.destroyMessageBuffer=destroyMessageBuffer},{"../../address":83,"@quenk/noni/lib/data/maybe":77,"@quenk/noni/lib/data/record":78,"@quenk/noni/lib/data/string":80}],111:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.THREAD_STATE_INVALID=exports.THREAD_STATE_ERROR=exports.THREAD_STATE_WAIT=exports.THREAD_STATE_RUN=exports.THREAD_STATE_IDLE=void 0;exports.THREAD_STATE_IDLE=0;exports.THREAD_STATE_RUN=1;exports.THREAD_STATE_WAIT=2;exports.THREAD_STATE_ERROR=3;exports.THREAD_STATE_INVALID=4},{}],112:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.makeFrameName=exports.SharedThread=exports.Job=void 0;const errors=require("../../runtime/error");const op=require("../../runtime/op");const future_1=require("@quenk/noni/lib/control/monad/future");const array_1=require("@quenk/noni/lib/data/array");const maybe_1=require("@quenk/noni/lib/data/maybe");const frame_1=require("../../runtime/stack/frame");const ledger_1=require("../../runtime/heap/ledger");const op_1=require("../../runtime/op");const type_1=require("../../type");const __1=require("../");const runtime_1=require("../../runtime");class Job{constructor(thread,fun,args=[]){this.thread=thread;this.fun=fun;this.args=args;this.active=false}}exports.Job=Job;class SharedThread{constructor(vm,script,scheduler,context){this.vm=vm;this.script=script;this.scheduler=scheduler;this.context=context;this.fstack=[];this.fsp=0;this.rp=0;this.state=__1.THREAD_STATE_IDLE}invokeVM(p,f){let frm=new frame_1.StackFrame((0,exports.makeFrameName)(this,f.name),p.script,this,(0,maybe_1.just)(p),f.code.slice());for(let i=0;i<f.argc;i++)frm.push(p.pop());this.fstack.push(frm);this.fsp=this.fstack.length-1;this.scheduler.run()}invokeForeign(frame,fun,args){let val=fun.exec.apply(null,[this,...args]);frame.push(this.vm.heap.intern(frame,val));this.scheduler.run()}wait(task){this.state=__1.THREAD_STATE_WAIT;let onError=e=>{this.state=__1.THREAD_STATE_ERROR;this.raise(e)};let onSuccess=()=>{this.state=__1.THREAD_STATE_IDLE;this.scheduler.run()};task.fork(onError,onSuccess)}raise(e){this.state=__1.THREAD_STATE_ERROR;this.vm.raise(this.context.actor,e)}die(){let that=this;this.state=__1.THREAD_STATE_INVALID;this.scheduler.dequeue(this);return(0,future_1.doFuture)(function*(){let ret=that.context.actor.stop();if(ret)yield ret;that.vm.heap.threadExit(that);return(0,future_1.pure)(undefined)})}resume(job){this.state=__1.THREAD_STATE_RUN;if(!job.active){job.active=true;let{fun:fun,args:args}=job;let frame=new frame_1.StackFrame((0,exports.makeFrameName)(this,fun.name),this.script,this,(0,maybe_1.nothing)(),fun.foreign?[op.LDN|this.script.info.indexOf(fun),op.CALL]:fun.code.slice());frame.data=args.map(arg=>(0,ledger_1.isHeapAddress)(arg)?this.vm.heap.move(arg,frame.name):arg);this.fstack=[frame];this.fsp=0;this.rp=0}while(!(0,array_1.empty)(this.fstack)){let sp=this.fsp;let frame=this.fstack[sp];if(this.rp!=0)frame.data.push(this.rp);while(!frame.isFinished()&&this.state===__1.THREAD_STATE_RUN){let pos=frame.getPosition();let next=frame.code[pos]>>>0;let opcode=next&runtime_1.OPCODE_MASK;let operand=next&runtime_1.OPERAND_MASK;this.vm.logOp(this,frame,opcode,operand);op_1.handlers[opcode](this,frame,operand);if(pos===frame.getPosition())frame.advance();if(sp!==this.fsp)break}if(this.state===__1.THREAD_STATE_WAIT)return;if(sp===this.fsp){this.vm.heap.frameExit(this.fstack.pop());this.fsp--;this.rp=frame.data.pop()}}this.state=__1.THREAD_STATE_IDLE}exec(name,args=[]){let{script:script}=this;let fun=script.info.find(info=>info.name===name&&info.descriptor===type_1.TYPE_FUN);if(!fun)return this.raise(new errors.UnknownFunErr(name));this.scheduler.postJob(new Job(this,fun,args))}}exports.SharedThread=SharedThread;const makeFrameName=(thread,funName)=>(0,array_1.empty)(thread.fstack)?`${thread.context.template.id}@${thread.context.aid}#${funName}`:`${(0,array_1.tail)(thread.fstack).name}/${funName}`;exports.makeFrameName=makeFrameName},{"../":111,"../../runtime":100,"../../runtime/error":98,"../../runtime/heap/ledger":99,"../../runtime/op":103,"../../runtime/stack/frame":105,"../../type":114,"@quenk/noni/lib/control/monad/future":70,"@quenk/noni/lib/data/array":73,"@quenk/noni/lib/data/maybe":77}],113:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.SharedScheduler=void 0;const array_1=require("@quenk/noni/lib/data/array");const __1=require("../");class SharedScheduler{constructor(vm,queue=[]){this.vm=vm;this.queue=queue;this._running=false}postJob(job){this.queue.push(job);this.run()}dequeue(thread){this.queue=this.queue.filter(job=>job.thread!==thread)}run(){if(this._running)return;this._running=true;let job;while(job=this.queue.find(({thread:thread})=>thread.state===__1.THREAD_STATE_IDLE)){let{thread:thread}=job;thread.resume(job);if(thread.state!==__1.THREAD_STATE_WAIT)this.queue=(0,array_1.remove)(this.queue,job)}this._running=false}}exports.SharedScheduler=SharedScheduler},{"../":111,"@quenk/noni/lib/data/array":73}],114:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getType=exports.TYPE_CONS=exports.TYPE_FUN=exports.TYPE_ARRAY=exports.TYPE_OBJECT=exports.TYPE_STRING=exports.TYPE_BOOLEAN=exports.TYPE_INT32=exports.TYPE_INT16=exports.TYPE_INT8=exports.TYPE_UINT32=exports.TYPE_UINT16=exports.TYPE_UINT8=exports.TYPE_VOID=exports.BYTE_INDEX=exports.BYTE_TYPE=exports.TYPE_STEP=void 0;exports.TYPE_STEP=16777216;exports.BYTE_TYPE=4278190080;exports.BYTE_INDEX=16777215;exports.TYPE_VOID=0;exports.TYPE_UINT8=exports.TYPE_STEP;exports.TYPE_UINT16=exports.TYPE_STEP*2;exports.TYPE_UINT32=exports.TYPE_STEP*3;exports.TYPE_INT8=exports.TYPE_STEP*4;exports.TYPE_INT16=exports.TYPE_STEP*5;exports.TYPE_INT32=exports.TYPE_STEP*6;exports.TYPE_BOOLEAN=exports.TYPE_STEP*7;exports.TYPE_STRING=exports.TYPE_STEP*8;exports.TYPE_OBJECT=exports.TYPE_STEP*9;exports.TYPE_ARRAY=exports.TYPE_STEP*10;exports.TYPE_FUN=exports.TYPE_STEP*11;exports.TYPE_CONS=exports.TYPE_STEP*12;const getType=d=>d&exports.BYTE_TYPE;exports.getType=getType},{}],115:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ACTION_STOP=exports.ACTION_RESTART=exports.ACTION_IGNORE=exports.ACTION_RAISE=void 0;exports.ACTION_RAISE=-1;exports.ACTION_IGNORE=0;exports.ACTION_RESTART=1;exports.ACTION_STOP=2},{}],116:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Caret=exports.CARET=void 0;const views=require("./wml/caret");const wml_1=require("@quenk/wml");const util_1=require("../../util");exports.CARET="ww-caret";class Caret extends wml_1.Component{constructor(){super(...arguments);this.view=new views.Main(this);this.values={root:{id:this.attrs&&this.attrs.id?this.attrs.id:"",className:(0,util_1.concat)(exports.CARET,this.attrs&&this.attrs.className?this.attrs.className:"")}}}}exports.Caret=Caret},{"../../util":188,"./wml/caret":117,"@quenk/wml":190}],117:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class Main{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("span",{id:__context.values.root.id,class:__context.values.root.className},[])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.Main=Main},{"@quenk/noni/lib/data/maybe":77,"@quenk/wml/lib/dom":189}],118:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Link=exports.LinkClickedEvent=exports.LINK=void 0;const wml=require("@quenk/wml");const document=require("@quenk/wml/lib/dom");const views=require("./views");const util_1=require("../../util");const active_1=require("../state/active");const disabled_1=require("../state/disabled");exports.LINK="ww-link";class LinkClickedEvent{constructor(name,href){this.name=name;this.href=href}}exports.LinkClickedEvent=LinkClickedEvent;class Link extends wml.Component{constructor(){super(...arguments);this.view=this.attrs&&this.attrs.disabled?new views.DisabledLinkView(this):new views.LinkView(this);this.name=this.attrs&&this.attrs.name?this.attrs.name:"";this.title=this.attrs&&this.attrs.title?this.attrs.title:"";this.href=this.attrs&&this.attrs.href?this.attrs.href:"";this.values={id:this.attrs&&this.attrs.id?this.attrs.id:"",disabled:this.attrs&&this.attrs.disabled?this.attrs.disabled:null,className:(0,util_1.concat)(exports.LINK,this.attrs&&this.attrs.className?this.attrs.className:"",this.attrs&&this.attrs.active?active_1.ACTIVE:"",this.attrs&&this.attrs.disabled?disabled_1.DISABLED:"",this.attrs&&this.attrs.disabled?`-ww-disabled`:""),title:this.attrs&&this.attrs.title?this.attrs.title:null,name:this.attrs&&this.attrs.name?this.attrs.name:null,href:this.attrs&&this.attrs.href?this.attrs.href:"#",active:this.attrs&&this.attrs.active?this.attrs.active:false,content:this.attrs&&this.attrs.text?[document.createTextNode(this.attrs.text)]:this.children,clicked:e=>{if(this.attrs&&!this.attrs.disabled){let{name:name,href:href,onClick:onClick}=this.attrs;if(!href)e.preventDefault();if(onClick)onClick(new LinkClickedEvent(name,href))}}}}activate(){let m=(0,util_1.getById)(this.view,this.values.id);if(m.isJust()){let e=m.get();e.classList.remove(active_1.ACTIVE);e.classList.add(active_1.ACTIVE)}return this}deactivate(){let m=(0,util_1.getById)(this.view,this.values.id);if(m.isJust())m.get().classList.remove(active_1.ACTIVE);return this}}exports.Link=Link},{"../../util":188,"../state/active":122,"../state/disabled":123,"./views":119,"@quenk/wml":190,"@quenk/wml/lib/dom":189}],119:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.LinkView=exports.DisabledLinkView=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class DisabledLinkView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("span",{id:__context.values.id,class:__context.values.className,href:__context.values.href,title:__context.values.title,onclick:__context.values.clicked},[...__context.values.content])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.DisabledLinkView=DisabledLinkView;class LinkView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("a",{id:__context.values.id,class:__context.values.className,href:__context.values.href,title:__context.values.title,onclick:__context.values.clicked},[...__context.values.content])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.LinkView=LinkView},{"@quenk/noni/lib/data/maybe":77,"@quenk/wml/lib/dom":189}],120:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getBlockClassName=exports.BOTTOM=exports.MIDDLE=exports.HORIZONTAL=exports.RIGHT=exports.LEFT=exports.JUSTIFIED=exports.CLEARFIX=exports.BLOCK=exports.POSITIONED=exports.PUSHABLE=exports.VERTICAL=void 0;exports.VERTICAL="-vertical";exports.PUSHABLE="-pushable";exports.POSITIONED="-positioned";exports.BLOCK="-block";exports.CLEARFIX="-clearfix";exports.JUSTIFIED="-justified";exports.LEFT="-left";exports.RIGHT="-right";exports.HORIZONTAL="-horizontal";exports.MIDDLE="-middle";exports.BOTTOM="-bottom";const getBlockClassName=attrs=>attrs.block===true?exports.BLOCK:"";exports.getBlockClassName=getBlockClassName},{}],121:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getSizeClassName=exports.Size=exports.EXTRA_LARGE=exports.LARGE=exports.MEDIUM=exports.SMALL=exports.EXTRA_SMALL=void 0;exports.EXTRA_SMALL="-extra-small";exports.SMALL="-small";exports.MEDIUM="-medium";exports.LARGE="-large";exports.EXTRA_LARGE="-extra-large";var Size;(function(Size){Size["ExtraSmall"]="extra-small";Size["Small"]="small";Size["Medium"]="medium";Size["Large"]="large";Size["ExtraLarge"]="extra-large"})(Size=exports.Size||(exports.Size={}));const getSizeClassName=s=>{if(s===Size.ExtraSmall)return exports.EXTRA_SMALL;else if(s===Size.Small)return exports.SMALL;else if(s===Size.Medium)return exports.MEDIUM;else if(s===Size.Large)return exports.LARGE;else if(s===Size.ExtraLarge)return exports.EXTRA_LARGE;return""};exports.getSizeClassName=getSizeClassName},{}],122:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.isActive=exports.deactivate=exports.activate=exports.ACTIVE=void 0;const util_1=require("../../util");exports.ACTIVE="-active";const activate=(view,id)=>(0,util_1.getById)(view,id).map(e=>{e.classList.remove(exports.ACTIVE);e.classList.add(exports.ACTIVE)});exports.activate=activate;const deactivate=(view,id)=>(0,util_1.getById)(view,id).map(e=>e.classList.remove(exports.ACTIVE));exports.deactivate=deactivate;const isActive=(view,id)=>(0,util_1.getById)(view,id).map(e=>e.classList.contains(exports.ACTIVE)).orJust(()=>false).get();exports.isActive=isActive},{"../../util":188}],123:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DISABLED=void 0;exports.DISABLED="-disabled"},{}],124:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.toggle=exports.show=exports.hide=exports.isHidden=exports.HIDDEN=void 0;const util_1=require("../../util");exports.HIDDEN="-ww-hidden";const isHidden=(view,id)=>{let m=view.findById(id);if(m.isNothing()){(0,util_1.warnMissing)(view,id);return true}else{return m.get().classList.contains(exports.HIDDEN)}};exports.isHidden=isHidden;const hide=(view,id)=>{let m=view.findById(id);if(m.isNothing()){return(0,util_1.warnMissing)(view,id)}else{let e=m.get();e.classList.remove(exports.HIDDEN);e.classList.add(exports.HIDDEN)}};exports.hide=hide;const show=(view,id)=>{let m=view.findById(id);if(m.isNothing()){return(0,util_1.warnMissing)(view,id)}else{m.get().classList.remove(exports.HIDDEN)}};exports.show=show;const toggle=(view,id)=>{let m=view.findById(id);if(m.isNothing()){return(0,util_1.warnMissing)(view,id)}else{m.get().classList.toggle(exports.HIDDEN)}};exports.toggle=toggle},{"../../util":188}],125:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getStyleClassName=exports.styles=exports.Style=exports.OUTLINE=exports.ERROR=exports.WARNING=exports.INFO=exports.SUCCESS=exports.PRIMARY=exports.DEFAULT=void 0;exports.DEFAULT="-default";exports.PRIMARY="-primary";exports.SUCCESS="-success";exports.INFO="-info";exports.WARNING="-warning";exports.ERROR="-error";exports.OUTLINE="-outline";var Style;(function(Style){Style["Default"]="default";Style["Primary"]="primary";Style["Success"]="success";Style["Info"]="info";Style["Warning"]="warning";Style["Error"]="error"})(Style=exports.Style||(exports.Style={}));exports.styles=[Style.Default,Style.Success,Style.Info,Style.Warning,Style.Error];const getStyleClassName=s=>{switch(s){case Style.Default:return exports.DEFAULT;case Style.Primary:return exports.PRIMARY;case Style.Success:return exports.SUCCESS;case Style.Info:return exports.INFO;case Style.Warning:return exports.WARNING;case Style.Error:return exports.ERROR}return exports.DEFAULT};exports.getStyleClassName=getStyleClassName},{}],126:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ButtonGroup=exports.BUTTON_GROUP_COMPAT=exports.BUTTON_GROUP_BUTTON=exports.BUTTON_GROUP=void 0;const views=require("./wml/button-group");const wml_1=require("@quenk/wml");const util_1=require("../../util");const toolbar_1=require("../toolbar");const __1=require("../../");exports.BUTTON_GROUP="ww-button-group";exports.BUTTON_GROUP_BUTTON="ww-button-group__button";exports.BUTTON_GROUP_COMPAT="ww-button-group-compat";class ButtonGroup extends wml_1.Component{constructor(){super(...arguments);this.view=new views.Main(this);this.values={root:{id:(0,__1.getId)(this.attrs),className:(0,util_1.concat)(exports.BUTTON_GROUP,toolbar_1.TOOLBAR_COMPAT,(0,__1.getClassName)(this.attrs))}}}}exports.ButtonGroup=ButtonGroup},{"../../":169,"../../util":188,"../toolbar":160,"./wml/button-group":127,"@quenk/wml":190}],127:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class Main{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("div",{id:__context.values.root.id,class:__context.values.root.className},[...__context.children])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.Main=Main},{"@quenk/noni/lib/data/maybe":77,"@quenk/wml/lib/dom":189}],128:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MultiButtonSelect=exports.ButtonSelect=exports.MultiButtonSection=exports.ButtonSection=exports.ButtonSelectValues=exports.ButtonChangedEvent=exports.BUTTON_SELECT_OPTION=exports.BUTTON_SELECT=void 0;const util_1=require("../../util");const __1=require("../../");const __2=require("../");const button_select_1=require("./wml/button-select");exports.BUTTON_SELECT="ww-button-select";exports.BUTTON_SELECT_OPTION="ww-button-select__option";class ButtonChangedEvent extends __2.Event{}exports.ButtonChangedEvent=ButtonChangedEvent;class ButtonSelectValues{constructor(ref,button){this.ref=ref;this.button=button;this.id=(0,__1.getId)(this.ref.attrs);this.className=(0,util_1.concat)(exports.BUTTON_SELECT,(0,__1.getClassName)(this.ref.attrs))}}exports.ButtonSelectValues=ButtonSelectValues;class ButtonSection{constructor(ref,onClick){this.ref=ref;this.onClick=onClick;this.current=getCurrent(this.ref.attrs);this.selected=[];this.options=this.ref.attrs&&this.ref.attrs.options?this.ref.attrs.options:[];this.isActive=(n=>this.ref.values.button.current===n);this.getClassNames=(n=>(0,util_1.concat)(exports.BUTTON_SELECT_OPTION,this.ref.values.button.options[n].className))}}exports.ButtonSection=ButtonSection;class MultiButtonSection extends ButtonSection{constructor(ref,onClick){super(ref,onClick);this.ref=ref;this.onClick=onClick;this.selected=getSelected(this.ref);this.isActive=(n=>this.ref.values.button.selected.indexOf(n)>-1)}}exports.MultiButtonSection=MultiButtonSection;class ButtonSelect extends __2.AbstractControl{constructor(){super(...arguments);this.view=new button_select_1.ButtonSelectView(this);this.values=new ButtonSelectValues(this,new ButtonSection(this,idx=>{this.values.button.current=idx;if(this.attrs&&this.attrs.onChange)this.attrs.onChange(new ButtonChangedEvent(this.attrs.name,this.values.button.options[idx].value));this.view.invalidate()}))}}exports.ButtonSelect=ButtonSelect;class MultiButtonSelect extends __2.AbstractControl{constructor(){super(...arguments);this.view=new button_select_1.ButtonSelectView(this);this.values=new ButtonSelectValues(this,new MultiButtonSection(this,n=>{let selected=this.values.button.selected;let pos=selected.indexOf(n);if(pos>-1)selected.splice(pos,1);else selected.push(n);if(this.attrs&&this.attrs.onChange)this.attrs.onChange(new ButtonChangedEvent(this.attrs.name,selected.map(n=>this.values.button.options[n].value)));this.view.invalidate()}))}}exports.MultiButtonSelect=MultiButtonSelect;const getCurrent=attrs=>{if(attrs!=null&&attrs.value!=null&&attrs.options!=null){return attrs.options.reduce((p,c,k)=>c.value===attrs.value?k:p,-1)}return-1};const getSelected=that=>{if(that.attrs&&that.attrs&&that.attrs.value&&that.attrs.options){let{value:value,options:options}=that.attrs;return value.map(v=>options.reduce((p,c,i)=>p>-1?p:c.value===v?i:p,-1))}else{return[]}}},{"../":147,"../../":169,"../../util":188,"./wml/button-select":129}],129:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ButtonSelectView=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const button_group_1=require("../../button-group");const button_1=require("../../button");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class ButtonSelectView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.widget(new button_group_1.ButtonGroup({id:__context.values.id,className:__context.values.className},[...__forIn(__context.values.button.options,(opt,idx,_$$all)=>[__this.widget(new button_1.Button({className:__context.values.button.getClassNames(idx),active:__context.values.button.isActive(idx),onClick:()=>__context.values.button.onClick(idx),text:opt.text},[]),{className:__context.values.button.getClassNames(idx),active:__context.values.button.isActive(idx),onClick:()=>__context.values.button.onClick(idx),text:opt.text})],()=>[])]),{id:__context.values.id,className:__context.values.className})})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.ButtonSelectView=ButtonSelectView},{"../../button":130,"../../button-group":126,"@quenk/noni/lib/data/maybe":77,"@quenk/wml/lib/dom":189}],130:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Button=exports.ButtonClickedEvent=exports.BUTTON=exports.Style=void 0;const views=require("./wml/button");const dom_1=require("@quenk/wml/lib/dom");const toolbar_1=require("../toolbar");const active_1=require("../../content/state/active");const orientation_1=require("../../content/orientation");const style_1=require("../../content/style");Object.defineProperty(exports,"Style",{enumerable:true,get:function(){return style_1.Style}});const size_1=require("../../content/size");const util_1=require("../../util");const __1=require("../../");const __2=require("../");exports.BUTTON="ww-button";class ButtonClickedEvent extends __2.Event{}exports.ButtonClickedEvent=ButtonClickedEvent;class Button extends __2.AbstractControl{constructor(){super(...arguments);this.view=this.attrs&&this.attrs.anchor?new views.AnchorView(this):new views.ButtonView(this);this.values={button:{wml:{id:"button"},id:(0,__1.getId)(this.attrs),className:(0,util_1.concat)(exports.BUTTON,(0,__1.getClassName)(this.attrs),toolbar_1.TOOLBAR_COMPAT,this.attrs&&this.attrs.style?(0,style_1.getStyleClassName)(this.attrs.style):style_1.DEFAULT,this.attrs&&this.attrs.size?(0,size_1.getSizeClassName)(this.attrs.size):"",this.attrs&&this.attrs.outline?style_1.OUTLINE:"",this.attrs&&this.attrs.block?orientation_1.BLOCK:"",this.attrs&&this.attrs.active?active_1.ACTIVE:""),type:this.attrs&&this.attrs.type?this.attrs.type:"button",name:this.attrs&&this.attrs.name?this.attrs.name:"",disabled:this.attrs&&this.attrs.disabled?true:null,anchor:this.attrs&&this.attrs.anchor?this.attrs.anchor:false,onclick:e=>{e.preventDefault();this.attrs&&this.attrs.onClick&&this.attrs.onClick(new ButtonClickedEvent(this.attrs&&this.attrs.name?this.attrs.name:"",this.attrs.value))},content:()=>this.attrs&&this.attrs.text?[(0,dom_1.text)(this.attrs.text)]:this.children}}}disable(){(0,util_1.getById)(this.view,this.values.button.wml.id).map(b=>b.setAttribute("disabled","disabled"))}enable(){(0,util_1.getById)(this.view,this.values.button.wml.id).map(b=>b.removeAttribute("disabled"))}toggle(){(0,util_1.getById)(this.view,this.values.button.wml.id).map(b=>b.hasAttribute("disabled")?this.enable():this.disable())}}exports.Button=Button},{"../":147,"../../":169,"../../content/orientation":120,"../../content/size":121,"../../content/state/active":122,"../../content/style":125,"../../util":188,"../toolbar":160,"./wml/button":131,"@quenk/wml/lib/dom":189}],131:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AnchorView=exports.ButtonView=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class ButtonView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("button",{wml:{id:__context.values.button.wml.id},id:__context.values.button.id,type:__context.values.button.type,name:__context.values.button.name,disabled:__context.values.button.disabled,class:__context.values.button.className,onclick:__context.values.button.onclick},[...__context.values.button.content()])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.ButtonView=ButtonView;class AnchorView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("a",{wml:{id:__context.values.button.wml.id},id:__context.values.button.id,type:__context.values.button.type,href:"#",name:__context.values.button.name,disabled:__context.values.button.disabled,class:__context.values.button.className,onclick:__context.values.button.onclick},[...__context.values.button.content()])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.AnchorView=AnchorView},{"@quenk/noni/lib/data/maybe":77,"@quenk/wml/lib/dom":189}],132:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Checkbox=exports.CheckChangedEvent=exports.CHECKBOX=void 0;const checkbox_1=require("./wml/checkbox");const util_1=require("../../util");const __1=require("../");const __2=require("../../");exports.CHECKBOX="ww-checkbox";class CheckChangedEvent extends __1.Event{}exports.CheckChangedEvent=CheckChangedEvent;class Checkbox extends __1.AbstractControl{constructor(){super(...arguments);this.view=new checkbox_1.Main(this);this.values={root:{id:(0,__2.getId)(this.attrs),className:(0,util_1.concat)(exports.CHECKBOX,(0,__2.getClassName)(this.attrs))},input:{name:(0,__1.getName)(this.attrs),value:this.attrs&&this.attrs.value?this.attrs.value:null,onChange:()=>{this.values.input.value=!this.values.input.value||null;if(this.attrs&&this.attrs.onChange)this.attrs.onChange(new CheckChangedEvent(this.values.input.name,this.values.input.value||false))}}}}}exports.Checkbox=Checkbox},{"../":147,"../../":169,"../../util":188,"./wml/checkbox":133}],133:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class Main{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("span",{id:__context.values.root.id,class:__context.values.root.className},[__this.node("label",{},[__this.node("input",{type:"checkbox",name:__context.values.input.name,checked:__context.values.input.value,onchange:__context.values.input.onChange},[]),...__context.children])])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.Main=Main},{"@quenk/noni/lib/data/maybe":77,"@quenk/wml/lib/dom":189}],134:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DateField=exports.DateChangedEvent=exports.Format=exports.usFormats=exports.commonFormats=exports.iso8601Formats=exports.YESTERDAY=exports.NOW=exports.TODAY=exports.DELAY=exports.VALUE_FORMAT=exports.DEFAULT_INPUT_DISPLAY=exports.DEFAULT_INPUT_PLACEHOLDER=exports.DEFAULT_INPUT_FORMAT=exports.DATE_FIELD_INPUT=exports.DATE_FIELD=void 0;const views=require("./wml/date-field");const moment=require("moment");const maybe_1=require("@quenk/noni/lib/data/maybe");const util_1=require("../../util");const feedback_1=require("../feedback");const form_1=require("../form");const __1=require("../../");const __2=require("../");const orientation_1=require("../../content/orientation");exports.DATE_FIELD="ww-date-field";exports.DATE_FIELD_INPUT="ww-date-field__input";exports.DEFAULT_INPUT_FORMAT=moment.ISO_8601;exports.DEFAULT_INPUT_PLACEHOLDER="YYYY-MM-DD";exports.DEFAULT_INPUT_DISPLAY="YYYY-MM-DD";exports.VALUE_FORMAT="YYYY-MM-DD";exports.DELAY=200;exports.TODAY="today";exports.NOW="now";exports.YESTERDAY="yesterday";exports.iso8601Formats=["YYYY-MM-DD","YYYY-MM-D","YYYY-M-DD","YYYY-M-D","YY-MM-DD","YY-MM-D","YY-M-DD","YY-M-D","YYYY/MM/DD","YYYY/MM/D","YYYY/M/DD","YYYY/M/D","YY/MM/DD","YY/MM/D","YY/M/DD","YY/M/D","YYYY MM DD","YYYY MM D","YYYY M DD","YYYY M D","YY MM DD","YY MM D","YY M DD","YY M D","YYYYMMDD","YYYYMMD","YYYYMDD","YYYYMD","YYMMDD","YYMMD","YYMDD","YYMD"];exports.commonFormats=["DD-MM-YYYY","D-MM-YYYY","DD-M-YYYY","D-M-YYYY","DD-MM-YY","D-MM-YY","DD-M-YY","D-M-YY","DD/MM/YYYY","D/MM/YYYY","DD/M/YYYY","D/M/YYYY","DD/MM/YY","D/MM/YY","DD/M/YY","D/M/YY","DD MM YYYY","D MM YYYY","DD M YYYY","D M YYYY","DD MM YY","D MM YY","DD M YY","D M YY","DDMMYYYY","DMMYYYY","DDMYYYY","DMYYYY","DDMMYY","DMMYY","DDMYY","DMYY"];exports.usFormats=["MM-DD-YYYY","MM-D-YYYY","M-DD-YYYY","M-D-YYYY","MM-DD-YY","MM-D-YY","M-DD-YY","M-D-YY","MM/DD/YYYY","MM/D/YYYY","M/DD/YYYY","M/D/YYYY","MM/DD/YY","MM/D/YY","M/DD/YY","M/D/YY","MM DD YYYY","MM D YYYY","M DD YYYY","M D YYYY","MM DD YY","MM D YY","M DD YY","M D YY","MMDDYYYY","MMDYYYY","MDDYYYY","MDYYYY","MMDDYY","MMDYY","MDDYY","MDYY"];var Format;(function(Format){Format[Format["ISO8601"]=1]="ISO8601";Format[Format["COMMON"]=2]="COMMON";Format[Format["USA"]=3]="USA"})(Format=exports.Format||(exports.Format={}));class DateChangedEvent extends __2.Event{}exports.DateChangedEvent=DateChangedEvent;class DateField extends form_1.AbstractFormControl{constructor(){super(...arguments);this.view=new views.Main(this);this.values={root:{wml:{id:"root"},id:(0,__1.getId)(this.attrs),className:(0,util_1.concat)(exports.DATE_FIELD,(0,__1.getClassName)(this.attrs),(0,orientation_1.getBlockClassName)(this.attrs),(0,feedback_1.getValidityClassName)(this.attrs))},control:{wml:{id:"input"},id:(0,__1.getId)(this.attrs)},label:{id:this.attrs&&this.attrs.name||"",text:this.attrs&&this.attrs.label||""},messages:{wml:{id:"messages"},text:(0,feedback_1.getMessage)(this.attrs)},input:{wml:{id:"input"},className:exports.DATE_FIELD_INPUT,name:(0,__2.getName)(this.attrs),format:getFormat(this.attrs),placeholder:getPlaceholder(this.attrs),display:getDisplay(this.attrs),moment:this.attrs&&this.attrs.value?(0,maybe_1.just)(parseDate(getValue(this.attrs),getFormat(this.attrs))):(0,maybe_1.nothing)(),value:()=>this.values.input.moment.isJust()&&this.values.input.moment.get().isValid()?this.values.input.moment.get().format(this.values.input.display):"",disabled:this.attrs&&this.attrs.disabled===true?true:null,onfocus:e=>{e.target.select()},oninput:e=>{e.target.oninput=null;this.values.input.onkeyup(e)},onkeyup:(0,util_1.debounce)(e=>{let value=e.target.value;if(value===""){this.values.input.moment=(0,maybe_1.nothing)();this.fireChange()}else{let m=parseDate(value,this.values.input.format);if(m.isValid()){this.values.input.moment=(0,maybe_1.just)(m);this.fireChange()}}},exports.DELAY),onblur:()=>{this.view.invalidate()}}}}fireChange(){if(this.attrs&&this.attrs.onChange){let name=this.attrs.name||"";if(this.values.input.moment.isJust()){let m=this.values.input.moment.get();if(m.isValid())this.attrs.onChange(new DateChangedEvent(name,m.format(exports.VALUE_FORMAT)))}else{this.attrs.onChange(new DateChangedEvent(name,undefined))}}}setMessage(msg){this.values.messages.text=msg;(0,form_1.setMessage)(this.view,this.values.messages.wml.id,msg);return this}removeMessage(){this.values.messages.text="";(0,form_1.removeMessage)(this.view,this.values.messages.wml.id);return this}}exports.DateField=DateField;const parseDate=(d,formats)=>{let str=d.toLowerCase();if(str===exports.TODAY||str===exports.NOW){return moment.utc()}else if(str===exports.YESTERDAY){return moment.utc().subtract(1,"d")}else{return moment.utc(d,[...formats,moment.ISO_8601],true)}};const getValue=attrs=>attrs&&attrs.value?attrs.value:"";const getFormat=attrs=>{if(attrs&&attrs.format){switch(attrs.format){case 2:return exports.commonFormats;case 3:return exports.usFormats;default:break}}return exports.iso8601Formats};const getPlaceholder=attrs=>{if(attrs&&attrs.placeholder)return attrs.placeholder;if(attrs&&attrs.format){switch(attrs.format){case 2:return"DD-MM-YYYY";case 3:return"MM-DD-YYYY";default:return"YYYY-MM-DD"}}return"YYYY-MM-DD"};const getDisplay=attrs=>attrs&&attrs.display?attrs.display:exports.DEFAULT_INPUT_DISPLAY},{"../":147,"../../":169,"../../content/orientation":120,"../../util":188,"../feedback":142,"../form":144,"./wml/date-field":135,"@quenk/noni/lib/data/maybe":77,moment:200}],135:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const label_1=require("../../label");const help_1=require("../../help");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class Main{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("div",{id:__context.values.root.id,class:__context.values.root.className},[__this.widget(new label_1.Label({for:__context.values.root.id,text:__context.values.label.text},[]),{for:__context.values.root.id,text:__context.values.label.text}),__this.node("input",{wml:{id:__context.values.input.wml.id},name:__context.values.input.wml.id,onfocus:__context.values.input.onfocus,oninput:__context.values.input.oninput,onkeyup:__context.values.input.onkeyup,onblur:__context.values.input.onblur,value:__context.values.input.value(),disabled:__context.values.input.disabled,class:__context.values.input.className,placeholder:__context.values.input.placeholder},[]),__this.widget(new help_1.Help({wml:{id:__context.values.messages.wml.id},text:__context.values.messages.text},[]),{wml:{id:__context.values.messages.wml.id},text:__context.values.messages.text})])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.Main=Main},{"../../help":145,"../../label":150,"@quenk/noni/lib/data/maybe":77,"@quenk/wml/lib/dom":189}],136:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DisplayField=exports.DISPLAY_FIELD_CONTENT=exports.DISPLAY_FIELD=exports.Style=void 0;const wml_1=require("@quenk/wml");const toolbar_1=require("../toolbar");const orientation_1=require("../../content/orientation");const disabled_1=require("../../content/state/disabled");const style_1=require("../../content/style");Object.defineProperty(exports,"Style",{enumerable:true,get:function(){return style_1.Style}});const size_1=require("../../content/size");const util_1=require("../../util");const __1=require("../../");const display_field_1=require("./wml/display-field");exports.DISPLAY_FIELD="ww-display-field";exports.DISPLAY_FIELD_CONTENT="ww-display-field__content";class DisplayField extends wml_1.Component{constructor(){super(...arguments);this.view=new display_field_1.Main(this);this.values={wml:{id:"display"},id:(0,__1.getId)(this.attrs),disabled:this.attrs&&this.attrs.disabled?this.attrs.disabled:false,className:(0,util_1.concat)(exports.DISPLAY_FIELD,(0,__1.getClassName)(this.attrs),toolbar_1.TOOLBAR_COMPAT,this.attrs&&this.attrs.style?(0,style_1.getStyleClassName)(this.attrs.style):style_1.DEFAULT,this.attrs&&this.attrs.size?(0,size_1.getSizeClassName)(this.attrs.size):"",this.attrs&&this.attrs.block?orientation_1.BLOCK:"",this.attrs&&this.attrs.disabled?disabled_1.DISABLED:""),onclick:e=>{e.stopPropagation();if(this.attrs&&this.attrs.onClick&&!this.values.disabled)this.attrs.onClick()},content:{className:exports.DISPLAY_FIELD_CONTENT}}}}exports.DisplayField=DisplayField},{"../../":169,"../../content/orientation":120,"../../content/size":121,"../../content/state/disabled":123,"../../content/style":125,"../../util":188,"../toolbar":160,"./wml/display-field":137,"@quenk/wml":190}],137:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class Main{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("div",{id:__context.values.id,class:__context.values.className,onclick:__context.values.onclick},[__this.node("div",{class:__context.values.content.className},[...__context.children])])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.Main=Main},{"@quenk/noni/lib/data/maybe":77,"@quenk/wml/lib/dom":189}],138:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DropDown=exports.DROP_DOWN_CONTENT=exports.DROP_DOWN_TOGGLE=exports.DROP_DOWN=void 0;const views=require("./wml/drop-down");const hidden=require("../../content/state/hidden");const style=require("../../content/style");const wml_1=require("@quenk/wml");const button_group_1=require("../button-group");const util_1=require("../../util");const __1=require("../../");exports.DROP_DOWN="ww-drop-down-menu";exports.DROP_DOWN_TOGGLE="ww-drop-down-menu__toggle";exports.DROP_DOWN_CONTENT="ww-drop-down__content";class DropDown extends wml_1.Component{constructor(){super(...arguments);this.view=new views.Main(this);this.values={root:{wml:{id:"root"},id:(0,__1.getId)(this.attrs),className:(0,util_1.concat)(exports.DROP_DOWN,button_group_1.BUTTON_GROUP_COMPAT,(0,__1.getClassName)(this.attrs))},button:{text:this.attrs&&this.attrs.buttonText?this.attrs.buttonText:"",anchor:this.attrs&&this.attrs.anchor?this.attrs.anchor:false,className:(0,util_1.concat)(exports.DROP_DOWN_TOGGLE,style.DEFAULT,this.attrs&&this.attrs.buttonClassName?this.attrs.buttonClassName:""),disabled:this.attrs&&this.attrs.disabled?this.attrs.disabled:undefined,template:()=>this.attrs&&this.attrs.buttonTemplate?this.attrs.buttonTemplate(this):new views.ButtonView(this),onClick:()=>{let mayRoot=(0,util_1.getById)(this.view,this.values.root.wml.id);if(mayRoot.isJust()){let e=mayRoot.get();if(this.values.content.autoClose){let hide=this.values.content.hide;for(let i=0;i<e.children.length;i++){e.children[i].removeEventListener("click",hide);e.children[i].addEventListener("click",hide)}}this.toggle();window.addEventListener("click",this)}}},content:{wml:{id:"content"},className:(0,util_1.concat)(exports.DROP_DOWN_CONTENT,hidden.HIDDEN),autoClose:this.attrs&&this.attrs.autoClose===false?false:true,render:()=>this.children,hide:()=>this.hide()}}}isHidden(){return hidden.isHidden(this.view,this.values.content.wml.id)}hide(){hidden.hide(this.view,this.values.content.wml.id);return this}show(){hidden.show(this.view,this.values.content.wml.id);return this}toggle(){hidden.toggle(this.view,this.values.content.wml.id);return this}handleEvent(e){(0,util_1.getById)(this.view,this.values.root.wml.id).map(root=>{if(!document.body.contains(root))document.removeEventListener("click",this);if(!root.contains(e.target))this.hide()})}}exports.DropDown=DropDown},{"../../":169,"../../content/state/hidden":124,"../../content/style":125,"../../util":188,"../button-group":126,"./wml/drop-down":139,"@quenk/wml":190}],139:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Main=exports.ButtonView=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const button_1=require("../../button");const caret_1=require("../../../content/caret");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class ButtonView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.widget(new button_1.Button({className:__context.values.button.className,anchor:__context.values.button.anchor,disabled:__context.values.button.disabled,onClick:__context.values.button.onClick},[text(__context.values.button.text+" "),__this.widget(new caret_1.Caret({},[]),{})]),{className:__context.values.button.className,anchor:__context.values.button.anchor,disabled:__context.values.button.disabled,onClick:__context.values.button.onClick})})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.ButtonView=ButtonView;class Main{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("div",{wml:{id:__context.values.root.wml.id},class:__context.values.root.className},[__this.registerView(__context.values.button.template()).render(),__this.node("div",{wml:{id:__context.values.content.wml.id},class:__context.values.content.className},[...__context.values.content.render()])])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.Main=Main},{"../../../content/caret":116,"../../button":130,"@quenk/noni/lib/data/maybe":77,"@quenk/wml/lib/dom":189}],140:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DropList=exports.DROP_LIST=exports.ItemSelectedEvent=void 0;const views=require("./wml/drop-list");const util_1=require("../../util");const size_1=require("../../content/size");const orientation_1=require("../../content/orientation");const results_menu_1=require("../results-menu");Object.defineProperty(exports,"ItemSelectedEvent",{enumerable:true,get:function(){return results_menu_1.ItemSelectedEvent}});const search_1=require("../search");const __1=require("../../");const __2=require("../");exports.DROP_LIST="ww-drop-list";class DropList extends __2.AbstractControl{constructor(){super(...arguments);this.view=new views.Main(this);this.values={id:(0,__1.getId)(this.attrs),className:(0,util_1.concat)(exports.DROP_LIST,(0,__1.getClassName)(this.attrs),this.attrs&&this.attrs.size?(0,size_1.getSizeClassName)(this.attrs.size):"",this.attrs&&this.attrs.block?orientation_1.BLOCK:""),name:(0,__2.getName)(this.attrs),value:this.attrs&&this.attrs.value,control:{wml:{id:"drop-list"}},messages:{wml:{id:"messages"}},display:{disabled:this.attrs&&this.attrs.disabled,placeholder:()=>{if(this.attrs){if(this.attrs.options&&this.values.value)return getCurrent(this.attrs.options,this.values.value);return this.attrs.placeholder||"Select one"}},onClick:()=>{this.toggle()}},menu:{wml:{id:"menu"},name:this.attrs&&this.attrs.name?this.attrs.name:"",block:this.attrs&&this.attrs.block?this.attrs.block:false,hidden:true,results:this.attrs&&this.attrs.options?this.attrs.options:[],onSelect:e=>{if(this.attrs&&this.attrs.onSelect)this.attrs.onSelect(new results_menu_1.ItemSelectedEvent(e.name,e.value.value));this.values.value=e.value.value;this.view.invalidate()},itemTemplate:this.attrs&&this.attrs.itemTemplate?this.attrs.itemTemplate:undefined,noItemsTemplate:this.attrs&&this.attrs.noItemsTemplate?this.attrs.noItemsTemplate:undefined,stringifier:this.attrs&&this.attrs.stringifier?this.attrs.stringifier:v=>v.label}}}update(options){this.values.menu.results=options;this.view.invalidate();return this}open(){(0,search_1.openMenu)(this.view,this.values.menu.wml.id);return this}close(){(0,search_1.closeMenu)(this.view,this.values.menu.wml.id);return this}toggle(){(0,search_1.toggleMenu)(this.view,this.values.menu.wml.id);return this}}exports.DropList=DropList;const getCurrent=(opts,value,text="Select one")=>opts.reduce((p,c)=>c.value===value?c.label:p,text)},{"../":147,"../../":169,"../../content/orientation":120,"../../content/size":121,"../../util":188,"../results-menu":152,"../search":154,"./wml/drop-list":141}],141:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const caret_1=require("../../../content/caret");const results_menu_1=require("../../results-menu");const display_field_1=require("../../display-field");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class Main{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("div",{id:__context.values.id,class:__context.values.className},[__this.widget(new display_field_1.DisplayField({onClick:__context.values.display.onClick,disabled:__context.values.display.disabled},[text(__context.values.display.placeholder()),__this.widget(new caret_1.Caret({},[]),{})]),{onClick:__context.values.display.onClick,disabled:__context.values.display.disabled}),__this.widget(new results_menu_1.ResultsMenu({wml:{id:__context.values.menu.wml.id},block:__context.values.menu.block,name:__context.values.menu.name,hidden:__context.values.menu.hidden,results:__context.values.menu.results,onSelect:__context.values.menu.onSelect,noItemsTemplate:__context.values.menu.noItemsTemplate,itemTemplate:__context.values.menu.itemTemplate,stringifier:__context.values.menu.stringifier},[]),{wml:{id:__context.values.menu.wml.id},block:__context.values.menu.block,name:__context.values.menu.name,hidden:__context.values.menu.hidden,results:__context.values.menu.results,onSelect:__context.values.menu.onSelect,noItemsTemplate:__context.values.menu.noItemsTemplate,itemTemplate:__context.values.menu.itemTemplate,stringifier:__context.values.menu.stringifier})])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.Main=Main},{"../../../content/caret":116,"../../display-field":136,"../../results-menu":152,"@quenk/noni/lib/data/maybe":77,"@quenk/wml/lib/dom":189}],142:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.validationState2ClassName=exports.getMessage=exports.getValidityClassName=exports.getValidationState=exports.removeValidationState=exports.setValidationState=exports.removeMessage=exports.setMessage=exports.AbstractFeedbackControl=exports.ValidationState=void 0;const style=require("../content/style");const document=require("@quenk/wml/lib/dom");const util_1=require("../util");const control_1=require("../control");var ValidationState;(function(ValidationState){ValidationState["Neutral"]="neutral";ValidationState["Error"]="error";ValidationState["Success"]="success";ValidationState["Warning"]="warning"})(ValidationState=exports.ValidationState||(exports.ValidationState={}));class AbstractFeedbackControl extends control_1.AbstractControl{setMessage(msg){(0,exports.setMessage)(this.view,this.values.messages.wml.id,msg);return this}removeMessage(){(0,exports.removeMessage)(this.view,this.values.messages.wml.id);return this}setValidationState(state){(0,exports.setValidationState)(this.view,this.values.control.wml.id,state);return this}removeValidationState(){(0,exports.removeValidationState)(this.view,this.values.control.wml.id);return this}getValidationState(){return(0,exports.getValidationState)(this.view,this.values.control.wml.id)}}exports.AbstractFeedbackControl=AbstractFeedbackControl;const setMessage=(view,id,msg)=>(0,util_1.getById)(view,id).map(messages=>{let node=document.createTextNode(msg);while(messages.lastChild)messages.removeChild(messages.lastChild);messages.appendChild(node)});exports.setMessage=setMessage;const removeMessage=(view,id)=>(0,util_1.getById)(view,id).map(messages=>{while(messages.lastChild)messages.removeChild(messages.lastChild)});exports.removeMessage=removeMessage;const setValidationState=(view,id,state)=>{(0,exports.removeValidationState)(view,id);if(state!==ValidationState.Neutral)(0,util_1.getById)(view,id).map(e=>e.classList.add((0,exports.validationState2ClassName)(state)))};exports.setValidationState=setValidationState;const removeValidationState=(view,id)=>{(0,util_1.getById)(view,id).map(h=>{h.classList.remove(style.SUCCESS);h.classList.remove(style.ERROR);h.classList.remove(style.WARNING)})};exports.removeValidationState=removeValidationState;const getValidationState=(view,id)=>(0,util_1.getById)(view,id).map(h=>{if(h.classList.contains(style.SUCCESS))return ValidationState.Success;else if(h.classList.contains(style.WARNING))return ValidationState.Warning;else if(h.classList.contains(style.ERROR))return ValidationState.Error;else return ValidationState.Neutral}).get();exports.getValidationState=getValidationState;const getValidityClassName=attrs=>{if(attrs){if(attrs.error&&attrs.error!="")return style.ERROR;if(attrs.warning&&attrs.warning!="")return style.WARNING;if(attrs.success&&attrs.success!="")return style.SUCCESS}return""};exports.getValidityClassName=getValidityClassName;const getMessage=attrs=>{if(attrs){if(attrs.error&&attrs.error!="")return attrs.error;if(attrs.warning&&attrs.warning!="")return attrs.warning;if(attrs.success&&attrs.success!="")return attrs.success;if(attrs.message&&attrs.message!="")return attrs.message}return""};exports.getMessage=getMessage;const validationState2ClassName=state=>{if(state===ValidationState.Success)return style.SUCCESS;else if(state===ValidationState.Warning)return style.WARNING;else if(state===ValidationState.Error)return style.ERROR;else return""};exports.validationState2ClassName=validationState2ClassName},{"../content/style":125,"../control":147,"../util":188,"@quenk/wml/lib/dom":189}],143:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.focus=exports.FocusLostEvent=exports.FocusGainedEvent=void 0;const util_1=require("../util");class FocusGainedEvent{constructor(name){this.name=name}}exports.FocusGainedEvent=FocusGainedEvent;class FocusLostEvent{constructor(name){this.name=name}}exports.FocusLostEvent=FocusLostEvent;const focus=(view,id)=>{(0,util_1.getById)(view,id).map(e=>e.focus())};exports.focus=focus},{"../util":188}],144:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.removeMessage=exports.setMessage=exports.getLabel=exports.AbstractFormControl=void 0;const util_1=require("../util");const feedback_1=require("./feedback");class AbstractFormControl extends feedback_1.AbstractFeedbackControl{}exports.AbstractFormControl=AbstractFormControl;const getLabel=attrs=>attrs&&attrs.label?attrs.label:"";exports.getLabel=getLabel;const setMessage=(view,id,msg)=>{(0,util_1.getById)(view,id).map(h=>{h.setMessage(msg)})};exports.setMessage=setMessage;const removeMessage=(view,id)=>{(0,util_1.getById)(view,id).map(h=>{h.removeMessage()})};exports.removeMessage=removeMessage},{"../util":188,"./feedback":142}],145:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Help=exports.HELP=void 0;const document=require("@quenk/wml/lib/dom");const wml_1=require("@quenk/wml");const util_1=require("../../util");const feedback_1=require("../feedback");const __1=require("../../");const help_1=require("./wml/help");exports.HELP="ww-help";class Help extends wml_1.Component{constructor(){super(...arguments);this.view=new help_1.Main(this);this.values={help:{wml:{id:"help"},id:this.attrs&&this.attrs.id?this.attrs.id:"",className:(0,util_1.concat)(exports.HELP,(0,__1.getClassName)(this.attrs)),text:this.attrs&&this.attrs.text?[document.createTextNode(this.attrs.text)]:this.children}}}setMessage(msg){(0,feedback_1.setMessage)(this.view,this.values.help.wml.id,msg);return this}removeMessage(){(0,feedback_1.removeMessage)(this.view,this.values.help.wml.id);return this}}exports.Help=Help},{"../../":169,"../../util":188,"../feedback":142,"./wml/help":146,"@quenk/wml":190,"@quenk/wml/lib/dom":189}],146:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class Main{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("span",{wml:{id:__context.values.help.wml.id},id:__context.values.help.id,class:__context.values.help.className},[...__context.values.help.text])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.Main=Main},{"@quenk/noni/lib/data/maybe":77,"@quenk/wml/lib/dom":189}],147:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getValue=exports.getDisabled=exports.getName=exports.AbstractControl=exports.Event=void 0;const wml_1=require("@quenk/wml");const maybe_1=require("@quenk/noni/lib/data/maybe");class Event{constructor(name,value){this.name=name;this.value=value}}exports.Event=Event;class AbstractControl extends wml_1.Component{}exports.AbstractControl=AbstractControl;const getName=attrs=>attrs&&attrs.name?attrs.name:"";exports.getName=getName;const getDisabled=attrs=>attrs&&attrs.disabled?attrs.disabled:undefined;exports.getDisabled=getDisabled;const getValue=attrs=>attrs&&attrs.value?(0,maybe_1.just)(attrs.value):(0,maybe_1.nothing)();exports.getValue=getValue},{"@quenk/noni/lib/data/maybe":77,"@quenk/wml":190}],148:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AddOn=exports.InputGroup=exports.INPUT_GROUP_BUTTON_ADDON=exports.INPUT_GROUP_ADDON=exports.INPUT_GROUP=void 0;const wml_1=require("@quenk/wml");const util_1=require("../../util");const __1=require("../../");const input_group_1=require("./wml/input-group");exports.INPUT_GROUP="ww-input-group";exports.INPUT_GROUP_ADDON="ww-input-group__addon";exports.INPUT_GROUP_BUTTON_ADDON="ww-input-group__button-addon";class InputGroup extends wml_1.Component{constructor(){super(...arguments);this.view=new input_group_1.InputGroupView(this);this.values={id:(0,__1.getId)(this.attrs),className:(0,util_1.concat)(exports.INPUT_GROUP,(0,__1.getClassName)(this.attrs))}}}exports.InputGroup=InputGroup;class AddOn extends wml_1.Component{constructor(){super(...arguments);this.view=new input_group_1.AddOnView(this);this.values={id:(0,__1.getId)(this.attrs),className:(0,util_1.concat)(this.attrs.button?exports.INPUT_GROUP_BUTTON_ADDON:exports.INPUT_GROUP_ADDON,(0,__1.getClassName)(this.attrs))}}}exports.AddOn=AddOn},{"../../":169,"../../util":188,"./wml/input-group":149,"@quenk/wml":190}],149:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.AddOnView=exports.InputGroupView=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class InputGroupView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("div",{id:__context.values.id,class:__context.values.className},[...__context.children])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.InputGroupView=InputGroupView;class AddOnView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("div",{id:__context.values.id,class:__context.values.className},[...__context.children])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.AddOnView=AddOnView},{"@quenk/noni/lib/data/maybe":77,"@quenk/wml/lib/dom":189}],150:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Label=exports.LABEL=void 0;const document=require("@quenk/wml/lib/dom");const wml_1=require("@quenk/wml");const util_1=require("../../util");const __1=require("../../");const label_1=require("./wml/label");exports.LABEL="ww-label";class Label extends wml_1.Component{constructor(){super(...arguments);this.view=new label_1.Main(this);this.values={label:{className:(0,util_1.concat)(exports.LABEL,(0,__1.getClassName)(this.attrs)),for:this.attrs&&this.attrs.for?this.attrs.for:"",text:this.attrs&&this.attrs.text?[document.createTextNode(this.attrs.text)]:this.children}}}}exports.Label=Label},{"../../":169,"../../util":188,"./wml/label":151,"@quenk/wml":190,"@quenk/wml/lib/dom":189}],151:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class Main{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("label",{for:__context.values.label.for,class:__context.values.label.className},[...__context.values.label.text])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.Main=Main},{"@quenk/noni/lib/data/maybe":77,"@quenk/wml/lib/dom":189}],152:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ResultsMenu=exports.ItemSelectedEvent=exports.RESULTS_MENU=void 0;const maybe_1=require("@quenk/noni/lib/data/maybe");const wml_1=require("@quenk/wml");const __1=require("../../");const util_1=require("../../util");const __2=require("../");const results_menu_1=require("./wml/results-menu");exports.RESULTS_MENU="ww-results-menu";class ItemSelectedEvent extends __2.Event{}exports.ItemSelectedEvent=ItemSelectedEvent;class ResultsMenu extends wml_1.Component{constructor(){super(...arguments);this.view=new results_menu_1.Main(this);this.values={wml:{id:"menu"},tree:(0,maybe_1.nothing)(),results:this.attrs&&this.attrs.results?this.attrs.results:[],name:this.attrs&&this.attrs.name?this.attrs.name:"",className:(0,util_1.concat)(exports.RESULTS_MENU,(0,__1.getClassName)(this.attrs)),block:this.attrs&&this.attrs.block?this.attrs.block:false,hidden:this.attrs&&this.attrs.hidden?this.attrs.hidden:false,item:{stringifier:this.attrs&&this.attrs.stringifier?this.attrs.stringifier:v=>Object.toString.call(v),click:index=>{if(this.attrs&&this.attrs.onSelect)this.attrs.onSelect(new ItemSelectedEvent(this.attrs&&this.attrs.name||"",this.values.results[index]))},template:(result,index)=>this.attrs&&this.attrs.itemTemplate?this.attrs.itemTemplate(result,index,this):new results_menu_1.ItemTemplateView({option:this.values.item.stringifier(result)}),noItemsTemplate:()=>this.attrs&&this.attrs.noItemsTemplate?this.attrs.noItemsTemplate:new results_menu_1.NoItemsTemplateView({})}}}open(){(0,util_1.getById)(this.view,this.values.wml.id).map(m=>m.show());this.values.hidden=false;if(this.attrs&&this.attrs.onOpen)this.attrs.onOpen();return this}close(){(0,util_1.getById)(this.view,this.values.wml.id).map(m=>m.hide());this.values.hidden=true;if(this.attrs&&this.attrs.onClose)this.attrs.onClose();return this}toggle(){(0,util_1.getById)(this.view,this.values.wml.id).map(m=>m.toggle());this.values.hidden=!this.values.hidden;if(this.values.hidden===true&&this.attrs&&this.attrs.onClose)this.attrs.onClose();else if(this.values.hidden===false&&this.attrs&&this.attrs.onOpen)this.attrs.onOpen();return this}handleEvent(e){if(this.values.tree.isJust()){let root=this.values.tree.get();if(!document.body.contains(root))document.removeEventListener("click",this);if(!root.contains(e.target))this.close()}}update(results){this.values.results=results;this.values.hidden=false;this.view.invalidate();return this}render(){this.values.tree=(0,maybe_1.just)(this.view.render());window.removeEventListener("click",this);window.addEventListener("click",this);return this.values.tree.get()}}exports.ResultsMenu=ResultsMenu},{"../":147,"../../":169,"../../util":188,"./wml/results-menu":153,"@quenk/noni/lib/data/maybe":77,"@quenk/wml":190}],153:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Main=exports.NoItemsTemplateView=exports.ItemTemplateView=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const link_1=require("../../../content/link");const menu_1=require("../../../menu/menu");const item_1=require("../../../menu/item");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class ItemTemplateView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("span",{},[text(__context.option)])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.ItemTemplateView=ItemTemplateView;class NoItemsTemplateView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("b",{},[__document.createTextNode("No results to display.")])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.NoItemsTemplateView=NoItemsTemplateView;class Main{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.widget(new menu_1.Menu({wml:{id:__context.values.wml.id},className:__context.values.className,block:__context.values.block,hidden:__context.values.hidden},[...__forIn(__context.values.results,(result,index,_$$all)=>[__this.widget(new item_1.Item({name:""+index},[__this.widget(new link_1.Link({onClick:()=>__context.values.item.click(index)},[__this.registerView(__context.values.item.template(result,index)).render()]),{onClick:()=>__context.values.item.click(index)})]),{name:""+index})],()=>[__this.registerView(__context.values.item.noItemsTemplate()).render()])]),{wml:{id:__context.values.wml.id},className:__context.values.className,block:__context.values.block,hidden:__context.values.hidden})})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.Main=Main},{"../../../content/link":118,"../../../menu/item":181,"../../../menu/menu":183,"@quenk/noni/lib/data/maybe":77,"@quenk/wml/lib/dom":189}],154:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.toggleMenu=exports.closeMenu=exports.openMenu=exports.updateMenu=exports.Search=exports.Input=exports.EscapeEvent=exports.FocusLostEvent=exports.FocusGainedEvent=exports.TermChangedEvent=exports.SEARCH_INPUT=exports.SEARCH=exports.ESCAPE=exports.ItemSelectedEvent=void 0;const views=require("./wml/search");const timer_1=require("@quenk/noni/lib/control/timer");const orientation_1=require("../../content/orientation");const util_1=require("../../util");const results_menu_1=require("../results-menu");Object.defineProperty(exports,"ItemSelectedEvent",{enumerable:true,get:function(){return results_menu_1.ItemSelectedEvent}});const __1=require("../../");const __2=require("../");exports.ESCAPE=27;exports.SEARCH="ww-search";exports.SEARCH_INPUT="ww-search__input";class TermChangedEvent extends __2.Event{}exports.TermChangedEvent=TermChangedEvent;class FocusGainedEvent{constructor(name){this.name=name}}exports.FocusGainedEvent=FocusGainedEvent;class FocusLostEvent{constructor(name){this.name=name}}exports.FocusLostEvent=FocusLostEvent;class EscapeEvent{constructor(name){this.name=name}}exports.EscapeEvent=EscapeEvent;class Input extends __2.AbstractControl{constructor(){super(...arguments);this.view=new views.InputView(this);this.values={wml:{id:"root"},className:(0,util_1.concat)(exports.SEARCH_INPUT,(0,__1.getClassName)(this.attrs)),placeholder:this.attrs&&this.attrs.placeholder?this.attrs.placeholder:"",readOnly:this.attrs&&this.attrs.readOnly||undefined,disabled:this.attrs&&this.attrs.disabled||undefined,autocomplete:"do not enable please",autofocus:this.attrs&&this.attrs.autofocus?true:undefined,size:String(this.attrs&&this.attrs.size?this.attrs.size:20),value:this.attrs&&this.attrs.value?this.attrs.value:"",onfocus:e=>{let target=e.target;if(this.attrs&&this.attrs.onFocus)this.attrs.onFocus(new FocusGainedEvent(this.attrs&&this.attrs.name||""));target.value=target.value},onkeyup:e=>{if(e.keyCode===exports.ESCAPE){if(this.attrs&&this.attrs.onEscape)this.attrs.onEscape(new EscapeEvent(this.attrs.name||""))}else{this.fireSearch(e)}},oninput:e=>{e.target.oninput=null;this.values.onkeyup(e)},onblur:()=>{if(this.attrs&&this.attrs.onBlur)this.attrs.onBlur(new FocusLostEvent(this.attrs&&this.attrs.name||""))}}}fireSearch(e){if(this.attrs&&this.attrs.onSearch){let name=""+this.attrs.name;let value=e.target.value;this.attrs.onSearch(new TermChangedEvent(name,value))}}rendered(){if(this.values.autofocus===true)this.focus()}focus(){(0,timer_1.tick)(()=>getInput(this).map(i=>i.focus()));return this}setSize(n){this.values.size=String(n);getInput(this).map(i=>i.setAttribute("size",String(n)));return this}getSize(){return Number(this.values.size)}}exports.Input=Input;class Search extends __2.AbstractControl{constructor(){super(...arguments);this.view=new views.Main(this);this.values={root:{wml:{id:"root"},id:(0,__1.getId)(this.attrs),className:(0,util_1.concat)(exports.SEARCH,(0,__1.getClassName)(this.attrs),(0,orientation_1.getBlockClassName)(this.attrs))},input:{wml:{id:"input"},name:(0,__2.getName)(this.attrs),placeholder:this.attrs&&this.attrs.placeholder?this.attrs.placeholder:"",autofocus:this.attrs&&this.attrs.autofocus?true:undefined,readOnly:this.attrs&&this.attrs.readOnly||undefined,disabled:this.attrs&&this.attrs.disabled||undefined,value:this.attrs&&this.attrs.term?this.attrs.term:this.attrs&&this.attrs.stringifier&&this.attrs.value?this.attrs.stringifier(this.attrs.value):"",onFocus:this.attrs&&this.attrs.onFocus||undefined,onSearch:this.attrs&&this.attrs.onSearch?this.attrs.onSearch:undefined,onEscape:()=>this.close(),onBlur:this.attrs&&this.attrs.onBlur?this.attrs.onBlur:undefined},menu:{wml:{id:"menu"},name:this.attrs&&this.attrs.name?this.attrs.name:"",block:this.attrs&&this.attrs.block?this.attrs.block:false,onSelect:e=>{this.close();if(this.attrs&&this.attrs.onSelect)this.attrs.onSelect(e)},itemTemplate:this.attrs&&this.attrs.itemTemplate?this.attrs.itemTemplate:undefined,noItemsTemplate:this.attrs&&this.attrs.noItemsTemplate?this.attrs.noItemsTemplate:undefined,stringifier:this.attrs&&this.attrs.stringifier?this.attrs.stringifier:undefined}}}set(value){(0,util_1.getById)(this.view,this.values.root.wml.id).map(e=>{e.value=value});return this}focus(){(0,util_1.getById)(this.view,this.values.input.wml.id).map(i=>i.focus());return this}update(results){(0,exports.updateMenu)(this.view,this.values.menu.wml.id,results);return this}open(){(0,exports.openMenu)(this.view,this.values.menu.wml.id);return this}close(){(0,exports.closeMenu)(this.view,this.values.menu.wml.id);return this}}exports.Search=Search;const getInput=i=>(0,util_1.getById)(i.view,i.values.wml.id);const updateMenu=(view,id,results)=>{let mMenu=(0,util_1.getById)(view,id);if(mMenu.isJust())mMenu.get().update(results)};exports.updateMenu=updateMenu;const openMenu=(view,id)=>{(0,util_1.getById)(view,id).map(m=>m.open())};exports.openMenu=openMenu;const closeMenu=(view,id)=>{(0,util_1.getById)(view,id).map(m=>m.close())};exports.closeMenu=closeMenu;const toggleMenu=(view,id)=>{(0,util_1.getById)(view,id).map(m=>m.toggle())};exports.toggleMenu=toggleMenu},{"../":147,"../../":169,"../../content/orientation":120,"../../util":188,"../results-menu":152,"./wml/search":155,"@quenk/noni/lib/control/timer":72}],155:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Main=exports.InputView=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const results_menu_1=require("../../results-menu");const __1=require("../");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class InputView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("input",{wml:{id:__context.values.wml.id},class:__context.values.className,onkeyup:__context.values.onkeyup,oninput:__context.values.oninput,onfocus:__context.values.onfocus,onblur:__context.values.onblur,autofocus:__context.values.autofocus,autocomplete:__context.values.autocomplete,size:__context.values.size,placeholder:__context.values.placeholder,readOnly:__context.values.readOnly,disabled:__context.values.disabled,value:__context.values.value},[])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.InputView=InputView;class Main{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("div",{wml:{id:__context.values.root.wml.id},id:__context.values.root.id,class:__context.values.root.className},[__this.widget(new __1.Input({wml:{id:__context.values.input.wml.id},name:__context.values.input.name,autofocus:__context.values.input.autofocus,onFocus:__context.values.input.onFocus,onSearch:__context.values.input.onSearch,onEscape:__context.values.input.onEscape,onBlur:__context.values.input.onBlur,placeholder:__context.values.input.placeholder,readOnly:__context.values.input.readOnly,disabled:__context.values.input.disabled,value:__context.values.input.value},[]),{wml:{id:__context.values.input.wml.id},name:__context.values.input.name,autofocus:__context.values.input.autofocus,onFocus:__context.values.input.onFocus,onSearch:__context.values.input.onSearch,onEscape:__context.values.input.onEscape,onBlur:__context.values.input.onBlur,placeholder:__context.values.input.placeholder,readOnly:__context.values.input.readOnly,disabled:__context.values.input.disabled,value:__context.values.input.value}),__this.widget(new results_menu_1.ResultsMenu({wml:{id:__context.values.menu.wml.id},hidden:true,block:__context.values.menu.block,onSelect:__context.values.menu.onSelect,noItemsTemplate:__context.values.menu.noItemsTemplate,itemTemplate:__context.values.menu.itemTemplate,stringifier:__context.values.menu.stringifier},[]),{wml:{id:__context.values.menu.wml.id},hidden:true,block:__context.values.menu.block,onSelect:__context.values.menu.onSelect,noItemsTemplate:__context.values.menu.noItemsTemplate,itemTemplate:__context.values.menu.itemTemplate,stringifier:__context.values.menu.stringifier})])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.Main=Main},{"../":154,"../../results-menu":152,"@quenk/noni/lib/data/maybe":77,"@quenk/wml/lib/dom":189}],156:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TextField=exports.TEXT_FIELD=exports.TextChangedEvent=void 0;const views=require("./wml/text-field");const record_1=require("@quenk/noni/lib/data/record");const util_1=require("../../util");const feedback_1=require("../feedback");const form_1=require("../form");const text_input_1=require("../text-input");Object.defineProperty(exports,"TextChangedEvent",{enumerable:true,get:function(){return text_input_1.TextChangedEvent}});const __1=require("../../");const __2=require("../");exports.TEXT_FIELD="ww-text-field";class TextField extends form_1.AbstractFormControl{constructor(){super(...arguments);this.view=new views.Main(this);this.values={root:{wml:{id:"root"},className:(0,util_1.concat)(exports.TEXT_FIELD,(0,__1.getClassName)(this.attrs),(0,feedback_1.getValidityClassName)(this.attrs))},messages:{wml:{id:"message"},text:(0,feedback_1.getMessage)(this.attrs)},label:{id:(0,__2.getName)(this.attrs),text:(0,form_1.getLabel)(this.attrs)},control:{wml:{id:"root"},attrs:(0,record_1.merge)(this.attrs.html||{},{id:(0,__1.getId)(this.attrs),name:(0,__2.getName)(this.attrs),type:this.attrs&&this.attrs.type?this.attrs.type:"text",min:this.attrs&&this.attrs.min?this.attrs.min:undefined,max:this.attrs&&this.attrs.max?this.attrs.max:undefined,focus:this.attrs&&this.attrs.focus?this.attrs.focus:undefined,placeholder:this.attrs&&this.attrs.placeholder?this.attrs.placeholder:"",match:this.attrs&&this.attrs.match?this.attrs.match:undefined,length:this.attrs&&this.attrs.length?this.attrs.length:undefined,value:this.attrs&&this.attrs.value?this.attrs.value:"",disabled:this.attrs&&this.attrs.disabled?true:undefined,readOnly:this.attrs&&this.attrs.readOnly?true:undefined,rows:this.attrs&&this.attrs.rows?this.attrs.rows:1,oninput:this.attrs&&this.attrs.onChange?oninput(this):()=>{},onChange:this.attrs&&this.attrs.onChange?this.attrs.onChange:()=>{}})}}}setMessage(msg){getHelp(this).map(h=>h.setMessage(msg));return this}removeMessage(){getHelp(this).map(h=>h.removeMessage());return this}}exports.TextField=TextField;const getHelp=t=>(0,util_1.getById)(t.view,t.values.messages.wml.id);const oninput=f=>e=>{if(f.attrs&&f.attrs&&f.attrs.onChange)f.attrs.onChange(new text_input_1.TextChangedEvent(f.attrs&&f.attrs.name?f.attrs.name:"",e.target.value))}},{"../":147,"../../":169,"../../util":188,"../feedback":142,"../form":144,"../text-input":158,"./wml/text-field":157,"@quenk/noni/lib/data/record":78}],157:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const label_1=require("../../label");const help_1=require("../../help");const text_input_1=require("../../text-input");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class Main{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("div",{wml:{id:__context.values.root.wml.id},class:__context.values.root.className},[__this.widget(new label_1.Label({for:__context.values.control.attrs.id,text:__context.values.label.text},[]),{for:__context.values.control.attrs.id,text:__context.values.label.text}),__this.widget(new text_input_1.TextInput(__context.values.control.attrs,[]),__context.values.control.attrs),__this.widget(new help_1.Help({wml:{id:__context.values.messages.wml.id},text:__context.values.messages.text},[]),{wml:{id:__context.values.messages.wml.id},text:__context.values.messages.text})])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.Main=Main},{"../../help":145,"../../label":150,"../../text-input":158,"@quenk/noni/lib/data/maybe":77,"@quenk/wml/lib/dom":189}],158:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TextInput=exports.TextChangedEvent=exports.TEXT_INPUT=void 0;const views=require("./wml/text-input");const timer_1=require("@quenk/noni/lib/control/timer");const record_1=require("@quenk/noni/lib/data/record");const util_1=require("../../util");const orientation_1=require("../../content/orientation");const size_1=require("../../content/size");const focus_1=require("../focus");const __1=require("../../");const __2=require("../");exports.TEXT_INPUT="ww-text-input";class TextChangedEvent extends __2.Event{}exports.TextChangedEvent=TextChangedEvent;class TextInput extends __2.AbstractControl{constructor(){super(...arguments);this.view=this.attrs&&this.attrs.rows&&this.attrs.rows>1?new views.Textarea(this):new views.Input(this);this.length=this.attrs&&this.attrs.length?this.attrs.length:Infinity;this.values={control:{wml:{id:"root"}},attrs:(0,record_1.merge)(this.attrs&&this.attrs.html||{},{id:(0,__1.getId)(this.attrs),class:(0,util_1.concat)(exports.TEXT_INPUT,(0,__1.getClassName)(this.attrs),this.attrs&&this.attrs.size?(0,size_1.getSizeClassName)(this.attrs.size):"",this.attrs&&this.attrs.block?orientation_1.BLOCK:""),name:(0,__2.getName)(this.attrs),type:this.attrs&&this.attrs.type?this.attrs.type:"text",min:this.attrs&&this.attrs.min?String(this.attrs.min):null,max:this.attrs&&this.attrs.max?String(this.attrs.max):null,match:new RegExp(this.attrs&&this.attrs.match?this.attrs.match:"."),placeholder:this.attrs&&this.attrs.placeholder?this.attrs.placeholder:"",value:this.attrs&&this.attrs.value?this.attrs.value:"",rows:String(this.attrs&&this.attrs.rows?this.attrs.rows:1),disabled:this.attrs&&this.attrs.disabled===true?true:null,readOnly:this.attrs&&this.attrs.readOnly===true?true:null,onkeydown:e=>{if(e.key.length===1){let value=e.target.value||"";if(!this.values.attrs.match.test(e.key)||value.length>this.length)e.preventDefault()}},oninput:dispatchInput(this),autofocus:this.attrs&&this.attrs.focus?true:undefined,onfocus:()=>{if(this.attrs&&this.attrs.onFocusGained)this.attrs.onFocusGained(new focus_1.FocusGainedEvent((0,__2.getName)(this.attrs)))},onblur:()=>{if(this.attrs&&this.attrs.onFocusLost)this.attrs.onFocusLost(new focus_1.FocusLostEvent((0,__2.getName)(this.attrs)))}})}}rendered(){if(this.values.attrs.autofocus===true)this.focus()}focus(){return(0,timer_1.tick)(()=>(0,focus_1.focus)(this.view,this.values.control.wml.id))}}exports.TextInput=TextInput;const dispatchInput=i=>e=>{if(i.attrs&&i.attrs.onChange)i.attrs.onChange(new TextChangedEvent(i.attrs&&i.attrs.name?i.attrs.name:"",e.target.value))}},{"../":147,"../../":169,"../../content/orientation":120,"../../content/size":121,"../../util":188,"../focus":143,"./wml/text-input":159,"@quenk/noni/lib/control/timer":72,"@quenk/noni/lib/data/record":78}],159:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Input=exports.Textarea=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const document=require("@quenk/wml/lib/dom");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class Textarea{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("textarea",__context.values.attrs,[document.createTextNode(__context.values.attrs.value)])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.Textarea=Textarea;class Input{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("input",__context.values.attrs,[])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.Input=Input},{"@quenk/noni/lib/data/maybe":77,"@quenk/wml/lib/dom":189}],160:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Toolbar=exports.TOOLBAR_COMPAT=exports.TOOLBAR=void 0;const views=require("./wml/toolbar");const wml_1=require("@quenk/wml");const util_1=require("../../util");const __1=require("../../");exports.TOOLBAR="ww-toolbar";exports.TOOLBAR_COMPAT="-toolbar-compat";class Toolbar extends wml_1.Component{constructor(){super(...arguments);this.view=new views.Main(this);this.values={root:{id:(0,__1.getId)(this.attrs),className:(0,util_1.concat)(exports.TOOLBAR,(0,__1.getClassName)(this.attrs))}}}}exports.Toolbar=Toolbar},{"../../":169,"../../util":188,"./wml/toolbar":161,"@quenk/wml":190}],161:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class Main{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("div",{id:__context.values.root.id,class:__context.values.root.className},[...__context.children])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.Main=Main},{"@quenk/noni/lib/data/maybe":77,"@quenk/wml/lib/dom":189}],162:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.sortById=exports.SortRequest=void 0;const path_1=require("@quenk/noni/lib/data/record/path");const sort_1=require("@quenk/noni/lib/data/array/sort");class SortRequest{constructor(column,data,key){this.column=column;this.data=data;this.key=key}}exports.SortRequest=SortRequest;const sortById=(cols,key,data,id)=>{let spec=cols[id];let[current,original]=data;if(spec===undefined)return[current,key];if(!spec.sort)return[current,key];if(key[0]===id){return[current.reverse(),[key[0],key[1]*-1]]}else{let strategy=getSortStrategy(spec.sort);let alias=spec.alias?spec.alias:spec.name;return[doSort(original.slice(),strategy,alias),[id,-1]]}};exports.sortById=sortById;const getSortStrategy=s=>{if(typeof s==="function")return s;if(s==="date")return sort_1.date;if(s==="number")return sort_1.number;if(s==="string")return sort_1.string;return sort_1.natural};const doSort=(data,s,alias)=>data.sort((a,b)=>s(getAny(alias,a),getAny(alias,b)));const getAny=(path,src)=>(0,path_1.getDefault)(path,src,undefined)},{"@quenk/noni/lib/data/array/sort":74,"@quenk/noni/lib/data/record/path":79}],163:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DataChangedEvent=exports.CellClickedEvent=exports.HeadingClickedEvent=void 0;class HeadingClickedEvent{constructor(column){this.column=column}}exports.HeadingClickedEvent=HeadingClickedEvent;class CellClickedEvent{constructor(column,row){this.column=column;this.row=row}}exports.CellClickedEvent=CellClickedEvent;class DataChangedEvent{constructor(name,data,key){this.name=name;this.data=data;this.key=key}}exports.DataChangedEvent=DataChangedEvent},{}],164:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DataTable=exports.NewCellContext=exports.NewBodyContext=exports.NewHeadingContext=exports.NewHeadContext=exports.DESC=exports.ASC=exports.DATA_TABLE_CELL=exports.DATA_TABLE_BODY=exports.DATA_TABLE_HEADING=exports.DATA_TABLE_HEAD=exports.DATA_TABLE=exports.HeadingClickedEvent=exports.CellClickedEvent=exports.DataChangedEvent=exports.SortRequest=void 0;const views=require("./wml/table");const wml_1=require("@quenk/wml");const array_1=require("@quenk/noni/lib/data/array");const path_1=require("@quenk/noni/lib/data/record/path");const util_1=require("../../util");const __1=require("../../");const sort_1=require("./column/sort");Object.defineProperty(exports,"SortRequest",{enumerable:true,get:function(){return sort_1.SortRequest}});const event_1=require("./event");Object.defineProperty(exports,"DataChangedEvent",{enumerable:true,get:function(){return event_1.DataChangedEvent}});Object.defineProperty(exports,"CellClickedEvent",{enumerable:true,get:function(){return event_1.CellClickedEvent}});Object.defineProperty(exports,"HeadingClickedEvent",{enumerable:true,get:function(){return event_1.HeadingClickedEvent}});const range_1=require("./range");exports.DATA_TABLE="ww-data-table";exports.DATA_TABLE_HEAD="ww-data-table__head";exports.DATA_TABLE_HEADING="ww-data-table__heading";exports.DATA_TABLE_BODY="ww-data-table__body";exports.DATA_TABLE_CELL="ww-data-table__cell";exports.ASC="-asc";exports.DESC="-desc";class NewHeadContext{constructor(table){this.table=table;this.className=(0,util_1.concat)(exports.DATA_TABLE_HEAD,this.table.attrs&&this.table.attrs.headClassName||"");this.columns=this.table.values.columns;this.data=this.table.values.dataset[0];this.heading=((c,i)=>getHeadingView(this.table,new NewHeadingContext(this.table,this,c,i),c).render())}}exports.NewHeadContext=NewHeadContext;class NewHeadingContext{constructor(table,headContext,column,index){this.table=table;this.headContext=headContext;this.column=column;this.index=index;this.className=(0,util_1.concat)(exports.DATA_TABLE_HEADING,this.table.attrs&&this.table.attrs.headingClassName||"",this.column.headingClassName,getSortClassName(this.table.values.sortKey,this.index));this.onclick=(_=>{if(this.column.sort)this.table.values.sort(this.index);if(this.column.onHeadingClicked)this.column.onHeadingClicked(new event_1.HeadingClickedEvent(this.index));if(this.table.attrs&&this.table.attrs.onHeadingClicked)this.table.attrs.onHeadingClicked(new event_1.HeadingClickedEvent(this.index))})}}exports.NewHeadingContext=NewHeadingContext;class NewBodyContext{constructor(table){this.table=table;this.className=(0,util_1.concat)(exports.DATA_TABLE_BODY,this.table.attrs&&this.table.attrs.bodyClassName||"");this.columns=this.table.values.columns;this.data=this.table.values.dataset[0];this.cell=((c,id,row)=>getCellView(this.table,new NewCellContext(this.table,this,c,id,row),c).render())}}exports.NewBodyContext=NewBodyContext;class NewCellContext{constructor(table,bodyContext,spec,column,row){this.table=table;this.bodyContext=bodyContext;this.spec=spec;this.column=column;this.row=row;this.id=cellId(this.column,this.row);this.className=(0,util_1.concat)(exports.DATA_TABLE_CELL,this.table.attrs&&this.table.attrs.cellClassName||"",this.spec.cellClassName,getSortClassName(this.table.values.sortKey,this.column));this.value=(0,path_1.unsafeGet)(this.spec.name,this.table.values.dataset[0][this.row]);this.datum=this.table.values.dataset[0][this.row];this.format=this.spec.format?this.spec.format:c=>String(c==null?"":c);this.onclick=(()=>{if(this.spec.onCellClicked)this.spec.onCellClicked(new event_1.CellClickedEvent(this.column,this.row));if(this.table.attrs&&this.table.attrs.onCellClicked)this.table.attrs.onCellClicked(new event_1.CellClickedEvent(this.column,this.row))})}}exports.NewCellContext=NewCellContext;class DataTable extends wml_1.Component{constructor(){super(...arguments);this.view=new views.Main(this);this.theadView=new views.EmptyView({});this.tbodyView=new views.EmptyView({});this.values={wml:{id:"table"},id:(0,__1.getId)(this.attrs),className:(0,util_1.concat)(exports.DATA_TABLE,(0,__1.getClassName)(this.attrs)),name:this.attrs&&this.attrs.name||"",sortable:this.attrs&&this.attrs.sortable!=null?this.attrs.sortable:true,sortKey:this.attrs&&this.attrs.sortKey?this.attrs.sortKey:[-1,1],sort:col=>{if(this.values.sortable)this.sort(col)},dataset:this.attrs&&this.attrs.data?[this.attrs.data.slice(),this.attrs.data.slice()]:[[],[]],columns:this.attrs&&this.attrs.columns?this.attrs.columns:[],thead:()=>{this.theadView=getHeadView(this,new NewHeadContext(this));return this.theadView.render()},tbody:()=>{this.tbodyView=getBodyView(this,new NewBodyContext(this));return this.tbodyView.render()}}}fireChange(){if(this.attrs&&this.attrs.onChange)this.attrs.onChange(new event_1.DataChangedEvent(this.values.name,this.values.dataset[0].slice(),this.values.sortKey.slice()))}update(data){this.values.dataset=[data.slice(),data.slice()];this.view.invalidate();this.fireChange();return this}updateWithSortKey(data,key){this.values.sortKey=key;this.update(data);return this}sort(id){let{sortKey:sortKey,dataset:dataset}=this.values;let del=getSortDelegate(this);let[data,key]=del(new sort_1.SortRequest(id,dataset[1],sortKey));this.values.dataset[0]=data;this.values.sortKey=key;this.view.invalidate();this.fireChange();return this}getRow(row){let mTr=(0,util_1.getById)(this.tbodyView,`${row}`);if(mTr.isNothing())return new range_1.RangeInstance([]);let tr=mTr.get();return new range_1.RangeInstance((0,array_1.make)(tr.cells.length,n=>tr.cells[n]))}getCell(column,row){let cells=this.getRow(row).cells;if(!cells[column])return new range_1.RangeInstance([]);return new range_1.RangeInstance([cells[column]])}}exports.DataTable=DataTable;const getHeadView=(table,ctx)=>table.attrs&&table.attrs.headFragment?table.attrs.headFragment(ctx):new views.HeadView(ctx);const getHeadingView=(table,ctx,c)=>c.headingFragment?c.headingFragment(ctx):table.attrs&&table.attrs.headingFragment?table.attrs.headingFragment(ctx):new views.HeadingView(ctx);const getBodyView=(table,ctx)=>table.attrs&&table.attrs.bodyFragment?table.attrs.bodyFragment(ctx):new views.BodyView(ctx);const getCellView=(table,ctx,c)=>c.cellFragment?c.cellFragment(ctx):table.attrs&&table.attrs.cellFragment?table.attrs.cellFragment(ctx):new views.CellView(ctx);const getSortDelegate=table=>table.attrs&&table.attrs.sortDelegate?table.attrs.sortDelegate:r=>(0,sort_1.sortById)(table.values.columns,r.key,[table.values.dataset[0],r.data],r.column);const getSortClassName=(key,index)=>key[0]===index?key[1]===1?exports.ASC:exports.DESC:"";const cellId=(column,row)=>`${column},${row}`},{"../../":169,"../../util":188,"./column/sort":162,"./event":163,"./range":165,"./wml/table":166,"@quenk/noni/lib/data/array":73,"@quenk/noni/lib/data/record/path":79,"@quenk/wml":190}],165:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RangeInstance=void 0;class RangeInstance{constructor(cells){this.cells=cells}}exports.RangeInstance=RangeInstance},{}],166:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Main=exports.CellView=exports.BodyView=exports.HeadingView=exports.HeadView=exports.EmptyView=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const table_1=require("../../../layout/table");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class EmptyView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("div",{},[])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.EmptyView=EmptyView;class HeadView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("thead",{class:__context.className},[__this.node("tr",{},[...__forIn(__context.columns,(col,idx,_$$all)=>[__context.heading(col,idx)],()=>[])])])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.HeadView=HeadView;class HeadingView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("th",{class:__context.className,onclick:__context.onclick},[text(__context.column.heading)])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.HeadingView=HeadingView;class BodyView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("tbody",{class:__context.className},[...__forIn(__context.data,(_,row,_$$all)=>[__this.node("tr",{wml:{id:String(row)}},[...__forIn(__context.columns,(col,idx,_$$all)=>[__context.cell(col,idx,row)],()=>[])])],()=>[])])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.BodyView=BodyView;class CellView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("td",{wml:{id:__context.id},class:__context.className,onclick:__context.onclick},[text(__context.format(__context.value))])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.CellView=CellView;class Main{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.widget(new table_1.TableLayout({wml:{id:__context.values.wml.id},id:__context.values.id,className:__context.values.className},[__context.values.thead(),__context.values.tbody()]),{wml:{id:__context.values.wml.id},id:__context.values.id,className:__context.values.className})})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.Main=Main},{"../../../layout/table":177,"@quenk/noni/lib/data/maybe":77,"@quenk/wml/lib/dom":189}],167:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ModalFooter=exports.ModalBody=exports.ModalHeader=exports.Modal=exports.MODAL_FOOTER=exports.MODAL_BODY=exports.MODAL_HEADER=exports.MODAL_CONTENT=exports.MODAL_POSITION=exports.MODAL=void 0;const views=require("./wml/modal");const wml_1=require("@quenk/wml");const util_1=require("../../util");const __1=require("../../");const layout_1=require("../../layout");exports.MODAL="ww-modal";exports.MODAL_POSITION="ww-modal__position";exports.MODAL_CONTENT="ww-modal__content";exports.MODAL_HEADER="ww-modal__header";exports.MODAL_BODY="ww-modal__body";exports.MODAL_FOOTER="ww-modal__footer";class Modal extends wml_1.Component{constructor(){super(...arguments);this.view=new views.Modal(this);this.values={wml:{id:"root"},id:(0,__1.getId)(this.attrs),className:(0,util_1.concat)(exports.MODAL,(0,__1.getClassName)(this.attrs)),content:{className:exports.MODAL_CONTENT},position:{className:exports.MODAL_POSITION}}}close(){let mO=(0,util_1.getById)(this.view,this.values.wml.id);if(mO.isJust()){let n=mO.get();if(n.parentNode)n.parentNode.removeChild(n)}}}exports.Modal=Modal;class ModalHeader extends layout_1.AbstractLayout{constructor(){super(...arguments);this.view=new views.ModalHeader(this);this.values={wml:{id:"root"},id:(0,__1.getId)(this.attrs),className:(0,util_1.concat)(exports.MODAL_HEADER,(0,__1.getClassName)(this.attrs)),content:{wml:{id:"root"}}}}}exports.ModalHeader=ModalHeader;class ModalBody extends layout_1.AbstractLayout{constructor(){super(...arguments);this.view=new views.ModalBody(this);this.values={wml:{id:"root"},id:(0,__1.getId)(this.attrs),className:(0,util_1.concat)(exports.MODAL_BODY,(0,__1.getClassName)(this.attrs)),content:{wml:{id:"root"}}}}}exports.ModalBody=ModalBody;class ModalFooter extends wml_1.Component{constructor(){super(...arguments);this.view=new views.ModalFooter(this);this.values={wml:{id:"root"},id:(0,__1.getId)(this.attrs),className:(0,util_1.concat)(exports.MODAL_FOOTER,(0,__1.getClassName)(this.attrs)),content:{wml:{id:"root"}}}}}exports.ModalFooter=ModalFooter},{"../../":169,"../../layout":174,"../../util":188,"./wml/modal":168,"@quenk/wml":190}],168:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ModalFooter=exports.ModalBody=exports.ModalHeader=exports.Modal=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class Modal{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("div",{wml:{id:__context.values.wml.id},id:__context.values.id,class:__context.values.className},[__this.node("div",{class:__context.values.position.className},[__this.node("div",{class:__context.values.content.className},[...__context.children])])])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.Modal=Modal;class ModalHeader{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("div",{wml:{id:__context.values.wml.id},id:__context.values.id,class:__context.values.className},[...__context.children])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.ModalHeader=ModalHeader;class ModalBody{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("div",{wml:{id:__context.values.wml.id},id:__context.values.id,class:__context.values.className},[...__context.children])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.ModalBody=ModalBody;class ModalFooter{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("div",{wml:{id:__context.values.wml.id},id:__context.values.id,class:__context.values.className},[...__context.children])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.ModalFooter=ModalFooter},{"@quenk/noni/lib/data/maybe":77,"@quenk/wml/lib/dom":189}],169:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getClassName=exports.getId=void 0;const getId=attrs=>attrs.id?attrs.id:"";exports.getId=getId;const getClassName=attrs=>attrs.className||"";exports.getClassName=getClassName},{}],170:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ActionBar=exports.ACTION_BAR_CONTENT=exports.ACTION_BAR=void 0;const orientation=require("../../content/orientation");const __1=require("../..");const util_1=require("../../util");const __2=require("../");const action_bar_1=require("./wml/action-bar");exports.ACTION_BAR="ww-action-bar";exports.ACTION_BAR_CONTENT="ww-action-bar__content";class ActionBar extends __2.AbstractLayout{constructor(){super(...arguments);this.view=new action_bar_1.Main(this);this.values={root:{wml:{id:"root"},id:this.attrs&&this.attrs.id?this.attrs.id:"",className:(0,util_1.concat)(exports.ACTION_BAR,__2.LAYOUT,orientation.POSITIONED,(0,__1.getClassName)(this.attrs))},content:{wml:{id:"content"},class:exports.ACTION_BAR_CONTENT}}}}exports.ActionBar=ActionBar},{"../":174,"../..":169,"../../content/orientation":120,"../../util":188,"./wml/action-bar":171}],171:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class Main{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("div",{wml:{id:__context.values.root.wml.id},id:__context.values.root.id,class:__context.values.root.className},[__this.node("div",{wml:{id:__context.values.content.wml.id},class:__context.values.content.class},[...__context.children])])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.Main=Main},{"@quenk/noni/lib/data/maybe":77,"@quenk/wml/lib/dom":189}],172:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Column=exports.Row=exports.GridLayout=exports.GRID_LAYOUT_COLUMN=exports.GRID_LAYOUT_ROW=exports.GRID_LAYOUT=void 0;const views=require("./wml/grid");const util_1=require("../../util");const __1=require("../");exports.GRID_LAYOUT="ww-grid-layout";exports.GRID_LAYOUT_ROW="ww-grid-layout__row";exports.GRID_LAYOUT_COLUMN="ww-grid-layout__column";class GridLayout extends __1.AbstractLayout{constructor(){super(...arguments);this.view=new views.GridLayout(this);this.values={content:{id:this.attrs&&this.attrs.id,wml:{id:"root"},className:()=>{let c=this.attrs&&this.attrs.className?this.attrs.className:"";return(0,util_1.concat)(exports.GRID_LAYOUT,__1.LAYOUT,c)}}}}}exports.GridLayout=GridLayout;class Row extends __1.AbstractLayout{constructor(){super(...arguments);this.view=new views.Row(this);this.values={content:{id:this.attrs&&this.attrs.id,wml:{id:"row"},className:()=>{let c=this.attrs&&this.attrs.className?this.attrs.className:"";return(0,util_1.concat)(exports.GRID_LAYOUT_ROW,c)}}}}}exports.Row=Row;class Column extends __1.AbstractLayout{constructor(){super(...arguments);this.view=new views.Column(this);this.values={content:{id:this.attrs&&this.attrs.id,wml:{id:"column"},className:()=>{if(this.attrs!=null){return(0,util_1.concat)(exports.GRID_LAYOUT_COLUMN,this.attrs.span?`-span${this.attrs.span}`:"-span12",this.attrs.offset?`-offset${this.attrs.offset}`:"",this.attrs.className)}else{return(0,util_1.concat)(exports.GRID_LAYOUT_COLUMN,"-span12")}}}}}}exports.Column=Column},{"../":174,"../../util":188,"./wml/grid":173}],173:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Column=exports.Row=exports.GridLayout=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class GridLayout{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("div",{wml:{id:__context.values.content.wml.id},id:__context.values.content.id,class:__context.values.content.className()},[...__context.children])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.GridLayout=GridLayout;class Row{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("div",{wml:{id:__context.values.content.wml.id},id:__context.values.content.id,class:__context.values.content.className()},[...__context.children])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.Row=Row;class Column{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("div",{wml:{id:__context.values.content.wml.id},id:__context.values.content.id,class:__context.values.content.className()},[...__context.children])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.Column=Column},{"@quenk/noni/lib/data/maybe":77,"@quenk/wml/lib/dom":189}],174:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.doRemoveContent=exports.doSetContent=exports.AbstractLayout=exports.LAYOUT=void 0;const wml_1=require("@quenk/wml");const util_1=require("../util");exports.LAYOUT="-layout";class AbstractLayout extends wml_1.Component{setContent(c){(0,exports.doSetContent)(this.view,this.values.content.wml.id,c);return this}removeContent(){(0,exports.doRemoveContent)(this.view,this.values.content.wml.id);return this}}exports.AbstractLayout=AbstractLayout;const doSetContent=(view,id,content)=>{let maybeRoot=view.findById(id);if(maybeRoot.isNothing())return(0,util_1.warnMissing)(view,id);let n=maybeRoot.get();while(n.firstChild)n.removeChild(n.firstChild);content=Array.isArray(content)?content:[content];for(let i=0;i<content.length;i++)n.appendChild(content[i])};exports.doSetContent=doSetContent;const doRemoveContent=(view,id)=>{let maybeNode=view.findById(id);if(maybeNode.isNothing())return(0,util_1.warnMissing)(view,id);let n=maybeNode.get();while(n.firstChild)n.removeChild(n.firstChild)};exports.doRemoveContent=doRemoveContent},{"../util":188,"@quenk/wml":190}],175:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.PanelFooter=exports.PanelBody=exports.PanelHeader=exports.Panel=exports.PANEL_FOOTER=exports.PANEL_BODY=exports.PANEL_HEADER=exports.PANEL=void 0;const style=require("../../content/style");const views=require("./wml/panel");const util_1=require("../../util");const __1=require("..");exports.PANEL="ww-panel";exports.PANEL_HEADER="ww-panel__header";exports.PANEL_BODY="ww-panel__body";exports.PANEL_FOOTER="ww-panel__footer";class Panel extends __1.AbstractLayout{constructor(){super(...arguments);this.view=new views.Panel(this);this.values={content:{id:this.attrs&&this.attrs.id,wml:{id:"panel"},className:(0,util_1.concat)(exports.PANEL,__1.LAYOUT,this.attrs&&this.attrs.style?`-${this.attrs.style}`:style.DEFAULT,this.attrs&&this.attrs.className?this.attrs.className:"")}}}}exports.Panel=Panel;class PanelHeader extends __1.AbstractLayout{constructor(){super(...arguments);this.view=new views.PanelHeader(this);this.values={content:{wml:{id:"header"},id:this.attrs&&this.attrs.id,className:(0,util_1.concat)(exports.PANEL_HEADER,__1.LAYOUT,this.attrs&&this.attrs.className?this.attrs.className:"")}}}}exports.PanelHeader=PanelHeader;class PanelBody extends __1.AbstractLayout{constructor(){super(...arguments);this.view=new views.PanelBody(this);this.values={content:{wml:{id:"body"},id:this.attrs&&this.attrs.id,className:(0,util_1.concat)(exports.PANEL_BODY,__1.LAYOUT,this.attrs&&this.attrs.className?this.attrs.className:"")}}}}exports.PanelBody=PanelBody;class PanelFooter extends __1.AbstractLayout{constructor(){super(...arguments);this.view=new views.PanelFooter(this);this.values={content:{wml:{id:"footer"},id:this.attrs&&this.attrs.id,className:(0,util_1.concat)(exports.PANEL_FOOTER,__1.LAYOUT,this.attrs&&this.attrs.className?this.attrs.className:"")}}}}exports.PanelFooter=PanelFooter},{"..":174,"../../content/style":125,"../../util":188,"./wml/panel":176}],176:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.PanelFooter=exports.PanelBody=exports.PanelHeader=exports.Panel=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class Panel{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("div",{wml:{id:__context.values.content.id},class:__context.values.content.className},[...__context.children])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.Panel=Panel;class PanelHeader{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("div",{wml:{id:__context.values.content.id},class:__context.values.content.className},[...__context.children])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.PanelHeader=PanelHeader;class PanelBody{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("div",{wml:{id:__context.values.content.id},class:__context.values.content.className},[...__context.children])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.PanelBody=PanelBody;class PanelFooter{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("div",{wml:{id:__context.values.content.id},class:__context.values.content.className},[...__context.children])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.PanelFooter=PanelFooter},{"@quenk/noni/lib/data/maybe":77,"@quenk/wml/lib/dom":189}],177:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TableLayout=exports.TableWindow=exports.TableCell=exports.TableHeading=exports.TableRow=exports.TableFooter=exports.TableBody=exports.TableHeader=exports.HOVERABLE=exports.ALTERNATE=exports.COMPACT=exports.BORDERED=exports.TABLE_WINDOW=exports.TABLE_LAYOUT=exports.TABLE_CELL=exports.TABLE_HEADING=exports.TABLE_ROW=exports.TABLE_FOOTER=exports.TABLE_BODY=exports.TABLE_HEADER=void 0;const views=require("./wml/table");const wml_1=require("@quenk/wml");const util_1=require("../../util");const __1=require("../../");exports.TABLE_HEADER="ww-table-layout__header";exports.TABLE_BODY="ww-table-layout__body";exports.TABLE_FOOTER="ww-table-layout__footer";exports.TABLE_ROW="ww-table-layout__row";exports.TABLE_HEADING="ww-table-layout _heading";exports.TABLE_CELL="ww-table-layout__cell";exports.TABLE_LAYOUT="ww-table-layout";exports.TABLE_WINDOW="ww-table-window";exports.BORDERED="-bordered";exports.COMPACT="-compact";exports.ALTERNATE="-alternate";exports.HOVERABLE="-hoverable";class TableHeader extends wml_1.Component{constructor(){super(...arguments);this.view=new views.TableHeader(this);this.values={id:(0,__1.getId)(this.attrs),className:(0,util_1.concat)(exports.TABLE_HEADER,(0,__1.getClassName)(this.attrs))}}}exports.TableHeader=TableHeader;class TableBody extends wml_1.Component{constructor(){super(...arguments);this.view=new views.TableBody(this);this.values={id:(0,__1.getId)(this.attrs),className:(0,util_1.concat)(exports.TABLE_BODY,(0,__1.getClassName)(this.attrs))}}}exports.TableBody=TableBody;class TableFooter extends wml_1.Component{constructor(){super(...arguments);this.view=new views.TableFooter(this);this.values={id:(0,__1.getId)(this.attrs),className:(0,util_1.concat)(exports.TABLE_FOOTER,(0,__1.getClassName)(this.attrs))}}}exports.TableFooter=TableFooter;class TableRow extends wml_1.Component{constructor(){super(...arguments);this.view=new views.TableRow(this);this.values={id:(0,__1.getId)(this.attrs),className:(0,util_1.concat)(exports.TABLE_ROW,(0,__1.getClassName)(this.attrs)),onclick:this.attrs&&this.attrs.onclick?this.attrs.onclick:undefined}}}exports.TableRow=TableRow;class TableHeading extends wml_1.Component{constructor(){super(...arguments);this.view=new views.TableHeading(this);this.values={id:(0,__1.getId)(this.attrs),className:(0,util_1.concat)(exports.TABLE_HEADING,(0,__1.getClassName)(this.attrs)),onclick:this.attrs&&this.attrs.onclick?this.attrs.onclick:undefined}}}exports.TableHeading=TableHeading;class TableCell extends wml_1.Component{constructor(){super(...arguments);this.view=new views.TableCell(this);this.values={id:(0,__1.getId)(this.attrs),className:(0,util_1.concat)(exports.TABLE_CELL,(0,__1.getClassName)(this.attrs)),colspan:this.attrs&&this.attrs.colspan?this.attrs.colspan:1,rowspan:this.attrs&&this.attrs.rowspan?this.attrs.rowspan:1,onclick:this.attrs&&this.attrs.onclick?this.attrs.onclick:undefined}}}exports.TableCell=TableCell;class TableWindow extends wml_1.Component{constructor(){super(...arguments);this.view=new views.TableWindow(this);this.values={id:(0,__1.getId)(this.attrs),className:(0,util_1.concat)(exports.TABLE_WINDOW,(0,__1.getClassName)(this.attrs))}}}exports.TableWindow=TableWindow;class TableLayout extends wml_1.Component{constructor(){super(...arguments);this.view=new views.TableLayout(this);this.values={wml:{id:"table"},id:(0,__1.getId)(this.attrs),className:(0,util_1.concat)(exports.TABLE_LAYOUT,(0,__1.getClassName)(this.attrs),this.attrs&&this.attrs.alternate?exports.ALTERNATE:"",this.attrs&&this.attrs.bordered?exports.BORDERED:"",this.attrs&&this.attrs.compact?exports.COMPACT:"",this.attrs&&this.attrs.hoverable?exports.HOVERABLE:"")}}}exports.TableLayout=TableLayout},{"../../":169,"../../util":188,"./wml/table":178,"@quenk/wml":190}],178:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.TableLayout=exports.TableWindow=exports.TableCell=exports.TableHeading=exports.TableRow=exports.TableFooter=exports.TableBody=exports.TableHeader=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class TableHeader{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("thead",{id:__context.values.id,class:__context.values.className},[...__context.children])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.TableHeader=TableHeader;class TableBody{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("tbody",{id:__context.values.id,class:__context.values.className},[...__context.children])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.TableBody=TableBody;class TableFooter{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("tfoot",{id:__context.values.id,class:__context.values.className},[...__context.children])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.TableFooter=TableFooter;class TableRow{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("tr",{id:__context.values.id,class:__context.values.className,onclick:__context.values.onclick},[...__context.children])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.TableRow=TableRow;class TableHeading{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("th",{id:__context.values.id,class:__context.values.className,onclick:__context.values.onclick},[...__context.children])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.TableHeading=TableHeading;class TableCell{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("td",{id:__context.values.id,class:__context.values.className,colspan:String(__context.values.colspan),rowspan:String(__context.values.rowspan),onclick:__context.values.onclick},[...__context.children])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.TableCell=TableCell;class TableWindow{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("div",{id:__context.values.id,class:__context.values.className},[...__context.children])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.TableWindow=TableWindow;class TableLayout{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("table",{id:__context.values.id,class:__context.values.className},[...__context.children])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.TableLayout=TableLayout},{"@quenk/noni/lib/data/maybe":77,"@quenk/wml/lib/dom":189}],179:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MenuHeader=exports.MENU_HEADER=void 0;const wml=require("@quenk/wml");const document=require("@quenk/wml/lib/dom");const views=require("./wml/header");const util_1=require("../../util");exports.MENU_HEADER="ww-menu-header";class MenuHeader extends wml.Component{constructor(){super(...arguments);this.view=new views.Main(this);this.values={span:{id:this.attrs&&this.attrs.id?this.attrs.id:"",className:(0,util_1.concat)(exports.MENU_HEADER,this.attrs&&this.attrs.className?this.attrs.className:"")},text:this.attrs&&this.attrs.text?[document.createTextNode(this.attrs.text)]:this.children}}}exports.MenuHeader=MenuHeader},{"../../util":188,"./wml/header":180,"@quenk/wml":190,"@quenk/wml/lib/dom":189}],180:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class Main{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("span",{id:__context.values.span.id,class:__context.values.span.className},[...__context.values.text])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.Main=Main},{"@quenk/noni/lib/data/maybe":77,"@quenk/wml/lib/dom":189}],181:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Item=exports.Divider=exports.ItemClickedEvent=exports.DIVIDER=exports.ITEM=void 0;const wml=require("@quenk/wml");const document=require("@quenk/wml/lib/dom");const views=require("./wml/item");const active_1=require("../../content/state/active");const active_2=require("../../content/state/active");const util_1=require("../../util");exports.ITEM="ww-menu-item";exports.DIVIDER="ww-menu-divider";class ItemClickedEvent{constructor(name){this.name=name}}exports.ItemClickedEvent=ItemClickedEvent;class Divider extends wml.Component{constructor(){super(...arguments);this.view=new views.DividerView(this);this.values={className:exports.DIVIDER}}}exports.Divider=Divider;class Item extends wml.Component{constructor(){super(...arguments);this.view=new views.Main(this);this.values={root:{wml:{id:"root"},id:this.attrs&&this.attrs.id?this.attrs.id:"",className:(0,util_1.concat)(exports.ITEM,this.attrs&&this.attrs.active?active_2.ACTIVE:""),content:{render:()=>{if(this.attrs&&this.attrs.text)return[document.createTextNode(this.attrs.text)];else return this.children}}}}}activate(){(0,active_1.activate)(this.view,this.values.root.wml.id);return this}deactivate(){(0,active_1.deactivate)(this.view,this.values.root.wml.id);return this}}exports.Item=Item},{"../../content/state/active":122,"../../util":188,"./wml/item":182,"@quenk/wml":190,"@quenk/wml/lib/dom":189}],182:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Main=exports.DividerView=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class DividerView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("li",{class:__context.values.className},[])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.DividerView=DividerView;class Main{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("li",{wml:{id:__context.values.root.wml.id},id:__context.values.root.id,class:__context.values.root.className},[...__context.values.root.content.render()])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.Main=Main},{"@quenk/noni/lib/data/maybe":77,"@quenk/wml/lib/dom":189}],183:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Menu=exports.HeaderItem=exports.CONTENT_MODE=exports.NAV_MODE=exports.MENU_HEADER_ITEM=exports.MENU=void 0;const hidden=require("../../content/state/hidden");const headerViews=require("./wml/header");const wml_1=require("@quenk/wml");const dom_1=require("@quenk/wml/lib/dom");const util_1=require("../../util");const orientation_1=require("../../content/orientation");const __1=require("../../");const menu_1=require("./wml/menu");exports.MENU="ww-menu";exports.MENU_HEADER_ITEM="ww-menu__header-item";exports.NAV_MODE="nav";exports.CONTENT_MODE="content";class HeaderItem extends wml_1.Component{constructor(){super(...arguments);this.view=new headerViews.Main(this);this.values={root:{className:(0,util_1.concat)(exports.MENU_HEADER_ITEM,(0,__1.getClassName)(this.attrs)),content:this.attrs&&this.attrs.text?[(0,dom_1.text)(this.attrs.text)]:this.children}}}}exports.HeaderItem=HeaderItem;class Menu extends wml_1.Component{constructor(){super(...arguments);this.view=new menu_1.Main(this);this.values={root:{wml:{id:"root"},id:(0,__1.getId)(this.attrs),className:(0,util_1.concat)(exports.MENU,(0,__1.getClassName)(this.attrs),this.attrs&&this.attrs.hidden?hidden.HIDDEN:"",this.attrs&&this.attrs.block?orientation_1.BLOCK:"")},menu:{id:"menu"},content:()=>this.children}}isHidden(){return hidden.isHidden(this.view,this.values.root.wml.id)}hide(){hidden.hide(this.view,this.values.root.wml.id);return this}show(){hidden.show(this.view,this.values.root.wml.id);return this}toggle(){hidden.toggle(this.view,this.values.root.wml.id);return this}setContent(content){this.values.content=(()=>content);this.view.invalidate();this.show();return this}}exports.Menu=Menu},{"../../":169,"../../content/orientation":120,"../../content/state/hidden":124,"../../util":188,"./wml/header":184,"./wml/menu":185,"@quenk/wml":190,"@quenk/wml/lib/dom":189}],184:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class Main{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("li",{class:__context.values.root.className},[...__context.values.root.content])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.Main=Main},{"@quenk/noni/lib/data/maybe":77,"@quenk/wml/lib/dom":189}],185:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class Main{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("ul",{wml:{id:__context.values.root.wml.id},id:__context.values.root.id,class:__context.values.root.className},[...__context.values.content()])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.Main=Main},{"@quenk/noni/lib/data/maybe":77,"@quenk/wml/lib/dom":189}],186:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.NavMenu=exports.NAV_MENU=exports.Link=exports.Item=void 0;const wml=require("@quenk/wml");const util=require("../../util");const record_1=require("@quenk/noni/lib/data/record");const type_1=require("@quenk/noni/lib/data/type");const orientation_1=require("../../content/orientation");const view_1=require("./view");var item_1=require("../item");Object.defineProperty(exports,"Item",{enumerable:true,get:function(){return item_1.Item}});var link_1=require("../../content/link");Object.defineProperty(exports,"Link",{enumerable:true,get:function(){return link_1.Link}});exports.NAV_MENU="ww-nav-menu";class NavMenu extends wml.Component{constructor(){super(...arguments);this.view=new view_1.NavMenuView(this);this.values={id:this.attrs.id,className:util.concat(exports.NAV_MENU,this.attrs.className,this.attrs.vertical?orientation_1.VERTICAL:""),items:expand(this.attrs.items||[])}}}exports.NavMenu=NavMenu;const expand=spec=>{let list=Array.isArray(spec)?spec:[spec];return list.reduce((expanded,item)=>{if((0,type_1.isString)(item)){return[...expanded,{type:"header",text:item}]}else if((0,type_1.isObject)(item)){return[...expanded,(0,record_1.mapTo)(item,(val,text)=>{if((0,type_1.isFunction)(val))return{type:"link",name:text,text:text,onClick:val};else if((0,type_1.isObject)(val))return(0,record_1.merge)({type:"link",name:text,text:text},val);else return{type:"link",name:text,text:text,href:String(val)}})]}else if(Array.isArray(item)){return[...expanded,{type:"menu",items:item}]}else{return expanded}},[])}},{"../../content/link":118,"../../content/orientation":120,"../../util":188,"../item":181,"./view":187,"@quenk/noni/lib/data/record":78,"@quenk/noni/lib/data/type":81,"@quenk/wml":190}],187:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.NavMenuView=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const item_1=require("../item");const header_1=require("../header");const link_1=require("../../content/link");const _1=require(".");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class NavMenuView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("ul",{id:__context.values.id,class:__context.values.className},[...__forIn(__context.values.items,(item,_$$i,_$$all)=>[__this.widget(new item_1.Item({},[...item["type"]==="header"?(()=>[__this.widget(new header_1.MenuHeader(item,[]),item)])():(()=>[...item["type"]==="link"?(()=>[__this.widget(new link_1.Link(item,[]),item)])():(()=>[...item["type"]==="menu"?(()=>[__this.widget(new _1.NavMenu(item,[]),item)])():(()=>[])()])()])()]),{})],()=>[]),...__context.children])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.NavMenuView=NavMenuView},{".":186,"../../content/link":118,"../header":179,"../item":181,"@quenk/noni/lib/data/maybe":77,"@quenk/wml/lib/dom":189}],188:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.debounce=exports.replaceContent=exports.noop=exports.concat=exports.combine=exports.warnMissing=exports.getById=void 0;const getById=(view,id)=>{let m=view.findById(id);if(m.isNothing()){(0,exports.warnMissing)(view,id)}return m};exports.getById=getById;const warnMissing=(view,id)=>{console.warn("The view ",view,` does not have an id "${id}"!`)};exports.warnMissing=warnMissing;const combine=(str,joiner=" ")=>str.filter(s=>s!=null||s!="").join(joiner);exports.combine=combine;const concat=(...str)=>str.filter(s=>s==null||s==""?false:true).map(s=>s.trim()).join(" ");exports.concat=concat;const noop=()=>{};exports.noop=noop;const replaceContent=(r,node)=>{while(node.lastChild)node.removeChild(node.lastChild);node.appendChild(r.render())};exports.replaceContent=replaceContent;const debounce=(f,delay)=>{let timer=-1;return delay===0?f:a=>{if(timer===-1){timer=window.setTimeout(()=>f(a),delay)}else{clearTimeout(timer);timer=window.setTimeout(()=>f(a),delay)}}};exports.debounce=debounce},{}],189:[function(require,module,exports){(function(global){(function(){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.createElement=exports.unsafe=exports.text=exports.createUnsafeNode=exports.createTextNode=exports.escapeHTML=exports.escapeAttrValue=exports.escapeAttrs=exports.isBrowser=exports.WMLDOMElement=exports.WMLDOMText=exports.WMLDOMNode=exports.WMLNodeList=void 0;const record_1=require("@quenk/noni/lib/data/record");const type_1=require("@quenk/noni/lib/data/type");let window=global;let document=global.document;const DOCTYPE="<!DOCTYPE html>";const ATTR_ESC_MAP={"&":"\\u0026",">":"\\u003e","<":"\\u003c",'"':"\\u0022","=":"\\u003d","\\":"\\u005c","\u2028":"\\u2028","\u2029":"\\u2029"};const attrsEscRegex=new RegExp(`[${(0,record_1.mapTo)(ATTR_ESC_MAP,(_,k)=>k)}]`,"g");const HTML_ENT_MAP={'"':"&quot;","&":"&amp;","'":"&apos;","<":"&lt;",">":"&gt;"};const htmlEscRegex=new RegExp(`[${(0,record_1.mapTo)(HTML_ENT_MAP,(_,k)=>k)}]`,"g");const voidElements=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];class WMLNodeList{constructor(){this.length=0}item(){return null}forEach(){}}exports.WMLNodeList=WMLNodeList;class WMLDOMNode{constructor(nodeName,nodeType){this.nodeName=nodeName;this.nodeType=nodeType;this.ATTRIBUTE_NODE=-1;this.CDATA_SECTION_NODE=-1;this.COMMENT_NODE=-1;this.DOCUMENT_FRAGMENT_NODE=-1;this.DOCUMENT_NODE=-1;this.DOCUMENT_POSITION_CONTAINED_BY=-1;this.DOCUMENT_POSITION_CONTAINS=-1;this.DOCUMENT_POSITION_DISCONNECTED=-1;this.DOCUMENT_POSITION_FOLLOWING=-1;this.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=-1;this.DOCUMENT_POSITION_PRECEDING=-1;this.DOCUMENT_TYPE_NODE=-1;this.ELEMENT_NODE=-1;this.ENTITY_NODE=-1;this.ENTITY_REFERENCE_NODE=-1;this.NOTATION_NODE=-1;this.PROCESSING_INSTRUCTION_NODE=-1;this.TEXT_NODE=-1;this.baseURI="";this.childNodes=new WMLNodeList;this.firstChild=null;this.isConnected=false;this.lastChild=null;this.namespaceURI=null;this.nextSibling=null;this.nodeValue=null;this.ownerDocument=null;this.parentElement=null;this.parentNode=null;this.previousSibling=null}get textContent(){return""}addEventListener(){}dispatchEvent(){return false}removeEventListener(){}appendChild(newChild){return newChild}cloneNode(){return this}compareDocumentPosition(){return 0}contains(){return false}getRootNode(){return this}hasChildNodes(){return false}insertBefore(newChild){return newChild}isDefaultNamespace(){return false}isEqualNode(){return false}isSameNode(){return false}lookupNamespaceURI(){return null}lookupPrefix(){return null}normalize(){}remove(){}before(){}after(){}replaceWith(){}removeChild(oldChild){return oldChild}replaceChild(_,oldChild){return oldChild}}exports.WMLDOMNode=WMLDOMNode;class WMLDOMText extends WMLDOMNode{constructor(value,escape=true){super("#text",-1);this.value=value;this.escape=escape}get textContent(){return this.escape?(0,exports.escapeHTML)(this.value):this.value}}exports.WMLDOMText=WMLDOMText;class WMLDOMElement extends WMLDOMNode{constructor(tag,attrs,children=[]){super(tag,-1);this.tag=tag;this.attrs=attrs;this.children=children}get innerHTML(){return this.children.map(c=>c.nodeName==="#text"?c.textContent:c.outerHTML).join("")}get outerHTML(){let{tag:tag}=this;let content=this.innerHTML;let attrs=(0,record_1.mapTo)((0,exports.escapeAttrs)(this.attrs),(value,name)=>!value?name:`${name}="${value}"`).join(" ");attrs=attrs.trim()!=""?` ${attrs}`:"";let open=`<${tag}${attrs}>`;if(tag==="html")open=`${DOCTYPE}${open}`;return voidElements.indexOf(tag)>-1?open:`${open}${content}</${tag}>`}setAttribute(key,value){this.attrs[key]=value}appendChild(newChild){this.children.push(newChild);return newChild}}exports.WMLDOMElement=WMLDOMElement;exports.isBrowser=window!=null&&document!=null;const escapeAttrs=attrs=>(0,record_1.map)(attrs,value=>(0,type_1.isFunction)(value)?value:value instanceof WMLDOMText?value.textContent:(0,exports.escapeAttrValue)(String(value)));exports.escapeAttrs=escapeAttrs;const escapeAttrValue=value=>value.replace(attrsEscRegex,hit=>ATTR_ESC_MAP[hit]);exports.escapeAttrValue=escapeAttrValue;const escapeHTML=value=>value.replace(htmlEscRegex,hit=>HTML_ENT_MAP[hit]);exports.escapeHTML=escapeHTML;const createTextNode=txt=>{let str=String(txt==null?"":txt);return exports.isBrowser?document.createTextNode(str):new WMLDOMText(str)};exports.createTextNode=createTextNode;exports.text=exports.createTextNode;const createUnsafeNode=txt=>{let str=String(txt==null?"":txt);return exports.isBrowser?createBrowserUnsafeNode(str):new WMLDOMText(str,false)};exports.createUnsafeNode=createUnsafeNode;exports.unsafe=exports.createUnsafeNode;const createBrowserUnsafeNode=html=>{let tmpl=document.createElement("template");tmpl.innerHTML=html;return tmpl.content};const createElement=(tag,attrs={},children=[])=>{if(!exports.isBrowser){return new WMLDOMElement(tag,attrs,children)}else{let e=document.createElement(tag);(0,record_1.forEach)(attrs,(value,key)=>{if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":e.appendChild(document.createTextNode(""+c));case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});return e}};exports.createElement=createElement}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"@quenk/noni/lib/data/record":78,"@quenk/noni/lib/data/type":81}],190:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.renderAsNode=exports.Component=void 0;class Component{constructor(attrs,children){this.attrs=attrs;this.children=children}rendered(){}removed(){}render(){return this.view.render()}}exports.Component=Component;const renderAsNode=r=>r.render();exports.renderAsNode=renderAsNode},{}],191:[function(require,module,exports){},{}],192:[function(require,module,exports){"use strict";var GetIntrinsic=require("get-intrinsic");var callBind=require("./");var $indexOf=callBind(GetIntrinsic("String.prototype.indexOf"));module.exports=function callBoundIntrinsic(name,allowMissing){var intrinsic=GetIntrinsic(name,!!allowMissing);if(typeof intrinsic==="function"&&$indexOf(name,".prototype.")>-1){return callBind(intrinsic)}return intrinsic}},{"./":193,"get-intrinsic":196}],193:[function(require,module,exports){"use strict";var bind=require("function-bind");var GetIntrinsic=require("get-intrinsic");var $apply=GetIntrinsic("%Function.prototype.apply%");var $call=GetIntrinsic("%Function.prototype.call%");var $reflectApply=GetIntrinsic("%Reflect.apply%",true)||bind.call($call,$apply);var $gOPD=GetIntrinsic("%Object.getOwnPropertyDescriptor%",true);var $defineProperty=GetIntrinsic("%Object.defineProperty%",true);var $max=GetIntrinsic("%Math.max%");if($defineProperty){try{$defineProperty({},"a",{value:1})}catch(e){$defineProperty=null}}module.exports=function callBind(originalFunction){var func=$reflectApply(bind,$call,arguments);if($gOPD&&$defineProperty){var desc=$gOPD(func,"length");if(desc.configurable){$defineProperty(func,"length",{value:1+$max(0,originalFunction.length-(arguments.length-1))})}}return func};var applyBind=function applyBind(){return $reflectApply(bind,$apply,arguments)};if($defineProperty){$defineProperty(module.exports,"apply",{value:applyBind})}else{module.exports.apply=applyBind}},{"function-bind":195,"get-intrinsic":196}],194:[function(require,module,exports){"use strict";var ERROR_MESSAGE="Function.prototype.bind called on incompatible ";var slice=Array.prototype.slice;var toStr=Object.prototype.toString;var funcType="[object Function]";module.exports=function bind(that){var target=this;if(typeof target!=="function"||toStr.call(target)!==funcType){throw new TypeError(ERROR_MESSAGE+target)}var args=slice.call(arguments,1);var bound;var binder=function(){if(this instanceof bound){var result=target.apply(this,args.concat(slice.call(arguments)));if(Object(result)===result){return result}return this}else{return target.apply(that,args.concat(slice.call(arguments)))}};var boundLength=Math.max(0,target.length-args.length);var boundArgs=[];for(var i=0;i<boundLength;i++){boundArgs.push("$"+i)}bound=Function("binder","return function ("+boundArgs.join(",")+"){ return binder.apply(this,arguments); }")(binder);if(target.prototype){var Empty=function Empty(){};Empty.prototype=target.prototype;bound.prototype=new Empty;Empty.prototype=null}return bound}},{}],195:[function(require,module,exports){"use strict";var implementation=require("./implementation");module.exports=Function.prototype.bind||implementation},{"./implementation":194}],196:[function(require,module,exports){"use strict";var undefined;var $SyntaxError=SyntaxError;var $Function=Function;var $TypeError=TypeError;var getEvalledConstructor=function(expressionSyntax){try{return $Function('"use strict"; return ('+expressionSyntax+").constructor;")()}catch(e){}};var $gOPD=Object.getOwnPropertyDescriptor;if($gOPD){try{$gOPD({},"")}catch(e){$gOPD=null}}var throwTypeError=function(){throw new $TypeError};var ThrowTypeError=$gOPD?function(){try{arguments.callee;return throwTypeError}catch(calleeThrows){try{return $gOPD(arguments,"callee").get}catch(gOPDthrows){return throwTypeError}}}():throwTypeError;var hasSymbols=require("has-symbols")();var getProto=Object.getPrototypeOf||function(x){return x.__proto__};var needsEval={};var TypedArray=typeof Uint8Array==="undefined"?undefined:getProto(Uint8Array);var INTRINSICS={"%AggregateError%":typeof AggregateError==="undefined"?undefined:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer==="undefined"?undefined:ArrayBuffer,"%ArrayIteratorPrototype%":hasSymbols?getProto([][Symbol.iterator]()):undefined,"%AsyncFromSyncIteratorPrototype%":undefined,"%AsyncFunction%":needsEval,"%AsyncGenerator%":needsEval,"%AsyncGeneratorFunction%":needsEval,"%AsyncIteratorPrototype%":needsEval,"%Atomics%":typeof Atomics==="undefined"?undefined:Atomics,"%BigInt%":typeof BigInt==="undefined"?undefined:BigInt,"%Boolean%":Boolean,"%DataView%":typeof DataView==="undefined"?undefined:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array==="undefined"?undefined:Float32Array,"%Float64Array%":typeof Float64Array==="undefined"?undefined:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry==="undefined"?undefined:FinalizationRegistry,"%Function%":$Function,"%GeneratorFunction%":needsEval,"%Int8Array%":typeof Int8Array==="undefined"?undefined:Int8Array,"%Int16Array%":typeof Int16Array==="undefined"?undefined:Int16Array,"%Int32Array%":typeof Int32Array==="undefined"?undefined:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":hasSymbols?getProto(getProto([][Symbol.iterator]())):undefined,"%JSON%":typeof JSON==="object"?JSON:undefined,"%Map%":typeof Map==="undefined"?undefined:Map,"%MapIteratorPrototype%":typeof Map==="undefined"||!hasSymbols?undefined:getProto((new Map)[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise==="undefined"?undefined:Promise,"%Proxy%":typeof Proxy==="undefined"?undefined:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect==="undefined"?undefined:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set==="undefined"?undefined:Set,"%SetIteratorPrototype%":typeof Set==="undefined"||!hasSymbols?undefined:getProto((new Set)[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer==="undefined"?undefined:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":hasSymbols?getProto(""[Symbol.iterator]()):undefined,"%Symbol%":hasSymbols?Symbol:undefined,"%SyntaxError%":$SyntaxError,"%ThrowTypeError%":ThrowTypeError,"%TypedArray%":TypedArray,"%TypeError%":$TypeError,"%Uint8Array%":typeof Uint8Array==="undefined"?undefined:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray==="undefined"?undefined:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array==="undefined"?undefined:Uint16Array,"%Uint32Array%":typeof Uint32Array==="undefined"?undefined:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap==="undefined"?undefined:WeakMap,"%WeakRef%":typeof WeakRef==="undefined"?undefined:WeakRef,"%WeakSet%":typeof WeakSet==="undefined"?undefined:WeakSet};var doEval=function doEval(name){var value;if(name==="%AsyncFunction%"){value=getEvalledConstructor("async function () {}")}else if(name==="%GeneratorFunction%"){value=getEvalledConstructor("function* () {}")}else if(name==="%AsyncGeneratorFunction%"){value=getEvalledConstructor("async function* () {}")}else if(name==="%AsyncGenerator%"){var fn=doEval("%AsyncGeneratorFunction%");if(fn){value=fn.prototype}}else if(name==="%AsyncIteratorPrototype%"){var gen=doEval("%AsyncGenerator%");if(gen){value=getProto(gen.prototype)}}INTRINSICS[name]=value;return value};var LEGACY_ALIASES={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]};var bind=require("function-bind");var hasOwn=require("has");var $concat=bind.call(Function.call,Array.prototype.concat);var $spliceApply=bind.call(Function.apply,Array.prototype.splice);var $replace=bind.call(Function.call,String.prototype.replace);var $strSlice=bind.call(Function.call,String.prototype.slice);var $exec=bind.call(Function.call,RegExp.prototype.exec);var rePropName=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g;var reEscapeChar=/\\(\\)?/g;var stringToPath=function stringToPath(string){var first=$strSlice(string,0,1);var last=$strSlice(string,-1);if(first==="%"&&last!=="%"){throw new $SyntaxError("invalid intrinsic syntax, expected closing `%`")}else if(last==="%"&&first!=="%"){throw new $SyntaxError("invalid intrinsic syntax, expected opening `%`")}var result=[];$replace(string,rePropName,function(match,number,quote,subString){result[result.length]=quote?$replace(subString,reEscapeChar,"$1"):number||match});return result};var getBaseIntrinsic=function getBaseIntrinsic(name,allowMissing){var intrinsicName=name;var alias;if(hasOwn(LEGACY_ALIASES,intrinsicName)){alias=LEGACY_ALIASES[intrinsicName];intrinsicName="%"+alias[0]+"%"}if(hasOwn(INTRINSICS,intrinsicName)){var value=INTRINSICS[intrinsicName];if(value===needsEval){value=doEval(intrinsicName)}if(typeof value==="undefined"&&!allowMissing){throw new $TypeError("intrinsic "+name+" exists, but is not available. Please file an issue!")}return{alias:alias,name:intrinsicName,value:value}}throw new $SyntaxError("intrinsic "+name+" does not exist!")};module.exports=function GetIntrinsic(name,allowMissing){if(typeof name!=="string"||name.length===0){throw new $TypeError("intrinsic name must be a non-empty string")}if(arguments.length>1&&typeof allowMissing!=="boolean"){throw new $TypeError('"allowMissing" argument must be a boolean')}if($exec(/^%?[^%]*%?$/,name)===null){throw new $SyntaxError("`%` may not be present anywhere but at the beginning and end of the intrinsic name")}var parts=stringToPath(name);var intrinsicBaseName=parts.length>0?parts[0]:"";var intrinsic=getBaseIntrinsic("%"+intrinsicBaseName+"%",allowMissing);var intrinsicRealName=intrinsic.name;var value=intrinsic.value;var skipFurtherCaching=false;var alias=intrinsic.alias;if(alias){intrinsicBaseName=alias[0];$spliceApply(parts,$concat([0,1],alias))}for(var i=1,isOwn=true;i<parts.length;i+=1){var part=parts[i];var first=$strSlice(part,0,1);var last=$strSlice(part,-1);if((first==='"'||first==="'"||first==="`"||(last==='"'||last==="'"||last==="`"))&&first!==last){throw new $SyntaxError("property names with quotes must have matching quotes")}if(part==="constructor"||!isOwn){skipFurtherCaching=true}intrinsicBaseName+="."+part;intrinsicRealName="%"+intrinsicBaseName+"%";if(hasOwn(INTRINSICS,intrinsicRealName)){value=INTRINSICS[intrinsicRealName]}else if(value!=null){if(!(part in value)){if(!allowMissing){throw new $TypeError("base intrinsic for "+name+" exists, but the property is not available.")}return void undefined}if($gOPD&&i+1>=parts.length){var desc=$gOPD(value,part);isOwn=!!desc;if(isOwn&&"get"in desc&&!("originalValue"in desc.get)){value=desc.get}else{value=value[part]}}else{isOwn=hasOwn(value,part);value=value[part]}if(isOwn&&!skipFurtherCaching){INTRINSICS[intrinsicRealName]=value}}}return value}},{"function-bind":195,has:199,"has-symbols":197}],197:[function(require,module,exports){"use strict";var origSymbol=typeof Symbol!=="undefined"&&Symbol;var hasSymbolSham=require("./shams");module.exports=function hasNativeSymbols(){if(typeof origSymbol!=="function"){return false}if(typeof Symbol!=="function"){return false}if(typeof origSymbol("foo")!=="symbol"){return false}if(typeof Symbol("bar")!=="symbol"){return false}return hasSymbolSham()}},{"./shams":198}],198:[function(require,module,exports){"use strict";module.exports=function hasSymbols(){if(typeof Symbol!=="function"||typeof Object.getOwnPropertySymbols!=="function"){return false}if(typeof Symbol.iterator==="symbol"){return true}var obj={};var sym=Symbol("test");var symObj=Object(sym);if(typeof sym==="string"){return false}if(Object.prototype.toString.call(sym)!=="[object Symbol]"){return false}if(Object.prototype.toString.call(symObj)!=="[object Symbol]"){return false}var symVal=42;obj[sym]=symVal;for(sym in obj){return false}if(typeof Object.keys==="function"&&Object.keys(obj).length!==0){return false}if(typeof Object.getOwnPropertyNames==="function"&&Object.getOwnPropertyNames(obj).length!==0){return false}var syms=Object.getOwnPropertySymbols(obj);if(syms.length!==1||syms[0]!==sym){return false}if(!Object.prototype.propertyIsEnumerable.call(obj,sym)){return false}if(typeof Object.getOwnPropertyDescriptor==="function"){var descriptor=Object.getOwnPropertyDescriptor(obj,sym);if(descriptor.value!==symVal||descriptor.enumerable!==true){return false}}return true}},{}],199:[function(require,module,exports){"use strict";var bind=require("function-bind");module.exports=bind.call(Function.call,Object.prototype.hasOwnProperty)},{"function-bind":195}],200:[function(require,module,exports){(function(global,factory){typeof exports==="object"&&typeof module!=="undefined"?module.exports=factory():typeof define==="function"&&define.amd?define(factory):global.moment=factory()})(this,function(){"use strict";var hookCallback;function hooks(){return hookCallback.apply(null,arguments)}function setHookCallback(callback){hookCallback=callback}function isArray(input){return input instanceof Array||Object.prototype.toString.call(input)==="[object Array]"}function isObject(input){return input!=null&&Object.prototype.toString.call(input)==="[object Object]"}function hasOwnProp(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function isObjectEmpty(obj){if(Object.getOwnPropertyNames){return Object.getOwnPropertyNames(obj).length===0}else{var k;for(k in obj){if(hasOwnProp(obj,k)){return false}}return true}}function isUndefined(input){return input===void 0}function isNumber(input){return typeof input==="number"||Object.prototype.toString.call(input)==="[object Number]"}function isDate(input){return input instanceof Date||Object.prototype.toString.call(input)==="[object Date]"}function map(arr,fn){var res=[],i,arrLen=arr.length;for(i=0;i<arrLen;++i){res.push(fn(arr[i],i))}return res}function extend(a,b){for(var i in b){if(hasOwnProp(b,i)){a[i]=b[i]}}if(hasOwnProp(b,"toString")){a.toString=b.toString}if(hasOwnProp(b,"valueOf")){a.valueOf=b.valueOf}return a}function createUTC(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,true).utc()}function defaultParsingFlags(){return{empty:false,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:false,invalidEra:null,invalidMonth:null,invalidFormat:false,userInvalidated:false,iso:false,parsedDateParts:[],era:null,meridiem:null,rfc2822:false,weekdayMismatch:false}}function getParsingFlags(m){if(m._pf==null){m._pf=defaultParsingFlags()}return m._pf}var some;if(Array.prototype.some){some=Array.prototype.some}else{some=function(fun){var t=Object(this),len=t.length>>>0,i;for(i=0;i<len;i++){if(i in t&&fun.call(this,t[i],i,t)){return true}}return false}}function isValid(m){if(m._isValid==null){var flags=getParsingFlags(m),parsedParts=some.call(flags.parsedDateParts,function(i){return i!=null}),isNowValid=!isNaN(m._d.getTime())&&flags.overflow<0&&!flags.empty&&!flags.invalidEra&&!flags.invalidMonth&&!flags.invalidWeekday&&!flags.weekdayMismatch&&!flags.nullInput&&!flags.invalidFormat&&!flags.userInvalidated&&(!flags.meridiem||flags.meridiem&&parsedParts);if(m._strict){isNowValid=isNowValid&&flags.charsLeftOver===0&&flags.unusedTokens.length===0&&flags.bigHour===undefined}if(Object.isFrozen==null||!Object.isFrozen(m)){m._isValid=isNowValid}else{return isNowValid}}return m._isValid}function createInvalid(flags){var m=createUTC(NaN);if(flags!=null){extend(getParsingFlags(m),flags)}else{getParsingFlags(m).userInvalidated=true}return m}var momentProperties=hooks.momentProperties=[],updateInProgress=false;function copyConfig(to,from){var i,prop,val,momentPropertiesLen=momentProperties.length;if(!isUndefined(from._isAMomentObject)){to._isAMomentObject=from._isAMomentObject}if(!isUndefined(from._i)){to._i=from._i}if(!isUndefined(from._f)){to._f=from._f}if(!isUndefined(from._l)){to._l=from._l}if(!isUndefined(from._strict)){to._strict=from._strict}if(!isUndefined(from._tzm)){to._tzm=from._tzm}if(!isUndefined(from._isUTC)){to._isUTC=from._isUTC}if(!isUndefined(from._offset)){to._offset=from._offset}if(!isUndefined(from._pf)){to._pf=getParsingFlags(from)}if(!isUndefined(from._locale)){to._locale=from._locale}if(momentPropertiesLen>0){for(i=0;i<momentPropertiesLen;i++){prop=momentProperties[i];val=from[prop];if(!isUndefined(val)){to[prop]=val}}}return to}function Moment(config){copyConfig(this,config);this._d=new Date(config._d!=null?config._d.getTime():NaN);if(!this.isValid()){this._d=new Date(NaN)}if(updateInProgress===false){updateInProgress=true;hooks.updateOffset(this);updateInProgress=false}}function isMoment(obj){return obj instanceof Moment||obj!=null&&obj._isAMomentObject!=null}function warn(msg){if(hooks.suppressDeprecationWarnings===false&&typeof console!=="undefined"&&console.warn){console.warn("Deprecation warning: "+msg)}}function deprecate(msg,fn){var firstTime=true;return extend(function(){if(hooks.deprecationHandler!=null){hooks.deprecationHandler(null,msg)}if(firstTime){var args=[],arg,i,key,argLen=arguments.length;for(i=0;i<argLen;i++){arg="";if(typeof arguments[i]==="object"){arg+="\n["+i+"] ";for(key in arguments[0]){if(hasOwnProp(arguments[0],key)){arg+=key+": "+arguments[0][key]+", "}}arg=arg.slice(0,-2)}else{arg=arguments[i]}args.push(arg)}warn(msg+"\nArguments: "+Array.prototype.slice.call(args).join("")+"\n"+(new Error).stack);firstTime=false}return fn.apply(this,arguments)},fn)}var deprecations={};function deprecateSimple(name,msg){if(hooks.deprecationHandler!=null){hooks.deprecationHandler(name,msg)}if(!deprecations[name]){warn(msg);deprecations[name]=true}}hooks.suppressDeprecationWarnings=false;hooks.deprecationHandler=null;function isFunction(input){return typeof Function!=="undefined"&&input instanceof Function||Object.prototype.toString.call(input)==="[object Function]"}function set(config){var prop,i;for(i in config){if(hasOwnProp(config,i)){prop=config[i];if(isFunction(prop)){this[i]=prop}else{this["_"+i]=prop}}}this._config=config;this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function mergeConfigs(parentConfig,childConfig){var res=extend({},parentConfig),prop;for(prop in childConfig){if(hasOwnProp(childConfig,prop)){if(isObject(parentConfig[prop])&&isObject(childConfig[prop])){res[prop]={};extend(res[prop],parentConfig[prop]);extend(res[prop],childConfig[prop])}else if(childConfig[prop]!=null){res[prop]=childConfig[prop]}else{delete res[prop]}}}for(prop in parentConfig){if(hasOwnProp(parentConfig,prop)&&!hasOwnProp(childConfig,prop)&&isObject(parentConfig[prop])){res[prop]=extend({},res[prop])}}return res}function Locale(config){if(config!=null){this.set(config)}}var keys;if(Object.keys){keys=Object.keys}else{keys=function(obj){var i,res=[];for(i in obj){if(hasOwnProp(obj,i)){res.push(i)}}return res}}var defaultCalendar={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function calendar(key,mom,now){var output=this._calendar[key]||this._calendar["sameElse"];return isFunction(output)?output.call(mom,now):output}function zeroFill(number,targetLength,forceSign){var absNumber=""+Math.abs(number),zerosToFill=targetLength-absNumber.length,sign=number>=0;return(sign?forceSign?"+":"":"-")+Math.pow(10,Math.max(0,zerosToFill)).toString().substr(1)+absNumber}var formattingTokens=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,formatFunctions={},formatTokenFunctions={};function addFormatToken(token,padded,ordinal,callback){var func=callback;if(typeof callback==="string"){func=function(){return this[callback]()}}if(token){formatTokenFunctions[token]=func}if(padded){formatTokenFunctions[padded[0]]=function(){return zeroFill(func.apply(this,arguments),padded[1],padded[2])}}if(ordinal){formatTokenFunctions[ordinal]=function(){return this.localeData().ordinal(func.apply(this,arguments),token)}}}function removeFormattingTokens(input){if(input.match(/\[[\s\S]/)){return input.replace(/^\[|\]$/g,"")}return input.replace(/\\/g,"")}function makeFormatFunction(format){var array=format.match(formattingTokens),i,length;for(i=0,length=array.length;i<length;i++){if(formatTokenFunctions[array[i]]){array[i]=formatTokenFunctions[array[i]]}else{array[i]=removeFormattingTokens(array[i])}}return function(mom){var output="",i;for(i=0;i<length;i++){output+=isFunction(array[i])?array[i].call(mom,format):array[i]}return output}}function formatMoment(m,format){if(!m.isValid()){return m.localeData().invalidDate()}format=expandFormat(format,m.localeData());formatFunctions[format]=formatFunctions[format]||makeFormatFunction(format);return formatFunctions[format](m)}function expandFormat(format,locale){var i=5;function replaceLongDateFormatTokens(input){return locale.longDateFormat(input)||input}localFormattingTokens.lastIndex=0;while(i>=0&&localFormattingTokens.test(format)){format=format.replace(localFormattingTokens,replaceLongDateFormatTokens);localFormattingTokens.lastIndex=0;i-=1}return format}var defaultLongDateFormat={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function longDateFormat(key){var format=this._longDateFormat[key],formatUpper=this._longDateFormat[key.toUpperCase()];if(format||!formatUpper){return format}this._longDateFormat[key]=formatUpper.match(formattingTokens).map(function(tok){if(tok==="MMMM"||tok==="MM"||tok==="DD"||tok==="dddd"){return tok.slice(1)}return tok}).join("");return this._longDateFormat[key]}var defaultInvalidDate="Invalid date";function invalidDate(){return this._invalidDate}var defaultOrdinal="%d",defaultDayOfMonthOrdinalParse=/\d{1,2}/;function ordinal(number){return this._ordinal.replace("%d",number)}var defaultRelativeTime={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function relativeTime(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return isFunction(output)?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number)}function pastFuture(diff,output){var format=this._relativeTime[diff>0?"future":"past"];return isFunction(format)?format(output):format.replace(/%s/i,output)}var aliases={};function addUnitAlias(unit,shorthand){var lowerCase=unit.toLowerCase();aliases[lowerCase]=aliases[lowerCase+"s"]=aliases[shorthand]=unit}function normalizeUnits(units){return typeof units==="string"?aliases[units]||aliases[units.toLowerCase()]:undefined}function normalizeObjectUnits(inputObject){var normalizedInput={},normalizedProp,prop;for(prop in inputObject){if(hasOwnProp(inputObject,prop)){normalizedProp=normalizeUnits(prop);if(normalizedProp){normalizedInput[normalizedProp]=inputObject[prop]}}}return normalizedInput}var priorities={};function addUnitPriority(unit,priority){priorities[unit]=priority}function getPrioritizedUnits(unitsObj){var units=[],u;for(u in unitsObj){if(hasOwnProp(unitsObj,u)){units.push({unit:u,priority:priorities[u]})}}units.sort(function(a,b){return a.priority-b.priority});return units}function isLeapYear(year){return year%4===0&&year%100!==0||year%400===0}function absFloor(number){if(number<0){return Math.ceil(number)||0}else{return Math.floor(number)}}function toInt(argumentForCoercion){var coercedNumber=+argumentForCoercion,value=0;if(coercedNumber!==0&&isFinite(coercedNumber)){value=absFloor(coercedNumber)}return value}function makeGetSet(unit,keepTime){return function(value){if(value!=null){set$1(this,unit,value);hooks.updateOffset(this,keepTime);return this}else{return get(this,unit)}}}function get(mom,unit){return mom.isValid()?mom._d["get"+(mom._isUTC?"UTC":"")+unit]():NaN}function set$1(mom,unit,value){if(mom.isValid()&&!isNaN(value)){if(unit==="FullYear"&&isLeapYear(mom.year())&&mom.month()===1&&mom.date()===29){value=toInt(value);mom._d["set"+(mom._isUTC?"UTC":"")+unit](value,mom.month(),daysInMonth(value,mom.month()))}else{mom._d["set"+(mom._isUTC?"UTC":"")+unit](value)}}}function stringGet(units){units=normalizeUnits(units);if(isFunction(this[units])){return this[units]()}return this}function stringSet(units,value){if(typeof units==="object"){units=normalizeObjectUnits(units);var prioritized=getPrioritizedUnits(units),i,prioritizedLen=prioritized.length;for(i=0;i<prioritizedLen;i++){this[prioritized[i].unit](units[prioritized[i].unit])}}else{units=normalizeUnits(units);if(isFunction(this[units])){return this[units](value)}}return this}var match1=/\d/,match2=/\d\d/,match3=/\d{3}/,match4=/\d{4}/,match6=/[+-]?\d{6}/,match1to2=/\d\d?/,match3to4=/\d\d\d\d?/,match5to6=/\d\d\d\d\d\d?/,match1to3=/\d{1,3}/,match1to4=/\d{1,4}/,match1to6=/[+-]?\d{1,6}/,matchUnsigned=/\d+/,matchSigned=/[+-]?\d+/,matchOffset=/Z|[+-]\d\d:?\d\d/gi,matchShortOffset=/Z|[+-]\d\d(?::?\d\d)?/gi,matchTimestamp=/[+-]?\d+(\.\d{1,3})?/,matchWord=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,regexes;regexes={};function addRegexToken(token,regex,strictRegex){regexes[token]=isFunction(regex)?regex:function(isStrict,localeData){return isStrict&&strictRegex?strictRegex:regex}}function getParseRegexForToken(token,config){if(!hasOwnProp(regexes,token)){return new RegExp(unescapeFormat(token))}return regexes[token](config._strict,config._locale)}function unescapeFormat(s){return regexEscape(s.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(matched,p1,p2,p3,p4){return p1||p2||p3||p4}))}function regexEscape(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var tokens={};function addParseToken(token,callback){var i,func=callback,tokenLen;if(typeof token==="string"){token=[token]}if(isNumber(callback)){func=function(input,array){array[callback]=toInt(input)}}tokenLen=token.length;for(i=0;i<tokenLen;i++){tokens[token[i]]=func}}function addWeekParseToken(token,callback){addParseToken(token,function(input,array,config,token){config._w=config._w||{};callback(input,config._w,config,token)})}function addTimeToArrayFromToken(token,input,config){if(input!=null&&hasOwnProp(tokens,token)){tokens[token](input,config._a,config,token)}}var YEAR=0,MONTH=1,DATE=2,HOUR=3,MINUTE=4,SECOND=5,MILLISECOND=6,WEEK=7,WEEKDAY=8;function mod(n,x){return(n%x+x)%x}var indexOf;if(Array.prototype.indexOf){indexOf=Array.prototype.indexOf}else{indexOf=function(o){var i;for(i=0;i<this.length;++i){if(this[i]===o){return i}}return-1}}function daysInMonth(year,month){if(isNaN(year)||isNaN(month)){return NaN}var modMonth=mod(month,12);year+=(month-modMonth)/12;return modMonth===1?isLeapYear(year)?29:28:31-modMonth%7%2}addFormatToken("M",["MM",2],"Mo",function(){return this.month()+1});addFormatToken("MMM",0,0,function(format){return this.localeData().monthsShort(this,format)});addFormatToken("MMMM",0,0,function(format){return this.localeData().months(this,format)});addUnitAlias("month","M");addUnitPriority("month",8);addRegexToken("M",match1to2);addRegexToken("MM",match1to2,match2);addRegexToken("MMM",function(isStrict,locale){return locale.monthsShortRegex(isStrict)});addRegexToken("MMMM",function(isStrict,locale){return locale.monthsRegex(isStrict)});addParseToken(["M","MM"],function(input,array){array[MONTH]=toInt(input)-1});addParseToken(["MMM","MMMM"],function(input,array,config,token){var month=config._locale.monthsParse(input,token,config._strict);if(month!=null){array[MONTH]=month}else{getParsingFlags(config).invalidMonth=input}});var defaultLocaleMonths="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),defaultLocaleMonthsShort="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),MONTHS_IN_FORMAT=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,defaultMonthsShortRegex=matchWord,defaultMonthsRegex=matchWord;function localeMonths(m,format){if(!m){return isArray(this._months)?this._months:this._months["standalone"]}return isArray(this._months)?this._months[m.month()]:this._months[(this._months.isFormat||MONTHS_IN_FORMAT).test(format)?"format":"standalone"][m.month()]}function localeMonthsShort(m,format){if(!m){return isArray(this._monthsShort)?this._monthsShort:this._monthsShort["standalone"]}return isArray(this._monthsShort)?this._monthsShort[m.month()]:this._monthsShort[MONTHS_IN_FORMAT.test(format)?"format":"standalone"][m.month()]}function handleStrictParse(monthName,format,strict){var i,ii,mom,llc=monthName.toLocaleLowerCase();if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[];for(i=0;i<12;++i){mom=createUTC([2e3,i]);this._shortMonthsParse[i]=this.monthsShort(mom,"").toLocaleLowerCase();this._longMonthsParse[i]=this.months(mom,"").toLocaleLowerCase()}}if(strict){if(format==="MMM"){ii=indexOf.call(this._shortMonthsParse,llc);return ii!==-1?ii:null}else{ii=indexOf.call(this._longMonthsParse,llc);return ii!==-1?ii:null}}else{if(format==="MMM"){ii=indexOf.call(this._shortMonthsParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._longMonthsParse,llc);return ii!==-1?ii:null}else{ii=indexOf.call(this._longMonthsParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._shortMonthsParse,llc);return ii!==-1?ii:null}}}function localeMonthsParse(monthName,format,strict){var i,mom,regex;if(this._monthsParseExact){return handleStrictParse.call(this,monthName,format,strict)}if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[]}for(i=0;i<12;i++){mom=createUTC([2e3,i]);if(strict&&!this._longMonthsParse[i]){this._longMonthsParse[i]=new RegExp("^"+this.months(mom,"").replace(".","")+"$","i");this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(mom,"").replace(".","")+"$","i")}if(!strict&&!this._monthsParse[i]){regex="^"+this.months(mom,"")+"|^"+this.monthsShort(mom,"");this._monthsParse[i]=new RegExp(regex.replace(".",""),"i")}if(strict&&format==="MMMM"&&this._longMonthsParse[i].test(monthName)){return i}else if(strict&&format==="MMM"&&this._shortMonthsParse[i].test(monthName)){return i}else if(!strict&&this._monthsParse[i].test(monthName)){return i}}}function setMonth(mom,value){var dayOfMonth;if(!mom.isValid()){return mom}if(typeof value==="string"){if(/^\d+$/.test(value)){value=toInt(value)}else{value=mom.localeData().monthsParse(value);if(!isNumber(value)){return mom}}}dayOfMonth=Math.min(mom.date(),daysInMonth(mom.year(),value));mom._d["set"+(mom._isUTC?"UTC":"")+"Month"](value,dayOfMonth);return mom}function getSetMonth(value){if(value!=null){setMonth(this,value);hooks.updateOffset(this,true);return this}else{return get(this,"Month")}}function getDaysInMonth(){return daysInMonth(this.year(),this.month())}function monthsShortRegex(isStrict){if(this._monthsParseExact){if(!hasOwnProp(this,"_monthsRegex")){computeMonthsParse.call(this)}if(isStrict){return this._monthsShortStrictRegex}else{return this._monthsShortRegex}}else{if(!hasOwnProp(this,"_monthsShortRegex")){this._monthsShortRegex=defaultMonthsShortRegex}return this._monthsShortStrictRegex&&isStrict?this._monthsShortStrictRegex:this._monthsShortRegex}}function monthsRegex(isStrict){if(this._monthsParseExact){if(!hasOwnProp(this,"_monthsRegex")){computeMonthsParse.call(this)}if(isStrict){return this._monthsStrictRegex}else{return this._monthsRegex}}else{if(!hasOwnProp(this,"_monthsRegex")){this._monthsRegex=defaultMonthsRegex}return this._monthsStrictRegex&&isStrict?this._monthsStrictRegex:this._monthsRegex}}function computeMonthsParse(){function cmpLenRev(a,b){return b.length-a.length}var shortPieces=[],longPieces=[],mixedPieces=[],i,mom;for(i=0;i<12;i++){mom=createUTC([2e3,i]);shortPieces.push(this.monthsShort(mom,""));longPieces.push(this.months(mom,""));mixedPieces.push(this.months(mom,""));mixedPieces.push(this.monthsShort(mom,""))}shortPieces.sort(cmpLenRev);longPieces.sort(cmpLenRev);mixedPieces.sort(cmpLenRev);for(i=0;i<12;i++){shortPieces[i]=regexEscape(shortPieces[i]);longPieces[i]=regexEscape(longPieces[i])}for(i=0;i<24;i++){mixedPieces[i]=regexEscape(mixedPieces[i])}this._monthsRegex=new RegExp("^("+mixedPieces.join("|")+")","i");this._monthsShortRegex=this._monthsRegex;this._monthsStrictRegex=new RegExp("^("+longPieces.join("|")+")","i");this._monthsShortStrictRegex=new RegExp("^("+shortPieces.join("|")+")","i")}addFormatToken("Y",0,0,function(){var y=this.year();return y<=9999?zeroFill(y,4):"+"+y});addFormatToken(0,["YY",2],0,function(){return this.year()%100});addFormatToken(0,["YYYY",4],0,"year");addFormatToken(0,["YYYYY",5],0,"year");addFormatToken(0,["YYYYYY",6,true],0,"year");addUnitAlias("year","y");addUnitPriority("year",1);addRegexToken("Y",matchSigned);addRegexToken("YY",match1to2,match2);addRegexToken("YYYY",match1to4,match4);addRegexToken("YYYYY",match1to6,match6);addRegexToken("YYYYYY",match1to6,match6);addParseToken(["YYYYY","YYYYYY"],YEAR);addParseToken("YYYY",function(input,array){array[YEAR]=input.length===2?hooks.parseTwoDigitYear(input):toInt(input)});addParseToken("YY",function(input,array){array[YEAR]=hooks.parseTwoDigitYear(input)});addParseToken("Y",function(input,array){array[YEAR]=parseInt(input,10)});function daysInYear(year){return isLeapYear(year)?366:365}hooks.parseTwoDigitYear=function(input){return toInt(input)+(toInt(input)>68?1900:2e3)};var getSetYear=makeGetSet("FullYear",true);function getIsLeapYear(){return isLeapYear(this.year())}function createDate(y,m,d,h,M,s,ms){var date;if(y<100&&y>=0){date=new Date(y+400,m,d,h,M,s,ms);if(isFinite(date.getFullYear())){date.setFullYear(y)}}else{date=new Date(y,m,d,h,M,s,ms)}return date}function createUTCDate(y){var date,args;if(y<100&&y>=0){args=Array.prototype.slice.call(arguments);args[0]=y+400;date=new Date(Date.UTC.apply(null,args));if(isFinite(date.getUTCFullYear())){date.setUTCFullYear(y)}}else{date=new Date(Date.UTC.apply(null,arguments))}return date}function firstWeekOffset(year,dow,doy){var fwd=7+dow-doy,fwdlw=(7+createUTCDate(year,0,fwd).getUTCDay()-dow)%7;return-fwdlw+fwd-1}function dayOfYearFromWeeks(year,week,weekday,dow,doy){var localWeekday=(7+weekday-dow)%7,weekOffset=firstWeekOffset(year,dow,doy),dayOfYear=1+7*(week-1)+localWeekday+weekOffset,resYear,resDayOfYear;if(dayOfYear<=0){resYear=year-1;resDayOfYear=daysInYear(resYear)+dayOfYear}else if(dayOfYear>daysInYear(year)){resYear=year+1;resDayOfYear=dayOfYear-daysInYear(year)}else{resYear=year;resDayOfYear=dayOfYear}return{year:resYear,dayOfYear:resDayOfYear}}function weekOfYear(mom,dow,doy){var weekOffset=firstWeekOffset(mom.year(),dow,doy),week=Math.floor((mom.dayOfYear()-weekOffset-1)/7)+1,resWeek,resYear;if(week<1){resYear=mom.year()-1;resWeek=week+weeksInYear(resYear,dow,doy)}else if(week>weeksInYear(mom.year(),dow,doy)){resWeek=week-weeksInYear(mom.year(),dow,doy);resYear=mom.year()+1}else{resYear=mom.year();resWeek=week}return{week:resWeek,year:resYear}}function weeksInYear(year,dow,doy){var weekOffset=firstWeekOffset(year,dow,doy),weekOffsetNext=firstWeekOffset(year+1,dow,doy);return(daysInYear(year)-weekOffset+weekOffsetNext)/7}addFormatToken("w",["ww",2],"wo","week");addFormatToken("W",["WW",2],"Wo","isoWeek");addUnitAlias("week","w");addUnitAlias("isoWeek","W");addUnitPriority("week",5);addUnitPriority("isoWeek",5);addRegexToken("w",match1to2);addRegexToken("ww",match1to2,match2);addRegexToken("W",match1to2);addRegexToken("WW",match1to2,match2);addWeekParseToken(["w","ww","W","WW"],function(input,week,config,token){week[token.substr(0,1)]=toInt(input)});function localeWeek(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week}var defaultLocaleWeek={dow:0,doy:6};function localeFirstDayOfWeek(){return this._week.dow}function localeFirstDayOfYear(){return this._week.doy}function getSetWeek(input){var week=this.localeData().week(this);return input==null?week:this.add((input-week)*7,"d")}function getSetISOWeek(input){var week=weekOfYear(this,1,4).week;return input==null?week:this.add((input-week)*7,"d")}addFormatToken("d",0,"do","day");addFormatToken("dd",0,0,function(format){return this.localeData().weekdaysMin(this,format)});addFormatToken("ddd",0,0,function(format){return this.localeData().weekdaysShort(this,format)});addFormatToken("dddd",0,0,function(format){return this.localeData().weekdays(this,format)});addFormatToken("e",0,0,"weekday");addFormatToken("E",0,0,"isoWeekday");addUnitAlias("day","d");addUnitAlias("weekday","e");addUnitAlias("isoWeekday","E");addUnitPriority("day",11);addUnitPriority("weekday",11);addUnitPriority("isoWeekday",11);addRegexToken("d",match1to2);addRegexToken("e",match1to2);addRegexToken("E",match1to2);addRegexToken("dd",function(isStrict,locale){return locale.weekdaysMinRegex(isStrict)});addRegexToken("ddd",function(isStrict,locale){return locale.weekdaysShortRegex(isStrict)});addRegexToken("dddd",function(isStrict,locale){return locale.weekdaysRegex(isStrict)});addWeekParseToken(["dd","ddd","dddd"],function(input,week,config,token){var weekday=config._locale.weekdaysParse(input,token,config._strict);if(weekday!=null){week.d=weekday}else{getParsingFlags(config).invalidWeekday=input}});addWeekParseToken(["d","e","E"],function(input,week,config,token){week[token]=toInt(input)});function parseWeekday(input,locale){if(typeof input!=="string"){return input}if(!isNaN(input)){return parseInt(input,10)}input=locale.weekdaysParse(input);if(typeof input==="number"){return input}return null}function parseIsoWeekday(input,locale){if(typeof input==="string"){return locale.weekdaysParse(input)%7||7}return isNaN(input)?null:input}function shiftWeekdays(ws,n){return ws.slice(n,7).concat(ws.slice(0,n))}var defaultLocaleWeekdays="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),defaultLocaleWeekdaysShort="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),defaultLocaleWeekdaysMin="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),defaultWeekdaysRegex=matchWord,defaultWeekdaysShortRegex=matchWord,defaultWeekdaysMinRegex=matchWord;function localeWeekdays(m,format){var weekdays=isArray(this._weekdays)?this._weekdays:this._weekdays[m&&m!==true&&this._weekdays.isFormat.test(format)?"format":"standalone"];return m===true?shiftWeekdays(weekdays,this._week.dow):m?weekdays[m.day()]:weekdays}function localeWeekdaysShort(m){return m===true?shiftWeekdays(this._weekdaysShort,this._week.dow):m?this._weekdaysShort[m.day()]:this._weekdaysShort}function localeWeekdaysMin(m){return m===true?shiftWeekdays(this._weekdaysMin,this._week.dow):m?this._weekdaysMin[m.day()]:this._weekdaysMin}function handleStrictParse$1(weekdayName,format,strict){var i,ii,mom,llc=weekdayName.toLocaleLowerCase();if(!this._weekdaysParse){this._weekdaysParse=[];this._shortWeekdaysParse=[];this._minWeekdaysParse=[];for(i=0;i<7;++i){mom=createUTC([2e3,1]).day(i);this._minWeekdaysParse[i]=this.weekdaysMin(mom,"").toLocaleLowerCase();this._shortWeekdaysParse[i]=this.weekdaysShort(mom,"").toLocaleLowerCase();this._weekdaysParse[i]=this.weekdays(mom,"").toLocaleLowerCase()}}if(strict){if(format==="dddd"){ii=indexOf.call(this._weekdaysParse,llc);return ii!==-1?ii:null}else if(format==="ddd"){ii=indexOf.call(this._shortWeekdaysParse,llc);return ii!==-1?ii:null}else{ii=indexOf.call(this._minWeekdaysParse,llc);return ii!==-1?ii:null}}else{if(format==="dddd"){ii=indexOf.call(this._weekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._shortWeekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._minWeekdaysParse,llc);return ii!==-1?ii:null}else if(format==="ddd"){ii=indexOf.call(this._shortWeekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._weekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._minWeekdaysParse,llc);return ii!==-1?ii:null}else{ii=indexOf.call(this._minWeekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._weekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._shortWeekdaysParse,llc);return ii!==-1?ii:null}}}function localeWeekdaysParse(weekdayName,format,strict){var i,mom,regex;if(this._weekdaysParseExact){return handleStrictParse$1.call(this,weekdayName,format,strict)}if(!this._weekdaysParse){this._weekdaysParse=[];this._minWeekdaysParse=[];this._shortWeekdaysParse=[];this._fullWeekdaysParse=[]}for(i=0;i<7;i++){mom=createUTC([2e3,1]).day(i);if(strict&&!this._fullWeekdaysParse[i]){this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(mom,"").replace(".","\\.?")+"$","i");this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(mom,"").replace(".","\\.?")+"$","i");this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(mom,"").replace(".","\\.?")+"$","i")}if(!this._weekdaysParse[i]){regex="^"+this.weekdays(mom,"")+"|^"+this.weekdaysShort(mom,"")+"|^"+this.weekdaysMin(mom,"");this._weekdaysParse[i]=new RegExp(regex.replace(".",""),"i")}if(strict&&format==="dddd"&&this._fullWeekdaysParse[i].test(weekdayName)){return i}else if(strict&&format==="ddd"&&this._shortWeekdaysParse[i].test(weekdayName)){return i}else if(strict&&format==="dd"&&this._minWeekdaysParse[i].test(weekdayName)){return i}else if(!strict&&this._weekdaysParse[i].test(weekdayName)){return i}}}function getSetDayOfWeek(input){if(!this.isValid()){return input!=null?this:NaN}var day=this._isUTC?this._d.getUTCDay():this._d.getDay();if(input!=null){input=parseWeekday(input,this.localeData());return this.add(input-day,"d")}else{return day}}function getSetLocaleDayOfWeek(input){if(!this.isValid()){return input!=null?this:NaN}var weekday=(this.day()+7-this.localeData()._week.dow)%7;return input==null?weekday:this.add(input-weekday,"d")}function getSetISODayOfWeek(input){if(!this.isValid()){return input!=null?this:NaN}if(input!=null){var weekday=parseIsoWeekday(input,this.localeData());return this.day(this.day()%7?weekday:weekday-7)}else{return this.day()||7}}function weekdaysRegex(isStrict){if(this._weekdaysParseExact){if(!hasOwnProp(this,"_weekdaysRegex")){computeWeekdaysParse.call(this)}if(isStrict){return this._weekdaysStrictRegex}else{return this._weekdaysRegex}}else{if(!hasOwnProp(this,"_weekdaysRegex")){this._weekdaysRegex=defaultWeekdaysRegex}return this._weekdaysStrictRegex&&isStrict?this._weekdaysStrictRegex:this._weekdaysRegex}}function weekdaysShortRegex(isStrict){if(this._weekdaysParseExact){if(!hasOwnProp(this,"_weekdaysRegex")){computeWeekdaysParse.call(this)}if(isStrict){return this._weekdaysShortStrictRegex}else{return this._weekdaysShortRegex}}else{if(!hasOwnProp(this,"_weekdaysShortRegex")){this._weekdaysShortRegex=defaultWeekdaysShortRegex}return this._weekdaysShortStrictRegex&&isStrict?this._weekdaysShortStrictRegex:this._weekdaysShortRegex}}function weekdaysMinRegex(isStrict){if(this._weekdaysParseExact){if(!hasOwnProp(this,"_weekdaysRegex")){computeWeekdaysParse.call(this)}if(isStrict){return this._weekdaysMinStrictRegex}else{return this._weekdaysMinRegex}}else{if(!hasOwnProp(this,"_weekdaysMinRegex")){this._weekdaysMinRegex=defaultWeekdaysMinRegex}return this._weekdaysMinStrictRegex&&isStrict?this._weekdaysMinStrictRegex:this._weekdaysMinRegex}}function computeWeekdaysParse(){function cmpLenRev(a,b){return b.length-a.length}var minPieces=[],shortPieces=[],longPieces=[],mixedPieces=[],i,mom,minp,shortp,longp;for(i=0;i<7;i++){mom=createUTC([2e3,1]).day(i);minp=regexEscape(this.weekdaysMin(mom,""));shortp=regexEscape(this.weekdaysShort(mom,""));longp=regexEscape(this.weekdays(mom,""));minPieces.push(minp);shortPieces.push(shortp);longPieces.push(longp);mixedPieces.push(minp);mixedPieces.push(shortp);mixedPieces.push(longp)}minPieces.sort(cmpLenRev);shortPieces.sort(cmpLenRev);longPieces.sort(cmpLenRev);mixedPieces.sort(cmpLenRev);this._weekdaysRegex=new RegExp("^("+mixedPieces.join("|")+")","i");this._weekdaysShortRegex=this._weekdaysRegex;this._weekdaysMinRegex=this._weekdaysRegex;this._weekdaysStrictRegex=new RegExp("^("+longPieces.join("|")+")","i");this._weekdaysShortStrictRegex=new RegExp("^("+shortPieces.join("|")+")","i");this._weekdaysMinStrictRegex=new RegExp("^("+minPieces.join("|")+")","i")}function hFormat(){return this.hours()%12||12}function kFormat(){return this.hours()||24}addFormatToken("H",["HH",2],0,"hour");addFormatToken("h",["hh",2],0,hFormat);addFormatToken("k",["kk",2],0,kFormat);addFormatToken("hmm",0,0,function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)});addFormatToken("hmmss",0,0,function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)});addFormatToken("Hmm",0,0,function(){return""+this.hours()+zeroFill(this.minutes(),2)});addFormatToken("Hmmss",0,0,function(){return""+this.hours()+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)});function meridiem(token,lowercase){addFormatToken(token,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),lowercase)})}meridiem("a",true);meridiem("A",false);addUnitAlias("hour","h");addUnitPriority("hour",13);function matchMeridiem(isStrict,locale){return locale._meridiemParse}addRegexToken("a",matchMeridiem);addRegexToken("A",matchMeridiem);addRegexToken("H",match1to2);addRegexToken("h",match1to2);addRegexToken("k",match1to2);addRegexToken("HH",match1to2,match2);addRegexToken("hh",match1to2,match2);addRegexToken("kk",match1to2,match2);addRegexToken("hmm",match3to4);addRegexToken("hmmss",match5to6);addRegexToken("Hmm",match3to4);addRegexToken("Hmmss",match5to6);addParseToken(["H","HH"],HOUR);addParseToken(["k","kk"],function(input,array,config){var kInput=toInt(input);array[HOUR]=kInput===24?0:kInput});addParseToken(["a","A"],function(input,array,config){config._isPm=config._locale.isPM(input);config._meridiem=input});addParseToken(["h","hh"],function(input,array,config){array[HOUR]=toInt(input);getParsingFlags(config).bigHour=true});addParseToken("hmm",function(input,array,config){var pos=input.length-2;array[HOUR]=toInt(input.substr(0,pos));array[MINUTE]=toInt(input.substr(pos));getParsingFlags(config).bigHour=true});addParseToken("hmmss",function(input,array,config){var pos1=input.length-4,pos2=input.length-2;array[HOUR]=toInt(input.substr(0,pos1));array[MINUTE]=toInt(input.substr(pos1,2));array[SECOND]=toInt(input.substr(pos2));getParsingFlags(config).bigHour=true});addParseToken("Hmm",function(input,array,config){var pos=input.length-2;array[HOUR]=toInt(input.substr(0,pos));array[MINUTE]=toInt(input.substr(pos))});addParseToken("Hmmss",function(input,array,config){var pos1=input.length-4,pos2=input.length-2;array[HOUR]=toInt(input.substr(0,pos1));array[MINUTE]=toInt(input.substr(pos1,2));array[SECOND]=toInt(input.substr(pos2))});function localeIsPM(input){return(input+"").toLowerCase().charAt(0)==="p"}var defaultLocaleMeridiemParse=/[ap]\.?m?\.?/i,getSetHour=makeGetSet("Hours",true);function localeMeridiem(hours,minutes,isLower){if(hours>11){return isLower?"pm":"PM"}else{return isLower?"am":"AM"}}var baseConfig={calendar:defaultCalendar,longDateFormat:defaultLongDateFormat,invalidDate:defaultInvalidDate,ordinal:defaultOrdinal,dayOfMonthOrdinalParse:defaultDayOfMonthOrdinalParse,relativeTime:defaultRelativeTime,months:defaultLocaleMonths,monthsShort:defaultLocaleMonthsShort,week:defaultLocaleWeek,weekdays:defaultLocaleWeekdays,weekdaysMin:defaultLocaleWeekdaysMin,weekdaysShort:defaultLocaleWeekdaysShort,meridiemParse:defaultLocaleMeridiemParse};var locales={},localeFamilies={},globalLocale;function commonPrefix(arr1,arr2){var i,minl=Math.min(arr1.length,arr2.length);for(i=0;i<minl;i+=1){if(arr1[i]!==arr2[i]){return i}}return minl}function normalizeLocale(key){return key?key.toLowerCase().replace("_","-"):key}function chooseLocale(names){var i=0,j,next,locale,split;while(i<names.length){split=normalizeLocale(names[i]).split("-");j=split.length;next=normalizeLocale(names[i+1]);next=next?next.split("-"):null;while(j>0){locale=loadLocale(split.slice(0,j).join("-"));if(locale){return locale}if(next&&next.length>=j&&commonPrefix(split,next)>=j-1){break}j--}i++}return globalLocale}function isLocaleNameSane(name){return name.match("^[^/\\\\]*$")!=null}function loadLocale(name){var oldLocale=null,aliasedRequire;if(locales[name]===undefined&&typeof module!=="undefined"&&module&&module.exports&&isLocaleNameSane(name)){try{oldLocale=globalLocale._abbr;aliasedRequire=require;aliasedRequire("./locale/"+name);getSetGlobalLocale(oldLocale)}catch(e){locales[name]=null}}return locales[name]}function getSetGlobalLocale(key,values){var data;if(key){if(isUndefined(values)){data=getLocale(key)}else{data=defineLocale(key,values)}if(data){globalLocale=data}else{if(typeof console!=="undefined"&&console.warn){console.warn("Locale "+key+" not found. Did you forget to load it?")}}}return globalLocale._abbr}function defineLocale(name,config){if(config!==null){var locale,parentConfig=baseConfig;config.abbr=name;if(locales[name]!=null){deprecateSimple("defineLocaleOverride","use moment.updateLocale(localeName, config) to change "+"an existing locale. moment.defineLocale(localeName, "+"config) should only be used for creating a new locale "+"See http://momentjs.com/guides/#/warnings/define-locale/ for more info.");parentConfig=locales[name]._config}else if(config.parentLocale!=null){if(locales[config.parentLocale]!=null){parentConfig=locales[config.parentLocale]._config}else{locale=loadLocale(config.parentLocale);if(locale!=null){parentConfig=locale._config}else{if(!localeFamilies[config.parentLocale]){localeFamilies[config.parentLocale]=[]}localeFamilies[config.parentLocale].push({name:name,config:config});return null}}}locales[name]=new Locale(mergeConfigs(parentConfig,config));if(localeFamilies[name]){localeFamilies[name].forEach(function(x){defineLocale(x.name,x.config)})}getSetGlobalLocale(name);return locales[name]}else{delete locales[name];return null}}function updateLocale(name,config){if(config!=null){var locale,tmpLocale,parentConfig=baseConfig;if(locales[name]!=null&&locales[name].parentLocale!=null){locales[name].set(mergeConfigs(locales[name]._config,config))}else{tmpLocale=loadLocale(name);if(tmpLocale!=null){parentConfig=tmpLocale._config}config=mergeConfigs(parentConfig,config);if(tmpLocale==null){config.abbr=name}locale=new Locale(config);locale.parentLocale=locales[name];locales[name]=locale}getSetGlobalLocale(name)}else{if(locales[name]!=null){if(locales[name].parentLocale!=null){locales[name]=locales[name].parentLocale;if(name===getSetGlobalLocale()){getSetGlobalLocale(name)}}else if(locales[name]!=null){delete locales[name]}}}return locales[name]}function getLocale(key){var locale;if(key&&key._locale&&key._locale._abbr){key=key._locale._abbr}if(!key){return globalLocale}if(!isArray(key)){locale=loadLocale(key);if(locale){return locale}key=[key]}return chooseLocale(key)}function listLocales(){return keys(locales)}function checkOverflow(m){var overflow,a=m._a;if(a&&getParsingFlags(m).overflow===-2){overflow=a[MONTH]<0||a[MONTH]>11?MONTH:a[DATE]<1||a[DATE]>daysInMonth(a[YEAR],a[MONTH])?DATE:a[HOUR]<0||a[HOUR]>24||a[HOUR]===24&&(a[MINUTE]!==0||a[SECOND]!==0||a[MILLISECOND]!==0)?HOUR:a[MINUTE]<0||a[MINUTE]>59?MINUTE:a[SECOND]<0||a[SECOND]>59?SECOND:a[MILLISECOND]<0||a[MILLISECOND]>999?MILLISECOND:-1;if(getParsingFlags(m)._overflowDayOfYear&&(overflow<YEAR||overflow>DATE)){overflow=DATE}if(getParsingFlags(m)._overflowWeeks&&overflow===-1){overflow=WEEK}if(getParsingFlags(m)._overflowWeekday&&overflow===-1){overflow=WEEKDAY}getParsingFlags(m).overflow=overflow}return m}var extendedIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,basicIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,tzRegex=/Z|[+-]\d\d(?::?\d\d)?/,isoDates=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,false],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,false],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,false],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,false],["YYYY",/\d{4}/,false]],isoTimes=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],aspNetJsonRegex=/^\/?Date\((-?\d+)/i,rfc2822=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,obsOffsets={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function configFromISO(config){var i,l,string=config._i,match=extendedIsoRegex.exec(string)||basicIsoRegex.exec(string),allowTime,dateFormat,timeFormat,tzFormat,isoDatesLen=isoDates.length,isoTimesLen=isoTimes.length;if(match){getParsingFlags(config).iso=true;for(i=0,l=isoDatesLen;i<l;i++){if(isoDates[i][1].exec(match[1])){dateFormat=isoDates[i][0];allowTime=isoDates[i][2]!==false;break}}if(dateFormat==null){config._isValid=false;return}if(match[3]){for(i=0,l=isoTimesLen;i<l;i++){if(isoTimes[i][1].exec(match[3])){timeFormat=(match[2]||" ")+isoTimes[i][0];break}}if(timeFormat==null){config._isValid=false;return}}if(!allowTime&&timeFormat!=null){config._isValid=false;return}if(match[4]){if(tzRegex.exec(match[4])){tzFormat="Z"}else{config._isValid=false;return}}config._f=dateFormat+(timeFormat||"")+(tzFormat||"");configFromStringAndFormat(config)}else{config._isValid=false}}function extractFromRFC2822Strings(yearStr,monthStr,dayStr,hourStr,minuteStr,secondStr){var result=[untruncateYear(yearStr),defaultLocaleMonthsShort.indexOf(monthStr),parseInt(dayStr,10),parseInt(hourStr,10),parseInt(minuteStr,10)];if(secondStr){result.push(parseInt(secondStr,10))}return result}function untruncateYear(yearStr){var year=parseInt(yearStr,10);if(year<=49){return 2e3+year}else if(year<=999){return 1900+year}return year}function preprocessRFC2822(s){return s.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function checkWeekday(weekdayStr,parsedInput,config){if(weekdayStr){var weekdayProvided=defaultLocaleWeekdaysShort.indexOf(weekdayStr),weekdayActual=new Date(parsedInput[0],parsedInput[1],parsedInput[2]).getDay();if(weekdayProvided!==weekdayActual){getParsingFlags(config).weekdayMismatch=true;config._isValid=false;return false}}return true}function calculateOffset(obsOffset,militaryOffset,numOffset){if(obsOffset){return obsOffsets[obsOffset]}else if(militaryOffset){return 0}else{var hm=parseInt(numOffset,10),m=hm%100,h=(hm-m)/100;return h*60+m}}function configFromRFC2822(config){var match=rfc2822.exec(preprocessRFC2822(config._i)),parsedArray;if(match){parsedArray=extractFromRFC2822Strings(match[4],match[3],match[2],match[5],match[6],match[7]);if(!checkWeekday(match[1],parsedArray,config)){return}config._a=parsedArray;config._tzm=calculateOffset(match[8],match[9],match[10]);config._d=createUTCDate.apply(null,config._a);config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm);getParsingFlags(config).rfc2822=true}else{config._isValid=false}}function configFromString(config){var matched=aspNetJsonRegex.exec(config._i);if(matched!==null){config._d=new Date(+matched[1]);return}configFromISO(config);if(config._isValid===false){delete config._isValid}else{return}configFromRFC2822(config);if(config._isValid===false){delete config._isValid}else{return}if(config._strict){config._isValid=false}else{hooks.createFromInputFallback(config)}}hooks.createFromInputFallback=deprecate("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), "+"which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are "+"discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(config){config._d=new Date(config._i+(config._useUTC?" UTC":""))});function defaults(a,b,c){if(a!=null){return a}if(b!=null){return b}return c}function currentDateArray(config){var nowValue=new Date(hooks.now());if(config._useUTC){return[nowValue.getUTCFullYear(),nowValue.getUTCMonth(),nowValue.getUTCDate()]}return[nowValue.getFullYear(),nowValue.getMonth(),nowValue.getDate()]}function configFromArray(config){var i,date,input=[],currentDate,expectedWeekday,yearToUse;if(config._d){return}currentDate=currentDateArray(config);if(config._w&&config._a[DATE]==null&&config._a[MONTH]==null){dayOfYearFromWeekInfo(config)}if(config._dayOfYear!=null){yearToUse=defaults(config._a[YEAR],currentDate[YEAR]);if(config._dayOfYear>daysInYear(yearToUse)||config._dayOfYear===0){getParsingFlags(config)._overflowDayOfYear=true}date=createUTCDate(yearToUse,0,config._dayOfYear);config._a[MONTH]=date.getUTCMonth();config._a[DATE]=date.getUTCDate()}for(i=0;i<3&&config._a[i]==null;++i){config._a[i]=input[i]=currentDate[i]}for(;i<7;i++){config._a[i]=input[i]=config._a[i]==null?i===2?1:0:config._a[i]}if(config._a[HOUR]===24&&config._a[MINUTE]===0&&config._a[SECOND]===0&&config._a[MILLISECOND]===0){config._nextDay=true;config._a[HOUR]=0}config._d=(config._useUTC?createUTCDate:createDate).apply(null,input);expectedWeekday=config._useUTC?config._d.getUTCDay():config._d.getDay();if(config._tzm!=null){config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm)}if(config._nextDay){config._a[HOUR]=24}if(config._w&&typeof config._w.d!=="undefined"&&config._w.d!==expectedWeekday){getParsingFlags(config).weekdayMismatch=true}}function dayOfYearFromWeekInfo(config){var w,weekYear,week,weekday,dow,doy,temp,weekdayOverflow,curWeek;w=config._w;if(w.GG!=null||w.W!=null||w.E!=null){dow=1;doy=4;weekYear=defaults(w.GG,config._a[YEAR],weekOfYear(createLocal(),1,4).year);week=defaults(w.W,1);weekday=defaults(w.E,1);if(weekday<1||weekday>7){weekdayOverflow=true}}else{dow=config._locale._week.dow;doy=config._locale._week.doy;curWeek=weekOfYear(createLocal(),dow,doy);weekYear=defaults(w.gg,config._a[YEAR],curWeek.year);week=defaults(w.w,curWeek.week);if(w.d!=null){weekday=w.d;if(weekday<0||weekday>6){weekdayOverflow=true}}else if(w.e!=null){weekday=w.e+dow;if(w.e<0||w.e>6){weekdayOverflow=true}}else{weekday=dow}}if(week<1||week>weeksInYear(weekYear,dow,doy)){getParsingFlags(config)._overflowWeeks=true}else if(weekdayOverflow!=null){getParsingFlags(config)._overflowWeekday=true}else{temp=dayOfYearFromWeeks(weekYear,week,weekday,dow,doy);config._a[YEAR]=temp.year;config._dayOfYear=temp.dayOfYear}}hooks.ISO_8601=function(){};hooks.RFC_2822=function(){};function configFromStringAndFormat(config){if(config._f===hooks.ISO_8601){configFromISO(config);return}if(config._f===hooks.RFC_2822){configFromRFC2822(config);return}config._a=[];getParsingFlags(config).empty=true;var string=""+config._i,i,parsedInput,tokens,token,skipped,stringLength=string.length,totalParsedInputLength=0,era,tokenLen;tokens=expandFormat(config._f,config._locale).match(formattingTokens)||[];tokenLen=tokens.length;for(i=0;i<tokenLen;i++){token=tokens[i];parsedInput=(string.match(getParseRegexForToken(token,config))||[])[0];if(parsedInput){skipped=string.substr(0,string.indexOf(parsedInput));if(skipped.length>0){getParsingFlags(config).unusedInput.push(skipped)}string=string.slice(string.indexOf(parsedInput)+parsedInput.length);totalParsedInputLength+=parsedInput.length}if(formatTokenFunctions[token]){if(parsedInput){getParsingFlags(config).empty=false}else{getParsingFlags(config).unusedTokens.push(token)}addTimeToArrayFromToken(token,parsedInput,config)}else if(config._strict&&!parsedInput){getParsingFlags(config).unusedTokens.push(token)}}getParsingFlags(config).charsLeftOver=stringLength-totalParsedInputLength;if(string.length>0){getParsingFlags(config).unusedInput.push(string)}if(config._a[HOUR]<=12&&getParsingFlags(config).bigHour===true&&config._a[HOUR]>0){getParsingFlags(config).bigHour=undefined}getParsingFlags(config).parsedDateParts=config._a.slice(0);getParsingFlags(config).meridiem=config._meridiem;config._a[HOUR]=meridiemFixWrap(config._locale,config._a[HOUR],config._meridiem);era=getParsingFlags(config).era;if(era!==null){config._a[YEAR]=config._locale.erasConvertYear(era,config._a[YEAR])}configFromArray(config);checkOverflow(config)}function meridiemFixWrap(locale,hour,meridiem){var isPm;if(meridiem==null){return hour}if(locale.meridiemHour!=null){return locale.meridiemHour(hour,meridiem)}else if(locale.isPM!=null){isPm=locale.isPM(meridiem);if(isPm&&hour<12){hour+=12}if(!isPm&&hour===12){hour=0}return hour}else{return hour}}function configFromStringAndArray(config){var tempConfig,bestMoment,scoreToBeat,i,currentScore,validFormatFound,bestFormatIsValid=false,configfLen=config._f.length;if(configfLen===0){getParsingFlags(config).invalidFormat=true;config._d=new Date(NaN);return}for(i=0;i<configfLen;i++){currentScore=0;validFormatFound=false;tempConfig=copyConfig({},config);if(config._useUTC!=null){tempConfig._useUTC=config._useUTC}tempConfig._f=config._f[i];configFromStringAndFormat(tempConfig);if(isValid(tempConfig)){validFormatFound=true}currentScore+=getParsingFlags(tempConfig).charsLeftOver;currentScore+=getParsingFlags(tempConfig).unusedTokens.length*10;getParsingFlags(tempConfig).score=currentScore;if(!bestFormatIsValid){if(scoreToBeat==null||currentScore<scoreToBeat||validFormatFound){scoreToBeat=currentScore;bestMoment=tempConfig;if(validFormatFound){bestFormatIsValid=true}}}else{if(currentScore<scoreToBeat){scoreToBeat=currentScore;bestMoment=tempConfig}}}extend(config,bestMoment||tempConfig)}function configFromObject(config){if(config._d){return}var i=normalizeObjectUnits(config._i),dayOrDate=i.day===undefined?i.date:i.day;config._a=map([i.year,i.month,dayOrDate,i.hour,i.minute,i.second,i.millisecond],function(obj){return obj&&parseInt(obj,10)});configFromArray(config)}function createFromConfig(config){var res=new Moment(checkOverflow(prepareConfig(config)));if(res._nextDay){res.add(1,"d");res._nextDay=undefined}return res}function prepareConfig(config){var input=config._i,format=config._f;config._locale=config._locale||getLocale(config._l);if(input===null||format===undefined&&input===""){return createInvalid({nullInput:true})}if(typeof input==="string"){config._i=input=config._locale.preparse(input)}if(isMoment(input)){return new Moment(checkOverflow(input))}else if(isDate(input)){config._d=input}else if(isArray(format)){configFromStringAndArray(config)}else if(format){configFromStringAndFormat(config)}else{configFromInput(config)}if(!isValid(config)){config._d=null}return config}function configFromInput(config){var input=config._i;if(isUndefined(input)){config._d=new Date(hooks.now())}else if(isDate(input)){config._d=new Date(input.valueOf())}else if(typeof input==="string"){configFromString(config)}else if(isArray(input)){config._a=map(input.slice(0),function(obj){return parseInt(obj,10)});configFromArray(config)}else if(isObject(input)){configFromObject(config)}else if(isNumber(input)){config._d=new Date(input)}else{hooks.createFromInputFallback(config)}}function createLocalOrUTC(input,format,locale,strict,isUTC){var c={};if(format===true||format===false){strict=format;format=undefined}if(locale===true||locale===false){strict=locale;locale=undefined}if(isObject(input)&&isObjectEmpty(input)||isArray(input)&&input.length===0){input=undefined}c._isAMomentObject=true;c._useUTC=c._isUTC=isUTC;c._l=locale;c._i=input;c._f=format;c._strict=strict;return createFromConfig(c)}function createLocal(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,false)}var prototypeMin=deprecate("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var other=createLocal.apply(null,arguments);if(this.isValid()&&other.isValid()){return other<this?this:other}else{return createInvalid()}}),prototypeMax=deprecate("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var other=createLocal.apply(null,arguments);if(this.isValid()&&other.isValid()){return other>this?this:other}else{return createInvalid()}});function pickBy(fn,moments){var res,i;if(moments.length===1&&isArray(moments[0])){moments=moments[0]}if(!moments.length){return createLocal()}res=moments[0];for(i=1;i<moments.length;++i){if(!moments[i].isValid()||moments[i][fn](res)){res=moments[i]}}return res}function min(){var args=[].slice.call(arguments,0);return pickBy("isBefore",args)}function max(){var args=[].slice.call(arguments,0);return pickBy("isAfter",args)}var now=function(){return Date.now?Date.now():+new Date};var ordering=["year","quarter","month","week","day","hour","minute","second","millisecond"];function isDurationValid(m){var key,unitHasDecimal=false,i,orderLen=ordering.length;for(key in m){if(hasOwnProp(m,key)&&!(indexOf.call(ordering,key)!==-1&&(m[key]==null||!isNaN(m[key])))){return false}}for(i=0;i<orderLen;++i){if(m[ordering[i]]){if(unitHasDecimal){return false}if(parseFloat(m[ordering[i]])!==toInt(m[ordering[i]])){unitHasDecimal=true}}}return true}function isValid$1(){return this._isValid}function createInvalid$1(){return createDuration(NaN)}function Duration(duration){var normalizedInput=normalizeObjectUnits(duration),years=normalizedInput.year||0,quarters=normalizedInput.quarter||0,months=normalizedInput.month||0,weeks=normalizedInput.week||normalizedInput.isoWeek||0,days=normalizedInput.day||0,hours=normalizedInput.hour||0,minutes=normalizedInput.minute||0,seconds=normalizedInput.second||0,milliseconds=normalizedInput.millisecond||0;this._isValid=isDurationValid(normalizedInput);this._milliseconds=+milliseconds+seconds*1e3+minutes*6e4+hours*1e3*60*60;this._days=+days+weeks*7;this._months=+months+quarters*3+years*12;this._data={};this._locale=getLocale();this._bubble()}function isDuration(obj){return obj instanceof Duration}function absRound(number){if(number<0){return Math.round(-1*number)*-1}else{return Math.round(number)}}function compareArrays(array1,array2,dontConvert){var len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0,i;for(i=0;i<len;i++){if(dontConvert&&array1[i]!==array2[i]||!dontConvert&&toInt(array1[i])!==toInt(array2[i])){diffs++}}return diffs+lengthDiff}function offset(token,separator){addFormatToken(token,0,0,function(){var offset=this.utcOffset(),sign="+";if(offset<0){offset=-offset;sign="-"}return sign+zeroFill(~~(offset/60),2)+separator+zeroFill(~~offset%60,2)})}offset("Z",":");offset("ZZ","");addRegexToken("Z",matchShortOffset);addRegexToken("ZZ",matchShortOffset);addParseToken(["Z","ZZ"],function(input,array,config){config._useUTC=true;config._tzm=offsetFromString(matchShortOffset,input)});var chunkOffset=/([\+\-]|\d\d)/gi;function offsetFromString(matcher,string){var matches=(string||"").match(matcher),chunk,parts,minutes;if(matches===null){return null}chunk=matches[matches.length-1]||[];parts=(chunk+"").match(chunkOffset)||["-",0,0];minutes=+(parts[1]*60)+toInt(parts[2]);return minutes===0?0:parts[0]==="+"?minutes:-minutes}function cloneWithOffset(input,model){var res,diff;if(model._isUTC){res=model.clone();diff=(isMoment(input)||isDate(input)?input.valueOf():createLocal(input).valueOf())-res.valueOf();res._d.setTime(res._d.valueOf()+diff);hooks.updateOffset(res,false);return res}else{return createLocal(input).local()}}function getDateOffset(m){return-Math.round(m._d.getTimezoneOffset())}hooks.updateOffset=function(){};function getSetOffset(input,keepLocalTime,keepMinutes){var offset=this._offset||0,localAdjust;if(!this.isValid()){return input!=null?this:NaN}if(input!=null){if(typeof input==="string"){input=offsetFromString(matchShortOffset,input);if(input===null){return this}}else if(Math.abs(input)<16&&!keepMinutes){input=input*60}if(!this._isUTC&&keepLocalTime){localAdjust=getDateOffset(this)}this._offset=input;this._isUTC=true;if(localAdjust!=null){this.add(localAdjust,"m")}if(offset!==input){if(!keepLocalTime||this._changeInProgress){addSubtract(this,createDuration(input-offset,"m"),1,false)}else if(!this._changeInProgress){this._changeInProgress=true;hooks.updateOffset(this,true);this._changeInProgress=null}}return this}else{return this._isUTC?offset:getDateOffset(this)}}function getSetZone(input,keepLocalTime){if(input!=null){if(typeof input!=="string"){input=-input}this.utcOffset(input,keepLocalTime);return this}else{return-this.utcOffset()}}function setOffsetToUTC(keepLocalTime){return this.utcOffset(0,keepLocalTime)}function setOffsetToLocal(keepLocalTime){if(this._isUTC){this.utcOffset(0,keepLocalTime);this._isUTC=false;if(keepLocalTime){this.subtract(getDateOffset(this),"m")}}return this}function setOffsetToParsedOffset(){if(this._tzm!=null){this.utcOffset(this._tzm,false,true)}else if(typeof this._i==="string"){var tZone=offsetFromString(matchOffset,this._i);if(tZone!=null){this.utcOffset(tZone)}else{this.utcOffset(0,true)}}return this}function hasAlignedHourOffset(input){if(!this.isValid()){return false}input=input?createLocal(input).utcOffset():0;return(this.utcOffset()-input)%60===0}function isDaylightSavingTime(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function isDaylightSavingTimeShifted(){if(!isUndefined(this._isDSTShifted)){return this._isDSTShifted}var c={},other;copyConfig(c,this);c=prepareConfig(c);if(c._a){other=c._isUTC?createUTC(c._a):createLocal(c._a);this._isDSTShifted=this.isValid()&&compareArrays(c._a,other.toArray())>0}else{this._isDSTShifted=false}return this._isDSTShifted}function isLocal(){return this.isValid()?!this._isUTC:false}function isUtcOffset(){return this.isValid()?this._isUTC:false}function isUtc(){return this.isValid()?this._isUTC&&this._offset===0:false}var aspNetRegex=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,isoRegex=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function createDuration(input,key){var duration=input,match=null,sign,ret,diffRes;if(isDuration(input)){duration={ms:input._milliseconds,d:input._days,M:input._months}}else if(isNumber(input)||!isNaN(+input)){duration={};if(key){duration[key]=+input}else{duration.milliseconds=+input}}else if(match=aspNetRegex.exec(input)){sign=match[1]==="-"?-1:1;duration={y:0,d:toInt(match[DATE])*sign,h:toInt(match[HOUR])*sign,m:toInt(match[MINUTE])*sign,s:toInt(match[SECOND])*sign,ms:toInt(absRound(match[MILLISECOND]*1e3))*sign}}else if(match=isoRegex.exec(input)){sign=match[1]==="-"?-1:1;duration={y:parseIso(match[2],sign),M:parseIso(match[3],sign),w:parseIso(match[4],sign),d:parseIso(match[5],sign),h:parseIso(match[6],sign),m:parseIso(match[7],sign),s:parseIso(match[8],sign)}}else if(duration==null){duration={}}else if(typeof duration==="object"&&("from"in duration||"to"in duration)){diffRes=momentsDifference(createLocal(duration.from),createLocal(duration.to));duration={};duration.ms=diffRes.milliseconds;duration.M=diffRes.months}ret=new Duration(duration);if(isDuration(input)&&hasOwnProp(input,"_locale")){ret._locale=input._locale}if(isDuration(input)&&hasOwnProp(input,"_isValid")){ret._isValid=input._isValid}return ret}createDuration.fn=Duration.prototype;createDuration.invalid=createInvalid$1;function parseIso(inp,sign){var res=inp&&parseFloat(inp.replace(",","."));return(isNaN(res)?0:res)*sign}function positiveMomentsDifference(base,other){var res={};res.months=other.month()-base.month()+(other.year()-base.year())*12;if(base.clone().add(res.months,"M").isAfter(other)){--res.months}res.milliseconds=+other-+base.clone().add(res.months,"M");return res}function momentsDifference(base,other){var res;if(!(base.isValid()&&other.isValid())){return{milliseconds:0,months:0}}other=cloneWithOffset(other,base);if(base.isBefore(other)){res=positiveMomentsDifference(base,other)}else{res=positiveMomentsDifference(other,base);res.milliseconds=-res.milliseconds;res.months=-res.months}return res}function createAdder(direction,name){return function(val,period){var dur,tmp;if(period!==null&&!isNaN(+period)){deprecateSimple(name,"moment()."+name+"(period, number) is deprecated. Please use moment()."+name+"(number, period). "+"See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info.");tmp=val;val=period;period=tmp}dur=createDuration(val,period);addSubtract(this,dur,direction);return this}}function addSubtract(mom,duration,isAdding,updateOffset){var milliseconds=duration._milliseconds,days=absRound(duration._days),months=absRound(duration._months);if(!mom.isValid()){return}updateOffset=updateOffset==null?true:updateOffset;if(months){setMonth(mom,get(mom,"Month")+months*isAdding)}if(days){set$1(mom,"Date",get(mom,"Date")+days*isAdding)}if(milliseconds){mom._d.setTime(mom._d.valueOf()+milliseconds*isAdding)}if(updateOffset){hooks.updateOffset(mom,days||months)}}var add=createAdder(1,"add"),subtract=createAdder(-1,"subtract");function isString(input){return typeof input==="string"||input instanceof String}function isMomentInput(input){return isMoment(input)||isDate(input)||isString(input)||isNumber(input)||isNumberOrStringArray(input)||isMomentInputObject(input)||input===null||input===undefined}function isMomentInputObject(input){var objectTest=isObject(input)&&!isObjectEmpty(input),propertyTest=false,properties=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,property,propertyLen=properties.length;for(i=0;i<propertyLen;i+=1){property=properties[i];propertyTest=propertyTest||hasOwnProp(input,property)}return objectTest&&propertyTest}function isNumberOrStringArray(input){var arrayTest=isArray(input),dataTypeTest=false;if(arrayTest){dataTypeTest=input.filter(function(item){return!isNumber(item)&&isString(input)}).length===0}return arrayTest&&dataTypeTest}function isCalendarSpec(input){var objectTest=isObject(input)&&!isObjectEmpty(input),propertyTest=false,properties=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,property;for(i=0;i<properties.length;i+=1){property=properties[i];propertyTest=propertyTest||hasOwnProp(input,property)}return objectTest&&propertyTest}function getCalendarFormat(myMoment,now){var diff=myMoment.diff(now,"days",true);return diff<-6?"sameElse":diff<-1?"lastWeek":diff<0?"lastDay":diff<1?"sameDay":diff<2?"nextDay":diff<7?"nextWeek":"sameElse"}function calendar$1(time,formats){if(arguments.length===1){if(!arguments[0]){time=undefined;formats=undefined}else if(isMomentInput(arguments[0])){time=arguments[0];formats=undefined}else if(isCalendarSpec(arguments[0])){formats=arguments[0];time=undefined}}var now=time||createLocal(),sod=cloneWithOffset(now,this).startOf("day"),format=hooks.calendarFormat(this,sod)||"sameElse",output=formats&&(isFunction(formats[format])?formats[format].call(this,now):formats[format]);return this.format(output||this.localeData().calendar(format,this,createLocal(now)))}function clone(){return new Moment(this)}function isAfter(input,units){var localInput=isMoment(input)?input:createLocal(input);if(!(this.isValid()&&localInput.isValid())){return false}units=normalizeUnits(units)||"millisecond";if(units==="millisecond"){return this.valueOf()>localInput.valueOf()}else{return localInput.valueOf()<this.clone().startOf(units).valueOf()}}function isBefore(input,units){var localInput=isMoment(input)?input:createLocal(input);if(!(this.isValid()&&localInput.isValid())){return false}units=normalizeUnits(units)||"millisecond";if(units==="millisecond"){return this.valueOf()<localInput.valueOf()}else{return this.clone().endOf(units).valueOf()<localInput.valueOf()}}function isBetween(from,to,units,inclusivity){var localFrom=isMoment(from)?from:createLocal(from),localTo=isMoment(to)?to:createLocal(to);if(!(this.isValid()&&localFrom.isValid()&&localTo.isValid())){return false}inclusivity=inclusivity||"()";return(inclusivity[0]==="("?this.isAfter(localFrom,units):!this.isBefore(localFrom,units))&&(inclusivity[1]===")"?this.isBefore(localTo,units):!this.isAfter(localTo,units))}function isSame(input,units){var localInput=isMoment(input)?input:createLocal(input),inputMs;if(!(this.isValid()&&localInput.isValid())){return false}units=normalizeUnits(units)||"millisecond";if(units==="millisecond"){return this.valueOf()===localInput.valueOf()}else{inputMs=localInput.valueOf();return this.clone().startOf(units).valueOf()<=inputMs&&inputMs<=this.clone().endOf(units).valueOf()}}function isSameOrAfter(input,units){return this.isSame(input,units)||this.isAfter(input,units)}function isSameOrBefore(input,units){return this.isSame(input,units)||this.isBefore(input,units)}function diff(input,units,asFloat){var that,zoneDelta,output;if(!this.isValid()){return NaN}that=cloneWithOffset(input,this);if(!that.isValid()){return NaN}zoneDelta=(that.utcOffset()-this.utcOffset())*6e4;units=normalizeUnits(units);switch(units){case"year":output=monthDiff(this,that)/12;break;case"month":output=monthDiff(this,that);break;case"quarter":output=monthDiff(this,that)/3;break;case"second":output=(this-that)/1e3;break;case"minute":output=(this-that)/6e4;break;case"hour":output=(this-that)/36e5;break;case"day":output=(this-that-zoneDelta)/864e5;break;case"week":output=(this-that-zoneDelta)/6048e5;break;default:output=this-that}return asFloat?output:absFloor(output)}function monthDiff(a,b){if(a.date()<b.date()){return-monthDiff(b,a)}var wholeMonthDiff=(b.year()-a.year())*12+(b.month()-a.month()),anchor=a.clone().add(wholeMonthDiff,"months"),anchor2,adjust;if(b-anchor<0){anchor2=a.clone().add(wholeMonthDiff-1,"months");adjust=(b-anchor)/(anchor-anchor2)}else{anchor2=a.clone().add(wholeMonthDiff+1,"months");adjust=(b-anchor)/(anchor2-anchor)}return-(wholeMonthDiff+adjust)||0}hooks.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";hooks.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function toString(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function toISOString(keepOffset){if(!this.isValid()){return null}var utc=keepOffset!==true,m=utc?this.clone().utc():this;if(m.year()<0||m.year()>9999){return formatMoment(m,utc?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ")}if(isFunction(Date.prototype.toISOString)){if(utc){return this.toDate().toISOString()}else{return new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",formatMoment(m,"Z"))}}return formatMoment(m,utc?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function inspect(){if(!this.isValid()){return"moment.invalid(/* "+this._i+" */)"}var func="moment",zone="",prefix,year,datetime,suffix;if(!this.isLocal()){func=this.utcOffset()===0?"moment.utc":"moment.parseZone";zone="Z"}prefix="["+func+'("]';year=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY";datetime="-MM-DD[T]HH:mm:ss.SSS";suffix=zone+'[")]';return this.format(prefix+year+datetime+suffix)}function format(inputString){if(!inputString){inputString=this.isUtc()?hooks.defaultFormatUtc:hooks.defaultFormat}var output=formatMoment(this,inputString);return this.localeData().postformat(output)}function from(time,withoutSuffix){if(this.isValid()&&(isMoment(time)&&time.isValid()||createLocal(time).isValid())){return createDuration({to:this,from:time}).locale(this.locale()).humanize(!withoutSuffix)}else{return this.localeData().invalidDate()}}function fromNow(withoutSuffix){return this.from(createLocal(),withoutSuffix)}function to(time,withoutSuffix){if(this.isValid()&&(isMoment(time)&&time.isValid()||createLocal(time).isValid())){return createDuration({from:this,to:time}).locale(this.locale()).humanize(!withoutSuffix)}else{return this.localeData().invalidDate()}}function toNow(withoutSuffix){return this.to(createLocal(),withoutSuffix)}function locale(key){var newLocaleData;if(key===undefined){return this._locale._abbr}else{newLocaleData=getLocale(key);if(newLocaleData!=null){this._locale=newLocaleData}return this}}var lang=deprecate("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(key){if(key===undefined){return this.localeData()}else{return this.locale(key)}});function localeData(){return this._locale}var MS_PER_SECOND=1e3,MS_PER_MINUTE=60*MS_PER_SECOND,MS_PER_HOUR=60*MS_PER_MINUTE,MS_PER_400_YEARS=(365*400+97)*24*MS_PER_HOUR;function mod$1(dividend,divisor){return(dividend%divisor+divisor)%divisor}function localStartOfDate(y,m,d){if(y<100&&y>=0){return new Date(y+400,m,d)-MS_PER_400_YEARS}else{return new Date(y,m,d).valueOf()}}function utcStartOfDate(y,m,d){if(y<100&&y>=0){return Date.UTC(y+400,m,d)-MS_PER_400_YEARS}else{return Date.UTC(y,m,d)}}function startOf(units){var time,startOfDate;units=normalizeUnits(units);if(units===undefined||units==="millisecond"||!this.isValid()){return this}startOfDate=this._isUTC?utcStartOfDate:localStartOfDate;switch(units){case"year":time=startOfDate(this.year(),0,1);break;case"quarter":time=startOfDate(this.year(),this.month()-this.month()%3,1);break;case"month":time=startOfDate(this.year(),this.month(),1);break;case"week":time=startOfDate(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":time=startOfDate(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":time=startOfDate(this.year(),this.month(),this.date());break;case"hour":time=this._d.valueOf();time-=mod$1(time+(this._isUTC?0:this.utcOffset()*MS_PER_MINUTE),MS_PER_HOUR);break;case"minute":time=this._d.valueOf();time-=mod$1(time,MS_PER_MINUTE);break;case"second":time=this._d.valueOf();time-=mod$1(time,MS_PER_SECOND);break}this._d.setTime(time);hooks.updateOffset(this,true);return this}function endOf(units){var time,startOfDate;units=normalizeUnits(units);if(units===undefined||units==="millisecond"||!this.isValid()){return this}startOfDate=this._isUTC?utcStartOfDate:localStartOfDate;switch(units){case"year":time=startOfDate(this.year()+1,0,1)-1;break;case"quarter":time=startOfDate(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":time=startOfDate(this.year(),this.month()+1,1)-1;break;case"week":time=startOfDate(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":time=startOfDate(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":time=startOfDate(this.year(),this.month(),this.date()+1)-1;break;case"hour":time=this._d.valueOf();time+=MS_PER_HOUR-mod$1(time+(this._isUTC?0:this.utcOffset()*MS_PER_MINUTE),MS_PER_HOUR)-1;break;case"minute":time=this._d.valueOf();time+=MS_PER_MINUTE-mod$1(time,MS_PER_MINUTE)-1;break;case"second":time=this._d.valueOf();time+=MS_PER_SECOND-mod$1(time,MS_PER_SECOND)-1;break}this._d.setTime(time);hooks.updateOffset(this,true);return this}function valueOf(){return this._d.valueOf()-(this._offset||0)*6e4}function unix(){return Math.floor(this.valueOf()/1e3)}function toDate(){return new Date(this.valueOf())}function toArray(){var m=this;return[m.year(),m.month(),m.date(),m.hour(),m.minute(),m.second(),m.millisecond()]}function toObject(){var m=this;return{years:m.year(),months:m.month(),date:m.date(),hours:m.hours(),minutes:m.minutes(),seconds:m.seconds(),milliseconds:m.milliseconds()}}function toJSON(){return this.isValid()?this.toISOString():null}function isValid$2(){return isValid(this)}function parsingFlags(){return extend({},getParsingFlags(this))}function invalidAt(){return getParsingFlags(this).overflow}function creationData(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}addFormatToken("N",0,0,"eraAbbr");addFormatToken("NN",0,0,"eraAbbr");addFormatToken("NNN",0,0,"eraAbbr");addFormatToken("NNNN",0,0,"eraName");addFormatToken("NNNNN",0,0,"eraNarrow");addFormatToken("y",["y",1],"yo","eraYear");addFormatToken("y",["yy",2],0,"eraYear");addFormatToken("y",["yyy",3],0,"eraYear");addFormatToken("y",["yyyy",4],0,"eraYear");addRegexToken("N",matchEraAbbr);addRegexToken("NN",matchEraAbbr);addRegexToken("NNN",matchEraAbbr);addRegexToken("NNNN",matchEraName);addRegexToken("NNNNN",matchEraNarrow);addParseToken(["N","NN","NNN","NNNN","NNNNN"],function(input,array,config,token){var era=config._locale.erasParse(input,token,config._strict);if(era){getParsingFlags(config).era=era}else{getParsingFlags(config).invalidEra=input}});addRegexToken("y",matchUnsigned);addRegexToken("yy",matchUnsigned);addRegexToken("yyy",matchUnsigned);addRegexToken("yyyy",matchUnsigned);addRegexToken("yo",matchEraYearOrdinal);addParseToken(["y","yy","yyy","yyyy"],YEAR);addParseToken(["yo"],function(input,array,config,token){var match;if(config._locale._eraYearOrdinalRegex){match=input.match(config._locale._eraYearOrdinalRegex)}if(config._locale.eraYearOrdinalParse){array[YEAR]=config._locale.eraYearOrdinalParse(input,match)}else{array[YEAR]=parseInt(input,10)}});function localeEras(m,format){var i,l,date,eras=this._eras||getLocale("en")._eras;for(i=0,l=eras.length;i<l;++i){switch(typeof eras[i].since){case"string":date=hooks(eras[i].since).startOf("day");eras[i].since=date.valueOf();break}switch(typeof eras[i].until){case"undefined":eras[i].until=+Infinity;break;case"string":date=hooks(eras[i].until).startOf("day").valueOf();eras[i].until=date.valueOf();break}}return eras}function localeErasParse(eraName,format,strict){var i,l,eras=this.eras(),name,abbr,narrow;eraName=eraName.toUpperCase();for(i=0,l=eras.length;i<l;++i){name=eras[i].name.toUpperCase();abbr=eras[i].abbr.toUpperCase();narrow=eras[i].narrow.toUpperCase();if(strict){switch(format){case"N":case"NN":case"NNN":if(abbr===eraName){return eras[i]}break;case"NNNN":if(name===eraName){return eras[i]}break;case"NNNNN":if(narrow===eraName){return eras[i]}break}}else if([name,abbr,narrow].indexOf(eraName)>=0){return eras[i]}}}function localeErasConvertYear(era,year){var dir=era.since<=era.until?+1:-1;if(year===undefined){return hooks(era.since).year()}else{return hooks(era.since).year()+(year-era.offset)*dir}}function getEraName(){var i,l,val,eras=this.localeData().eras();for(i=0,l=eras.length;i<l;++i){val=this.clone().startOf("day").valueOf();if(eras[i].since<=val&&val<=eras[i].until){return eras[i].name}if(eras[i].until<=val&&val<=eras[i].since){return eras[i].name}}return""}function getEraNarrow(){var i,l,val,eras=this.localeData().eras();for(i=0,l=eras.length;i<l;++i){val=this.clone().startOf("day").valueOf();if(eras[i].since<=val&&val<=eras[i].until){return eras[i].narrow}if(eras[i].until<=val&&val<=eras[i].since){return eras[i].narrow}}return""}function getEraAbbr(){var i,l,val,eras=this.localeData().eras();for(i=0,l=eras.length;i<l;++i){val=this.clone().startOf("day").valueOf();if(eras[i].since<=val&&val<=eras[i].until){return eras[i].abbr}if(eras[i].until<=val&&val<=eras[i].since){return eras[i].abbr}}return""}function getEraYear(){var i,l,dir,val,eras=this.localeData().eras();for(i=0,l=eras.length;i<l;++i){dir=eras[i].since<=eras[i].until?+1:-1;val=this.clone().startOf("day").valueOf();if(eras[i].since<=val&&val<=eras[i].until||eras[i].until<=val&&val<=eras[i].since){return(this.year()-hooks(eras[i].since).year())*dir+eras[i].offset}}return this.year()}function erasNameRegex(isStrict){if(!hasOwnProp(this,"_erasNameRegex")){computeErasParse.call(this)}return isStrict?this._erasNameRegex:this._erasRegex}function erasAbbrRegex(isStrict){if(!hasOwnProp(this,"_erasAbbrRegex")){computeErasParse.call(this)}return isStrict?this._erasAbbrRegex:this._erasRegex}function erasNarrowRegex(isStrict){if(!hasOwnProp(this,"_erasNarrowRegex")){computeErasParse.call(this)}return isStrict?this._erasNarrowRegex:this._erasRegex}function matchEraAbbr(isStrict,locale){return locale.erasAbbrRegex(isStrict)}function matchEraName(isStrict,locale){return locale.erasNameRegex(isStrict)}function matchEraNarrow(isStrict,locale){return locale.erasNarrowRegex(isStrict)}function matchEraYearOrdinal(isStrict,locale){return locale._eraYearOrdinalRegex||matchUnsigned}function computeErasParse(){var abbrPieces=[],namePieces=[],narrowPieces=[],mixedPieces=[],i,l,eras=this.eras();for(i=0,l=eras.length;i<l;++i){namePieces.push(regexEscape(eras[i].name));abbrPieces.push(regexEscape(eras[i].abbr));narrowPieces.push(regexEscape(eras[i].narrow));mixedPieces.push(regexEscape(eras[i].name));mixedPieces.push(regexEscape(eras[i].abbr));mixedPieces.push(regexEscape(eras[i].narrow))}this._erasRegex=new RegExp("^("+mixedPieces.join("|")+")","i");this._erasNameRegex=new RegExp("^("+namePieces.join("|")+")","i");this._erasAbbrRegex=new RegExp("^("+abbrPieces.join("|")+")","i");this._erasNarrowRegex=new RegExp("^("+narrowPieces.join("|")+")","i")}addFormatToken(0,["gg",2],0,function(){return this.weekYear()%100});addFormatToken(0,["GG",2],0,function(){return this.isoWeekYear()%100});function addWeekYearFormatToken(token,getter){addFormatToken(0,[token,token.length],0,getter)}addWeekYearFormatToken("gggg","weekYear");addWeekYearFormatToken("ggggg","weekYear");addWeekYearFormatToken("GGGG","isoWeekYear");addWeekYearFormatToken("GGGGG","isoWeekYear");addUnitAlias("weekYear","gg");addUnitAlias("isoWeekYear","GG");addUnitPriority("weekYear",1);addUnitPriority("isoWeekYear",1);addRegexToken("G",matchSigned);addRegexToken("g",matchSigned);addRegexToken("GG",match1to2,match2);addRegexToken("gg",match1to2,match2);addRegexToken("GGGG",match1to4,match4);addRegexToken("gggg",match1to4,match4);addRegexToken("GGGGG",match1to6,match6);addRegexToken("ggggg",match1to6,match6);addWeekParseToken(["gggg","ggggg","GGGG","GGGGG"],function(input,week,config,token){week[token.substr(0,2)]=toInt(input)});addWeekParseToken(["gg","GG"],function(input,week,config,token){week[token]=hooks.parseTwoDigitYear(input)});function getSetWeekYear(input){return getSetWeekYearHelper.call(this,input,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function getSetISOWeekYear(input){return getSetWeekYearHelper.call(this,input,this.isoWeek(),this.isoWeekday(),1,4)}function getISOWeeksInYear(){return weeksInYear(this.year(),1,4)}function getISOWeeksInISOWeekYear(){return weeksInYear(this.isoWeekYear(),1,4)}function getWeeksInYear(){var weekInfo=this.localeData()._week;return weeksInYear(this.year(),weekInfo.dow,weekInfo.doy)}function getWeeksInWeekYear(){var weekInfo=this.localeData()._week;return weeksInYear(this.weekYear(),weekInfo.dow,weekInfo.doy)}function getSetWeekYearHelper(input,week,weekday,dow,doy){var weeksTarget;if(input==null){return weekOfYear(this,dow,doy).year}else{weeksTarget=weeksInYear(input,dow,doy);if(week>weeksTarget){week=weeksTarget}return setWeekAll.call(this,input,week,weekday,dow,doy)}}function setWeekAll(weekYear,week,weekday,dow,doy){var dayOfYearData=dayOfYearFromWeeks(weekYear,week,weekday,dow,doy),date=createUTCDate(dayOfYearData.year,0,dayOfYearData.dayOfYear);this.year(date.getUTCFullYear());this.month(date.getUTCMonth());this.date(date.getUTCDate());return this}addFormatToken("Q",0,"Qo","quarter");addUnitAlias("quarter","Q");addUnitPriority("quarter",7);addRegexToken("Q",match1);addParseToken("Q",function(input,array){array[MONTH]=(toInt(input)-1)*3});function getSetQuarter(input){return input==null?Math.ceil((this.month()+1)/3):this.month((input-1)*3+this.month()%3)}addFormatToken("D",["DD",2],"Do","date");addUnitAlias("date","D");addUnitPriority("date",9);addRegexToken("D",match1to2);addRegexToken("DD",match1to2,match2);addRegexToken("Do",function(isStrict,locale){return isStrict?locale._dayOfMonthOrdinalParse||locale._ordinalParse:locale._dayOfMonthOrdinalParseLenient});addParseToken(["D","DD"],DATE);addParseToken("Do",function(input,array){array[DATE]=toInt(input.match(match1to2)[0])});var getSetDayOfMonth=makeGetSet("Date",true);addFormatToken("DDD",["DDDD",3],"DDDo","dayOfYear");addUnitAlias("dayOfYear","DDD");addUnitPriority("dayOfYear",4);addRegexToken("DDD",match1to3);addRegexToken("DDDD",match3);addParseToken(["DDD","DDDD"],function(input,array,config){config._dayOfYear=toInt(input)});function getSetDayOfYear(input){var dayOfYear=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return input==null?dayOfYear:this.add(input-dayOfYear,"d")}addFormatToken("m",["mm",2],0,"minute");addUnitAlias("minute","m");addUnitPriority("minute",14);addRegexToken("m",match1to2);addRegexToken("mm",match1to2,match2);addParseToken(["m","mm"],MINUTE);var getSetMinute=makeGetSet("Minutes",false);addFormatToken("s",["ss",2],0,"second");addUnitAlias("second","s");addUnitPriority("second",15);addRegexToken("s",match1to2);addRegexToken("ss",match1to2,match2);addParseToken(["s","ss"],SECOND);var getSetSecond=makeGetSet("Seconds",false);addFormatToken("S",0,0,function(){return~~(this.millisecond()/100)});addFormatToken(0,["SS",2],0,function(){return~~(this.millisecond()/10)});addFormatToken(0,["SSS",3],0,"millisecond");addFormatToken(0,["SSSS",4],0,function(){return this.millisecond()*10});addFormatToken(0,["SSSSS",5],0,function(){return this.millisecond()*100});addFormatToken(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});addFormatToken(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});addFormatToken(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});addFormatToken(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});addUnitAlias("millisecond","ms");addUnitPriority("millisecond",16);addRegexToken("S",match1to3,match1);addRegexToken("SS",match1to3,match2);addRegexToken("SSS",match1to3,match3);var token,getSetMillisecond;for(token="SSSS";token.length<=9;token+="S"){addRegexToken(token,matchUnsigned)}function parseMs(input,array){array[MILLISECOND]=toInt(("0."+input)*1e3)}for(token="S";token.length<=9;token+="S"){addParseToken(token,parseMs)}getSetMillisecond=makeGetSet("Milliseconds",false);addFormatToken("z",0,0,"zoneAbbr");addFormatToken("zz",0,0,"zoneName");function getZoneAbbr(){return this._isUTC?"UTC":""}function getZoneName(){return this._isUTC?"Coordinated Universal Time":""}var proto=Moment.prototype;proto.add=add;proto.calendar=calendar$1;proto.clone=clone;proto.diff=diff;proto.endOf=endOf;proto.format=format;proto.from=from;proto.fromNow=fromNow;proto.to=to;proto.toNow=toNow;proto.get=stringGet;proto.invalidAt=invalidAt;proto.isAfter=isAfter;proto.isBefore=isBefore;proto.isBetween=isBetween;proto.isSame=isSame;proto.isSameOrAfter=isSameOrAfter;proto.isSameOrBefore=isSameOrBefore;proto.isValid=isValid$2;proto.lang=lang;proto.locale=locale;proto.localeData=localeData;proto.max=prototypeMax;proto.min=prototypeMin;proto.parsingFlags=parsingFlags;proto.set=stringSet;proto.startOf=startOf;proto.subtract=subtract;proto.toArray=toArray;proto.toObject=toObject;proto.toDate=toDate;proto.toISOString=toISOString;proto.inspect=inspect;if(typeof Symbol!=="undefined"&&Symbol.for!=null){proto[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}}proto.toJSON=toJSON;proto.toString=toString;proto.unix=unix;proto.valueOf=valueOf;proto.creationData=creationData;proto.eraName=getEraName;proto.eraNarrow=getEraNarrow;proto.eraAbbr=getEraAbbr;proto.eraYear=getEraYear;proto.year=getSetYear;proto.isLeapYear=getIsLeapYear;proto.weekYear=getSetWeekYear;proto.isoWeekYear=getSetISOWeekYear;proto.quarter=proto.quarters=getSetQuarter;proto.month=getSetMonth;proto.daysInMonth=getDaysInMonth;proto.week=proto.weeks=getSetWeek;proto.isoWeek=proto.isoWeeks=getSetISOWeek;proto.weeksInYear=getWeeksInYear;proto.weeksInWeekYear=getWeeksInWeekYear;proto.isoWeeksInYear=getISOWeeksInYear;proto.isoWeeksInISOWeekYear=getISOWeeksInISOWeekYear;proto.date=getSetDayOfMonth;proto.day=proto.days=getSetDayOfWeek;proto.weekday=getSetLocaleDayOfWeek;proto.isoWeekday=getSetISODayOfWeek;proto.dayOfYear=getSetDayOfYear;proto.hour=proto.hours=getSetHour;proto.minute=proto.minutes=getSetMinute;proto.second=proto.seconds=getSetSecond;proto.millisecond=proto.milliseconds=getSetMillisecond;proto.utcOffset=getSetOffset;proto.utc=setOffsetToUTC;proto.local=setOffsetToLocal;proto.parseZone=setOffsetToParsedOffset;proto.hasAlignedHourOffset=hasAlignedHourOffset;proto.isDST=isDaylightSavingTime;proto.isLocal=isLocal;proto.isUtcOffset=isUtcOffset;proto.isUtc=isUtc;proto.isUTC=isUtc;proto.zoneAbbr=getZoneAbbr;proto.zoneName=getZoneName;proto.dates=deprecate("dates accessor is deprecated. Use date instead.",getSetDayOfMonth);proto.months=deprecate("months accessor is deprecated. Use month instead",getSetMonth);proto.years=deprecate("years accessor is deprecated. Use year instead",getSetYear);proto.zone=deprecate("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",getSetZone);proto.isDSTShifted=deprecate("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",isDaylightSavingTimeShifted);function createUnix(input){return createLocal(input*1e3)}function createInZone(){return createLocal.apply(null,arguments).parseZone()}function preParsePostFormat(string){return string}var proto$1=Locale.prototype;proto$1.calendar=calendar;proto$1.longDateFormat=longDateFormat;proto$1.invalidDate=invalidDate;proto$1.ordinal=ordinal;proto$1.preparse=preParsePostFormat;proto$1.postformat=preParsePostFormat;proto$1.relativeTime=relativeTime;proto$1.pastFuture=pastFuture;proto$1.set=set;proto$1.eras=localeEras;proto$1.erasParse=localeErasParse;proto$1.erasConvertYear=localeErasConvertYear;proto$1.erasAbbrRegex=erasAbbrRegex;proto$1.erasNameRegex=erasNameRegex;proto$1.erasNarrowRegex=erasNarrowRegex;proto$1.months=localeMonths;proto$1.monthsShort=localeMonthsShort;proto$1.monthsParse=localeMonthsParse;proto$1.monthsRegex=monthsRegex;proto$1.monthsShortRegex=monthsShortRegex;proto$1.week=localeWeek;proto$1.firstDayOfYear=localeFirstDayOfYear;proto$1.firstDayOfWeek=localeFirstDayOfWeek;proto$1.weekdays=localeWeekdays;proto$1.weekdaysMin=localeWeekdaysMin;proto$1.weekdaysShort=localeWeekdaysShort;proto$1.weekdaysParse=localeWeekdaysParse;proto$1.weekdaysRegex=weekdaysRegex;proto$1.weekdaysShortRegex=weekdaysShortRegex;proto$1.weekdaysMinRegex=weekdaysMinRegex;proto$1.isPM=localeIsPM;proto$1.meridiem=localeMeridiem;function get$1(format,index,field,setter){var locale=getLocale(),utc=createUTC().set(setter,index);return locale[field](utc,format)}function listMonthsImpl(format,index,field){if(isNumber(format)){index=format;format=undefined}format=format||"";if(index!=null){return get$1(format,index,field,"month")}var i,out=[];for(i=0;i<12;i++){out[i]=get$1(format,i,field,"month")}return out}function listWeekdaysImpl(localeSorted,format,index,field){if(typeof localeSorted==="boolean"){if(isNumber(format)){index=format;format=undefined}format=format||""}else{format=localeSorted;index=format;localeSorted=false;if(isNumber(format)){index=format;format=undefined}format=format||""}var locale=getLocale(),shift=localeSorted?locale._week.dow:0,i,out=[];if(index!=null){return get$1(format,(index+shift)%7,field,"day")}for(i=0;i<7;i++){out[i]=get$1(format,(i+shift)%7,field,"day")}return out}function listMonths(format,index){return listMonthsImpl(format,index,"months")}function listMonthsShort(format,index){return listMonthsImpl(format,index,"monthsShort")}function listWeekdays(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdays")}function listWeekdaysShort(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdaysShort")}function listWeekdaysMin(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdaysMin")}getSetGlobalLocale("en",{eras:[{since:"0001-01-01",until:+Infinity,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-Infinity,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(number){var b=number%10,output=toInt(number%100/10)===1?"th":b===1?"st":b===2?"nd":b===3?"rd":"th";return number+output}});hooks.lang=deprecate("moment.lang is deprecated. Use moment.locale instead.",getSetGlobalLocale);hooks.langData=deprecate("moment.langData is deprecated. Use moment.localeData instead.",getLocale);var mathAbs=Math.abs;function abs(){var data=this._data;this._milliseconds=mathAbs(this._milliseconds);this._days=mathAbs(this._days);this._months=mathAbs(this._months);data.milliseconds=mathAbs(data.milliseconds);data.seconds=mathAbs(data.seconds);data.minutes=mathAbs(data.minutes);data.hours=mathAbs(data.hours);data.months=mathAbs(data.months);data.years=mathAbs(data.years);return this}function addSubtract$1(duration,input,value,direction){var other=createDuration(input,value);duration._milliseconds+=direction*other._milliseconds;duration._days+=direction*other._days;duration._months+=direction*other._months;return duration._bubble()}function add$1(input,value){return addSubtract$1(this,input,value,1)}function subtract$1(input,value){return addSubtract$1(this,input,value,-1)}function absCeil(number){if(number<0){return Math.floor(number)}else{return Math.ceil(number)}}function bubble(){var milliseconds=this._milliseconds,days=this._days,months=this._months,data=this._data,seconds,minutes,hours,years,monthsFromDays;if(!(milliseconds>=0&&days>=0&&months>=0||milliseconds<=0&&days<=0&&months<=0)){milliseconds+=absCeil(monthsToDays(months)+days)*864e5;days=0;months=0}data.milliseconds=milliseconds%1e3;seconds=absFloor(milliseconds/1e3);data.seconds=seconds%60;minutes=absFloor(seconds/60);data.minutes=minutes%60;hours=absFloor(minutes/60);data.hours=hours%24;days+=absFloor(hours/24);monthsFromDays=absFloor(daysToMonths(days));months+=monthsFromDays;days-=absCeil(monthsToDays(monthsFromDays));years=absFloor(months/12);months%=12;data.days=days;data.months=months;data.years=years;return this}function daysToMonths(days){return days*4800/146097}function monthsToDays(months){return months*146097/4800}function as(units){if(!this.isValid()){return NaN}var days,months,milliseconds=this._milliseconds;units=normalizeUnits(units);if(units==="month"||units==="quarter"||units==="year"){days=this._days+milliseconds/864e5;months=this._months+daysToMonths(days);switch(units){case"month":return months;case"quarter":return months/3;case"year":return months/12}}else{days=this._days+Math.round(monthsToDays(this._months));switch(units){case"week":return days/7+milliseconds/6048e5;case"day":return days+milliseconds/864e5;case"hour":return days*24+milliseconds/36e5;case"minute":return days*1440+milliseconds/6e4;case"second":return days*86400+milliseconds/1e3;case"millisecond":return Math.floor(days*864e5)+milliseconds;default:throw new Error("Unknown unit "+units)}}}function valueOf$1(){if(!this.isValid()){return NaN}return this._milliseconds+this._days*864e5+this._months%12*2592e6+toInt(this._months/12)*31536e6}function makeAs(alias){return function(){return this.as(alias)}}var asMilliseconds=makeAs("ms"),asSeconds=makeAs("s"),asMinutes=makeAs("m"),asHours=makeAs("h"),asDays=makeAs("d"),asWeeks=makeAs("w"),asMonths=makeAs("M"),asQuarters=makeAs("Q"),asYears=makeAs("y");function clone$1(){return createDuration(this)}function get$2(units){units=normalizeUnits(units);return this.isValid()?this[units+"s"]():NaN}function makeGetter(name){return function(){return this.isValid()?this._data[name]:NaN}}var milliseconds=makeGetter("milliseconds"),seconds=makeGetter("seconds"),minutes=makeGetter("minutes"),hours=makeGetter("hours"),days=makeGetter("days"),months=makeGetter("months"),years=makeGetter("years");function weeks(){return absFloor(this.days()/7)}var round=Math.round,thresholds={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function substituteTimeAgo(string,number,withoutSuffix,isFuture,locale){return locale.relativeTime(number||1,!!withoutSuffix,string,isFuture)}function relativeTime$1(posNegDuration,withoutSuffix,thresholds,locale){var duration=createDuration(posNegDuration).abs(),seconds=round(duration.as("s")),minutes=round(duration.as("m")),hours=round(duration.as("h")),days=round(duration.as("d")),months=round(duration.as("M")),weeks=round(duration.as("w")),years=round(duration.as("y")),a=seconds<=thresholds.ss&&["s",seconds]||seconds<thresholds.s&&["ss",seconds]||minutes<=1&&["m"]||minutes<thresholds.m&&["mm",minutes]||hours<=1&&["h"]||hours<thresholds.h&&["hh",hours]||days<=1&&["d"]||days<thresholds.d&&["dd",days];if(thresholds.w!=null){a=a||weeks<=1&&["w"]||weeks<thresholds.w&&["ww",weeks]}a=a||months<=1&&["M"]||months<thresholds.M&&["MM",months]||years<=1&&["y"]||["yy",years];a[2]=withoutSuffix;a[3]=+posNegDuration>0;a[4]=locale;return substituteTimeAgo.apply(null,a)}function getSetRelativeTimeRounding(roundingFunction){if(roundingFunction===undefined){return round}if(typeof roundingFunction==="function"){round=roundingFunction;return true}return false}function getSetRelativeTimeThreshold(threshold,limit){if(thresholds[threshold]===undefined){return false}if(limit===undefined){return thresholds[threshold]}thresholds[threshold]=limit;if(threshold==="s"){thresholds.ss=limit-1}return true}function humanize(argWithSuffix,argThresholds){if(!this.isValid()){return this.localeData().invalidDate()}var withSuffix=false,th=thresholds,locale,output;if(typeof argWithSuffix==="object"){argThresholds=argWithSuffix;argWithSuffix=false}if(typeof argWithSuffix==="boolean"){withSuffix=argWithSuffix}if(typeof argThresholds==="object"){th=Object.assign({},thresholds,argThresholds);if(argThresholds.s!=null&&argThresholds.ss==null){th.ss=argThresholds.s-1}}locale=this.localeData();output=relativeTime$1(this,!withSuffix,th,locale);if(withSuffix){output=locale.pastFuture(+this,output)}return locale.postformat(output)}var abs$1=Math.abs;function sign(x){return(x>0)-(x<0)||+x}function toISOString$1(){if(!this.isValid()){return this.localeData().invalidDate()}var seconds=abs$1(this._milliseconds)/1e3,days=abs$1(this._days),months=abs$1(this._months),minutes,hours,years,s,total=this.asSeconds(),totalSign,ymSign,daysSign,hmsSign;if(!total){return"P0D"}minutes=absFloor(seconds/60);hours=absFloor(minutes/60);seconds%=60;minutes%=60;years=absFloor(months/12);months%=12;s=seconds?seconds.toFixed(3).replace(/\.?0+$/,""):"";totalSign=total<0?"-":"";ymSign=sign(this._months)!==sign(total)?"-":"";daysSign=sign(this._days)!==sign(total)?"-":"";hmsSign=sign(this._milliseconds)!==sign(total)?"-":"";return totalSign+"P"+(years?ymSign+years+"Y":"")+(months?ymSign+months+"M":"")+(days?daysSign+days+"D":"")+(hours||minutes||seconds?"T":"")+(hours?hmsSign+hours+"H":"")+(minutes?hmsSign+minutes+"M":"")+(seconds?hmsSign+s+"S":"")}var proto$2=Duration.prototype;proto$2.isValid=isValid$1;proto$2.abs=abs;proto$2.add=add$1;proto$2.subtract=subtract$1;proto$2.as=as;proto$2.asMilliseconds=asMilliseconds;proto$2.asSeconds=asSeconds;proto$2.asMinutes=asMinutes;proto$2.asHours=asHours;proto$2.asDays=asDays;proto$2.asWeeks=asWeeks;proto$2.asMonths=asMonths;proto$2.asQuarters=asQuarters;proto$2.asYears=asYears;proto$2.valueOf=valueOf$1;proto$2._bubble=bubble;proto$2.clone=clone$1;proto$2.get=get$2;proto$2.milliseconds=milliseconds;proto$2.seconds=seconds;proto$2.minutes=minutes;proto$2.hours=hours;proto$2.days=days;proto$2.weeks=weeks;proto$2.months=months;proto$2.years=years;proto$2.humanize=humanize;proto$2.toISOString=toISOString$1;proto$2.toString=toISOString$1;proto$2.toJSON=toISOString$1;proto$2.locale=locale;proto$2.localeData=localeData;proto$2.toIsoString=deprecate("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",toISOString$1);proto$2.lang=lang;addFormatToken("X",0,0,"unix");addFormatToken("x",0,0,"valueOf");addRegexToken("x",matchSigned);addRegexToken("X",matchTimestamp);addParseToken("X",function(input,array,config){config._d=new Date(parseFloat(input)*1e3)});addParseToken("x",function(input,array,config){config._d=new Date(toInt(input))});hooks.version="2.29.4";setHookCallback(createLocal);hooks.fn=proto;hooks.min=min;hooks.max=max;hooks.now=now;hooks.utc=createUTC;hooks.unix=createUnix;hooks.months=listMonths;hooks.isDate=isDate;hooks.locale=getSetGlobalLocale;hooks.invalid=createInvalid;hooks.duration=createDuration;hooks.isMoment=isMoment;hooks.weekdays=listWeekdays;hooks.parseZone=createInZone;hooks.localeData=getLocale;hooks.isDuration=isDuration;hooks.monthsShort=listMonthsShort;hooks.weekdaysMin=listWeekdaysMin;hooks.defineLocale=defineLocale;hooks.updateLocale=updateLocale;hooks.locales=listLocales;hooks.weekdaysShort=listWeekdaysShort;hooks.normalizeUnits=normalizeUnits;hooks.relativeTimeRounding=getSetRelativeTimeRounding;hooks.relativeTimeThreshold=getSetRelativeTimeThreshold;hooks.calendarFormat=getCalendarFormat;hooks.prototype=proto;hooks.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};return hooks})},{}],201:[function(require,module,exports){var hasMap=typeof Map==="function"&&Map.prototype;var mapSizeDescriptor=Object.getOwnPropertyDescriptor&&hasMap?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null;var mapSize=hasMap&&mapSizeDescriptor&&typeof mapSizeDescriptor.get==="function"?mapSizeDescriptor.get:null;var mapForEach=hasMap&&Map.prototype.forEach;var hasSet=typeof Set==="function"&&Set.prototype;var setSizeDescriptor=Object.getOwnPropertyDescriptor&&hasSet?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null;var setSize=hasSet&&setSizeDescriptor&&typeof setSizeDescriptor.get==="function"?setSizeDescriptor.get:null;var setForEach=hasSet&&Set.prototype.forEach;var hasWeakMap=typeof WeakMap==="function"&&WeakMap.prototype;var weakMapHas=hasWeakMap?WeakMap.prototype.has:null;var hasWeakSet=typeof WeakSet==="function"&&WeakSet.prototype;var weakSetHas=hasWeakSet?WeakSet.prototype.has:null;var hasWeakRef=typeof WeakRef==="function"&&WeakRef.prototype;var weakRefDeref=hasWeakRef?WeakRef.prototype.deref:null;var booleanValueOf=Boolean.prototype.valueOf;var objectToString=Object.prototype.toString;var functionToString=Function.prototype.toString;var $match=String.prototype.match;var $slice=String.prototype.slice;var $replace=String.prototype.replace;var $toUpperCase=String.prototype.toUpperCase;var $toLowerCase=String.prototype.toLowerCase;var $test=RegExp.prototype.test;var $concat=Array.prototype.concat;var $join=Array.prototype.join;var $arrSlice=Array.prototype.slice;var $floor=Math.floor;var bigIntValueOf=typeof BigInt==="function"?BigInt.prototype.valueOf:null;var gOPS=Object.getOwnPropertySymbols;var symToString=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?Symbol.prototype.toString:null;var hasShammedSymbols=typeof Symbol==="function"&&typeof Symbol.iterator==="object";var toStringTag=typeof Symbol==="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===hasShammedSymbols?"object":"symbol")?Symbol.toStringTag:null;var isEnumerable=Object.prototype.propertyIsEnumerable;var gPO=(typeof Reflect==="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(O){return O.__proto__}:null);function addNumericSeparator(num,str){if(num===Infinity||num===-Infinity||num!==num||num&&num>-1e3&&num<1e3||$test.call(/e/,str)){return str}var sepRegex=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof num==="number"){var int=num<0?-$floor(-num):$floor(num);if(int!==num){var intStr=String(int);var dec=$slice.call(str,intStr.length+1);return $replace.call(intStr,sepRegex,"$&_")+"."+$replace.call($replace.call(dec,/([0-9]{3})/g,"$&_"),/_$/,"")}}return $replace.call(str,sepRegex,"$&_")}var utilInspect=require("./util.inspect");var inspectCustom=utilInspect.custom;var inspectSymbol=isSymbol(inspectCustom)?inspectCustom:null;module.exports=function inspect_(obj,options,depth,seen){var opts=options||{};if(has(opts,"quoteStyle")&&(opts.quoteStyle!=="single"&&opts.quoteStyle!=="double")){throw new TypeError('option "quoteStyle" must be "single" or "double"')}if(has(opts,"maxStringLength")&&(typeof opts.maxStringLength==="number"?opts.maxStringLength<0&&opts.maxStringLength!==Infinity:opts.maxStringLength!==null)){throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`')}var customInspect=has(opts,"customInspect")?opts.customInspect:true;if(typeof customInspect!=="boolean"&&customInspect!=="symbol"){throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`")}if(has(opts,"indent")&&opts.indent!==null&&opts.indent!=="\t"&&!(parseInt(opts.indent,10)===opts.indent&&opts.indent>0)){throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`')}if(has(opts,"numericSeparator")&&typeof opts.numericSeparator!=="boolean"){throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`')}var numericSeparator=opts.numericSeparator;if(typeof obj==="undefined"){return"undefined"}if(obj===null){return"null"}if(typeof obj==="boolean"){return obj?"true":"false"}if(typeof obj==="string"){return inspectString(obj,opts)}if(typeof obj==="number"){if(obj===0){return Infinity/obj>0?"0":"-0"}var str=String(obj);return numericSeparator?addNumericSeparator(obj,str):str}if(typeof obj==="bigint"){var bigIntStr=String(obj)+"n";return numericSeparator?addNumericSeparator(obj,bigIntStr):bigIntStr}var maxDepth=typeof opts.depth==="undefined"?5:opts.depth;if(typeof depth==="undefined"){depth=0}if(depth>=maxDepth&&maxDepth>0&&typeof obj==="object"){return isArray(obj)?"[Array]":"[Object]"}var indent=getIndent(opts,depth);if(typeof seen==="undefined"){seen=[]}else if(indexOf(seen,obj)>=0){return"[Circular]"}function inspect(value,from,noIndent){if(from){seen=$arrSlice.call(seen);seen.push(from)}if(noIndent){var newOpts={depth:opts.depth};if(has(opts,"quoteStyle")){newOpts.quoteStyle=opts.quoteStyle}return inspect_(value,newOpts,depth+1,seen)}return inspect_(value,opts,depth+1,seen)}if(typeof obj==="function"&&!isRegExp(obj)){var name=nameOf(obj);var keys=arrObjKeys(obj,inspect);return"[Function"+(name?": "+name:" (anonymous)")+"]"+(keys.length>0?" { "+$join.call(keys,", ")+" }":"")}if(isSymbol(obj)){var symString=hasShammedSymbols?$replace.call(String(obj),/^(Symbol\(.*\))_[^)]*$/,"$1"):symToString.call(obj);return typeof obj==="object"&&!hasShammedSymbols?markBoxed(symString):symString}if(isElement(obj)){var s="<"+$toLowerCase.call(String(obj.nodeName));var attrs=obj.attributes||[];for(var i=0;i<attrs.length;i++){s+=" "+attrs[i].name+"="+wrapQuotes(quote(attrs[i].value),"double",opts)}s+=">";if(obj.childNodes&&obj.childNodes.length){s+="..."}s+="</"+$toLowerCase.call(String(obj.nodeName))+">";return s}if(isArray(obj)){if(obj.length===0){return"[]"}var xs=arrObjKeys(obj,inspect);if(indent&&!singleLineValues(xs)){return"["+indentedJoin(xs,indent)+"]"}return"[ "+$join.call(xs,", ")+" ]"}if(isError(obj)){var parts=arrObjKeys(obj,inspect);if(!("cause"in Error.prototype)&&"cause"in obj&&!isEnumerable.call(obj,"cause")){return"{ ["+String(obj)+"] "+$join.call($concat.call("[cause]: "+inspect(obj.cause),parts),", ")+" }"}if(parts.length===0){return"["+String(obj)+"]"}return"{ ["+String(obj)+"] "+$join.call(parts,", ")+" }"}if(typeof obj==="object"&&customInspect){if(inspectSymbol&&typeof obj[inspectSymbol]==="function"&&utilInspect){return utilInspect(obj,{depth:maxDepth-depth})}else if(customInspect!=="symbol"&&typeof obj.inspect==="function"){return obj.inspect()}}if(isMap(obj)){var mapParts=[];mapForEach.call(obj,function(value,key){mapParts.push(inspect(key,obj,true)+" => "+inspect(value,obj))});return collectionOf("Map",mapSize.call(obj),mapParts,indent)}if(isSet(obj)){var setParts=[];setForEach.call(obj,function(value){setParts.push(inspect(value,obj))});return collectionOf("Set",setSize.call(obj),setParts,indent)}if(isWeakMap(obj)){return weakCollectionOf("WeakMap")}if(isWeakSet(obj)){return weakCollectionOf("WeakSet")}if(isWeakRef(obj)){return weakCollectionOf("WeakRef")}if(isNumber(obj)){return markBoxed(inspect(Number(obj)))}if(isBigInt(obj)){return markBoxed(inspect(bigIntValueOf.call(obj)))}if(isBoolean(obj)){return markBoxed(booleanValueOf.call(obj))}if(isString(obj)){return markBoxed(inspect(String(obj)))}if(!isDate(obj)&&!isRegExp(obj)){var ys=arrObjKeys(obj,inspect);var isPlainObject=gPO?gPO(obj)===Object.prototype:obj instanceof Object||obj.constructor===Object;var protoTag=obj instanceof Object?"":"null prototype";var stringTag=!isPlainObject&&toStringTag&&Object(obj)===obj&&toStringTag in obj?$slice.call(toStr(obj),8,-1):protoTag?"Object":"";var constructorTag=isPlainObject||typeof obj.constructor!=="function"?"":obj.constructor.name?obj.constructor.name+" ":"";var tag=constructorTag+(stringTag||protoTag?"["+$join.call($concat.call([],stringTag||[],protoTag||[]),": ")+"] ":"");if(ys.length===0){return tag+"{}"}if(indent){return tag+"{"+indentedJoin(ys,indent)+"}"}return tag+"{ "+$join.call(ys,", ")+" }"}return String(obj)};function wrapQuotes(s,defaultStyle,opts){var quoteChar=(opts.quoteStyle||defaultStyle)==="double"?'"':"'";return quoteChar+s+quoteChar}function quote(s){return $replace.call(String(s),/"/g,"&quot;")}function isArray(obj){return toStr(obj)==="[object Array]"&&(!toStringTag||!(typeof obj==="object"&&toStringTag in obj))}function isDate(obj){return toStr(obj)==="[object Date]"&&(!toStringTag||!(typeof obj==="object"&&toStringTag in obj))}function isRegExp(obj){return toStr(obj)==="[object RegExp]"&&(!toStringTag||!(typeof obj==="object"&&toStringTag in obj))}function isError(obj){return toStr(obj)==="[object Error]"&&(!toStringTag||!(typeof obj==="object"&&toStringTag in obj))}function isString(obj){return toStr(obj)==="[object String]"&&(!toStringTag||!(typeof obj==="object"&&toStringTag in obj))}function isNumber(obj){return toStr(obj)==="[object Number]"&&(!toStringTag||!(typeof obj==="object"&&toStringTag in obj))}function isBoolean(obj){return toStr(obj)==="[object Boolean]"&&(!toStringTag||!(typeof obj==="object"&&toStringTag in obj))}function isSymbol(obj){if(hasShammedSymbols){return obj&&typeof obj==="object"&&obj instanceof Symbol}if(typeof obj==="symbol"){return true}if(!obj||typeof obj!=="object"||!symToString){return false}try{symToString.call(obj);return true}catch(e){}return false}function isBigInt(obj){if(!obj||typeof obj!=="object"||!bigIntValueOf){return false}try{bigIntValueOf.call(obj);return true}catch(e){}return false}var hasOwn=Object.prototype.hasOwnProperty||function(key){return key in this};function has(obj,key){return hasOwn.call(obj,key)}function toStr(obj){return objectToString.call(obj)}function nameOf(f){if(f.name){return f.name}var m=$match.call(functionToString.call(f),/^function\s*([\w$]+)/);if(m){return m[1]}return null}function indexOf(xs,x){if(xs.indexOf){return xs.indexOf(x)}for(var i=0,l=xs.length;i<l;i++){if(xs[i]===x){return i}}return-1}function isMap(x){if(!mapSize||!x||typeof x!=="object"){return false}try{mapSize.call(x);try{setSize.call(x)}catch(s){return true}return x instanceof Map}catch(e){}return false}function isWeakMap(x){if(!weakMapHas||!x||typeof x!=="object"){return false}try{weakMapHas.call(x,weakMapHas);try{weakSetHas.call(x,weakSetHas)}catch(s){return true}return x instanceof WeakMap}catch(e){}return false}function isWeakRef(x){if(!weakRefDeref||!x||typeof x!=="object"){return false}try{weakRefDeref.call(x);return true}catch(e){}return false}function isSet(x){if(!setSize||!x||typeof x!=="object"){return false}try{setSize.call(x);try{mapSize.call(x)}catch(m){return true}return x instanceof Set}catch(e){}return false}function isWeakSet(x){if(!weakSetHas||!x||typeof x!=="object"){return false}try{weakSetHas.call(x,weakSetHas);try{weakMapHas.call(x,weakMapHas)}catch(s){return true}return x instanceof WeakSet}catch(e){}return false}function isElement(x){if(!x||typeof x!=="object"){return false}if(typeof HTMLElement!=="undefined"&&x instanceof HTMLElement){return true}return typeof x.nodeName==="string"&&typeof x.getAttribute==="function"}function inspectString(str,opts){if(str.length>opts.maxStringLength){var remaining=str.length-opts.maxStringLength;var trailer="... "+remaining+" more character"+(remaining>1?"s":"");return inspectString($slice.call(str,0,opts.maxStringLength),opts)+trailer}var s=$replace.call($replace.call(str,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,lowbyte);return wrapQuotes(s,"single",opts)}function lowbyte(c){var n=c.charCodeAt(0);var x={8:"b",9:"t",10:"n",12:"f",13:"r"}[n];if(x){return"\\"+x}return"\\x"+(n<16?"0":"")+$toUpperCase.call(n.toString(16))}function markBoxed(str){return"Object("+str+")"}function weakCollectionOf(type){return type+" { ? }"}function collectionOf(type,size,entries,indent){var joinedEntries=indent?indentedJoin(entries,indent):$join.call(entries,", ");return type+" ("+size+") {"+joinedEntries+"}"}function singleLineValues(xs){for(var i=0;i<xs.length;i++){if(indexOf(xs[i],"\n")>=0){return false}}return true}function getIndent(opts,depth){var baseIndent;if(opts.indent==="\t"){baseIndent="\t"}else if(typeof opts.indent==="number"&&opts.indent>0){baseIndent=$join.call(Array(opts.indent+1)," ")}else{return null}return{base:baseIndent,prev:$join.call(Array(depth+1),baseIndent)}}function indentedJoin(xs,indent){if(xs.length===0){return""}var lineJoiner="\n"+indent.prev+indent.base;return lineJoiner+$join.call(xs,","+lineJoiner)+"\n"+indent.prev}function arrObjKeys(obj,inspect){var isArr=isArray(obj);var xs=[];if(isArr){xs.length=obj.length;for(var i=0;i<obj.length;i++){xs[i]=has(obj,i)?inspect(obj[i],obj):""}}var syms=typeof gOPS==="function"?gOPS(obj):[];var symMap;if(hasShammedSymbols){symMap={};for(var k=0;k<syms.length;k++){symMap["$"+syms[k]]=syms[k]}}for(var key in obj){if(!has(obj,key)){continue}if(isArr&&String(Number(key))===key&&key<obj.length){continue}if(hasShammedSymbols&&symMap["$"+key]instanceof Symbol){continue}else if($test.call(/[^\w$]/,key)){xs.push(inspect(key,obj)+": "+inspect(obj[key],obj))}else{xs.push(key+": "+inspect(obj[key],obj))}}if(typeof gOPS==="function"){for(var j=0;j<syms.length;j++){if(isEnumerable.call(obj,syms[j])){xs.push("["+inspect(syms[j])+"]: "+inspect(obj[syms[j]],obj))}}}return xs}},{"./util.inspect":191}],202:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.pathToRegexp=exports.tokensToRegexp=exports.regexpToFunction=exports.match=exports.tokensToFunction=exports.compile=exports.parse=void 0;function lexer(str){var tokens=[];var i=0;while(i<str.length){var char=str[i];if(char==="*"||char==="+"||char==="?"){tokens.push({type:"MODIFIER",index:i,value:str[i++]});continue}if(char==="\\"){tokens.push({type:"ESCAPED_CHAR",index:i++,value:str[i++]});continue}if(char==="{"){tokens.push({type:"OPEN",index:i,value:str[i++]});continue}if(char==="}"){tokens.push({type:"CLOSE",index:i,value:str[i++]});continue}if(char===":"){var name="";var j=i+1;while(j<str.length){var code=str.charCodeAt(j);if(code>=48&&code<=57||code>=65&&code<=90||code>=97&&code<=122||code===95){name+=str[j++];continue}break}if(!name)throw new TypeError("Missing parameter name at ".concat(i));tokens.push({type:"NAME",index:i,value:name});i=j;continue}if(char==="("){var count=1;var pattern="";var j=i+1;if(str[j]==="?"){throw new TypeError('Pattern cannot start with "?" at '.concat(j))}while(j<str.length){if(str[j]==="\\"){pattern+=str[j++]+str[j++];continue}if(str[j]===")"){count--;if(count===0){j++;break}}else if(str[j]==="("){count++;if(str[j+1]!=="?"){throw new TypeError("Capturing groups are not allowed at ".concat(j))}}pattern+=str[j++]}if(count)throw new TypeError("Unbalanced pattern at ".concat(i));if(!pattern)throw new TypeError("Missing pattern at ".concat(i));tokens.push({type:"PATTERN",index:i,value:pattern});i=j;continue}tokens.push({type:"CHAR",index:i,value:str[i++]})}tokens.push({type:"END",index:i,value:""});return tokens}function parse(str,options){if(options===void 0){options={}}var tokens=lexer(str);var _a=options.prefixes,prefixes=_a===void 0?"./":_a;var defaultPattern="[^".concat(escapeString(options.delimiter||"/#?"),"]+?");var result=[];var key=0;var i=0;var path="";var tryConsume=function(type){if(i<tokens.length&&tokens[i].type===type)return tokens[i++].value};var mustConsume=function(type){var value=tryConsume(type);if(value!==undefined)return value;var _a=tokens[i],nextType=_a.type,index=_a.index;throw new TypeError("Unexpected ".concat(nextType," at ").concat(index,", expected ").concat(type))};var consumeText=function(){var result="";var value;while(value=tryConsume("CHAR")||tryConsume("ESCAPED_CHAR")){result+=value}return result};while(i<tokens.length){var char=tryConsume("CHAR");var name=tryConsume("NAME");var pattern=tryConsume("PATTERN");if(name||pattern){var prefix=char||"";if(prefixes.indexOf(prefix)===-1){path+=prefix;prefix=""}if(path){result.push(path);path=""}result.push({name:name||key++,prefix:prefix,suffix:"",pattern:pattern||defaultPattern,modifier:tryConsume("MODIFIER")||""});continue}var value=char||tryConsume("ESCAPED_CHAR");if(value){path+=value;continue}if(path){result.push(path);path=""}var open=tryConsume("OPEN");if(open){var prefix=consumeText();var name_1=tryConsume("NAME")||"";var pattern_1=tryConsume("PATTERN")||"";var suffix=consumeText();mustConsume("CLOSE");result.push({name:name_1||(pattern_1?key++:""),pattern:name_1&&!pattern_1?defaultPattern:pattern_1,prefix:prefix,suffix:suffix,modifier:tryConsume("MODIFIER")||""});continue}mustConsume("END")}return result}exports.parse=parse;function compile(str,options){return tokensToFunction(parse(str,options),options)}exports.compile=compile;function tokensToFunction(tokens,options){if(options===void 0){options={}}var reFlags=flags(options);var _a=options.encode,encode=_a===void 0?function(x){return x}:_a,_b=options.validate,validate=_b===void 0?true:_b;var matches=tokens.map(function(token){if(typeof token==="object"){return new RegExp("^(?:".concat(token.pattern,")$"),reFlags)}});return function(data){var path="";for(var i=0;i<tokens.length;i++){var token=tokens[i];if(typeof token==="string"){path+=token;continue}var value=data?data[token.name]:undefined;var optional=token.modifier==="?"||token.modifier==="*";var repeat=token.modifier==="*"||token.modifier==="+";if(Array.isArray(value)){if(!repeat){throw new TypeError('Expected "'.concat(token.name,'" to not repeat, but got an array'))}if(value.length===0){if(optional)continue;throw new TypeError('Expected "'.concat(token.name,'" to not be empty'))}for(var j=0;j<value.length;j++){var segment=encode(value[j],token);if(validate&&!matches[i].test(segment)){throw new TypeError('Expected all "'.concat(token.name,'" to match "').concat(token.pattern,'", but got "').concat(segment,'"'))}path+=token.prefix+segment+token.suffix}continue}if(typeof value==="string"||typeof value==="number"){var segment=encode(String(value),token);if(validate&&!matches[i].test(segment)){throw new TypeError('Expected "'.concat(token.name,'" to match "').concat(token.pattern,'", but got "').concat(segment,'"'))}path+=token.prefix+segment+token.suffix;continue}if(optional)continue;var typeOfMessage=repeat?"an array":"a string";throw new TypeError('Expected "'.concat(token.name,'" to be ').concat(typeOfMessage))}return path}}exports.tokensToFunction=tokensToFunction;function match(str,options){var keys=[];var re=pathToRegexp(str,keys,options);return regexpToFunction(re,keys,options)}exports.match=match;function regexpToFunction(re,keys,options){if(options===void 0){options={}}var _a=options.decode,decode=_a===void 0?function(x){return x}:_a;return function(pathname){var m=re.exec(pathname);if(!m)return false;var path=m[0],index=m.index;var params=Object.create(null);var _loop_1=function(i){if(m[i]===undefined)return"continue";var key=keys[i-1];if(key.modifier==="*"||key.modifier==="+"){params[key.name]=m[i].split(key.prefix+key.suffix).map(function(value){return decode(value,key)})}else{params[key.name]=decode(m[i],key)}};for(var i=1;i<m.length;i++){_loop_1(i)}return{path:path,index:index,params:params}}}exports.regexpToFunction=regexpToFunction;function escapeString(str){return str.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function flags(options){return options&&options.sensitive?"":"i"}function regexpToRegexp(path,keys){if(!keys)return path;var groupsRegex=/\((?:\?<(.*?)>)?(?!\?)/g;var index=0;var execResult=groupsRegex.exec(path.source);while(execResult){keys.push({name:execResult[1]||index++,prefix:"",suffix:"",modifier:"",pattern:""});execResult=groupsRegex.exec(path.source)}return path}function arrayToRegexp(paths,keys,options){var parts=paths.map(function(path){return pathToRegexp(path,keys,options).source});return new RegExp("(?:".concat(parts.join("|"),")"),flags(options))}function stringToRegexp(path,keys,options){return tokensToRegexp(parse(path,options),keys,options)}function tokensToRegexp(tokens,keys,options){if(options===void 0){options={}}var _a=options.strict,strict=_a===void 0?false:_a,_b=options.start,start=_b===void 0?true:_b,_c=options.end,end=_c===void 0?true:_c,_d=options.encode,encode=_d===void 0?function(x){return x}:_d,_e=options.delimiter,delimiter=_e===void 0?"/#?":_e,_f=options.endsWith,endsWith=_f===void 0?"":_f;var endsWithRe="[".concat(escapeString(endsWith),"]|$");var delimiterRe="[".concat(escapeString(delimiter),"]");var route=start?"^":"";for(var _i=0,tokens_1=tokens;_i<tokens_1.length;_i++){var token=tokens_1[_i];if(typeof token==="string"){route+=escapeString(encode(token))}else{var prefix=escapeString(encode(token.prefix));var suffix=escapeString(encode(token.suffix));if(token.pattern){if(keys)keys.push(token);if(prefix||suffix){if(token.modifier==="+"||token.modifier==="*"){var mod=token.modifier==="*"?"?":"";route+="(?:".concat(prefix,"((?:").concat(token.pattern,")(?:").concat(suffix).concat(prefix,"(?:").concat(token.pattern,"))*)").concat(suffix,")").concat(mod)}else{route+="(?:".concat(prefix,"(").concat(token.pattern,")").concat(suffix,")").concat(token.modifier)}}else{if(token.modifier==="+"||token.modifier==="*"){route+="((?:".concat(token.pattern,")").concat(token.modifier,")")}else{route+="(".concat(token.pattern,")").concat(token.modifier)}}}else{route+="(?:".concat(prefix).concat(suffix,")").concat(token.modifier)}}}if(end){if(!strict)route+="".concat(delimiterRe,"?");route+=!options.endsWith?"$":"(?=".concat(endsWithRe,")")}else{var endToken=tokens[tokens.length-1];var isEndDelimited=typeof endToken==="string"?delimiterRe.indexOf(endToken[endToken.length-1])>-1:endToken===undefined;if(!strict){route+="(?:".concat(delimiterRe,"(?=").concat(endsWithRe,"))?")}if(!isEndDelimited){route+="(?=".concat(delimiterRe,"|").concat(endsWithRe,")")}}return new RegExp(route,flags(options))}exports.tokensToRegexp=tokensToRegexp;function pathToRegexp(path,keys,options){if(path instanceof RegExp)return regexpToRegexp(path,keys);if(Array.isArray(path))return arrayToRegexp(path,keys,options);return stringToRegexp(path,keys,options)}exports.pathToRegexp=pathToRegexp},{}],203:[function(require,module,exports){var process=module.exports={};var cachedSetTimeout;var cachedClearTimeout;function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){cachedSetTimeout=setTimeout}else{cachedSetTimeout=defaultSetTimout}}catch(e){cachedSetTimeout=defaultSetTimout}try{if(typeof clearTimeout==="function"){cachedClearTimeout=clearTimeout}else{cachedClearTimeout=defaultClearTimeout}}catch(e){cachedClearTimeout=defaultClearTimeout}})();function runTimeout(fun){if(cachedSetTimeout===setTimeout){return setTimeout(fun,0)}if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout){cachedSetTimeout=setTimeout;return setTimeout(fun,0)}try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout){return clearTimeout(marker)}if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout){cachedClearTimeout=clearTimeout;return clearTimeout(marker)}try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}var queue=[];var draining=false;var currentQueue;var queueIndex=-1;function cleanUpNextTick(){if(!draining||!currentQueue){return}draining=false;if(currentQueue.length){queue=currentQueue.concat(queue)}else{queueIndex=-1}if(queue.length){drainQueue()}}function drainQueue(){if(draining){return}var timeout=runTimeout(cleanUpNextTick);draining=true;var len=queue.length;while(len){currentQueue=queue;queue=[];while(++queueIndex<len){if(currentQueue){currentQueue[queueIndex].run()}}queueIndex=-1;len=queue.length}currentQueue=null;draining=false;runClearTimeout(timeout)}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1){for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i]}}queue.push(new Item(fun,args));if(queue.length===1&&!draining){runTimeout(drainQueue)}};function Item(fun,array){this.fun=fun;this.array=array}Item.prototype.run=function(){this.fun.apply(null,this.array)};process.title="browser";process.browser=true;process.env={};process.argv=[];process.version="";process.versions={};function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.prependListener=noop;process.prependOnceListener=noop;process.listeners=function(name){return[]};process.binding=function(name){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported")};process.umask=function(){return 0}},{}],204:[function(require,module,exports){"use strict";var replace=String.prototype.replace;var percentTwenties=/%20/g;var Format={RFC1738:"RFC1738",RFC3986:"RFC3986"};module.exports={default:Format.RFC3986,formatters:{RFC1738:function(value){return replace.call(value,percentTwenties,"+")},RFC3986:function(value){return String(value)}},RFC1738:Format.RFC1738,RFC3986:Format.RFC3986}},{}],205:[function(require,module,exports){"use strict";var stringify=require("./stringify");var parse=require("./parse");var formats=require("./formats");module.exports={formats:formats,parse:parse,stringify:stringify}},{"./formats":204,"./parse":206,"./stringify":207}],206:[function(require,module,exports){"use strict";var utils=require("./utils");var has=Object.prototype.hasOwnProperty;var isArray=Array.isArray;var defaults={allowDots:false,allowPrototypes:false,allowSparse:false,arrayLimit:20,charset:"utf-8",charsetSentinel:false,comma:false,decoder:utils.decode,delimiter:"&",depth:5,ignoreQueryPrefix:false,interpretNumericEntities:false,parameterLimit:1e3,parseArrays:true,plainObjects:false,strictNullHandling:false};var interpretNumericEntities=function(str){return str.replace(/&#(\d+);/g,function($0,numberStr){return String.fromCharCode(parseInt(numberStr,10))})};var parseArrayValue=function(val,options){if(val&&typeof val==="string"&&options.comma&&val.indexOf(",")>-1){return val.split(",")}return val};var isoSentinel="utf8=%26%2310003%3B";var charsetSentinel="utf8=%E2%9C%93";var parseValues=function parseQueryStringValues(str,options){var obj={};var cleanStr=options.ignoreQueryPrefix?str.replace(/^\?/,""):str;var limit=options.parameterLimit===Infinity?undefined:options.parameterLimit;var parts=cleanStr.split(options.delimiter,limit);var skipIndex=-1;var i;var charset=options.charset;if(options.charsetSentinel){for(i=0;i<parts.length;++i){if(parts[i].indexOf("utf8=")===0){if(parts[i]===charsetSentinel){charset="utf-8"}else if(parts[i]===isoSentinel){charset="iso-8859-1"}skipIndex=i;i=parts.length}}}for(i=0;i<parts.length;++i){if(i===skipIndex){continue}var part=parts[i];var bracketEqualsPos=part.indexOf("]=");var pos=bracketEqualsPos===-1?part.indexOf("="):bracketEqualsPos+1;var key,val;if(pos===-1){key=options.decoder(part,defaults.decoder,charset,"key");val=options.strictNullHandling?null:""}else{key=options.decoder(part.slice(0,pos),defaults.decoder,charset,"key");val=utils.maybeMap(parseArrayValue(part.slice(pos+1),options),function(encodedVal){return options.decoder(encodedVal,defaults.decoder,charset,"value")})}if(val&&options.interpretNumericEntities&&charset==="iso-8859-1"){val=interpretNumericEntities(val)}if(part.indexOf("[]=")>-1){val=isArray(val)?[val]:val}if(has.call(obj,key)){obj[key]=utils.combine(obj[key],val)}else{obj[key]=val}}return obj};var parseObject=function(chain,val,options,valuesParsed){var leaf=valuesParsed?val:parseArrayValue(val,options);for(var i=chain.length-1;i>=0;--i){var obj;var root=chain[i];if(root==="[]"&&options.parseArrays){obj=[].concat(leaf)}else{obj=options.plainObjects?Object.create(null):{};var cleanRoot=root.charAt(0)==="["&&root.charAt(root.length-1)==="]"?root.slice(1,-1):root;var index=parseInt(cleanRoot,10);if(!options.parseArrays&&cleanRoot===""){obj={0:leaf}}else if(!isNaN(index)&&root!==cleanRoot&&String(index)===cleanRoot&&index>=0&&(options.parseArrays&&index<=options.arrayLimit)){obj=[];obj[index]=leaf}else if(cleanRoot!=="__proto__"){obj[cleanRoot]=leaf}}leaf=obj}return leaf};var parseKeys=function parseQueryStringKeys(givenKey,val,options,valuesParsed){if(!givenKey){return}var key=options.allowDots?givenKey.replace(/\.([^.[]+)/g,"[$1]"):givenKey;var brackets=/(\[[^[\]]*])/;var child=/(\[[^[\]]*])/g;var segment=options.depth>0&&brackets.exec(key);var parent=segment?key.slice(0,segment.index):key;var keys=[];if(parent){if(!options.plainObjects&&has.call(Object.prototype,parent)){if(!options.allowPrototypes){return}}keys.push(parent)}var i=0;while(options.depth>0&&(segment=child.exec(key))!==null&&i<options.depth){i+=1;if(!options.plainObjects&&has.call(Object.prototype,segment[1].slice(1,-1))){if(!options.allowPrototypes){return}}keys.push(segment[1])}if(segment){keys.push("["+key.slice(segment.index)+"]")}return parseObject(keys,val,options,valuesParsed)};var normalizeParseOptions=function normalizeParseOptions(opts){if(!opts){return defaults}if(opts.decoder!==null&&opts.decoder!==undefined&&typeof opts.decoder!=="function"){throw new TypeError("Decoder has to be a function.")}if(typeof opts.charset!=="undefined"&&opts.charset!=="utf-8"&&opts.charset!=="iso-8859-1"){throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined")}var charset=typeof opts.charset==="undefined"?defaults.charset:opts.charset;return{allowDots:typeof opts.allowDots==="undefined"?defaults.allowDots:!!opts.allowDots,allowPrototypes:typeof opts.allowPrototypes==="boolean"?opts.allowPrototypes:defaults.allowPrototypes,allowSparse:typeof opts.allowSparse==="boolean"?opts.allowSparse:defaults.allowSparse,arrayLimit:typeof opts.arrayLimit==="number"?opts.arrayLimit:defaults.arrayLimit,charset:charset,charsetSentinel:typeof opts.charsetSentinel==="boolean"?opts.charsetSentinel:defaults.charsetSentinel,comma:typeof opts.comma==="boolean"?opts.comma:defaults.comma,decoder:typeof opts.decoder==="function"?opts.decoder:defaults.decoder,delimiter:typeof opts.delimiter==="string"||utils.isRegExp(opts.delimiter)?opts.delimiter:defaults.delimiter,depth:typeof opts.depth==="number"||opts.depth===false?+opts.depth:defaults.depth,ignoreQueryPrefix:opts.ignoreQueryPrefix===true,interpretNumericEntities:typeof opts.interpretNumericEntities==="boolean"?opts.interpretNumericEntities:defaults.interpretNumericEntities,parameterLimit:typeof opts.parameterLimit==="number"?opts.parameterLimit:defaults.parameterLimit,parseArrays:opts.parseArrays!==false,plainObjects:typeof opts.plainObjects==="boolean"?opts.plainObjects:defaults.plainObjects,strictNullHandling:typeof opts.strictNullHandling==="boolean"?opts.strictNullHandling:defaults.strictNullHandling}};module.exports=function(str,opts){var options=normalizeParseOptions(opts);if(str===""||str===null||typeof str==="undefined"){return options.plainObjects?Object.create(null):{}}var tempObj=typeof str==="string"?parseValues(str,options):str;var obj=options.plainObjects?Object.create(null):{};var keys=Object.keys(tempObj);for(var i=0;i<keys.length;++i){var key=keys[i];var newObj=parseKeys(key,tempObj[key],options,typeof str==="string");obj=utils.merge(obj,newObj,options)}if(options.allowSparse===true){return obj}return utils.compact(obj)}},{"./utils":208}],207:[function(require,module,exports){"use strict";var getSideChannel=require("side-channel");var utils=require("./utils");var formats=require("./formats");var has=Object.prototype.hasOwnProperty;var arrayPrefixGenerators={brackets:function brackets(prefix){return prefix+"[]"},comma:"comma",indices:function indices(prefix,key){return prefix+"["+key+"]"},repeat:function repeat(prefix){return prefix}};var isArray=Array.isArray;var split=String.prototype.split;var push=Array.prototype.push;var pushToArray=function(arr,valueOrArray){push.apply(arr,isArray(valueOrArray)?valueOrArray:[valueOrArray])};var toISO=Date.prototype.toISOString;var defaultFormat=formats["default"];var defaults={addQueryPrefix:false,allowDots:false,charset:"utf-8",charsetSentinel:false,delimiter:"&",encode:true,encoder:utils.encode,encodeValuesOnly:false,format:defaultFormat,formatter:formats.formatters[defaultFormat],indices:false,serializeDate:function serializeDate(date){return toISO.call(date)},skipNulls:false,strictNullHandling:false};var isNonNullishPrimitive=function isNonNullishPrimitive(v){return typeof v==="string"||typeof v==="number"||typeof v==="boolean"||typeof v==="symbol"||typeof v==="bigint"};var sentinel={};var stringify=function stringify(object,prefix,generateArrayPrefix,commaRoundTrip,strictNullHandling,skipNulls,encoder,filter,sort,allowDots,serializeDate,format,formatter,encodeValuesOnly,charset,sideChannel){var obj=object;var tmpSc=sideChannel;var step=0;var findFlag=false;while((tmpSc=tmpSc.get(sentinel))!==void undefined&&!findFlag){var pos=tmpSc.get(object);step+=1;if(typeof pos!=="undefined"){if(pos===step){throw new RangeError("Cyclic object value")}else{findFlag=true}}if(typeof tmpSc.get(sentinel)==="undefined"){step=0}}if(typeof filter==="function"){obj=filter(prefix,obj)}else if(obj instanceof Date){obj=serializeDate(obj)}else if(generateArrayPrefix==="comma"&&isArray(obj)){obj=utils.maybeMap(obj,function(value){if(value instanceof Date){return serializeDate(value)}return value})}if(obj===null){if(strictNullHandling){return encoder&&!encodeValuesOnly?encoder(prefix,defaults.encoder,charset,"key",format):prefix}obj=""}if(isNonNullishPrimitive(obj)||utils.isBuffer(obj)){if(encoder){var keyValue=encodeValuesOnly?prefix:encoder(prefix,defaults.encoder,charset,"key",format);if(generateArrayPrefix==="comma"&&encodeValuesOnly){var valuesArray=split.call(String(obj),",");var valuesJoined="";for(var i=0;i<valuesArray.length;++i){valuesJoined+=(i===0?"":",")+formatter(encoder(valuesArray[i],defaults.encoder,charset,"value",format))}return[formatter(keyValue)+(commaRoundTrip&&isArray(obj)&&valuesArray.length===1?"[]":"")+"="+valuesJoined]}return[formatter(keyValue)+"="+formatter(encoder(obj,defaults.encoder,charset,"value",format))]}return[formatter(prefix)+"="+formatter(String(obj))]}var values=[];if(typeof obj==="undefined"){return values}var objKeys;if(generateArrayPrefix==="comma"&&isArray(obj)){objKeys=[{value:obj.length>0?obj.join(",")||null:void undefined}]}else if(isArray(filter)){objKeys=filter}else{var keys=Object.keys(obj);objKeys=sort?keys.sort(sort):keys}var adjustedPrefix=commaRoundTrip&&isArray(obj)&&obj.length===1?prefix+"[]":prefix;for(var j=0;j<objKeys.length;++j){var key=objKeys[j];var value=typeof key==="object"&&typeof key.value!=="undefined"?key.value:obj[key];if(skipNulls&&value===null){continue}var keyPrefix=isArray(obj)?typeof generateArrayPrefix==="function"?generateArrayPrefix(adjustedPrefix,key):adjustedPrefix:adjustedPrefix+(allowDots?"."+key:"["+key+"]");sideChannel.set(object,step);var valueSideChannel=getSideChannel();valueSideChannel.set(sentinel,sideChannel);pushToArray(values,stringify(value,keyPrefix,generateArrayPrefix,commaRoundTrip,strictNullHandling,skipNulls,encoder,filter,sort,allowDots,serializeDate,format,formatter,encodeValuesOnly,charset,valueSideChannel))}return values};var normalizeStringifyOptions=function normalizeStringifyOptions(opts){if(!opts){return defaults}if(opts.encoder!==null&&typeof opts.encoder!=="undefined"&&typeof opts.encoder!=="function"){throw new TypeError("Encoder has to be a function.")}var charset=opts.charset||defaults.charset;if(typeof opts.charset!=="undefined"&&opts.charset!=="utf-8"&&opts.charset!=="iso-8859-1"){throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined")}var format=formats["default"];if(typeof opts.format!=="undefined"){if(!has.call(formats.formatters,opts.format)){throw new TypeError("Unknown format option provided.")}format=opts.format}var formatter=formats.formatters[format];var filter=defaults.filter;if(typeof opts.filter==="function"||isArray(opts.filter)){filter=opts.filter}return{addQueryPrefix:typeof opts.addQueryPrefix==="boolean"?opts.addQueryPrefix:defaults.addQueryPrefix,allowDots:typeof opts.allowDots==="undefined"?defaults.allowDots:!!opts.allowDots,charset:charset,charsetSentinel:typeof opts.charsetSentinel==="boolean"?opts.charsetSentinel:defaults.charsetSentinel,delimiter:typeof opts.delimiter==="undefined"?defaults.delimiter:opts.delimiter,encode:typeof opts.encode==="boolean"?opts.encode:defaults.encode,encoder:typeof opts.encoder==="function"?opts.encoder:defaults.encoder,encodeValuesOnly:typeof opts.encodeValuesOnly==="boolean"?opts.encodeValuesOnly:defaults.encodeValuesOnly,filter:filter,format:format,formatter:formatter,serializeDate:typeof opts.serializeDate==="function"?opts.serializeDate:defaults.serializeDate,skipNulls:typeof opts.skipNulls==="boolean"?opts.skipNulls:defaults.skipNulls,sort:typeof opts.sort==="function"?opts.sort:null,strictNullHandling:typeof opts.strictNullHandling==="boolean"?opts.strictNullHandling:defaults.strictNullHandling}};module.exports=function(object,opts){var obj=object;var options=normalizeStringifyOptions(opts);var objKeys;var filter;if(typeof options.filter==="function"){filter=options.filter;obj=filter("",obj)}else if(isArray(options.filter)){filter=options.filter;objKeys=filter}var keys=[];if(typeof obj!=="object"||obj===null){return""}var arrayFormat;if(opts&&opts.arrayFormat in arrayPrefixGenerators){arrayFormat=opts.arrayFormat}else if(opts&&"indices"in opts){arrayFormat=opts.indices?"indices":"repeat"}else{arrayFormat="indices"}var generateArrayPrefix=arrayPrefixGenerators[arrayFormat];if(opts&&"commaRoundTrip"in opts&&typeof opts.commaRoundTrip!=="boolean"){throw new TypeError("`commaRoundTrip` must be a boolean, or absent")}var commaRoundTrip=generateArrayPrefix==="comma"&&opts&&opts.commaRoundTrip;if(!objKeys){objKeys=Object.keys(obj)}if(options.sort){objKeys.sort(options.sort)}var sideChannel=getSideChannel();for(var i=0;i<objKeys.length;++i){var key=objKeys[i];if(options.skipNulls&&obj[key]===null){continue}pushToArray(keys,stringify(obj[key],key,generateArrayPrefix,commaRoundTrip,options.strictNullHandling,options.skipNulls,options.encode?options.encoder:null,options.filter,options.sort,options.allowDots,options.serializeDate,options.format,options.formatter,options.encodeValuesOnly,options.charset,sideChannel))}var joined=keys.join(options.delimiter);var prefix=options.addQueryPrefix===true?"?":"";if(options.charsetSentinel){if(options.charset==="iso-8859-1"){prefix+="utf8=%26%2310003%3B&"}else{prefix+="utf8=%E2%9C%93&"}}return joined.length>0?prefix+joined:""}},{"./formats":204,"./utils":208,"side-channel":209}],208:[function(require,module,exports){"use strict";var formats=require("./formats");var has=Object.prototype.hasOwnProperty;var isArray=Array.isArray;var hexTable=function(){var array=[];for(var i=0;i<256;++i){array.push("%"+((i<16?"0":"")+i.toString(16)).toUpperCase())}return array}();var compactQueue=function compactQueue(queue){while(queue.length>1){var item=queue.pop();var obj=item.obj[item.prop];if(isArray(obj)){var compacted=[];for(var j=0;j<obj.length;++j){if(typeof obj[j]!=="undefined"){compacted.push(obj[j])}}item.obj[item.prop]=compacted}}};var arrayToObject=function arrayToObject(source,options){var obj=options&&options.plainObjects?Object.create(null):{};for(var i=0;i<source.length;++i){if(typeof source[i]!=="undefined"){obj[i]=source[i]}}return obj};var merge=function merge(target,source,options){if(!source){return target}if(typeof source!=="object"){if(isArray(target)){target.push(source)}else if(target&&typeof target==="object"){if(options&&(options.plainObjects||options.allowPrototypes)||!has.call(Object.prototype,source)){target[source]=true}}else{return[target,source]}return target}if(!target||typeof target!=="object"){return[target].concat(source)}var mergeTarget=target;if(isArray(target)&&!isArray(source)){mergeTarget=arrayToObject(target,options)}if(isArray(target)&&isArray(source)){source.forEach(function(item,i){if(has.call(target,i)){var targetItem=target[i];if(targetItem&&typeof targetItem==="object"&&item&&typeof item==="object"){target[i]=merge(targetItem,item,options)}else{target.push(item)}}else{target[i]=item}});return target}return Object.keys(source).reduce(function(acc,key){var value=source[key];if(has.call(acc,key)){acc[key]=merge(acc[key],value,options)}else{acc[key]=value}return acc},mergeTarget)};var assign=function assignSingleSource(target,source){return Object.keys(source).reduce(function(acc,key){acc[key]=source[key];return acc},target)};var decode=function(str,decoder,charset){var strWithoutPlus=str.replace(/\+/g," ");if(charset==="iso-8859-1"){return strWithoutPlus.replace(/%[0-9a-f]{2}/gi,unescape)}try{return decodeURIComponent(strWithoutPlus)}catch(e){return strWithoutPlus}};var encode=function encode(str,defaultEncoder,charset,kind,format){if(str.length===0){return str}var string=str;if(typeof str==="symbol"){string=Symbol.prototype.toString.call(str)}else if(typeof str!=="string"){string=String(str)}if(charset==="iso-8859-1"){return escape(string).replace(/%u[0-9a-f]{4}/gi,function($0){return"%26%23"+parseInt($0.slice(2),16)+"%3B"})}var out="";for(var i=0;i<string.length;++i){var c=string.charCodeAt(i);if(c===45||c===46||c===95||c===126||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122||format===formats.RFC1738&&(c===40||c===41)){out+=string.charAt(i);continue}if(c<128){out=out+hexTable[c];continue}if(c<2048){out=out+(hexTable[192|c>>6]+hexTable[128|c&63]);continue}if(c<55296||c>=57344){out=out+(hexTable[224|c>>12]+hexTable[128|c>>6&63]+hexTable[128|c&63]);continue}i+=1;c=65536+((c&1023)<<10|string.charCodeAt(i)&1023);out+=hexTable[240|c>>18]+hexTable[128|c>>12&63]+hexTable[128|c>>6&63]+hexTable[128|c&63]}return out};var compact=function compact(value){var queue=[{obj:{o:value},prop:"o"}];var refs=[];for(var i=0;i<queue.length;++i){var item=queue[i];var obj=item.obj[item.prop];var keys=Object.keys(obj);for(var j=0;j<keys.length;++j){var key=keys[j];var val=obj[key];if(typeof val==="object"&&val!==null&&refs.indexOf(val)===-1){queue.push({obj:obj,prop:key});refs.push(val)}}}compactQueue(queue);return value};var isRegExp=function isRegExp(obj){return Object.prototype.toString.call(obj)==="[object RegExp]"};var isBuffer=function isBuffer(obj){if(!obj||typeof obj!=="object"){return false}return!!(obj.constructor&&obj.constructor.isBuffer&&obj.constructor.isBuffer(obj))};var combine=function combine(a,b){return[].concat(a,b)};var maybeMap=function maybeMap(val,fn){if(isArray(val)){var mapped=[];for(var i=0;i<val.length;i+=1){mapped.push(fn(val[i]))}return mapped}return fn(val)};module.exports={arrayToObject:arrayToObject,assign:assign,combine:combine,compact:compact,decode:decode,encode:encode,isBuffer:isBuffer,isRegExp:isRegExp,maybeMap:maybeMap,merge:merge}},{"./formats":204}],209:[function(require,module,exports){"use strict";var GetIntrinsic=require("get-intrinsic");var callBound=require("call-bind/callBound");var inspect=require("object-inspect");var $TypeError=GetIntrinsic("%TypeError%");var $WeakMap=GetIntrinsic("%WeakMap%",true);var $Map=GetIntrinsic("%Map%",true);var $weakMapGet=callBound("WeakMap.prototype.get",true);var $weakMapSet=callBound("WeakMap.prototype.set",true);var $weakMapHas=callBound("WeakMap.prototype.has",true);var $mapGet=callBound("Map.prototype.get",true);var $mapSet=callBound("Map.prototype.set",true);var $mapHas=callBound("Map.prototype.has",true);var listGetNode=function(list,key){for(var prev=list,curr;(curr=prev.next)!==null;prev=curr){if(curr.key===key){prev.next=curr.next;curr.next=list.next;list.next=curr;return curr}}};var listGet=function(objects,key){var node=listGetNode(objects,key);return node&&node.value};var listSet=function(objects,key,value){var node=listGetNode(objects,key);if(node){node.value=value}else{objects.next={key:key,next:objects.next,value:value}}};var listHas=function(objects,key){return!!listGetNode(objects,key)};module.exports=function getSideChannel(){var $wm;var $m;var $o;var channel={assert:function(key){if(!channel.has(key)){throw new $TypeError("Side channel does not contain "+inspect(key))}},get:function(key){if($WeakMap&&key&&(typeof key==="object"||typeof key==="function")){if($wm){return $weakMapGet($wm,key)}}else if($Map){if($m){return $mapGet($m,key)}}else{if($o){return listGet($o,key)}}},has:function(key){if($WeakMap&&key&&(typeof key==="object"||typeof key==="function")){if($wm){return $weakMapHas($wm,key)}}else if($Map){if($m){return $mapHas($m,key)}}else{if($o){return listHas($o,key)}}return false},set:function(key,value){if($WeakMap&&key&&(typeof key==="object"||typeof key==="function")){if(!$wm){$wm=new $WeakMap}$weakMapSet($wm,key,value)}else if($Map){if(!$m){$m=new $Map}$mapSet($m,key,value)}else{if(!$o){$o={key:{},next:null}}listSet($o,key,value)}}};return channel}},{"call-bind/callBound":192,"get-intrinsic":196,"object-inspect":201}],210:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.supportedCurrencies=void 0;exports.supportedCurrencies=["USD","EUR","STR","TTD","EC","JMD","GUY"]},{}],211:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.jobStatuses=exports.JOB_STATUS_ARCHIVED=exports.JOB_STATUS_ACTIVE=exports.JOB_STATUS_NEW=void 0;exports.JOB_STATUS_NEW="new";exports.JOB_STATUS_ACTIVE="active";exports.JOB_STATUS_ARCHIVED="archived";exports.jobStatuses=[exports.JOB_STATUS_NEW,exports.JOB_STATUS_ACTIVE,exports.JOB_STATUS_ARCHIVED]},{}],212:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.supportedPaymentFrequencies=void 0;exports.supportedPaymentFrequencies=["Hourly","Daily","Weekly","Fortnightly","Monthly","One-Time"]},{}],213:[function(require,module,exports){(function(process){(function(){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DevCarib=void 0;const display_1=require("@quenk/jouvert/lib/app/service/display");const factory_1=require("@quenk/jouvert/lib/app/remote/model/factory");const director_1=require("@quenk/jouvert/lib/app/service/director");const remote_1=require("@quenk/jouvert/lib/app/remote");const jouvert_1=require("@quenk/jouvert");const hash_1=require("@quenk/frontend-routers/lib/hash");const browser_1=require("@quenk/jhr/lib/browser");const defaultConf={log:{level:Number(process.env.PVM_LOG_LEVEL)||1,logger:console}};class DevCarib extends jouvert_1.Jouvert{constructor(main,dialogs,conf=defaultConf){super(conf);this.main=main;this.dialogs=dialogs;this.conf=conf;this.agent=(0,browser_1.createAgent)();this.router=new hash_1.HashRouter(window,{});this.services={}}get models(){return factory_1.RemoteModelFactory.getInstance(this,this.services["remote.background"])}getModel(paths,handler=[],_context={}){return this.models.create(paths,handler)}spawn(t){let addr=super.spawn(t);this.services[t.id]=addr;return addr}tell(addr,msg){this.vm.tell(addr,msg);return this}init(){let viewDelegate=new display_1.HTMLElementViewDelegate(this.main);viewDelegate.set(this.view);this.spawn({id:"views",create:()=>new display_1.Display(new display_1.HTMLElementViewDelegate(this.view.findById("content").get()),this)});this.spawn({id:"dialogs",create:()=>new display_1.Display(new display_1.HTMLElementViewDelegate(this.dialogs),this)});this.spawn({id:"remote.background",create:()=>new remote_1.Remote(this.agent,this)});this.spawn({id:"router",create:()=>new director_1.Director(this.services.views,this.router,{},this.routes,this)})}run(){this.init();this.router.start();setTimeout(()=>this.router.handleEvent(new Event("hashchanged")),100)}}exports.DevCarib=DevCarib}).call(this)}).call(this,require("_process"))},{"@quenk/frontend-routers/lib/hash":32,"@quenk/jhr/lib/browser":38,"@quenk/jouvert":50,"@quenk/jouvert/lib/app/remote":52,"@quenk/jouvert/lib/app/remote/model/factory":53,"@quenk/jouvert/lib/app/service/director":67,"@quenk/jouvert/lib/app/service/display":68,_process:203}],214:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DevCaribForm=void 0;const validator_1=require("@quenk/jouvert/lib/app/scene/form/validator");class DevCaribForm extends validator_1.BaseValidatorFormScene{constructor(app,target,value={}){super(app,target,value);this.app=app;this.target=target;this.value=value}}exports.DevCaribForm=DevCaribForm},{"@quenk/jouvert/lib/app/scene/form/validator":62}],215:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DevCaribDialogRemoteForm=void 0;const display_1=require("@quenk/jouvert/lib/app/service/display");const views_1=require("./views");const _1=require("./");class DevCaribDialogRemoteForm extends _1.DevCaribRemoteForm{onSaveOk(){this.close()}close(){this.tell(this.app.services.dialogs,new display_1.Close(this.self()));this.abort()}show(){this.tell(this.app.services.dialogs,new display_1.Show(this.name,new views_1.DevCaribDialogRemoteFormView(this),this.self()))}}exports.DevCaribDialogRemoteForm=DevCaribDialogRemoteForm},{"./":216,"./views":217,"@quenk/jouvert/lib/app/service/display":68}],216:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.defaultHandlers=exports.DevCaribRemoteForm=exports.REMOTE_FORM_MODE_UPDATE=exports.REMOTE_FORM_MODE_CREATE=void 0;const future_1=require("@quenk/noni/lib/control/monad/future");const form_1=require("@quenk/jouvert/lib/app/scene/form");const handlers_1=require("@quenk/jouvert/lib/app/scene/remote/handlers");const display_1=require("@quenk/jouvert/lib/app/service/display");const __1=require("../");exports.REMOTE_FORM_MODE_CREATE="create";exports.REMOTE_FORM_MODE_UPDATE="update";class DevCaribRemoteForm extends __1.DevCaribForm{constructor(){super(...arguments);this.mode=exports.REMOTE_FORM_MODE_CREATE}getModel(paths){return this.app.getModel(paths,new handlers_1.OnSaveFailed(this))}onSaveFailed(failure){this.values.errors=failure.errors;this.show()}onSaveOk(){this.tell(this.target,new display_1.Close(this.self()))}doCreate(){let that=this;return(0,future_1.doFuture)(function*(){yield that.model.create(that.getValues());that.tell(that.self(),new form_1.SaveOk);return future_1.voidPure})}doUpdate(){let that=this;return(0,future_1.doFuture)(function*(){yield that.model.update(that.value.id,that.getModifiedValues());that.tell(that.self(),new form_1.SaveOk);return future_1.voidPure})}save(){this.wait(this.mode===exports.REMOTE_FORM_MODE_UPDATE?this.doUpdate():this.doCreate())}}exports.DevCaribRemoteForm=DevCaribRemoteForm;const defaultHandlers=form=>[new handlers_1.OnSaveFailed(form)];exports.defaultHandlers=defaultHandlers},{"../":214,"@quenk/jouvert/lib/app/scene/form":61,"@quenk/jouvert/lib/app/scene/remote/handlers":66,"@quenk/jouvert/lib/app/service/display":68,"@quenk/noni/lib/control/monad/future":70}],217:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DevCaribDialogRemoteFormView=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const modal_1=require("@quenk/wml-widgets/lib/dialog/modal");const button_1=require("@quenk/wml-widgets/lib/control/button");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class DevCaribDialogRemoteFormView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.widget(new modal_1.Modal({className:"-large"},[__this.widget(new modal_1.ModalHeader({},[text(__context.name)]),{}),__this.widget(new modal_1.ModalBody({},[__this.registerView(__context.view).render()]),{}),__this.widget(new modal_1.ModalFooter({},[__this.widget(new button_1.Button({text:"Close",onClick:()=>__context.close()},[]),{text:"Close",onClick:()=>__context.close()}),__this.widget(new button_1.Button({text:"Save",className:"-primary",onClick:()=>__context.save()},[]),{text:"Save",className:"-primary",onClick:()=>__context.save()})]),{})]),{className:"-large"})})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.DevCaribDialogRemoteFormView=DevCaribDialogRemoteFormView},{"@quenk/noni/lib/data/maybe":77,"@quenk/wml-widgets/lib/control/button":130,"@quenk/wml-widgets/lib/dialog/modal":167,"@quenk/wml/lib/dom":189}],218:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getStatusText=exports.statusMap=exports.USER_STATUS_DISABLED=exports.USER_STATUS_ACTIVE=void 0;exports.USER_STATUS_ACTIVE=5;exports.USER_STATUS_DISABLED=1;exports.statusMap={[exports.USER_STATUS_ACTIVE]:"active",[exports.USER_STATUS_DISABLED]:" disabled"};const getStatusText=status=>exports.statusMap[status]||"Unknown";exports.getStatusText=getStatusText},{}],219:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CurrencyMoneyTextField=void 0;const wml_1=require("@quenk/wml");const currency_1=require("@devcarib/common/lib/data/currency");const money_1=require("./money");class CurrencyMoneyTextField extends wml_1.Component{constructor(){var _a,_b;super(...arguments);this.view=new money_1.CurrencyMoneyTextFieldView(this);this.values={dropList:{name:(_a=this.attrs.names)===null||_a===void 0?void 0:_a[0],value:this.attrs.currency||currency_1.supportedCurrencies[0],options:currency_1.supportedCurrencies.map(sym=>({label:sym,value:sym})),onSelect:this.attrs.onChange},input:{name:(_b=this.attrs.names)===null||_b===void 0?void 0:_b[1],value:this.attrs.value?String(this.attrs.value):"0",onChange:this.attrs.onChange}}}}exports.CurrencyMoneyTextField=CurrencyMoneyTextField},{"./money":220,"@devcarib/common/lib/data/currency":210,"@quenk/wml":190}],220:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CurrencyMoneyTextFieldView=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const input_group_1=require("@quenk/wml-widgets/lib/control/input-group");const text_input_1=require("@quenk/wml-widgets/lib/control/text-input");const drop_list_1=require("@quenk/wml-widgets/lib/control/drop-list");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class CurrencyMoneyTextFieldView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.widget(new input_group_1.InputGroup({className:"board-currency-money-text-field"},[__this.widget(new input_group_1.AddOn({button:true},[__this.widget(new drop_list_1.DropList({name:__context.values.dropList.name,options:__context.values.dropList.options,value:__context.values.dropList.value,onSelect:__context.values.dropList.onSelect},[]),{name:__context.values.dropList.name,options:__context.values.dropList.options,value:__context.values.dropList.value,onSelect:__context.values.dropList.onSelect})]),{button:true}),__this.widget(new text_input_1.TextInput({name:__context.values.input.name,value:__context.values.input.value,type:"number",min:0,onChange:__context.values.input.onChange},[]),{name:__context.values.input.name,value:__context.values.input.value,type:"number",min:0,onChange:__context.values.input.onChange})]),{className:"board-currency-money-text-field"})})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.CurrencyMoneyTextFieldView=CurrencyMoneyTextFieldView},{"@quenk/noni/lib/data/maybe":77,"@quenk/wml-widgets/lib/control/drop-list":140,"@quenk/wml-widgets/lib/control/input-group":148,"@quenk/wml-widgets/lib/control/text-input":158,"@quenk/wml/lib/dom":189}],221:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.truncate=exports.timefromnow=exports.timestamp=void 0;const moment=require("moment");const timestamp=str=>{let stamp=moment(str);if(str===""||!stamp.isValid())return"";return stamp.format("MMMM Do YYYY")};exports.timestamp=timestamp;const timefromnow=str=>{let date=moment(str);if(str===""||!date.isValid())return"";return date.fromNow()};exports.timefromnow=timefromnow;const truncate=limit=>(str="")=>str.length>limit?`${str.substr(0,limit)}...`:str;exports.truncate=truncate},{moment:200}],222:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobFormCompanyFieldsView=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const grid_1=require("@quenk/wml-widgets/lib/layout/grid");const text_field_1=require("@quenk/wml-widgets/lib/control/text-field");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class JobFormCompanyFieldsView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.widget(new grid_1.GridLayout({},[__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new text_field_1.TextField({wml:{id:"company"},name:"company",label:"Company Name*",value:__context.data.company,onChange:__context.onChange},[]),{wml:{id:"company"},name:"company",label:"Company Name*",value:__context.data.company,onChange:__context.onChange})]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new text_field_1.TextField({wml:{id:"company_logo"},name:"company_logo",label:"Logo",placeholder:"Please provide a url to a png image with resolution 400 x 400",value:__context.data.company_logo,onChange:__context.onChange},[]),{wml:{id:"company_logo"},name:"company_logo",label:"Logo",placeholder:"Please provide a url to a png image with resolution 400 x 400",value:__context.data.company_logo,onChange:__context.onChange})]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new text_field_1.TextField({wml:{id:"company_email"},name:"company_email",label:"Email*",value:__context.data.company_email,onChange:__context.onChange},[]),{wml:{id:"company_email"},name:"company_email",label:"Email*",value:__context.data.company_email,onChange:__context.onChange})]),{})]),{})]),{})})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.JobFormCompanyFieldsView=JobFormCompanyFieldsView},{"@quenk/noni/lib/data/maybe":77,"@quenk/wml-widgets/lib/control/text-field":156,"@quenk/wml-widgets/lib/layout/grid":172,"@quenk/wml/lib/dom":189}],223:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobFormJobFieldsView=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const grid_1=require("@quenk/wml-widgets/lib/layout/grid");const text_field_1=require("@quenk/wml-widgets/lib/control/text-field");const drop_list_1=require("@quenk/wml-widgets/lib/control/drop-list");const checkbox_1=require("@quenk/wml-widgets/lib/control/checkbox");const money_1=require("@devcarib/widgets/lib/control/input/money");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class JobFormJobFieldsView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.widget(new grid_1.GridLayout({},[__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new text_field_1.TextField({wml:{id:"title"},name:"title",label:"Title*",placeholder:"Example: Fintech Software Engineer Needed",value:__context.data.title,onChange:__context.onChange},[]),{wml:{id:"title"},name:"title",label:"Title*",placeholder:"Example: Fintech Software Engineer Needed",value:__context.data.title,onChange:__context.onChange})]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({span:6},[__this.widget(new text_field_1.TextField({wml:{id:"location"},name:"location",label:"Location*",value:__context.data.location,onChange:__context.onChange},[]),{wml:{id:"location"},name:"location",label:"Location*",value:__context.data.location,onChange:__context.onChange})]),{span:6}),__this.widget(new grid_1.Column({span:6},[__this.node("label",{class:"ww-label"},[__document.createTextNode("Select A Job Type*")]),__this.widget(new drop_list_1.DropList({wml:{id:"type"},className:"board-job-type-dropdown -block",name:"type",value:__context.data.type,options:__context.type.options,onSelect:__context.onSelect},[]),{wml:{id:"type"},className:"board-job-type-dropdown -block",name:"type",value:__context.data.type,options:__context.type.options,onSelect:__context.onSelect})]),{span:6})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new text_field_1.TextField({wml:{id:"apply_url"},name:"apply_url",label:"Apply Link",placeholder:"Specify a url or email address applicants can use to apply",value:__context.data.apply_url,onChange:__context.onChange},[]),{wml:{id:"apply_url"},name:"apply_url",label:"Apply Link",placeholder:"Specify a url or email address applicants can use to apply",value:__context.data.apply_url,onChange:__context.onChange})]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.node("b",{},[__document.createTextNode("\n         Is this a remote position? \n         "),__this.widget(new checkbox_1.Checkbox({name:"remote",value:__context.data.remote,onChange:__context.onSelect},[]),{name:"remote",value:__context.data.remote,onChange:__context.onSelect})])]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({span:6},[__this.node("b",{},[__document.createTextNode("Payment")]),__this.widget(new money_1.CurrencyMoneyTextField({names:["payment_currency","payment_amount"],onChange:__context.onChange},[]),{names:["payment_currency","payment_amount"],onChange:__context.onChange})]),{span:6}),__this.widget(new grid_1.Column({span:6},[__this.node("label",{class:"ww-label"},[__document.createTextNode("Payment Frequency")]),__this.widget(new drop_list_1.DropList({wml:{id:"payment_frequency"},className:"-block board-job-payment-frequency",name:"payment_frequency",value:__context.data.payment_frequency,options:__context.payment_frequency.options,onSelect:__context.onSelect},[]),{wml:{id:"payment_frequency"},className:"-block board-job-payment-frequency",name:"payment_frequency",value:__context.data.payment_frequency,options:__context.payment_frequency.options,onSelect:__context.onSelect})]),{span:6})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new text_field_1.TextField({wml:{id:"description"},name:"description",placeholder:"Provide full details of the job. Markdown is supported",rows:12,value:__context.data.description,onChange:__context.onChange},[]),{wml:{id:"description"},name:"description",placeholder:"Provide full details of the job. Markdown is supported",rows:12,value:__context.data.description,onChange:__context.onChange})]),{})]),{})]),{})})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.JobFormJobFieldsView=JobFormJobFieldsView},{"@devcarib/widgets/lib/control/input/money":219,"@quenk/noni/lib/data/maybe":77,"@quenk/wml-widgets/lib/control/checkbox":132,"@quenk/wml-widgets/lib/control/drop-list":140,"@quenk/wml-widgets/lib/control/text-field":156,"@quenk/wml-widgets/lib/layout/grid":172,"@quenk/wml/lib/dom":189}],224:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobFeaturesView=void 0;const __document=require("@quenk/wml/lib/dom");const maybe_1=require("@quenk/noni/lib/data/maybe");const filters_1=require("../../filters");const __if=(__expr,__conseq,__alt)=>__expr?__conseq():__alt?__alt():[];const __forIn=(list,f,alt)=>{let ret=[];for(let i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};const __forOf=(o,f,alt)=>{let ret=[];for(let key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};const text=__document.text;const unsafe=__document.unsafe;const isSet=value=>value!=null;class JobFeaturesView{constructor(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=(__this=>{return __this.node("div",{class:"board-job-features"},[...__context.type!=null?(()=>[__this.node("span",{class:"ww-tag -default"},[text(__context.type)])])():(()=>[])(),...__context.location!=null?(()=>[__this.node("span",{class:"ww-tag -default"},[text((0,filters_1.truncate)(60)(__context.location))])])():(()=>[])(),...__context.remote!=null?(()=>[__this.node("span",{class:"ww-tag -default"},[__document.createTextNode("Remote")])])():(()=>[])(),...__context.salary_range!=null?(()=>[__this.node("span",{class:"ww-tag -default"},[__document.createTextNode("$"),text(__context.salary_range)])])():(()=>[])()])})}registerView(v){this.views.push(v);return v}register(e,attrs){let attrsMap=attrs;if(attrsMap.wml){let{id:id,group:group}=attrsMap.wml;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error(`Duplicate id '${id}' detected!`);this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e}node(tag,attrs,children){let e=__document.createElement(tag);Object.keys(attrs).forEach(key=>{let value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(c=>{switch(typeof c){case"string":case"number":case"boolean":let tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError(`Can not adopt child ${c} of type ${typeof c}`)}});this.register(e,attrs);return e}widget(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()}findById(id){let mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce((p,c)=>p.isJust()?p:c.findById(id),mW)}findByGroup(name){let mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce((p,c)=>p.isJust()?p:c.findByGroup(name),mGroup)}invalidate(){let{tree:tree}=this;let parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)}render(){this.ids={};this.widgets.forEach(w=>w.removed());this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(w=>w.rendered());return this.tree}}exports.JobFeaturesView=JobFeaturesView},{"../../filters":221,"@quenk/noni/lib/data/maybe":77,"@quenk/wml/lib/dom":189}]},{},[31]);
