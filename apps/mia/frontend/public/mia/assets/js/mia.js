(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JOB=exports.JOBS=void 0;exports.JOBS="/mia/r/jobs";exports.JOB="/mia/r/jobs/{id}"},{}],2:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.MiaScene=void 0;var scene_1=require("@quenk/dfront/lib/app/scene");var MiaScene=function(_super){__extends(MiaScene,_super);function MiaScene(app,resume){var _this=_super.call(this,resume,app)||this;_this.app=app;_this.resume=resume;return _this}return MiaScene}(scene_1.DScene);exports.MiaScene=MiaScene},{"@quenk/dfront/lib/app/scene":15}],3:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.MiaManager=void 0;var _1=require(".");var MiaManager=function(_super){__extends(MiaManager,_super);function MiaManager(){return _super!==null&&_super.apply(this,arguments)||this}return MiaManager}(_1.MiaScene);exports.MiaManager=MiaManager},{".":2}],4:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Mia=exports.TIME_SEARCH_DEBOUNCE=exports.RESOURCE_JOB=exports.RESOURCE_JOBS=exports.ACTION_SHOW=exports.ACTION_REMOVE=exports.ACTION_APPROVE=void 0;var future_1=require("@quenk/noni/lib/control/monad/future");var function_1=require("@quenk/noni/lib/data/function");var view_1=require("@quenk/jouvert/lib/app/service/view");var factory_1=require("@quenk/jouvert/lib/app/remote/model/factory");var director_1=require("@quenk/jouvert/lib/app/director");var remote_1=require("@quenk/jouvert/lib/app/remote");var app_1=require("@quenk/dfront/lib/app");var hash_1=require("@quenk/frontend-routers/lib/hash");var browser_1=require("@quenk/jhr/lib/browser");var app_2=require("./views/app");var routes_1=require("./routes");exports.ACTION_APPROVE="approve";exports.ACTION_REMOVE="remove";exports.ACTION_SHOW="show";exports.RESOURCE_JOBS="/admin/r/jobs";exports.RESOURCE_JOB="/admin/r/jobs/{id}";exports.TIME_SEARCH_DEBOUNCE=500;var agent=(0,browser_1.createAgent)();var Mia=function(_super){__extends(Mia,_super);function Mia(main,dialogs){var _this=_super.call(this,main)||this;_this.main=main;_this.dialogs=dialogs;_this.view=new app_2.MiaView(_this);_this.modelFactory=factory_1.RemoteModelFactory.getInstance(_this,"remote.background");_this.router=new hash_1.HashRouter(window,{});_this.values={header:{links:{Logout:function(){return _this.runFuture(_this.logout())}}}};_this.onError=function(e){console.error(e);alert("An error has occurred! Details have been logged to the console.")};return _this}Mia.create=function(main,dialogs){return new Mia(main,dialogs)};Mia.prototype.logout=function(){return confirm("Do you want to logout now?")?agent.post("/admin/logout",{}).chain(function(){window.location.href="/admin";return(0,future_1.pure)(undefined)}):(0,future_1.pure)(undefined)};Mia.prototype.runFuture=function(ft){ft.fork(this.onError,function_1.noop)};Mia.prototype.tell=function(addr,msg){this.vm.tell(addr,msg);return this};Mia.prototype.run=function(){var _this=this;this.spawn({id:"views",create:function(){return new view_1.ViewService(new view_1.HTMLElementViewDelegate(_this.main),_this)}});this.spawn({id:"dialogs",create:function(){return new view_1.ViewService(new view_1.HTMLElementViewDelegate(_this.dialogs),_this)}});this.spawn({id:"remote.background",create:function(){return new remote_1.Remote(agent,_this)}});this.spawn({id:"router",create:function(){return new director_1.Director(_this.services.views,_this.router,{},routes_1.routes,_this)}});this.router.start();setTimeout(function(){return _this.router.handleEvent(new Event("hashchanged"))},100)};return Mia}(app_1.DApplication);exports.Mia=Mia},{"./routes":11,"./views/app":12,"@quenk/dfront/lib/app":14,"@quenk/frontend-routers/lib/hash":17,"@quenk/jhr/lib/browser":29,"@quenk/jouvert/lib/app/director":41,"@quenk/jouvert/lib/app/remote":45,"@quenk/jouvert/lib/app/remote/model/factory":46,"@quenk/jouvert/lib/app/service/view":52,"@quenk/noni/lib/control/monad/future":54,"@quenk/noni/lib/data/function":60}],5:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ActionColumn=exports.StatusColumn=exports.CompanyColumn=exports.TitleColumn=void 0;var views_1=require("./views");var TitleColumn=function(){function TitleColumn(action){var _this=this;this.action=action;this.name="title";this.heading="Title";this.cellFragment=function(c){return new views_1.TitleColumnView({job:c.datum,onClick:function(){return _this.action(c.datum)}})}}return TitleColumn}();exports.TitleColumn=TitleColumn;var CompanyColumn=function(){function CompanyColumn(){this.name="company";this.heading="Company"}return CompanyColumn}();exports.CompanyColumn=CompanyColumn;var StatusColumn=function(){function StatusColumn(){this.name="status";this.heading="Status"}return StatusColumn}();exports.StatusColumn=StatusColumn;var ActionColumn=function(){function ActionColumn(actions){var _this=this;this.actions=actions;this.name="";this.heading="Actions";this.cellFragment=function(c){return new views_1.ActionColumnView({actions:_this.actions,job:c.datum})}}return ActionColumn}();exports.ActionColumn=ActionColumn},{"./views":6}],6:[function(require,module,exports){"use strict";var __spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||arguments.length===2)for(var i=0,l=from.length,ar;i<l;i++){if(ar||!(i in from)){if(!ar)ar=Array.prototype.slice.call(from,0,i);ar[i]=from[i]}}return to.concat(ar||Array.prototype.slice.call(from))};Object.defineProperty(exports,"__esModule",{value:true});exports.ActionColumnView=exports.TitleColumnView=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var drop_down_1=require("@quenk/wml-widgets/lib/control/drop-down");var menu_1=require("@quenk/wml-widgets/lib/menu/menu");var item_1=require("@quenk/wml-widgets/lib/menu/item");var link_1=require("@quenk/wml-widgets/lib/content/link");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var TitleColumnView=function(){function TitleColumnView(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("td",{},[__this.widget(new link_1.Link({ww:{text:__context.job.title,onClick:__context.onClick}},[]),{ww:{text:__context.job.title,onClick:__context.onClick}})])}}TitleColumnView.prototype.registerView=function(v){this.views.push(v);return v};TitleColumnView.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};TitleColumnView.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};TitleColumnView.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};TitleColumnView.prototype.findById=function(id){var mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};TitleColumnView.prototype.findByGroup=function(name){var mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};TitleColumnView.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};TitleColumnView.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return TitleColumnView}();exports.TitleColumnView=TitleColumnView;var ActionColumnView=function(){function ActionColumnView(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("td",{},[__this.widget(new drop_down_1.DropDown({ww:{className:"-left",buttonText:"Action"}},[__this.widget(new menu_1.Menu({},__spreadArray([],__forIn(__context.actions,function(spec,_$$i,_$$all){return __spreadArray(__spreadArray([],spec.divider?function(){return[__this.widget(new item_1.Item({ww:{divider:true}},[]),{ww:{divider:true}})]}():function(){return[]}(),true),[__this.widget(new item_1.Item({},[__this.widget(new link_1.Link({ww:{text:spec.text,onClick:function(){return spec.onClick(__context.job)}}},[]),{ww:{text:spec.text,onClick:function(){return spec.onClick(__context.job)}}})]),{})],false)},function(){return[]}),true)),{})]),{ww:{className:"-left",buttonText:"Action"}})])}}ActionColumnView.prototype.registerView=function(v){this.views.push(v);return v};ActionColumnView.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};ActionColumnView.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};ActionColumnView.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};ActionColumnView.prototype.findById=function(id){var mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};ActionColumnView.prototype.findByGroup=function(name){var mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};ActionColumnView.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};ActionColumnView.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return ActionColumnView}();exports.ActionColumnView=ActionColumnView},{"@quenk/noni/lib/data/maybe":61,"@quenk/wml-widgets/lib/content/link":105,"@quenk/wml-widgets/lib/control/drop-down":116,"@quenk/wml-widgets/lib/menu/item":149,"@quenk/wml-widgets/lib/menu/menu":151,"@quenk/wml/lib/dom":155}],7:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.JobPreviewDialog=void 0;var api=require("../../api");var httpStatus=require("@quenk/jhr/lib/status");var confirm_1=require("@quenk/jouvert/lib/app/service/dialog/confirm");var handlers_1=require("@quenk/dfront/lib/app/scene/remote/handlers");var preview_1=require("./views/preview");var JobPreviewDialog=function(_super){__extends(JobPreviewDialog,_super);function JobPreviewDialog(app,job,target){if(target===void 0){target="?"}var _this=_super.call(this,app,app.services.dialogs,target)||this;_this.app=app;_this.job=job;_this.target=target;_this.name="Job Preview Dialog";_this.view=new preview_1.JobPreviewDialogView(_this);_this.jobModel=_this.app.getModel(api.JOB,new handlers_1.ExecOnComplete(httpStatus.OK,function(){_this.close()}));_this.values={job:_this.job,changes:{},frame:{id:"iframe",className:"mia-preview-frame",content:getPreview(_this.job)},onChange:function(e){_this.values.changes[e.name]=e.value},save:function(){_this.jobModel.update(_this.job.id,_this.values.changes).map(function(){_this.confirm()}).fork()},close:function(){return _this.close()}};return _this}return JobPreviewDialog}(confirm_1.ConfirmDialog);exports.JobPreviewDialog=JobPreviewDialog;var getPreview=function(_a){var description_html=_a.description_html,title=_a.title;return'\n<!DOCTYPE html>\n    <html>\n        <head>\n            <meta charset="utf-8">\n            <meta name="viewport" content="width=device-width, initial-scale=1.0">\n            <link rel="stylesheet" href="/assets/css/site.css">\n            <title>'+title+'</title>\n        </head>\n        <body>\n            <div class="ww-grid-layout board-job-body">\n                '+description_html+"\n            </div>\n        </body>\n    </html>\n"}},{"../../api":1,"./views/preview":8,"@quenk/dfront/lib/app/scene/remote/handlers":16,"@quenk/jhr/lib/status":37,"@quenk/jouvert/lib/app/service/dialog/confirm":50}],8:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobPreviewDialogView=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var type_1=require("@quenk/noni/lib/data/type");var grid_1=require("@quenk/wml-widgets/lib/layout/grid");var modal_1=require("@quenk/wml-widgets/lib/dialog/modal");var button_1=require("@quenk/wml-widgets/lib/control/button");var features_1=require("@devcarib/widgets/lib/job/panel/features");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var JobPreviewDialogView=function(){function JobPreviewDialogView(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.widget(new modal_1.Modal({ww:{className:"-large"}},[__this.widget(new modal_1.ModalHeader({},[text((0,type_1.toString)(__context.job.company))]),{}),__this.widget(new modal_1.ModalBody({},[__this.widget(new grid_1.GridLayout({},[__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.node("h1",{},[text((0,type_1.toString)(__context.job.title))])]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.registerView(new features_1.JobFeaturesView(__context.job)).render()]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.node("iframe",{wml:{id:__context.values.frame.id},class:__context.values.frame.className,srcdoc:__context.values.frame.content,sandbox:"",allow:""},[])]),{})]),{})]),{})]),{}),__this.widget(new modal_1.ModalFooter({},[__this.widget(new button_1.Button({ww:{onClick:__context.values.close,text:"Close"}},[]),{ww:{onClick:__context.values.close,text:"Close"}})]),{})]),{ww:{className:"-large"}})}}JobPreviewDialogView.prototype.registerView=function(v){this.views.push(v);return v};JobPreviewDialogView.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};JobPreviewDialogView.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};JobPreviewDialogView.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};JobPreviewDialogView.prototype.findById=function(id){var mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};JobPreviewDialogView.prototype.findByGroup=function(name){var mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};JobPreviewDialogView.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};JobPreviewDialogView.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return JobPreviewDialogView}();exports.JobPreviewDialogView=JobPreviewDialogView},{"@devcarib/widgets/lib/job/panel/features":172,"@quenk/noni/lib/data/maybe":61,"@quenk/noni/lib/data/type":65,"@quenk/wml-widgets/lib/control/button":114,"@quenk/wml-widgets/lib/dialog/modal":137,"@quenk/wml-widgets/lib/layout/grid":142,"@quenk/wml/lib/dom":155}],9:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var __generator=this&&this.__generator||function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=op[0]&2?y["return"]:op[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}};Object.defineProperty(exports,"__esModule",{value:true});exports.JobsManager=exports.AlertOnSearchNoData=exports.TIME_SEARCH_DEBOUNCE=exports.ACTION_SHOW=exports.ACTION_REMOVE=exports.ACTION_APPROVE=void 0;var jobStatus=require("@board/common/lib/data/job");var httpStatus=require("@quenk/jhr/lib/status");var api=require("../../api");var future_1=require("@quenk/noni/lib/control/monad/future");var string_1=require("@quenk/noni/lib/data/string");var function_1=require("@quenk/noni/lib/data/function");var timer_1=require("@quenk/noni/lib/control/timer");var browser_1=require("@quenk/jhr/lib/browser");var handlers_1=require("@quenk/dfront/lib/app/scene/remote/handlers");var columns_1=require("../columns");var preview_1=require("../dialogs/preview");var manager_1=require("../../common/scene/manager");var jobs_1=require("./views/jobs");exports.ACTION_APPROVE="approve";exports.ACTION_REMOVE="remove";exports.ACTION_SHOW="show";exports.TIME_SEARCH_DEBOUNCE=500;var agent=(0,browser_1.createAgent)();var AlertOnSearchNoData=function(_super){__extends(AlertOnSearchNoData,_super);function AlertOnSearchNoData(){return _super.call(this,httpStatus.NO_CONTENT,function(){alert("Your search returned no results")})||this}return AlertOnSearchNoData}(handlers_1.ExecOnComplete);exports.AlertOnSearchNoData=AlertOnSearchNoData;var JobsManager=function(_super){__extends(JobsManager,_super);function JobsManager(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new jobs_1.JobsManagerView(_this);_this.jobsModel=_this.app.getModel(api.JOBS);_this.values={search:{onChange:(0,timer_1.debounce)(function(e){var qry=e.value===""?{}:{q:e.value};_this.search(qry)},exports.TIME_SEARCH_DEBOUNCE)},table:{id:"table",data:[],pagination:{current:{count:0,page:1,limit:50},total:{count:0,pages:0}},columns:[new columns_1.TitleColumn(function(job){return _this.showJob(job)}),new columns_1.CompanyColumn,new columns_1.StatusColumn,new columns_1.ActionColumn([{text:"View",divider:false,onClick:function(data){return _this.showJob(data)}},{text:"Approve",divider:false,onClick:function(data){return _this.runFuture(_this.approveJob(data.id))}},{text:"Edit",divider:false,onClick:function(data){return _this.editJob(data)}},{text:"Remove",divider:true,onClick:function(data){return _this.runFuture(_this.removeJob(data.id))}}])]}};_this.onError=function(e){console.error(e);alert("An error has occurred! Details have been logged to the console.")};return _this}JobsManager.prototype.search=function(qry){var that=this;return(0,future_1.doFuture)(function(){var jobs,mtable;return __generator(this,function(_a){switch(_a.label){case 0:return[4,that.jobsModel.search(qry)];case 1:jobs=_a.sent();that.values.table.data=jobs;mtable=that.view.findById(that.values.table.id);if(mtable.isJust())mtable.get().update(jobs);return[2,future_1.voidPure]}})})};JobsManager.prototype.showJob=function(data){var _this=this;this.spawn(function(){return new preview_1.JobPreviewDialog(_this.app,data)})};JobsManager.prototype.approveJob=function(id){var that=this;return(0,future_1.doFuture)(function(){var path,change,r;return __generator(this,function(_a){switch(_a.label){case 0:path=(0,string_1.interpolate)(api.JOB,{id:id});change={status:jobStatus.JOB_STATUS_ACTIVE};return[4,agent.patch(path,change)];case 1:r=_a.sent();if(r.code==200){alert("Job approved!");that.reload()}else{alert("Could not complete request!")}return[2,(0,future_1.pure)(undefined)]}})})};JobsManager.prototype.editJob=function(data){var _this=this;this.spawn(function(){return new preview_1.JobPreviewDialog(_this.app,data,_this.self())})};JobsManager.prototype.removeJob=function(id){var that=this;return(0,future_1.doFuture)(function(){var path,r;return __generator(this,function(_a){switch(_a.label){case 0:path=(0,string_1.interpolate)(api.JOB,{id:id});return[4,agent.delete(path)];case 1:r=_a.sent();if(r.code==200){alert("Job removed!");that.reload()}else{alert("Could not complete request!")}return[2,(0,future_1.pure)(undefined)]}})})};JobsManager.prototype.runFuture=function(ft){ft.fork(this.onError,function_1.noop)};JobsManager.prototype.run=function(){var that=this;return(0,future_1.doFuture)(function(){return __generator(this,function(_a){switch(_a.label){case 0:return[4,that.search({})];case 1:_a.sent();that.show();return[2,future_1.voidPure]}})})};return JobsManager}(manager_1.MiaManager);exports.JobsManager=JobsManager},{"../../api":1,"../../common/scene/manager":3,"../columns":5,"../dialogs/preview":7,"./views/jobs":10,"@board/common/lib/data/job":170,"@quenk/dfront/lib/app/scene/remote/handlers":16,"@quenk/jhr/lib/browser":29,"@quenk/jhr/lib/status":37,"@quenk/noni/lib/control/monad/future":54,"@quenk/noni/lib/control/timer":56,"@quenk/noni/lib/data/function":60,"@quenk/noni/lib/data/string":64}],10:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JobsManagerView=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var grid_1=require("@quenk/wml-widgets/lib/layout/grid");var table_1=require("@quenk/wml-widgets/lib/data/table");var text_field_1=require("@quenk/wml-widgets/lib/control/text-field");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var JobsManagerView=function(){function JobsManagerView(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.widget(new grid_1.GridLayout({},[__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.node("h1",{},[__document.createTextNode("Manage Jobs")])]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new text_field_1.TextField({ww:{placeholder:"Search",onChange:__context.values.search.onChange}},[]),{ww:{placeholder:"Search",onChange:__context.values.search.onChange}})]),{})]),{}),__this.widget(new grid_1.Row({},[__this.widget(new grid_1.Column({},[__this.widget(new table_1.DataTable({wml:{id:__context.values.table.id},ww:{data:__context.values.table.data,columns:__context.values.table.columns}},[]),{wml:{id:__context.values.table.id},ww:{data:__context.values.table.data,columns:__context.values.table.columns}})]),{})]),{})]),{})}}JobsManagerView.prototype.registerView=function(v){this.views.push(v);return v};JobsManagerView.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};JobsManagerView.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};JobsManagerView.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};JobsManagerView.prototype.findById=function(id){var mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};JobsManagerView.prototype.findByGroup=function(name){var mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};JobsManagerView.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};JobsManagerView.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return JobsManagerView}();exports.JobsManagerView=JobsManagerView},{"@quenk/noni/lib/data/maybe":61,"@quenk/wml-widgets/lib/control/text-field":126,"@quenk/wml-widgets/lib/data/table":134,"@quenk/wml-widgets/lib/layout/grid":142,"@quenk/wml/lib/dom":155}],11:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.routes=void 0;var array_1=require("@quenk/noni/lib/data/array");var template_1=require("@quenk/potoo/lib/actor/template");var manager_1=require("./jobs/manager");var ignoredErrors=["ClientError","ServerError"];var trap=function(e){return(0,array_1.contains)(ignoredErrors,e.message)?template_1.ACTION_IGNORE:template_1.ACTION_RAISE};exports.routes={"/":{id:"dashboard",trap:trap,create:function(s,_,r){return new manager_1.JobsManager(s,r)}}}},{"./jobs/manager":9,"@quenk/noni/lib/data/array":57,"@quenk/potoo/lib/actor/template":92}],12:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MiaView=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var action_bar_1=require("@quenk/wml-widgets/lib/layout/action-bar");var main_1=require("@quenk/wml-widgets/lib/layout/main");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var MiaView=function(){function MiaView(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("main",{wml:{id:"main"}},[__this.widget(new action_bar_1.ActionBar({wml:{id:"navbar"},ww:{className:"mia-navbar-bar"}},[]),{wml:{id:"navbar"},ww:{className:"mia-navbar-bar"}}),__this.widget(new main_1.MainLayout({wml:{id:"content"},ww:{className:"mia-content"}},[]),{wml:{id:"content"},ww:{className:"mia-content"}})])}}MiaView.prototype.registerView=function(v){this.views.push(v);return v};MiaView.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};MiaView.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};MiaView.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};MiaView.prototype.findById=function(id){var mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};MiaView.prototype.findByGroup=function(name){var mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};MiaView.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};MiaView.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return MiaView}();exports.MiaView=MiaView},{"@quenk/noni/lib/data/maybe":61,"@quenk/wml-widgets/lib/layout/action-bar":140,"@quenk/wml-widgets/lib/layout/main":145,"@quenk/wml/lib/dom":155}],13:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});var app_1=require("./app");app_1.Mia.create(document.getElementById("main"),document.getElementById("dialogs")).run()},{"./app":4}],14:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.DApplication=exports.BACKGROUND_REMOTE=void 0;var record_1=require("@quenk/noni/lib/data/record");var app_1=require("@quenk/jouvert/lib/app");var factory_1=require("@quenk/jouvert/lib/app/remote/model/factory");exports.BACKGROUND_REMOTE="remote.background";var defaultConf={log:{level:6,logger:console}};var DApplication=function(_super){__extends(DApplication,_super);function DApplication(node,conf){if(conf===void 0){conf={}}var _this=_super.call(this,(0,record_1.merge3)(defaultConf,conf,{accept:function(m){return _this.onMessage(m)}}))||this;_this.node=node;_this.conf=conf;_this.services={};return _this}Object.defineProperty(DApplication.prototype,"models",{get:function(){return factory_1.RemoteModelFactory.getInstance(this,this.services[exports.BACKGROUND_REMOTE])},enumerable:false,configurable:true});DApplication.prototype.getModel=function(path,handler){return this.models.create(path,handler)};DApplication.prototype.onMessage=function(_){};DApplication.prototype.spawn=function(t){var addr=_super.prototype.spawn.call(this,t);this.services[t.id]=addr;return addr};return DApplication}(app_1.JApp);exports.DApplication=DApplication},{"@quenk/jouvert/lib/app":43,"@quenk/jouvert/lib/app/remote/model/factory":46,"@quenk/noni/lib/data/record":62}],15:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.DScene=void 0;var scene_1=require("@quenk/jouvert/lib/app/scene");var listener_1=require("@quenk/jouvert/lib/app/scene/form/listener");var director_1=require("@quenk/jouvert/lib/app/director");var scene_2=require("@quenk/jouvert/lib/app/scene");var view_1=require("@quenk/jouvert/lib/app/service/view");var DScene=function(_super){__extends(DScene,_super);function DScene(resume,app){var _this=_super.call(this,resume,app)||this;_this.resume=resume;_this.app=app;_this.name=_this.self();_this.receive=[new scene_1.SuspendCase(_this),new listener_1.FormAbortedCase(_this),new listener_1.FormSavedCase(_this)];return _this}DScene.prototype.afterShow=function(){return this};DScene.prototype.afterFormAborted=function(_){this.show();return this};DScene.prototype.afterFormSaved=function(_){this.reload();return this};DScene.prototype.show=function(){this.tell(this.resume.director,new view_1.Show(this.name,this.view,this.self()));this.afterShow();return this};DScene.prototype.reload=function(){this.tell(this.resume.director,new director_1.Reload(this.self()))};DScene.prototype.run=function(){this.show()};return DScene}(scene_2.AppScene);exports.DScene=DScene},{"@quenk/jouvert/lib/app/director":41,"@quenk/jouvert/lib/app/scene":49,"@quenk/jouvert/lib/app/scene/form/listener":48,"@quenk/jouvert/lib/app/service/view":52}],16:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.SlidingOnClientError=exports.SlidingOnComplete=exports.OrOnClientError=exports.OrOnComplete=exports.ExecOnClientError=exports.ExecOnComplete=void 0;var callback_1=require("@quenk/jouvert/lib/app/remote/callback");var ExecOnComplete=function(_super){__extends(ExecOnComplete,_super);function ExecOnComplete(code,callback){var _this=_super.call(this)||this;_this.code=code;_this.callback=callback;return _this}ExecOnComplete.prototype.onComplete=function(r){if(r.code===this.code)this.callback(r)};return ExecOnComplete}(callback_1.AbstractCompleteHandler);exports.ExecOnComplete=ExecOnComplete;var ExecOnClientError=function(_super){__extends(ExecOnClientError,_super);function ExecOnClientError(code,callback){var _this=_super.call(this)||this;_this.code=code;_this.callback=callback;return _this}ExecOnClientError.prototype.onClientError=function(r){if(r.code===this.code)this.callback(r)};return ExecOnClientError}(callback_1.AbstractCompleteHandler);exports.ExecOnClientError=ExecOnClientError;var OrOnComplete=function(_super){__extends(OrOnComplete,_super);function OrOnComplete(condition,onTrue,onFalse){var _this=_super.call(this)||this;_this.condition=condition;_this.onTrue=onTrue;_this.onFalse=onFalse;return _this}OrOnComplete.prototype.onComplete=function(r){var target=this.condition(r)?this.onTrue:this.onFalse;target.onComplete(r)};return OrOnComplete}(callback_1.AbstractCompleteHandler);exports.OrOnComplete=OrOnComplete;var OrOnClientError=function(_super){__extends(OrOnClientError,_super);function OrOnClientError(condition,onTrue,onFalse){var _this=_super.call(this)||this;_this.condition=condition;_this.onTrue=onTrue;_this.onFalse=onFalse;return _this}OrOnClientError.prototype.onClientError=function(r){var target=this.condition(r)?this.onTrue:this.onFalse;target.onClientError(r)};return OrOnClientError}(callback_1.AbstractCompleteHandler);exports.OrOnClientError=OrOnClientError;var SlidingOnComplete=function(_super){__extends(SlidingOnComplete,_super);function SlidingOnComplete(handlers){var _this=_super.call(this)||this;_this.handlers=handlers;_this.ptr=0;return _this}SlidingOnComplete.prototype.onComplete=function(r){var _a=this,handlers=_a.handlers,ptr=_a.ptr;if(handlers[ptr]){handlers[ptr].onComplete(r);ptr++}};return SlidingOnComplete}(callback_1.AbstractCompleteHandler);exports.SlidingOnComplete=SlidingOnComplete;var SlidingOnClientError=function(_super){__extends(SlidingOnClientError,_super);function SlidingOnClientError(handlers){var _this=_super.call(this)||this;_this.handlers=handlers;_this.ptr=0;return _this}SlidingOnClientError.prototype.onClientError=function(r){var _a=this,handlers=_a.handlers,ptr=_a.ptr;if(handlers[ptr]){handlers[ptr].onClientError(r);ptr++}};return SlidingOnClientError}(callback_1.AbstractCompleteHandler);exports.SlidingOnClientError=SlidingOnClientError},{"@quenk/jouvert/lib/app/remote/callback":44}],17:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.compile=exports.takeHash=exports.HashRouter=exports.DefaultRequest=exports.AbstractHashRouter=exports.Cache=void 0;var qs=require("qs");var toRegex=require("path-to-regexp");var function_1=require("@quenk/noni/lib/data/function");var future_1=require("@quenk/noni/lib/control/monad/future");var record_1=require("@quenk/noni/lib/data/record");var EVENT_HASH_CHANGED="hashchange";var Cache=function(){function Cache(regex,keys,filters,handler){this.regex=regex;this.keys=keys;this.filters=filters;this.handler=handler}return Cache}();exports.Cache=Cache;var AbstractHashRouter=function(){function AbstractHashRouter(window,routes){if(routes===void 0){routes={}}this.window=window;this.routes=routes;this.cache=[];this.keys=[]}AbstractHashRouter.prototype.handleEvent=function(_){var _this=this;var _a=exports.takeHash(this.window),path=_a[0],query=_a[1];var cache=this.cache;var mware=[];var handler=function(){return future_1.pure(undefined)};var keys=[];var r=null;var count=0;while(r==null&&count<cache.length){r=cache[count].regex.exec(path);keys=cache[count].keys;mware=cache[count].filters;handler=cache[count].handler;count=count+1}if(r!=null){var ft=this.createRequest(path,qs.parse(query),parseParams(keys,r));mware.reduce(function(p,c){return p.chain(c)},ft).chain(handler).catch(function(e){return _this.onError(e)}).fork(console.error,function_1.noop)}else{this.onNotFound(path).fork(console.error,function_1.noop)}};AbstractHashRouter.prototype.add=function(path,handler){if(this.routes.hasOwnProperty(path)){this.routes[path][1]=handler}else{this.routes[path]=[[],handler]}this.cache=exports.compile(this.routes);return this};AbstractHashRouter.prototype.use=function(path,mware){if(this.routes.hasOwnProperty(path)){this.routes[path][0].push(mware)}else{this.routes[path]=[[mware],function(){return future_1.pure(undefined)}]}this.cache=exports.compile(this.routes);return this};AbstractHashRouter.prototype.clear=function(){this.cache=[];this.routes={}};AbstractHashRouter.prototype.start=function(){this.window.addEventListener(EVENT_HASH_CHANGED,this);return this};AbstractHashRouter.prototype.stop=function(){this.window.removeEventListener(EVENT_HASH_CHANGED,this);return this};return AbstractHashRouter}();exports.AbstractHashRouter=AbstractHashRouter;var DefaultRequest=function(){function DefaultRequest(path,query,params){this.path=path;this.query=query;this.params=params}return DefaultRequest}();exports.DefaultRequest=DefaultRequest;var HashRouter=function(_super){__extends(HashRouter,_super);function HashRouter(window,routes,error,notFound){if(routes===void 0){routes={}}if(error===void 0){error=function(e){return future_1.raise(e)}}if(notFound===void 0){notFound=function(){return future_1.pure(function_1.noop())}}var _this=_super.call(this,window,routes)||this;_this.window=window;_this.routes=routes;_this.error=error;_this.notFound=notFound;return _this}HashRouter.prototype.createRequest=function(path,query,params){return future_1.pure(new DefaultRequest(path,query,params))};HashRouter.prototype.onError=function(e){return this.error(e)};HashRouter.prototype.onNotFound=function(path){return this.notFound(path)};return HashRouter}(AbstractHashRouter);exports.HashRouter=HashRouter;var parseParams=function(keys,results){var params=Object.create(null);keys.forEach(function(key,index){return params[key.name]=results[index+1]});return params};exports.takeHash=function(w){return w.location.hash!=null&&w.location.hash!=""?w.location.hash.replace(/^#/,"/").replace(/\/\//g,"/").split("?"):["/"]};exports.compile=function(r){return record_1.reduce(r,[],function(p,c,path){var keys=[];return p.concat(new Cache(toRegex.pathToRegexp(path,keys),keys,c[0],c[1]))})}},{"@quenk/noni/lib/control/monad/future":54,"@quenk/noni/lib/data/function":60,"@quenk/noni/lib/data/record":62,"path-to-regexp":18,qs:20}],18:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.pathToRegexp=exports.tokensToRegexp=exports.regexpToFunction=exports.match=exports.tokensToFunction=exports.compile=exports.parse=void 0;function lexer(str){var tokens=[];var i=0;while(i<str.length){var char=str[i];if(char==="*"||char==="+"||char==="?"){tokens.push({type:"MODIFIER",index:i,value:str[i++]});continue}if(char==="\\"){tokens.push({type:"ESCAPED_CHAR",index:i++,value:str[i++]});continue}if(char==="{"){tokens.push({type:"OPEN",index:i,value:str[i++]});continue}if(char==="}"){tokens.push({type:"CLOSE",index:i,value:str[i++]});continue}if(char===":"){var name="";var j=i+1;while(j<str.length){var code=str.charCodeAt(j);if(code>=48&&code<=57||code>=65&&code<=90||code>=97&&code<=122||code===95){name+=str[j++];continue}break}if(!name)throw new TypeError("Missing parameter name at "+i);tokens.push({type:"NAME",index:i,value:name});i=j;continue}if(char==="("){var count=1;var pattern="";var j=i+1;if(str[j]==="?"){throw new TypeError('Pattern cannot start with "?" at '+j)}while(j<str.length){if(str[j]==="\\"){pattern+=str[j++]+str[j++];continue}if(str[j]===")"){count--;if(count===0){j++;break}}else if(str[j]==="("){count++;if(str[j+1]!=="?"){throw new TypeError("Capturing groups are not allowed at "+j)}}pattern+=str[j++]}if(count)throw new TypeError("Unbalanced pattern at "+i);if(!pattern)throw new TypeError("Missing pattern at "+i);tokens.push({type:"PATTERN",index:i,value:pattern});i=j;continue}tokens.push({type:"CHAR",index:i,value:str[i++]})}tokens.push({type:"END",index:i,value:""});return tokens}function parse(str,options){if(options===void 0){options={}}var tokens=lexer(str);var _a=options.prefixes,prefixes=_a===void 0?"./":_a;var defaultPattern="[^"+escapeString(options.delimiter||"/#?")+"]+?";var result=[];var key=0;var i=0;var path="";var tryConsume=function(type){if(i<tokens.length&&tokens[i].type===type)return tokens[i++].value};var mustConsume=function(type){var value=tryConsume(type);if(value!==undefined)return value;var _a=tokens[i],nextType=_a.type,index=_a.index;throw new TypeError("Unexpected "+nextType+" at "+index+", expected "+type)};var consumeText=function(){var result="";var value;while(value=tryConsume("CHAR")||tryConsume("ESCAPED_CHAR")){result+=value}return result};while(i<tokens.length){var char=tryConsume("CHAR");var name=tryConsume("NAME");var pattern=tryConsume("PATTERN");if(name||pattern){var prefix=char||"";if(prefixes.indexOf(prefix)===-1){path+=prefix;prefix=""}if(path){result.push(path);path=""}result.push({name:name||key++,prefix:prefix,suffix:"",pattern:pattern||defaultPattern,modifier:tryConsume("MODIFIER")||""});continue}var value=char||tryConsume("ESCAPED_CHAR");if(value){path+=value;continue}if(path){result.push(path);path=""}var open=tryConsume("OPEN");if(open){var prefix=consumeText();var name_1=tryConsume("NAME")||"";var pattern_1=tryConsume("PATTERN")||"";var suffix=consumeText();mustConsume("CLOSE");result.push({name:name_1||(pattern_1?key++:""),pattern:name_1&&!pattern_1?defaultPattern:pattern_1,prefix:prefix,suffix:suffix,modifier:tryConsume("MODIFIER")||""});continue}mustConsume("END")}return result}exports.parse=parse;function compile(str,options){return tokensToFunction(parse(str,options),options)}exports.compile=compile;function tokensToFunction(tokens,options){if(options===void 0){options={}}var reFlags=flags(options);var _a=options.encode,encode=_a===void 0?function(x){return x}:_a,_b=options.validate,validate=_b===void 0?true:_b;var matches=tokens.map(function(token){if(typeof token==="object"){return new RegExp("^(?:"+token.pattern+")$",reFlags)}});return function(data){var path="";for(var i=0;i<tokens.length;i++){var token=tokens[i];if(typeof token==="string"){path+=token;continue}var value=data?data[token.name]:undefined;var optional=token.modifier==="?"||token.modifier==="*";var repeat=token.modifier==="*"||token.modifier==="+";if(Array.isArray(value)){if(!repeat){throw new TypeError('Expected "'+token.name+'" to not repeat, but got an array')}if(value.length===0){if(optional)continue;throw new TypeError('Expected "'+token.name+'" to not be empty')}for(var j=0;j<value.length;j++){var segment=encode(value[j],token);if(validate&&!matches[i].test(segment)){throw new TypeError('Expected all "'+token.name+'" to match "'+token.pattern+'", but got "'+segment+'"')}path+=token.prefix+segment+token.suffix}continue}if(typeof value==="string"||typeof value==="number"){var segment=encode(String(value),token);if(validate&&!matches[i].test(segment)){throw new TypeError('Expected "'+token.name+'" to match "'+token.pattern+'", but got "'+segment+'"')}path+=token.prefix+segment+token.suffix;continue}if(optional)continue;var typeOfMessage=repeat?"an array":"a string";throw new TypeError('Expected "'+token.name+'" to be '+typeOfMessage)}return path}}exports.tokensToFunction=tokensToFunction;function match(str,options){var keys=[];var re=pathToRegexp(str,keys,options);return regexpToFunction(re,keys,options)}exports.match=match;function regexpToFunction(re,keys,options){if(options===void 0){options={}}var _a=options.decode,decode=_a===void 0?function(x){return x}:_a;return function(pathname){var m=re.exec(pathname);if(!m)return false;var path=m[0],index=m.index;var params=Object.create(null);var _loop_1=function(i){if(m[i]===undefined)return"continue";var key=keys[i-1];if(key.modifier==="*"||key.modifier==="+"){params[key.name]=m[i].split(key.prefix+key.suffix).map(function(value){return decode(value,key)})}else{params[key.name]=decode(m[i],key)}};for(var i=1;i<m.length;i++){_loop_1(i)}return{path:path,index:index,params:params}}}exports.regexpToFunction=regexpToFunction;function escapeString(str){return str.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function flags(options){return options&&options.sensitive?"":"i"}function regexpToRegexp(path,keys){if(!keys)return path;var groupsRegex=/\((?:\?<(.*?)>)?(?!\?)/g;var index=0;var execResult=groupsRegex.exec(path.source);while(execResult){keys.push({name:execResult[1]||index++,prefix:"",suffix:"",modifier:"",pattern:""});execResult=groupsRegex.exec(path.source)}return path}function arrayToRegexp(paths,keys,options){var parts=paths.map(function(path){return pathToRegexp(path,keys,options).source});return new RegExp("(?:"+parts.join("|")+")",flags(options))}function stringToRegexp(path,keys,options){return tokensToRegexp(parse(path,options),keys,options)}function tokensToRegexp(tokens,keys,options){if(options===void 0){options={}}var _a=options.strict,strict=_a===void 0?false:_a,_b=options.start,start=_b===void 0?true:_b,_c=options.end,end=_c===void 0?true:_c,_d=options.encode,encode=_d===void 0?function(x){return x}:_d;var endsWith="["+escapeString(options.endsWith||"")+"]|$";var delimiter="["+escapeString(options.delimiter||"/#?")+"]";var route=start?"^":"";for(var _i=0,tokens_1=tokens;_i<tokens_1.length;_i++){var token=tokens_1[_i];if(typeof token==="string"){route+=escapeString(encode(token))}else{var prefix=escapeString(encode(token.prefix));var suffix=escapeString(encode(token.suffix));if(token.pattern){if(keys)keys.push(token);if(prefix||suffix){if(token.modifier==="+"||token.modifier==="*"){var mod=token.modifier==="*"?"?":"";route+="(?:"+prefix+"((?:"+token.pattern+")(?:"+suffix+prefix+"(?:"+token.pattern+"))*)"+suffix+")"+mod}else{route+="(?:"+prefix+"("+token.pattern+")"+suffix+")"+token.modifier}}else{route+="("+token.pattern+")"+token.modifier}}else{route+="(?:"+prefix+suffix+")"+token.modifier}}}if(end){if(!strict)route+=delimiter+"?";route+=!options.endsWith?"$":"(?="+endsWith+")"}else{var endToken=tokens[tokens.length-1];var isEndDelimited=typeof endToken==="string"?delimiter.indexOf(endToken[endToken.length-1])>-1:endToken===undefined;if(!strict){route+="(?:"+delimiter+"(?="+endsWith+"))?"}if(!isEndDelimited){route+="(?="+delimiter+"|"+endsWith+")"}}return new RegExp(route,flags(options))}exports.tokensToRegexp=tokensToRegexp;function pathToRegexp(path,keys,options){if(path instanceof RegExp)return regexpToRegexp(path,keys);if(Array.isArray(path))return arrayToRegexp(path,keys,options);return stringToRegexp(path,keys,options)}exports.pathToRegexp=pathToRegexp},{}],19:[function(require,module,exports){"use strict";var replace=String.prototype.replace;var percentTwenties=/%20/g;var Format={RFC1738:"RFC1738",RFC3986:"RFC3986"};module.exports={default:Format.RFC3986,formatters:{RFC1738:function(value){return replace.call(value,percentTwenties,"+")},RFC3986:function(value){return String(value)}},RFC1738:Format.RFC1738,RFC3986:Format.RFC3986}},{}],20:[function(require,module,exports){"use strict";var stringify=require("./stringify");var parse=require("./parse");var formats=require("./formats");module.exports={formats:formats,parse:parse,stringify:stringify}},{"./formats":19,"./parse":21,"./stringify":22}],21:[function(require,module,exports){"use strict";var utils=require("./utils");var has=Object.prototype.hasOwnProperty;var isArray=Array.isArray;var defaults={allowDots:false,allowPrototypes:false,allowSparse:false,arrayLimit:20,charset:"utf-8",charsetSentinel:false,comma:false,decoder:utils.decode,delimiter:"&",depth:5,ignoreQueryPrefix:false,interpretNumericEntities:false,parameterLimit:1e3,parseArrays:true,plainObjects:false,strictNullHandling:false};var interpretNumericEntities=function(str){return str.replace(/&#(\d+);/g,function($0,numberStr){return String.fromCharCode(parseInt(numberStr,10))})};var parseArrayValue=function(val,options){if(val&&typeof val==="string"&&options.comma&&val.indexOf(",")>-1){return val.split(",")}return val};var isoSentinel="utf8=%26%2310003%3B";var charsetSentinel="utf8=%E2%9C%93";var parseValues=function parseQueryStringValues(str,options){var obj={};var cleanStr=options.ignoreQueryPrefix?str.replace(/^\?/,""):str;var limit=options.parameterLimit===Infinity?undefined:options.parameterLimit;var parts=cleanStr.split(options.delimiter,limit);var skipIndex=-1;var i;var charset=options.charset;if(options.charsetSentinel){for(i=0;i<parts.length;++i){if(parts[i].indexOf("utf8=")===0){if(parts[i]===charsetSentinel){charset="utf-8"}else if(parts[i]===isoSentinel){charset="iso-8859-1"}skipIndex=i;i=parts.length}}}for(i=0;i<parts.length;++i){if(i===skipIndex){continue}var part=parts[i];var bracketEqualsPos=part.indexOf("]=");var pos=bracketEqualsPos===-1?part.indexOf("="):bracketEqualsPos+1;var key,val;if(pos===-1){key=options.decoder(part,defaults.decoder,charset,"key");val=options.strictNullHandling?null:""}else{key=options.decoder(part.slice(0,pos),defaults.decoder,charset,"key");val=utils.maybeMap(parseArrayValue(part.slice(pos+1),options),function(encodedVal){return options.decoder(encodedVal,defaults.decoder,charset,"value")})}if(val&&options.interpretNumericEntities&&charset==="iso-8859-1"){val=interpretNumericEntities(val)}if(part.indexOf("[]=")>-1){val=isArray(val)?[val]:val}if(has.call(obj,key)){obj[key]=utils.combine(obj[key],val)}else{obj[key]=val}}return obj};var parseObject=function(chain,val,options,valuesParsed){var leaf=valuesParsed?val:parseArrayValue(val,options);for(var i=chain.length-1;i>=0;--i){var obj;var root=chain[i];if(root==="[]"&&options.parseArrays){obj=[].concat(leaf)}else{obj=options.plainObjects?Object.create(null):{};var cleanRoot=root.charAt(0)==="["&&root.charAt(root.length-1)==="]"?root.slice(1,-1):root;var index=parseInt(cleanRoot,10);if(!options.parseArrays&&cleanRoot===""){obj={0:leaf}}else if(!isNaN(index)&&root!==cleanRoot&&String(index)===cleanRoot&&index>=0&&(options.parseArrays&&index<=options.arrayLimit)){obj=[];obj[index]=leaf}else{obj[cleanRoot]=leaf}}leaf=obj}return leaf};var parseKeys=function parseQueryStringKeys(givenKey,val,options,valuesParsed){if(!givenKey){return}var key=options.allowDots?givenKey.replace(/\.([^.[]+)/g,"[$1]"):givenKey;var brackets=/(\[[^[\]]*])/;var child=/(\[[^[\]]*])/g;var segment=options.depth>0&&brackets.exec(key);var parent=segment?key.slice(0,segment.index):key;var keys=[];if(parent){if(!options.plainObjects&&has.call(Object.prototype,parent)){if(!options.allowPrototypes){return}}keys.push(parent)}var i=0;while(options.depth>0&&(segment=child.exec(key))!==null&&i<options.depth){i+=1;if(!options.plainObjects&&has.call(Object.prototype,segment[1].slice(1,-1))){if(!options.allowPrototypes){return}}keys.push(segment[1])}if(segment){keys.push("["+key.slice(segment.index)+"]")}return parseObject(keys,val,options,valuesParsed)};var normalizeParseOptions=function normalizeParseOptions(opts){if(!opts){return defaults}if(opts.decoder!==null&&opts.decoder!==undefined&&typeof opts.decoder!=="function"){throw new TypeError("Decoder has to be a function.")}if(typeof opts.charset!=="undefined"&&opts.charset!=="utf-8"&&opts.charset!=="iso-8859-1"){throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined")}var charset=typeof opts.charset==="undefined"?defaults.charset:opts.charset;return{allowDots:typeof opts.allowDots==="undefined"?defaults.allowDots:!!opts.allowDots,allowPrototypes:typeof opts.allowPrototypes==="boolean"?opts.allowPrototypes:defaults.allowPrototypes,allowSparse:typeof opts.allowSparse==="boolean"?opts.allowSparse:defaults.allowSparse,arrayLimit:typeof opts.arrayLimit==="number"?opts.arrayLimit:defaults.arrayLimit,charset:charset,charsetSentinel:typeof opts.charsetSentinel==="boolean"?opts.charsetSentinel:defaults.charsetSentinel,comma:typeof opts.comma==="boolean"?opts.comma:defaults.comma,decoder:typeof opts.decoder==="function"?opts.decoder:defaults.decoder,delimiter:typeof opts.delimiter==="string"||utils.isRegExp(opts.delimiter)?opts.delimiter:defaults.delimiter,depth:typeof opts.depth==="number"||opts.depth===false?+opts.depth:defaults.depth,ignoreQueryPrefix:opts.ignoreQueryPrefix===true,interpretNumericEntities:typeof opts.interpretNumericEntities==="boolean"?opts.interpretNumericEntities:defaults.interpretNumericEntities,parameterLimit:typeof opts.parameterLimit==="number"?opts.parameterLimit:defaults.parameterLimit,parseArrays:opts.parseArrays!==false,plainObjects:typeof opts.plainObjects==="boolean"?opts.plainObjects:defaults.plainObjects,strictNullHandling:typeof opts.strictNullHandling==="boolean"?opts.strictNullHandling:defaults.strictNullHandling}};module.exports=function(str,opts){var options=normalizeParseOptions(opts);if(str===""||str===null||typeof str==="undefined"){return options.plainObjects?Object.create(null):{}}var tempObj=typeof str==="string"?parseValues(str,options):str;var obj=options.plainObjects?Object.create(null):{};var keys=Object.keys(tempObj);for(var i=0;i<keys.length;++i){var key=keys[i];var newObj=parseKeys(key,tempObj[key],options,typeof str==="string");obj=utils.merge(obj,newObj,options)}if(options.allowSparse===true){return obj}return utils.compact(obj)}},{"./utils":23}],22:[function(require,module,exports){"use strict";var getSideChannel=require("side-channel");var utils=require("./utils");var formats=require("./formats");var has=Object.prototype.hasOwnProperty;var arrayPrefixGenerators={brackets:function brackets(prefix){return prefix+"[]"},comma:"comma",indices:function indices(prefix,key){return prefix+"["+key+"]"},repeat:function repeat(prefix){return prefix}};var isArray=Array.isArray;var push=Array.prototype.push;var pushToArray=function(arr,valueOrArray){push.apply(arr,isArray(valueOrArray)?valueOrArray:[valueOrArray])};var toISO=Date.prototype.toISOString;var defaultFormat=formats["default"];var defaults={addQueryPrefix:false,allowDots:false,charset:"utf-8",charsetSentinel:false,delimiter:"&",encode:true,encoder:utils.encode,encodeValuesOnly:false,format:defaultFormat,formatter:formats.formatters[defaultFormat],indices:false,serializeDate:function serializeDate(date){return toISO.call(date)},skipNulls:false,strictNullHandling:false};var isNonNullishPrimitive=function isNonNullishPrimitive(v){return typeof v==="string"||typeof v==="number"||typeof v==="boolean"||typeof v==="symbol"||typeof v==="bigint"};var stringify=function stringify(object,prefix,generateArrayPrefix,strictNullHandling,skipNulls,encoder,filter,sort,allowDots,serializeDate,format,formatter,encodeValuesOnly,charset,sideChannel){var obj=object;if(sideChannel.has(object)){throw new RangeError("Cyclic object value")}if(typeof filter==="function"){obj=filter(prefix,obj)}else if(obj instanceof Date){obj=serializeDate(obj)}else if(generateArrayPrefix==="comma"&&isArray(obj)){obj=utils.maybeMap(obj,function(value){if(value instanceof Date){return serializeDate(value)}return value})}if(obj===null){if(strictNullHandling){return encoder&&!encodeValuesOnly?encoder(prefix,defaults.encoder,charset,"key",format):prefix}obj=""}if(isNonNullishPrimitive(obj)||utils.isBuffer(obj)){if(encoder){var keyValue=encodeValuesOnly?prefix:encoder(prefix,defaults.encoder,charset,"key",format);return[formatter(keyValue)+"="+formatter(encoder(obj,defaults.encoder,charset,"value",format))]}return[formatter(prefix)+"="+formatter(String(obj))]}var values=[];if(typeof obj==="undefined"){return values}var objKeys;if(generateArrayPrefix==="comma"&&isArray(obj)){objKeys=[{value:obj.length>0?obj.join(",")||null:undefined}]}else if(isArray(filter)){objKeys=filter}else{var keys=Object.keys(obj);objKeys=sort?keys.sort(sort):keys}for(var i=0;i<objKeys.length;++i){var key=objKeys[i];var value=typeof key==="object"&&key.value!==undefined?key.value:obj[key];if(skipNulls&&value===null){continue}var keyPrefix=isArray(obj)?typeof generateArrayPrefix==="function"?generateArrayPrefix(prefix,key):prefix:prefix+(allowDots?"."+key:"["+key+"]");sideChannel.set(object,true);var valueSideChannel=getSideChannel();pushToArray(values,stringify(value,keyPrefix,generateArrayPrefix,strictNullHandling,skipNulls,encoder,filter,sort,allowDots,serializeDate,format,formatter,encodeValuesOnly,charset,valueSideChannel))}return values};var normalizeStringifyOptions=function normalizeStringifyOptions(opts){if(!opts){return defaults}if(opts.encoder!==null&&opts.encoder!==undefined&&typeof opts.encoder!=="function"){throw new TypeError("Encoder has to be a function.")}var charset=opts.charset||defaults.charset;if(typeof opts.charset!=="undefined"&&opts.charset!=="utf-8"&&opts.charset!=="iso-8859-1"){throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined")}var format=formats["default"];if(typeof opts.format!=="undefined"){if(!has.call(formats.formatters,opts.format)){throw new TypeError("Unknown format option provided.")}format=opts.format}var formatter=formats.formatters[format];var filter=defaults.filter;if(typeof opts.filter==="function"||isArray(opts.filter)){filter=opts.filter}return{addQueryPrefix:typeof opts.addQueryPrefix==="boolean"?opts.addQueryPrefix:defaults.addQueryPrefix,allowDots:typeof opts.allowDots==="undefined"?defaults.allowDots:!!opts.allowDots,charset:charset,charsetSentinel:typeof opts.charsetSentinel==="boolean"?opts.charsetSentinel:defaults.charsetSentinel,delimiter:typeof opts.delimiter==="undefined"?defaults.delimiter:opts.delimiter,encode:typeof opts.encode==="boolean"?opts.encode:defaults.encode,encoder:typeof opts.encoder==="function"?opts.encoder:defaults.encoder,encodeValuesOnly:typeof opts.encodeValuesOnly==="boolean"?opts.encodeValuesOnly:defaults.encodeValuesOnly,filter:filter,format:format,formatter:formatter,serializeDate:typeof opts.serializeDate==="function"?opts.serializeDate:defaults.serializeDate,skipNulls:typeof opts.skipNulls==="boolean"?opts.skipNulls:defaults.skipNulls,sort:typeof opts.sort==="function"?opts.sort:null,strictNullHandling:typeof opts.strictNullHandling==="boolean"?opts.strictNullHandling:defaults.strictNullHandling}};module.exports=function(object,opts){var obj=object;var options=normalizeStringifyOptions(opts);var objKeys;var filter;if(typeof options.filter==="function"){filter=options.filter;obj=filter("",obj)}else if(isArray(options.filter)){filter=options.filter;objKeys=filter}var keys=[];if(typeof obj!=="object"||obj===null){return""}var arrayFormat;if(opts&&opts.arrayFormat in arrayPrefixGenerators){arrayFormat=opts.arrayFormat}else if(opts&&"indices"in opts){arrayFormat=opts.indices?"indices":"repeat"}else{arrayFormat="indices"}var generateArrayPrefix=arrayPrefixGenerators[arrayFormat];if(!objKeys){objKeys=Object.keys(obj)}if(options.sort){objKeys.sort(options.sort)}var sideChannel=getSideChannel();for(var i=0;i<objKeys.length;++i){var key=objKeys[i];if(options.skipNulls&&obj[key]===null){continue}pushToArray(keys,stringify(obj[key],key,generateArrayPrefix,options.strictNullHandling,options.skipNulls,options.encode?options.encoder:null,options.filter,options.sort,options.allowDots,options.serializeDate,options.format,options.formatter,options.encodeValuesOnly,options.charset,sideChannel))}var joined=keys.join(options.delimiter);var prefix=options.addQueryPrefix===true?"?":"";if(options.charsetSentinel){if(options.charset==="iso-8859-1"){prefix+="utf8=%26%2310003%3B&"}else{prefix+="utf8=%E2%9C%93&"}}return joined.length>0?prefix+joined:""}},{"./formats":19,"./utils":23,"side-channel":169}],23:[function(require,module,exports){"use strict";var formats=require("./formats");var has=Object.prototype.hasOwnProperty;var isArray=Array.isArray;var hexTable=function(){var array=[];for(var i=0;i<256;++i){array.push("%"+((i<16?"0":"")+i.toString(16)).toUpperCase())}return array}();var compactQueue=function compactQueue(queue){while(queue.length>1){var item=queue.pop();var obj=item.obj[item.prop];if(isArray(obj)){var compacted=[];for(var j=0;j<obj.length;++j){if(typeof obj[j]!=="undefined"){compacted.push(obj[j])}}item.obj[item.prop]=compacted}}};var arrayToObject=function arrayToObject(source,options){var obj=options&&options.plainObjects?Object.create(null):{};for(var i=0;i<source.length;++i){if(typeof source[i]!=="undefined"){obj[i]=source[i]}}return obj};var merge=function merge(target,source,options){if(!source){return target}if(typeof source!=="object"){if(isArray(target)){target.push(source)}else if(target&&typeof target==="object"){if(options&&(options.plainObjects||options.allowPrototypes)||!has.call(Object.prototype,source)){target[source]=true}}else{return[target,source]}return target}if(!target||typeof target!=="object"){return[target].concat(source)}var mergeTarget=target;if(isArray(target)&&!isArray(source)){mergeTarget=arrayToObject(target,options)}if(isArray(target)&&isArray(source)){source.forEach(function(item,i){if(has.call(target,i)){var targetItem=target[i];if(targetItem&&typeof targetItem==="object"&&item&&typeof item==="object"){target[i]=merge(targetItem,item,options)}else{target.push(item)}}else{target[i]=item}});return target}return Object.keys(source).reduce(function(acc,key){var value=source[key];if(has.call(acc,key)){acc[key]=merge(acc[key],value,options)}else{acc[key]=value}return acc},mergeTarget)};var assign=function assignSingleSource(target,source){return Object.keys(source).reduce(function(acc,key){acc[key]=source[key];return acc},target)};var decode=function(str,decoder,charset){var strWithoutPlus=str.replace(/\+/g," ");if(charset==="iso-8859-1"){return strWithoutPlus.replace(/%[0-9a-f]{2}/gi,unescape)}try{return decodeURIComponent(strWithoutPlus)}catch(e){return strWithoutPlus}};var encode=function encode(str,defaultEncoder,charset,kind,format){if(str.length===0){return str}var string=str;if(typeof str==="symbol"){string=Symbol.prototype.toString.call(str)}else if(typeof str!=="string"){string=String(str)}if(charset==="iso-8859-1"){return escape(string).replace(/%u[0-9a-f]{4}/gi,function($0){return"%26%23"+parseInt($0.slice(2),16)+"%3B"})}var out="";for(var i=0;i<string.length;++i){var c=string.charCodeAt(i);if(c===45||c===46||c===95||c===126||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122||format===formats.RFC1738&&(c===40||c===41)){out+=string.charAt(i);continue}if(c<128){out=out+hexTable[c];continue}if(c<2048){out=out+(hexTable[192|c>>6]+hexTable[128|c&63]);continue}if(c<55296||c>=57344){out=out+(hexTable[224|c>>12]+hexTable[128|c>>6&63]+hexTable[128|c&63]);continue}i+=1;c=65536+((c&1023)<<10|string.charCodeAt(i)&1023);out+=hexTable[240|c>>18]+hexTable[128|c>>12&63]+hexTable[128|c>>6&63]+hexTable[128|c&63]}return out};var compact=function compact(value){var queue=[{obj:{o:value},prop:"o"}];var refs=[];for(var i=0;i<queue.length;++i){var item=queue[i];var obj=item.obj[item.prop];var keys=Object.keys(obj);for(var j=0;j<keys.length;++j){var key=keys[j];var val=obj[key];if(typeof val==="object"&&val!==null&&refs.indexOf(val)===-1){queue.push({obj:obj,prop:key});refs.push(val)}}}compactQueue(queue);return value};var isRegExp=function isRegExp(obj){return Object.prototype.toString.call(obj)==="[object RegExp]"};var isBuffer=function isBuffer(obj){if(!obj||typeof obj!=="object"){return false}return!!(obj.constructor&&obj.constructor.isBuffer&&obj.constructor.isBuffer(obj))};var combine=function combine(a,b){return[].concat(a,b)};var maybeMap=function maybeMap(val,fn){if(isArray(val)){var mapped=[];for(var i=0;i<val.length;i+=1){mapped.push(fn(val[i]))}return mapped}return fn(val)};module.exports={arrayToObject:arrayToObject,assign:assign,combine:combine,compact:compact,decode:decode,encode:encode,isBuffer:isBuffer,isRegExp:isRegExp,maybeMap:maybeMap,merge:merge}},{"./formats":19}],24:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Agent=exports.defaultOptions=void 0;var util=require("../util");var record_1=require("@quenk/noni/lib/data/record");var future_1=require("@quenk/noni/lib/control/monad/future");var string_1=require("@quenk/noni/lib/data/string");var request_1=require("../request");exports.defaultOptions={ttl:0,tags:{},context:{}};var Agent=function(){function Agent(host,headers,cookies,options,transport,plugins){this.host=host;this.headers=headers;this.cookies=cookies;this.options=options;this.transport=transport;this.plugins=plugins}Agent.prototype.setTransport=function(transport,plugins){if(plugins===void 0){plugins=[]}var _a=this,host=_a.host,headers=_a.headers,cookies=_a.cookies,options=_a.options;return new Agent(host,headers,cookies,options,transport,plugins)};Agent.prototype.head=function(path,params,headers){if(params===void 0){params={}}if(headers===void 0){headers={}}return this.send(new request_1.Head(path,params,headers))};Agent.prototype.get=function(path,params,headers){if(params===void 0){params={}}if(headers===void 0){headers={}}return this.send(new request_1.Get(path,params,headers))};Agent.prototype.post=function(path,body,headers){if(headers===void 0){headers={}}return this.send(new request_1.Post(path,body,headers))};Agent.prototype.put=function(path,body,headers){if(headers===void 0){headers={}}return this.send(new request_1.Put(path,body,headers))};Agent.prototype.patch=function(path,body,headers){if(headers===void 0){headers={}}return this.send(new request_1.Patch(path,body,headers))};Agent.prototype.delete=function(path,body,headers){return this.send(new request_1.Delete(path,body,headers))};Agent.prototype.send=function(req){var _a=this,host=_a.host,cookies=_a.cookies,headers=_a.headers,transport=_a.transport,plugins=_a.plugins;var options=(0,record_1.rmerge3)(exports.defaultOptions,this.options,req.options);var port=options.port;var method=req.method,params=req.params,body=req.body;var tags=options.tags,context=options.context,ttl=options.ttl;var path=util.urlFromString((0,string_1.interpolate)(req.path,context),params);var ctx={host:host,port:port,method:method,path:path,body:body,headers:headers,cookies:cookies,options:{ttl:ttl,tags:tags,context:context}};var ft=plugins.reduce(function(f,p){return f.chain(function(c){return p.beforeRequest(c)})},(0,future_1.pure)(ctx));return ft.chain(function(ctx){return transport.send(ctx)}).chain(function(r){return plugins.reduce(function(f,p){return f.chain(function(res){return p.afterResponse(res)})},(0,future_1.pure)(r))})};return Agent}();exports.Agent=Agent},{"../request":34,"../util":38,"@quenk/noni/lib/control/monad/future":54,"@quenk/noni/lib/data/record":62,"@quenk/noni/lib/data/string":64}],25:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JSONParser=void 0;var record_1=require("@quenk/noni/lib/data/record");var error_1=require("@quenk/noni/lib/control/error");var either_1=require("@quenk/noni/lib/data/either");var defaultOptions={prefix:/^\)\]\}',?\n/,lenient:false};var JSONParser=function(){function JSONParser(options){if(options===void 0){options={}}this.options=options;this.responseType="";this.accepts="application/json";this.opts=(0,record_1.merge)(defaultOptions,this.options)}JSONParser.prototype.apply=function(body){var _a=this.opts,prefix=_a.prefix,lenient=_a.lenient;var str=body.replace(prefix,"");var eresult=(0,error_1.attempt)(function(){return JSON.parse(str)});return eresult.isLeft()&&lenient?(0,either_1.right)({}):eresult};return JSONParser}();exports.JSONParser=JSONParser},{"@quenk/noni/lib/control/error":53,"@quenk/noni/lib/data/either":59,"@quenk/noni/lib/data/record":62}],26:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.CSRFProtectionPlugin=exports.DEFAULT_CSRF_HEADER_NAME=exports.DEFAULT_CSRF_COOKIE_NAME=void 0;var future_1=require("@quenk/noni/lib/control/monad/future");var record_1=require("@quenk/noni/lib/data/record");exports.DEFAULT_CSRF_COOKIE_NAME="xsrf-token";exports.DEFAULT_CSRF_HEADER_NAME="x-xsrf-token";var CSRFProtectionPlugin=function(){function CSRFProtectionPlugin(cookie,header){if(cookie===void 0){cookie=exports.DEFAULT_CSRF_COOKIE_NAME}if(header===void 0){header=exports.DEFAULT_CSRF_HEADER_NAME}this.cookie=cookie;this.header=header}CSRFProtectionPlugin.prototype.beforeRequest=function(ctx){var _a;var mvalue=ctx.cookies.getCookie(this.cookie);if(mvalue.isJust())ctx.headers=(0,record_1.merge)(ctx.headers,(_a={},_a[this.header]=mvalue.get().value,_a));return(0,future_1.pure)(ctx)};CSRFProtectionPlugin.prototype.afterResponse=function(r){return(0,future_1.pure)(r)};return CSRFProtectionPlugin}();exports.CSRFProtectionPlugin=CSRFProtectionPlugin},{"@quenk/noni/lib/control/monad/future":54,"@quenk/noni/lib/data/record":62}],27:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JSONTransform=void 0;var util=require("../../util");var error_1=require("@quenk/noni/lib/control/error");var JSONTransform=function(){function JSONTransform(){this.type="application/json;charset=utf-8"}JSONTransform.prototype.apply=function(body){return(0,error_1.attempt)(function(){return util.isObject(body)&&!util.isFile(body)&&!util.isBlob(body)&&!util.isFormData(body)?JSON.stringify(body):""+body})};return JSONTransform}();exports.JSONTransform=JSONTransform},{"../../util":38,"@quenk/noni/lib/control/error":53}],28:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.XHRTransport=void 0;var future_1=require("@quenk/noni/lib/control/monad/future");var header_1=require("../../header");var response_1=require("../../response");var method_1=require("../../request/method");var headers_1=require("../../headers");var XHRTransport=function(){function XHRTransport(responseType,transform,parser){if(responseType===void 0){responseType=""}this.responseType=responseType;this.transform=transform;this.parser=parser}XHRTransport.prototype.send=function(ctx){var _this=this;var _a=this,parser=_a.parser,transform=_a.transform;var host=ctx.host,port=ctx.port,path=ctx.path,method=ctx.method,body=ctx.body,headers=ctx.headers,options=ctx.options,cookies=ctx.cookies;var xhr=new XMLHttpRequest;var portNumer=port&&port!==80&&port!==443?":"+port:"";var url=""+host+portNumer+(path[0]==="/"?"":"/")+path;return new future_1.Run(function(onError,onSuccess){var transBody=undefined;if(body!=null){var exceptBody=transform.apply(body);if(exceptBody.isLeft()){onError(new Error(exceptBody.takeLeft().message));return function(){}}else{transBody=exceptBody.takeRight()}}xhr.open(method,url,true);xhr.onload=function(){cookies.setCookies(document.cookie.split(";"));var exceptRes=parser.apply(xhr.response);if(exceptRes.isLeft()){onError(new Error(exceptRes.takeLeft().message))}else{var r=(0,response_1.createResponse)(xhr.status,exceptRes.takeRight(),(0,header_1.fromString)(xhr.getAllResponseHeaders()),options);onSuccess(r)}};xhr.timeout=options.ttl;xhr.responseType=_this.responseType;xhr.onerror=function(){return onError(new Error("TransportError"))};xhr.onabort=function(){return onError(new Error("AbortError"))};Object.keys(headers).forEach(function(k){xhr.setRequestHeader(k,headers[k])});if(method===method_1.Method.Get||method===method_1.Method.Head)xhr.setRequestHeader(headers_1.ACCEPTS,parser.accepts);else if(transform.type!=="multipart/form-data")xhr.setRequestHeader(headers_1.CONTENT_TYPE,transform.type);xhr.send(transBody);return function(){return xhr.abort()}})};return XHRTransport}();exports.XHRTransport=XHRTransport},{"../../header":32,"../../headers":33,"../../request/method":35,"../../response":36,"@quenk/noni/lib/control/monad/future":54}],29:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.get=exports.createAgent=exports.splitUrl=void 0;var document_1=require("./cookie/container/document");var json_1=require("./agent/transform/json");var json_2=require("./agent/parser/json");var xhr_1=require("./agent/transport/xhr");var request_1=require("./request");var csrf_1=require("./agent/plugin/csrf");var agent_1=require("./agent");var HTTP="http://";var HTTPS="https://";var splitUrl=function(url){var split=url.split(HTTP).join("").split(HTTPS).join("").split("/");if(split.length===1||split.length===2&&split[1]==="")return[split[0],"/"];return[split[0],"/"+split.slice(1).join("/")]};exports.splitUrl=splitUrl;var createAgent=function(host,port){if(host===void 0){host=getHost()}if(port===void 0){port=getPort()}return new agent_1.Agent(host,{},document_1.DocumentContainer.create(),{ttl:0,tags:{},context:{},port:port},new xhr_1.XHRTransport("",new json_1.JSONTransform,new json_2.JSONParser({lenient:true})),[new csrf_1.CSRFProtectionPlugin])};exports.createAgent=createAgent;var getHost=function(){return window.location.protocol+"//"+window.location.hostname};var getPort=function(){var port=window.location.port;return Number(port===""||port==null?80:port)};var get=function(url,params,headers){if(params===void 0){params={}}if(headers===void 0){headers={}}var _a=(0,exports.splitUrl)(url),host=_a[0],path=_a[1];return(0,exports.createAgent)(host).send(new request_1.Get(path,params,headers))};exports.get=get},{"./agent":24,"./agent/parser/json":25,"./agent/plugin/csrf":26,"./agent/transform/json":27,"./agent/transport/xhr":28,"./cookie/container/document":30,"./request":34}],30:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DocumentContainer=void 0;var record_1=require("@quenk/noni/lib/data/record");var __1=require("../");var DocumentContainer=function(){function DocumentContainer(store,cookies){if(store===void 0){store=document}if(cookies===void 0){cookies={}}this.store=store;this.cookies=cookies}DocumentContainer.create=function(store){if(store===void 0){store=document}return new DocumentContainer(store,(0,__1.fromCookieHeader)(store.cookie))};DocumentContainer.prototype.getCookies=function(){return(0,record_1.make)(this.cookies)};DocumentContainer.prototype.getCookie=function(name){return(0,__1.getCookieByName)(this.cookies,name)};DocumentContainer.prototype.setCookies=function(_){this.cookies=(0,__1.fromCookieHeader)(this.store.cookie);return this};return DocumentContainer}();exports.DocumentContainer=DocumentContainer},{"../":31,"@quenk/noni/lib/data/record":62}],31:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.toCookieHeader=exports.getCookieByName=exports.fromList=exports.fromCookieHeader=void 0;var record_1=require("@quenk/noni/lib/data/record");var fromCookieHeader=function(str){var rec=(0,record_1.make)();var cookies=str.split(";");var created=new Date;for(var i=0;i<cookies.length;i++){var cookie=cookies[i];var cookieLength=cookie.length;var delimIdx=cookie.indexOf("=");delimIdx=delimIdx<0?cookieLength:delimIdx;var name_1=decodeURIComponent(cookie.substring(0,delimIdx).replace(/^\s+|\s+$/g,""));var value=decodeURIComponent(cookie.substring(delimIdx+1,cookieLength));var c={name:name_1,value:value,created:created};rec[getPath(c)]=c}return rec};exports.fromCookieHeader=fromCookieHeader;var fromList=function(list){return list.reduce(function(p,c){var _a;return(0,record_1.merge)(p,(_a={},_a[getPath(c)]=c,_a))},{})};exports.fromList=fromList;var getPath=function(c){return[c.name,c.domain,c.path].join(";;")};var getCookieByName=function(store,name){return(0,record_1.pickValue)(store,function(c){return c.name===name})};exports.getCookieByName=getCookieByName;var toCookieHeader=function(store){return(0,record_1.mapTo)(store,function(c){return c.name+"="+c.value}).join("; ")};exports.toCookieHeader=toCookieHeader},{"@quenk/noni/lib/data/record":62}],32:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.set=exports.fromString=void 0;var fromString=function(headers){if(!headers)return{};var result={};headers.trim().split("\n").forEach(function(row){var index=row.indexOf(":");var key=row.slice(0,index).toLowerCase().trim();var value=row.slice(index+1).trim();if(typeof result[key]==="undefined"){result[key]=value}else if(Array.isArray(result[key])){result[key].push(value)}else{result[key]=[result[key],value]}});return result};exports.fromString=fromString;var set=function(xhr){var args=[];for(var _i=1;_i<arguments.length;_i++){args[_i-1]=arguments[_i]}var i=args.length;if(args.length>0)while(i--)if(i!==0)Object.keys(args[i]).forEach(function(k){if(args[i][k]!=null)xhr.setRequestHeader(k,args[i][k])})};exports.set=set},{}],33:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ACCEPTS=exports.CONTENT_TYPE=void 0;exports.CONTENT_TYPE="Content-Type";exports.ACCEPTS="Accept"},{}],34:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Delete=exports.Patch=exports.Put=exports.Post=exports.Get=exports.Head=void 0;var method_1=require("./method");var Head=function(){function Head(path,params,headers,options){if(headers===void 0){headers={}}if(options===void 0){options={ttl:0,tags:{},context:{}}}this.path=path;this.params=params;this.headers=headers;this.options=options;this.method=method_1.Method.Head}return Head}();exports.Head=Head;var Get=function(_super){__extends(Get,_super);function Get(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.method=method_1.Method.Get;return _this}return Get}(Head);exports.Get=Get;var Post=function(){function Post(path,body,headers,options){if(headers===void 0){headers={}}if(options===void 0){options={ttl:0,tags:{},context:{}}}this.path=path;this.body=body;this.headers=headers;this.options=options;this.method=method_1.Method.Post}return Post}();exports.Post=Post;var Put=function(_super){__extends(Put,_super);function Put(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.method=method_1.Method.Put;return _this}return Put}(Post);exports.Put=Put;var Patch=function(_super){__extends(Patch,_super);function Patch(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.method=method_1.Method.Patch;return _this}return Patch}(Post);exports.Patch=Patch;var Delete=function(_super){__extends(Delete,_super);function Delete(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.method=method_1.Method.Delete;return _this}return Delete}(Post);exports.Delete=Delete},{"./method":35}],35:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Method=void 0;var Method;(function(Method){Method["Head"]="HEAD";Method["Get"]="GET";Method["Put"]="PUT";Method["Post"]="POST";Method["Delete"]="DELETE";Method["Patch"]="PATCH"})(Method=exports.Method||(exports.Method={}))},{}],36:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.createResponse=exports.InternalServerError=exports.ServerError=exports.Conflict=exports.NotFound=exports.Forbidden=exports.Unauthorized=exports.BadRequest=exports.ClientError=exports.Created=exports.NoContent=exports.Accepted=exports.Ok=exports.Success=exports.GenericResponse=void 0;var status=require("./status");var GenericResponse=function(){function GenericResponse(code,body,headers,options){this.code=code;this.body=body;this.headers=headers;this.options=options}return GenericResponse}();exports.GenericResponse=GenericResponse;var Success=function(_super){__extends(Success,_super);function Success(){return _super!==null&&_super.apply(this,arguments)||this}return Success}(GenericResponse);exports.Success=Success;var Ok=function(_super){__extends(Ok,_super);function Ok(body,headers,options){var _this=_super.call(this,status.OK,body,headers,options)||this;_this.body=body;_this.headers=headers;_this.options=options;return _this}return Ok}(Success);exports.Ok=Ok;var Accepted=function(_super){__extends(Accepted,_super);function Accepted(body,headers,options){var _this=_super.call(this,status.ACCEPTED,body,headers,options)||this;_this.body=body;_this.headers=headers;_this.options=options;return _this}return Accepted}(Success);exports.Accepted=Accepted;var NoContent=function(_super){__extends(NoContent,_super);function NoContent(body,headers,options){var _this=_super.call(this,status.NO_CONTENT,body,headers,options)||this;_this.body=body;_this.headers=headers;_this.options=options;return _this}return NoContent}(Success);exports.NoContent=NoContent;var Created=function(_super){__extends(Created,_super);function Created(body,headers,options){var _this=_super.call(this,status.CREATED,body,headers,options)||this;_this.body=body;_this.headers=headers;_this.options=options;return _this}return Created}(Success);exports.Created=Created;var ClientError=function(_super){__extends(ClientError,_super);function ClientError(){return _super!==null&&_super.apply(this,arguments)||this}return ClientError}(GenericResponse);exports.ClientError=ClientError;var BadRequest=function(_super){__extends(BadRequest,_super);function BadRequest(body,headers,options){var _this=_super.call(this,status.BAD_REQUEST,body,headers,options)||this;_this.body=body;_this.headers=headers;_this.options=options;return _this}return BadRequest}(ClientError);exports.BadRequest=BadRequest;var Unauthorized=function(_super){__extends(Unauthorized,_super);function Unauthorized(body,headers,options){var _this=_super.call(this,status.UNAUTHORIZED,body,headers,options)||this;_this.body=body;_this.headers=headers;_this.options=options;return _this}return Unauthorized}(ClientError);exports.Unauthorized=Unauthorized;var Forbidden=function(_super){__extends(Forbidden,_super);function Forbidden(body,headers,options){var _this=_super.call(this,status.FORBIDDEN,body,headers,options)||this;_this.body=body;_this.headers=headers;_this.options=options;return _this}return Forbidden}(ClientError);exports.Forbidden=Forbidden;var NotFound=function(_super){__extends(NotFound,_super);function NotFound(body,headers,options){var _this=_super.call(this,status.NOT_FOUND,body,headers,options)||this;_this.body=body;_this.headers=headers;_this.options=options;return _this}return NotFound}(ClientError);exports.NotFound=NotFound;var Conflict=function(_super){__extends(Conflict,_super);function Conflict(body,headers,options){var _this=_super.call(this,status.CONFLICT,body,headers,options)||this;_this.body=body;_this.headers=headers;_this.options=options;return _this}return Conflict}(ClientError);exports.Conflict=Conflict;var ServerError=function(_super){__extends(ServerError,_super);function ServerError(){return _super!==null&&_super.apply(this,arguments)||this}return ServerError}(GenericResponse);exports.ServerError=ServerError;var InternalServerError=function(_super){__extends(InternalServerError,_super);function InternalServerError(body,headers,options){var _this=_super.call(this,status.INTERNAL_SERVER_ERROR,body,headers,options)||this;_this.body=body;_this.headers=headers;_this.options=options;_this.status=status.INTERNAL_SERVER_ERROR;return _this}return InternalServerError}(ServerError);exports.InternalServerError=InternalServerError;var createResponse=function(code,body,headers,options){switch(code){case status.OK:return new Ok(body,headers,options);case status.ACCEPTED:return new Accepted(body,headers,options);case status.NO_CONTENT:return new NoContent(body,headers,options);case status.CREATED:return new Created(body,headers,options);case status.BAD_REQUEST:return new BadRequest(body,headers,options);case status.BAD_REQUEST:return new BadRequest(body,headers,options);case status.UNAUTHORIZED:return new Unauthorized(body,headers,options);case status.FORBIDDEN:return new Forbidden(body,headers,options);case status.NOT_FOUND:return new NotFound(body,headers,options);case status.CONFLICT:return new Conflict(body,headers,options);case status.INTERNAL_SERVER_ERROR:return new InternalServerError(body,headers,options);default:if(code>=400&&code<=499)return new ClientError(code,body,headers,options);else if(code>=500)return new ServerError(code,body,headers,options);else return new GenericResponse(code,body,headers,options)}};exports.createResponse=createResponse},{"./status":37}],37:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.NOT_IMPLEMENTED=exports.INTERNAL_SERVER_ERROR=exports.UNAVAILABLE_FOR_LEGAL_RREASONS=exports.REQUEST_HEADER_FIELDS_TOO_LARGE=exports.TOO_MANY_REQUESTS=exports.PRECONDITION_REQUIRED=exports.UPGRADE_REQUIRED=exports.FAILED_DEPENDENCY=exports.LOCKED=exports.UNPROCESSABLE_ENTITY=exports.TEAPOT=exports.EXPECTATION_FAILED=exports.REQUESTED_RANGE_NOT_SATISFIABLE=exports.UNSUPPORTED_MEDIA_TYPE=exports.REQUEST_URI_TOO_LONG=exports.REQUEST_ENTITY_TOO_LARGE=exports.PRECONDITION_FAILED=exports.LENGTH_REQUIRED=exports.GONE=exports.CONFLICT=exports.REQUEST_TIMEOUT=exports.PROXY_AUTH_REQUIRED=exports.NOT_ACCEPTABLE=exports.METHOD_NOT_ALLOWED=exports.NOT_FOUND=exports.FORBIDDEN=exports.PAYMENT_REQUIRED=exports.UNAUTHORIZED=exports.BAD_REQUEST=exports.PERMANENT_REDIRECT=exports.TEMPORARY_REDIRECT=exports.USE_PROXY=exports.NOT_MODIFIED=exports.SEE_OTHER=exports.FOUND=exports.MOVED_PERMANENTLY=exports.MULTIPLE_CHOICES=exports.IM_USED=exports.ALREADY_REPORTED=exports.MULTI_STATUS=exports.PARTIAL_CONTENT=exports.RESET_CONTENT=exports.NO_CONTENT=exports.NON_AUTHORITATIV_INFO=exports.ACCEPTED=exports.CREATED=exports.OK=exports.PROCESSING=exports.SWITCHING_PROTOCOLS=exports.CONTINUE=void 0;exports.NETWORK_AUTHENTICATION_REQUIRED=exports.NOT_EXTENDED=exports.LOOP_DETECTED=exports.INSUFFICIENT_STORAGE=exports.VARIANT_ALSO_NEGOTIATES=exports.HTTP_VERSION_NOT_SUPPORTED=exports.GATEWAY_TIMEOUT=exports.SERVICE_UNAVAILABLE=exports.BAD_GATEWAY=void 0;exports.CONTINUE=100;exports.SWITCHING_PROTOCOLS=101;exports.PROCESSING=102;exports.OK=200;exports.CREATED=201;exports.ACCEPTED=202;exports.NON_AUTHORITATIV_INFO=203;exports.NO_CONTENT=204;exports.RESET_CONTENT=205;exports.PARTIAL_CONTENT=206;exports.MULTI_STATUS=207;exports.ALREADY_REPORTED=208;exports.IM_USED=226;exports.MULTIPLE_CHOICES=300;exports.MOVED_PERMANENTLY=301;exports.FOUND=302;exports.SEE_OTHER=303;exports.NOT_MODIFIED=304;exports.USE_PROXY=305;exports.TEMPORARY_REDIRECT=307;exports.PERMANENT_REDIRECT=308;exports.BAD_REQUEST=400;exports.UNAUTHORIZED=401;exports.PAYMENT_REQUIRED=402;exports.FORBIDDEN=403;exports.NOT_FOUND=404;exports.METHOD_NOT_ALLOWED=405;exports.NOT_ACCEPTABLE=406;exports.PROXY_AUTH_REQUIRED=407;exports.REQUEST_TIMEOUT=408;exports.CONFLICT=409;exports.GONE=410;exports.LENGTH_REQUIRED=411;exports.PRECONDITION_FAILED=412;exports.REQUEST_ENTITY_TOO_LARGE=413;exports.REQUEST_URI_TOO_LONG=414;exports.UNSUPPORTED_MEDIA_TYPE=415;exports.REQUESTED_RANGE_NOT_SATISFIABLE=416;exports.EXPECTATION_FAILED=417;exports.TEAPOT=418;exports.UNPROCESSABLE_ENTITY=422;exports.LOCKED=423;exports.FAILED_DEPENDENCY=424;exports.UPGRADE_REQUIRED=426;exports.PRECONDITION_REQUIRED=428;exports.TOO_MANY_REQUESTS=429;exports.REQUEST_HEADER_FIELDS_TOO_LARGE=431;exports.UNAVAILABLE_FOR_LEGAL_RREASONS=451;exports.INTERNAL_SERVER_ERROR=500;exports.NOT_IMPLEMENTED=501;exports.BAD_GATEWAY=502;exports.SERVICE_UNAVAILABLE=503;exports.GATEWAY_TIMEOUT=504;exports.HTTP_VERSION_NOT_SUPPORTED=505;exports.VARIANT_ALSO_NEGOTIATES=506;exports.INSUFFICIENT_STORAGE=507;exports.LOOP_DETECTED=508;exports.NOT_EXTENDED=510;exports.NETWORK_AUTHENTICATION_REQUIRED=511},{}],38:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.urlFromString=exports.isBlob=exports.isFormData=exports.isFile=exports.isObject=void 0;var qs_1=require("./qs");var isObject=function(obj){return typeof obj==="object"};exports.isObject=isObject;var isFile=function(obj){return toString.call(obj)==="[object File]"};exports.isFile=isFile;var isFormData=function(obj){return toString.call(obj)==="[object FormData]"};exports.isFormData=isFormData;var isBlob=function(obj){return toString.call(obj)==="[object Blob]"};exports.isBlob=isBlob;var urlFromString=function(url,params){if(params===void 0){params={}}return url+"?"+(0,qs_1.stringify)(params)};exports.urlFromString=urlFromString},{"./qs":39}],39:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.stringify=exports.formats=void 0;var record_1=require("@quenk/noni/lib/data/record");var percentTwenties=/%20/g;var Format={RFC1738:"RFC1738",RFC3986:"RFC3986"};exports.formats=(0,record_1.assign)({default:Format.RFC3986,formatters:{RFC1738:function(value){return replace.call(value,percentTwenties,"+")},RFC3986:String}},Format);var arrayPrefixGenerators={brackets:function(prefix){return prefix+"[]"},comma:"comma",indices:function(prefix,key){return prefix+"["+key+"]"},repeat:function(prefix){return prefix}};var has=Object.prototype.hasOwnProperty;var replace=String.prototype.replace;var isArray=Array.isArray;var push=Array.prototype.push;var pushToArray=function(arr,valueOrArray){push.apply(arr,isArray(valueOrArray)?valueOrArray:[valueOrArray])};var toISO=Date.prototype.toISOString;var defaultFormat=exports.formats["default"];var hexTable=function(){var array=[];for(var i=0;i<256;++i)array.push("%"+((i<16?"0":"")+i.toString(16)).toUpperCase());return array}();var utilsEncode=function(str,_,charset){if(str.length===0){return str}var string=str;if(typeof str==="symbol"){string=Symbol.prototype.toString.call(str)}else if(typeof str!=="string"){string=String(str)}if(charset==="iso-8859-1"){return escape(string).replace(/%u[0-9a-f]{4}/gi,function($0){return"%26%23"+parseInt($0.slice(2),16)+"%3B"})}var out="";for(var i=0;i<string.length;++i){var c=string.charCodeAt(i);if(c===45||c===46||c===95||c===126||c>=48&&c<=57||c>=65&&c<=90||c>=97&&c<=122){out+=string.charAt(i);continue}if(c<128){out=out+hexTable[c];continue}if(c<2048){out=out+(hexTable[192|c>>6]+hexTable[128|c&63]);continue}if(c<55296||c>=57344){out=out+(hexTable[224|c>>12]+hexTable[128|c>>6&63]+hexTable[128|c&63]);continue}i+=1;c=65536+((c&1023)<<10|string.charCodeAt(i)&1023);out+=hexTable[240|c>>18]+hexTable[128|c>>12&63]+hexTable[128|c>>6&63]+hexTable[128|c&63]}return out};var utilsMaybeMap=function(val,fn){if(isArray(val)){var mapped=[];for(var i=0;i<val.length;i+=1){mapped.push(fn(val[i]))}return mapped}return fn(val)};var utilsIsBuffer=function(obj){if(!obj||typeof obj!=="object"){return false}return!!(obj.constructor&&obj.constructor.isBuffer&&obj.constructor.isBuffer(obj))};var isNonNullishPrimitive=function(v){return typeof v==="string"||typeof v==="number"||typeof v==="boolean"||typeof v==="symbol"||typeof v==="bigint"};var defaults={addQueryPrefix:false,allowDots:false,charset:"utf-8",charsetSentinel:false,delimiter:"&",encode:true,encoder:utilsEncode,encodeValuesOnly:false,format:defaultFormat,formatter:exports.formats.formatters[defaultFormat],indices:false,serializeDate:function(date){return toISO.call(date)},skipNulls:false,strictNullHandling:false};function doStringify(target,prefix,generateArrayPrefix,strictNullHandling,skipNulls,encoder,filter,sort,allowDots,serializeDate,formatter,encodeValuesOnly,charset){var obj=target;if(typeof filter==="function"){obj=filter(prefix,obj)}else if(obj instanceof Date){obj=serializeDate(obj)}else if(generateArrayPrefix==="comma"&&isArray(obj)){obj=utilsMaybeMap(obj,function(value){if(value instanceof Date){return new String(serializeDate(value))}return value})}if(obj===null){if(strictNullHandling){return encoder&&!encodeValuesOnly?encoder(prefix,defaults.encoder,charset,"key"):prefix}obj=""}if(isNonNullishPrimitive(obj)||utilsIsBuffer(obj)){if(encoder){var keyValue=encodeValuesOnly?prefix:encoder(prefix,defaults.encoder,charset,"key");return[formatter(keyValue)+"="+formatter(encoder(obj,defaults.encoder,charset,"value"))]}return[formatter(prefix)+"="+formatter(String(obj))]}var values=[];if(typeof obj==="undefined"){return values}var objKeys;if(generateArrayPrefix==="comma"&&isArray(obj)){objKeys=[{value:obj.length>0?obj.join(",")||null:undefined}]}else if(isArray(filter)){objKeys=filter}else{var keys=Object.keys(obj);objKeys=sort?keys.sort(sort):keys}for(var i=0;i<objKeys.length;++i){var key=objKeys[i];var value=typeof key==="object"&&key.value!==undefined?key.value:obj[key];if(skipNulls&&value===null){continue}var keyPrefix=isArray(obj)?typeof generateArrayPrefix==="function"?generateArrayPrefix(prefix,key):prefix:prefix+(allowDots?"."+key:"["+key+"]");pushToArray(values,doStringify(value,keyPrefix,generateArrayPrefix,strictNullHandling,skipNulls,encoder,filter,sort,allowDots,serializeDate,formatter,encodeValuesOnly,charset))}return values}var normalizeStringifyOptions=function(opts){if(!opts){return defaults}if(opts.encoder!==null&&opts.encoder!==undefined&&typeof opts.encoder!=="function"){throw new TypeError("Encoder has to be a function.")}var charset=opts.charset||defaults.charset;if(typeof opts.charset!=="undefined"&&opts.charset!=="utf-8"&&opts.charset!=="iso-8859-1"){throw new TypeError("The charset option must be either utf-8,"+" iso-8859-1, or undefined")}var format=exports.formats["default"];if(typeof opts.format!=="undefined"){if(!has.call(exports.formats.formatters,opts.format)){throw new TypeError("Unknown format option provided.")}format=opts.format}var formatter=exports.formats.formatters[format];var filter;if(typeof opts.filter==="function"||isArray(opts.filter)){filter=opts.filter}return{addQueryPrefix:typeof opts.addQueryPrefix==="boolean"?opts.addQueryPrefix:defaults.addQueryPrefix,allowDots:typeof opts.allowDots==="undefined"?defaults.allowDots:!!opts.allowDots,charset:charset,charsetSentinel:typeof opts.charsetSentinel==="boolean"?opts.charsetSentinel:defaults.charsetSentinel,delimiter:typeof opts.delimiter==="undefined"?defaults.delimiter:opts.delimiter,encode:typeof opts.encode==="boolean"?opts.encode:defaults.encode,encoder:typeof opts.encoder==="function"?opts.encoder:defaults.encoder,encodeValuesOnly:typeof opts.encodeValuesOnly==="boolean"?opts.encodeValuesOnly:defaults.encodeValuesOnly,filter:filter,formatter:formatter,serializeDate:typeof opts.serializeDate==="function"?opts.serializeDate:defaults.serializeDate,skipNulls:typeof opts.skipNulls==="boolean"?opts.skipNulls:defaults.skipNulls,sort:typeof opts.sort==="function"?opts.sort:undefined,strictNullHandling:typeof opts.strictNullHandling==="boolean"?opts.strictNullHandling:defaults.strictNullHandling}};function stringify(target,opts){if(opts===void 0){opts={}}var obj=target;var options=normalizeStringifyOptions(opts);var objKeys;var filter;if(typeof options.filter==="function"){filter=options.filter;obj=filter("",obj)}else if(isArray(options.filter)){filter=options.filter;objKeys=filter}var keys=[];if(typeof obj!=="object"||obj===null){return""}var arrayFormat;if(opts&&opts.arrayFormat&&opts.arrayFormat in arrayPrefixGenerators){arrayFormat=opts.arrayFormat}else if(opts&&"indices"in opts){arrayFormat=opts.indices?"indices":"repeat"}else{arrayFormat="indices"}var generateArrayPrefix=arrayPrefixGenerators[arrayFormat];if(!objKeys){objKeys=Object.keys(obj)}if(options.sort){objKeys.sort(options.sort)}for(var i=0;i<objKeys.length;++i){var key=objKeys[i];if(options.skipNulls&&obj[key]===null){continue}pushToArray(keys,doStringify(obj[key],key,generateArrayPrefix,options.strictNullHandling,options.skipNulls,options.encode?options.encoder:undefined,options.filter,options.sort,options.allowDots,options.serializeDate,options.formatter,options.encodeValuesOnly,options.charset))}var joined=keys.join(options.delimiter);var prefix=options.addQueryPrefix===true?"?":"";if(options.charsetSentinel){if(options.charset==="iso-8859-1"){prefix+="utf8=%26%2310003%3B&"}else{prefix+="utf8=%E2%9C%93&"}}return joined.length>0?prefix+joined:""}exports.stringify=stringify},{"@quenk/noni/lib/data/record":62}],40:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Proxy=exports.Immutable=exports.Mutable=void 0;var resident_1=require("@quenk/potoo/lib/actor/resident");Object.defineProperty(exports,"Mutable",{enumerable:true,get:function(){return resident_1.Mutable}});Object.defineProperty(exports,"Immutable",{enumerable:true,get:function(){return resident_1.Immutable}});var Proxy=function(){function Proxy(instance){this.instance=instance}Proxy.prototype.self=function(){return this.instance.self()};Proxy.prototype.spawn=function(t){return this.instance.spawn(t)};Proxy.prototype.spawnGroup=function(name,tmpls){return this.instance.spawnGroup(name,tmpls)};Proxy.prototype.tell=function(actor,m){this.instance.tell(actor,m);return this};Proxy.prototype.select=function(c){this.instance.select(c);return this};Proxy.prototype.raise=function(e){this.instance.raise(e);return this};Proxy.prototype.kill=function(addr){this.instance.kill(addr);return this};Proxy.prototype.exit=function(){this.exit()};return Proxy}();exports.Proxy=Proxy},{"@quenk/potoo/lib/actor/resident":71}],41:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.Director=exports.ActorSuspended=exports.RouteChanged=exports.Supervisor=exports.SuspendActor=exports.SuspendTimer=exports.CancelTimer=exports.Suspended=exports.Suspend=exports.Reload=exports.Resume=exports.DEFAULT_TIMEOUT=void 0;var record_1=require("@quenk/noni/lib/data/record");var type_1=require("@quenk/noni/lib/data/type");var future_1=require("@quenk/noni/lib/control/monad/future");var case_1=require("@quenk/potoo/lib/actor/resident/case");var actor_1=require("../actor");exports.DEFAULT_TIMEOUT=1e3;var Resume=function(){function Resume(director,request){this.director=director;this.request=request}return Resume}();exports.Resume=Resume;var Reload=function(){function Reload(target){this.target=target}return Reload}();exports.Reload=Reload;var Suspend=function(){function Suspend(director){this.director=director}return Suspend}();exports.Suspend=Suspend;var Suspended=function(){function Suspended(actor){this.actor=actor}return Suspended}();exports.Suspended=Suspended;var CancelTimer=function(){function CancelTimer(){}return CancelTimer}();exports.CancelTimer=CancelTimer;var SuspendTimer=function(_super){__extends(SuspendTimer,_super);function SuspendTimer(director,timeout,system,onExpire,onFinish){var _this=_super.call(this,system)||this;_this.director=director;_this.timeout=timeout;_this.system=system;_this.onExpire=onExpire;_this.onFinish=onFinish;_this.timer=-1;_this.onCancelTimer=function(_){clearTimeout(_this.timer);_this.onFinish();_this.exit()};_this.receive=[new case_1.Case(CancelTimer,_this.onCancelTimer)];return _this}SuspendTimer.prototype.run=function(){var _this=this;this.timer=setTimeout(function(){_this.onExpire();_this.exit()},this.timeout)};return SuspendTimer}(actor_1.Immutable);exports.SuspendTimer=SuspendTimer;var SuspendActor=function(){function SuspendActor(){}return SuspendActor}();exports.SuspendActor=SuspendActor;var Supervisor=function(_super){__extends(Supervisor,_super);function Supervisor(director,display,info,system){var _this=_super.call(this,system)||this;_this.director=director;_this.display=display;_this.info=info;_this.system=system;_this.actor="?";_this.receive=[new case_1.Case(SuspendActor,function(){_this.tell(_this.actor,new Suspend(_this.self()))}),new case_1.Case(Reload,function(){_this.tell(_this.director,_this.info)}),new case_1.Case(Suspended,function(){_this.tell(_this.director,new ActorSuspended)}),new case_1.Default(function(m){_this.tell(_this.display,m)})];return _this}Supervisor.prototype.run=function(){var _a=this.info,request=_a.request,spec=_a.spec;var r=new Resume(this.self(),request);var candidate=type_1.isFunction(spec)?spec(r):spec;if(type_1.isObject(candidate)){var tmpl=candidate;var args=tmpl.args?tmpl.args:[];tmpl=record_1.merge(tmpl,{args:__spreadArrays([r],args)});this.actor=this.spawn(tmpl)}else{this.actor=candidate}this.tell(this.actor,r)};return Supervisor}(actor_1.Immutable);exports.Supervisor=Supervisor;var RouteChanged=function(){function RouteChanged(route,spec,request){this.route=route;this.spec=spec;this.request=request}return RouteChanged}();exports.RouteChanged=RouteChanged;var ActorSuspended=function(){function ActorSuspended(){}return ActorSuspended}();exports.ActorSuspended=ActorSuspended;var Director=function(_super){__extends(Director,_super);function Director(display,router,conf,routes,system){var _this=_super.call(this,system)||this;_this.display=display;_this.router=router;_this.conf=conf;_this.routes=routes;_this.system=system;_this.current=["","?","?"];_this.config=defaultConfig(_this.conf);_this.onRouteChanged=function(msg){var self=_this.self();var _a=_this,display=_a.display,routes=_a.routes,current=_a.current,config=_a.config;var route=current[0],supervisor=current[1];var onFinish=function(){if(supervisor!="?")_this.kill(supervisor);_this.current=[msg.route,_this.spawn(function(s){return new Supervisor(self,display,msg,s)}),"?"]};if(supervisor!="?"){var timeout_1=config.timeout;var onExpire_1=function(){_this.routes=record_1.exclude(routes,route);onFinish()};_this.current=[route,supervisor,_this.spawn(function(s){return new SuspendTimer(self,timeout_1,s,onExpire_1,onFinish)})];_this.tell(supervisor,new SuspendActor)}else{onFinish()}};_this.onActorSuspended=function(_){_this.tell(_this.current[2],new CancelTimer)};_this.receive=[new case_1.Case(RouteChanged,_this.onRouteChanged),new case_1.Case(ActorSuspended,_this.onActorSuspended)];return _this}Director.prototype.run=function(){var _this=this;record_1.forEach(this.routes,function(spec,route){_this.router.add(route,function(r){return future_1.fromCallback(function(cb){if(!_this.routes.hasOwnProperty(route)){return cb(new Error(route+": not responding!"))}else{_this.tell(_this.self(),new RouteChanged(route,spec,r));cb(null)}})})})};return Director}(actor_1.Immutable);exports.Director=Director;var defaultConfig=function(c){return record_1.merge({timeout:exports.DEFAULT_TIMEOUT},c)}},{"../actor":40,"@quenk/noni/lib/control/monad/future":54,"@quenk/noni/lib/data/record":62,"@quenk/noni/lib/data/type":65,"@quenk/potoo/lib/actor/resident/case":70}],42:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.FormSaved=exports.FormAborted=exports.SaveFailed=exports.SaveOk=exports.Save=exports.Abort=void 0;var Abort=function(){function Abort(){}return Abort}();exports.Abort=Abort;var Save=function(){function Save(){}return Save}();exports.Save=Save;var SaveOk=function(){function SaveOk(){}return SaveOk}();exports.SaveOk=SaveOk;var SaveFailed=function(){function SaveFailed(errors){if(errors===void 0){errors={}}this.errors=errors}return SaveFailed}();exports.SaveFailed=SaveFailed;var FormAborted=function(){function FormAborted(form){this.form=form}return FormAborted}();exports.FormAborted=FormAborted;var FormSaved=function(){function FormSaved(form){this.form=form}return FormSaved}();exports.FormSaved=FormSaved},{}],43:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.JApp=void 0;var vm_1=require("@quenk/potoo/lib/actor/system/vm");var JApp=function(){function JApp(conf){if(conf===void 0){conf={}}this.conf=conf;this.vm=vm_1.PVM.create(this,this.conf)}JApp.prototype.exec=function(i,s){return this.vm.exec(i,s)};JApp.prototype.execNow=function(i,s){return this.vm.execNow(i,s)};JApp.prototype.tell=function(addr,msg){this.vm.tell(addr,msg);return this};JApp.prototype.spawn=function(t){return this.vm.spawn(t)};return JApp}();exports.JApp=JApp},{"@quenk/potoo/lib/actor/system/vm":75}],44:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.SeqSendCallback=exports.ParSendCallback=exports.SendCallback=exports.CompositeBatchCompleteHandler=exports.CompositeCompleteHandler=exports.AbstractBatchCompleteHandler=exports.AbstractCompleteHandler=exports.SeqSend=exports.ParSend=exports.Send=void 0;var type_1=require("@quenk/noni/lib/data/type");var case_1=require("@quenk/potoo/lib/actor/resident/case");var resident_1=require("@quenk/potoo/lib/actor/resident");var _1=require("./");Object.defineProperty(exports,"Send",{enumerable:true,get:function(){return _1.Send}});Object.defineProperty(exports,"ParSend",{enumerable:true,get:function(){return _1.ParSend}});Object.defineProperty(exports,"SeqSend",{enumerable:true,get:function(){return _1.SeqSend}});var typeMatch={code:Number,options:Object,body:type_1.Any,headers:Object};var AbstractCompleteHandler=function(){function AbstractCompleteHandler(){}AbstractCompleteHandler.prototype.onError=function(_){};AbstractCompleteHandler.prototype.onClientError=function(_){};AbstractCompleteHandler.prototype.onServerError=function(_){};AbstractCompleteHandler.prototype.onComplete=function(_){};return AbstractCompleteHandler}();exports.AbstractCompleteHandler=AbstractCompleteHandler;var AbstractBatchCompleteHandler=function(_super){__extends(AbstractBatchCompleteHandler,_super);function AbstractBatchCompleteHandler(){return _super!==null&&_super.apply(this,arguments)||this}AbstractBatchCompleteHandler.prototype.onBatchComplete=function(_){};return AbstractBatchCompleteHandler}(AbstractCompleteHandler);exports.AbstractBatchCompleteHandler=AbstractBatchCompleteHandler;var CompositeCompleteHandler=function(){function CompositeCompleteHandler(handlers){this.handlers=handlers}CompositeCompleteHandler.prototype.onError=function(e){this.handlers.forEach(function(h){return h.onError(e)})};CompositeCompleteHandler.prototype.onClientError=function(r){this.handlers.forEach(function(h){return h.onClientError(r)})};CompositeCompleteHandler.prototype.onServerError=function(r){this.handlers.forEach(function(h){return h.onServerError(r)})};CompositeCompleteHandler.prototype.onComplete=function(r){this.handlers.forEach(function(h){return h.onComplete(r)})};return CompositeCompleteHandler}();exports.CompositeCompleteHandler=CompositeCompleteHandler;var CompositeBatchCompleteHandler=function(){function CompositeBatchCompleteHandler(handlers){this.handlers=handlers}CompositeBatchCompleteHandler.prototype.onError=function(e){this.handlers.forEach(function(h){return h.onError(e)})};CompositeBatchCompleteHandler.prototype.onClientError=function(r){this.handlers.forEach(function(h){return h.onClientError(r)})};CompositeBatchCompleteHandler.prototype.onServerError=function(r){this.handlers.forEach(function(h){return h.onServerError(r)})};CompositeBatchCompleteHandler.prototype.onBatchComplete=function(r){this.handlers.forEach(function(h){return h.onBatchComplete(r)})};return CompositeBatchCompleteHandler}();exports.CompositeBatchCompleteHandler=CompositeBatchCompleteHandler;var SendCallback=function(_super){__extends(SendCallback,_super);function SendCallback(system,remote,request,handler){var _this=_super.call(this,system)||this;_this.system=system;_this.remote=remote;_this.request=request;_this.handler=handler;_this.receive=[new case_1.Case(_1.TransportErr,function(e){_this.handler.onError(e)}),new case_1.Case(typeMatch,function(r){if(r.code>499){_this.handler.onServerError(r)}else if(r.code>399){_this.handler.onClientError(r)}else{_this.handler.onComplete(r)}})];return _this}SendCallback.prototype.run=function(){this.tell(this.remote,new _1.Send(this.self(),this.request))};return SendCallback}(resident_1.Temp);exports.SendCallback=SendCallback;var ParSendCallback=function(_super){__extends(ParSendCallback,_super);function ParSendCallback(system,remote,requests,handler){var _this=_super.call(this,system)||this;_this.system=system;_this.remote=remote;_this.requests=requests;_this.handler=handler;_this.receive=[new case_1.Case(_1.TransportErr,function(e){_this.handler.onError(e)}),new case_1.Case(_1.BatchResponse,function(r){var failed=r.value.filter(function(r){return r.code>299});if(failed.length>0){var res=failed[0];if(res.code>499){_this.handler.onServerError(res)}else{_this.handler.onClientError(res)}}else{_this.handler.onBatchComplete(r)}})];return _this}ParSendCallback.prototype.run=function(){this.tell(this.remote,new _1.ParSend(this.self(),this.requests))};return ParSendCallback}(resident_1.Temp);exports.ParSendCallback=ParSendCallback;var SeqSendCallback=function(_super){__extends(SeqSendCallback,_super);function SeqSendCallback(){return _super!==null&&_super.apply(this,arguments)||this}SeqSendCallback.prototype.run=function(){this.tell(this.remote,new _1.SeqSend(this.self(),this.requests))};return SeqSendCallback}(ParSendCallback);exports.SeqSendCallback=SeqSendCallback},{"./":45,"@quenk/noni/lib/data/type":65,"@quenk/potoo/lib/actor/resident":71,"@quenk/potoo/lib/actor/resident/case":70}],45:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Remote=exports.BatchResponse=exports.TransportErr=exports.ParSend=exports.SeqSend=exports.Send=void 0;var future_1=require("@quenk/noni/lib/control/monad/future");var case_1=require("@quenk/potoo/lib/actor/resident/case");var actor_1=require("../../actor");var Send=function(){function Send(client,request){this.client=client;this.request=request}return Send}();exports.Send=Send;var SeqSend=function(){function SeqSend(client,requests){this.client=client;this.requests=requests}return SeqSend}();exports.SeqSend=SeqSend;var ParSend=function(){function ParSend(client,requests){this.client=client;this.requests=requests}return ParSend}();exports.ParSend=ParSend;var TransportErr=function(){function TransportErr(client,error){this.client=client;this.error=error}Object.defineProperty(TransportErr.prototype,"message",{get:function(){return this.error.message},enumerable:false,configurable:true});return TransportErr}();exports.TransportErr=TransportErr;var BatchResponse=function(){function BatchResponse(value){this.value=value}return BatchResponse}();exports.BatchResponse=BatchResponse;var Remote=function(_super){__extends(Remote,_super);function Remote(agent,system){var _this=_super.call(this,system)||this;_this.agent=agent;_this.system=system;_this.onUnit=function(_a){var client=_a.client,request=_a.request;var onErr=function(e){return _this.tell(client,new TransportErr(client,e))};var onSucc=function(res){return _this.tell(client,res)};_this.agent.send(request).fork(onErr,onSucc)};_this.onParallel=function(_a){var client=_a.client,requests=_a.requests;var agent=_this.agent;var onErr=function(e){return _this.tell(client,e)};var onSucc=function(res){return _this.tell(client,new BatchResponse(res))};var rs=requests.map(function(r){return agent.send(r).catch(function(e){return future_1.raise(new TransportErr(client,e))})});future_1.parallel(rs).fork(onErr,onSucc)};_this.onSequential=function(_a){var client=_a.client,requests=_a.requests;var agent=_this.agent;var onErr=function(e){return _this.tell(client,e)};var onSucc=function(res){return _this.tell(client,new BatchResponse(res))};var rs=requests.map(function(r){return agent.send(r).catch(function(e){return future_1.raise(new TransportErr(client,e))})});future_1.sequential(rs).fork(onErr,onSucc)};_this.receive=[new case_1.Case(Send,_this.onUnit),new case_1.Case(ParSend,_this.onParallel),new case_1.Case(SeqSend,_this.onSequential)];return _this}Remote.prototype.run=function(){};return Remote}(actor_1.Immutable);exports.Remote=Remote},{"../../actor":40,"@quenk/noni/lib/control/monad/future":54,"@quenk/potoo/lib/actor/resident/case":70}],46:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RemoteModelFactory=void 0;var type_1=require("@quenk/noni/lib/data/type");var callback_1=require("../callback");var _1=require("./");var RemoteModelFactory=function(){function RemoteModelFactory(spawn,remote){this.spawn=spawn;this.remote=remote}RemoteModelFactory.getInstance=function(spawn,remote){return new RemoteModelFactory(type_1.isObject(spawn)?spawn.spawn.bind(spawn):spawn,remote)};RemoteModelFactory.prototype.create=function(path,handlers){return new _1.RemoteModel(this.remote,path,this.spawn,Array.isArray(handlers)?new callback_1.CompositeCompleteHandler(handlers):handlers)};return RemoteModelFactory}();exports.RemoteModelFactory=RemoteModelFactory},{"../callback":44,"./":47,"@quenk/noni/lib/data/type":65}],47:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.RemoteModel=exports.NotFoundHandler=exports.FutureHandler=void 0;var future_1=require("@quenk/noni/lib/control/monad/future");var maybe_1=require("@quenk/noni/lib/data/maybe");var string_1=require("@quenk/noni/lib/data/string");var request_1=require("@quenk/jhr/lib/request");var callback_1=require("../callback");var DefaultCompleteHandler=function(_super){__extends(DefaultCompleteHandler,_super);function DefaultCompleteHandler(){return _super!==null&&_super.apply(this,arguments)||this}return DefaultCompleteHandler}(callback_1.AbstractCompleteHandler);var FutureHandler=function(){function FutureHandler(handler,onFailure,onSuccess){this.handler=handler;this.onFailure=onFailure;this.onSuccess=onSuccess}FutureHandler.prototype.onError=function(e){this.handler.onError(e);this.onFailure(e.error instanceof Error?e.error:new Error(e.error.message))};FutureHandler.prototype.onClientError=function(r){this.handler.onClientError(r);var e=new Error("ClientError");e.code=r.code;this.onFailure(e)};FutureHandler.prototype.onServerError=function(r){this.handler.onServerError(r);var e=new Error("ServerError");e.code=r.code;this.onFailure(e)};FutureHandler.prototype.onComplete=function(r){this.handler.onComplete(r);this.onSuccess(r)};return FutureHandler}();exports.FutureHandler=FutureHandler;var NotFoundHandler=function(_super){__extends(NotFoundHandler,_super);function NotFoundHandler(handler,onFailure,onNotFound,onSuccess){var _this=_super.call(this,handler,onFailure,onSuccess)||this;_this.handler=handler;_this.onFailure=onFailure;_this.onNotFound=onNotFound;_this.onSuccess=onSuccess;return _this}NotFoundHandler.prototype.onClientError=function(r){if(r.code===404)this.onNotFound();else _super.prototype.onClientError.call(this,r)};return NotFoundHandler}(FutureHandler);exports.NotFoundHandler=NotFoundHandler;var RemoteModel=function(){function RemoteModel(remote,path,spawn,handler){if(handler===void 0){handler=new DefaultCompleteHandler}this.remote=remote;this.path=path;this.spawn=spawn;this.handler=handler}RemoteModel.prototype.create=function(data){var _this=this;return future_1.fromCallback(function(cb){_this.spawn(function(s){return new callback_1.SendCallback(s,_this.remote,new request_1.Post(_this.path,data),new FutureHandler(_this.handler,cb,function(r){cb(null,r.body.data.id)}))})})};RemoteModel.prototype.search=function(qry){var _this=this;return future_1.fromCallback(function(cb){_this.spawn(function(s){return new callback_1.SendCallback(s,_this.remote,new request_1.Get(_this.path,qry),new FutureHandler(_this.handler,cb,function(r){cb(null,r.code===204?[]:r.body.data)}))})})};RemoteModel.prototype.update=function(id,changes){var _this=this;return future_1.fromCallback(function(cb){_this.spawn(function(s){return new callback_1.SendCallback(s,_this.remote,new request_1.Patch(string_1.interpolate(_this.path,{id:id}),changes),new FutureHandler(_this.handler,cb,function(r){cb(null,r.code===200?true:false)}))})})};RemoteModel.prototype.get=function(id){var _this=this;return future_1.fromCallback(function(cb){_this.spawn(function(s){return new callback_1.SendCallback(s,_this.remote,new request_1.Get(string_1.interpolate(_this.path,{id:id}),{}),new NotFoundHandler(_this.handler,cb,function(){cb(null,maybe_1.nothing())},function(r){cb(null,maybe_1.fromNullable(r.body.data))}))})})};RemoteModel.prototype.remove=function(id){var _this=this;return future_1.fromCallback(function(cb){_this.spawn(function(s){return new callback_1.SendCallback(s,_this.remote,new request_1.Delete(string_1.interpolate(_this.path,{id:id}),{}),new FutureHandler(_this.handler,cb,function(r){cb(null,r.code===200?true:false)}))})})};return RemoteModel}();exports.RemoteModel=RemoteModel},{"../callback":44,"@quenk/jhr/lib/request":34,"@quenk/noni/lib/control/monad/future":54,"@quenk/noni/lib/data/maybe":61,"@quenk/noni/lib/data/string":64}],48:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.FormSavedCase=exports.FormAbortedCase=exports.FormSaved=exports.FormAborted=void 0;var case_1=require("@quenk/potoo/lib/actor/resident/case");var form_1=require("../../form");Object.defineProperty(exports,"FormAborted",{enumerable:true,get:function(){return form_1.FormAborted}});Object.defineProperty(exports,"FormSaved",{enumerable:true,get:function(){return form_1.FormSaved}});var FormAbortedCase=function(_super){__extends(FormAbortedCase,_super);function FormAbortedCase(listener){var _this=_super.call(this,form_1.FormAborted,function(m){listener.afterFormAborted(m)})||this;_this.listener=listener;return _this}return FormAbortedCase}(case_1.Case);exports.FormAbortedCase=FormAbortedCase;var FormSavedCase=function(_super){__extends(FormSavedCase,_super);function FormSavedCase(listener){var _this=_super.call(this,form_1.FormSaved,function(m){listener.afterFormSaved(m)})||this;_this.listener=listener;return _this}return FormSavedCase}(case_1.Case);exports.FormSavedCase=FormSavedCase},{"../../form":42,"@quenk/potoo/lib/actor/resident/case":70}],49:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.AppScene=exports.SuspendCase=void 0;var case_1=require("@quenk/potoo/lib/actor/resident/case");var actor_1=require("../../actor");var director_1=require("../director");var SuspendCase=function(_super){__extends(SuspendCase,_super);function SuspendCase(listener){var _this=_super.call(this,director_1.Suspend,function(s){listener.beforeSuspended(s).tell(listener.resume.director,new director_1.Suspended(listener.self()))})||this;_this.listener=listener;return _this}return SuspendCase}(case_1.Case);exports.SuspendCase=SuspendCase;var AppScene=function(_super){__extends(AppScene,_super);function AppScene(resume,system){var _this=_super.call(this,system)||this;_this.resume=resume;_this.system=system;_this.receive=[new SuspendCase(_this)];return _this}AppScene.prototype.beforeSuspended=function(_){return this};return AppScene}(actor_1.Immutable);exports.AppScene=AppScene},{"../../actor":40,"../director":41,"@quenk/potoo/lib/actor/resident/case":70}],50:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.ConfirmDialog=exports.DialogConfirmed=void 0;var view_1=require("../view");var _1=require("./");var DialogConfirmed=function(_super){__extends(DialogConfirmed,_super);function DialogConfirmed(){return _super!==null&&_super.apply(this,arguments)||this}return DialogConfirmed}(_1.DialogEvent);exports.DialogConfirmed=DialogConfirmed;var ConfirmDialog=function(_super){__extends(ConfirmDialog,_super);function ConfirmDialog(system,display,target){if(target===void 0){target="?"}var _this=_super.call(this,system,display,target)||this;_this.system=system;_this.display=display;_this.target=target;return _this}ConfirmDialog.prototype.confirm=function(){this.tell(this.display,new view_1.Close(this.name));this.fire(new DialogConfirmed(this.name));this.exit()};return ConfirmDialog}(_1.Dialog);exports.ConfirmDialog=ConfirmDialog},{"../view":52,"./":51}],51:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Dialog=exports.DialogClosed=exports.DialogEvent=void 0;var type_1=require("@quenk/noni/lib/data/type");var actor_1=require("../../../actor");var view_1=require("../view");var DialogEvent=function(){function DialogEvent(name){this.name=name}return DialogEvent}();exports.DialogEvent=DialogEvent;var DialogClosed=function(_super){__extends(DialogClosed,_super);function DialogClosed(){return _super!==null&&_super.apply(this,arguments)||this}return DialogClosed}(DialogEvent);exports.DialogClosed=DialogClosed;var Dialog=function(_super){__extends(Dialog,_super);function Dialog(system,display,target){if(target===void 0){target="?"}var _this=_super.call(this,system)||this;_this.system=system;_this.display=display;_this.target=target;_this.receive=[];return _this}Dialog.prototype.fire=function(e){if(type_1.isString(this.target)){this.tell(this.target,e)}else if(type_1.isFunction(this.target)){this.target(e)}else if(type_1.isObject(this.target)){this.target.onClose(e)}};Dialog.prototype.close=function(){this.tell(this.display,new view_1.Close(this.name));this.fire(new DialogClosed(this.name));this.exit()};Dialog.prototype.run=function(){this.tell(this.display,new view_1.Show(this.name,this.view,this.self()))};return Dialog}(actor_1.Immutable);exports.Dialog=Dialog},{"../../../actor":40,"../view":52,"@quenk/noni/lib/data/type":65}],52:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.ViewService=exports.ViewRemoved=exports.ViewStackEmpty=exports.ViewShown=exports.Close=exports.Pop=exports.Push=exports.Show=exports.HTMLElementViewDelegate=void 0;var array_1=require("@quenk/noni/lib/data/array");var resident_1=require("@quenk/potoo/lib/actor/resident");var case_1=require("@quenk/potoo/lib/actor/resident/case");var HTMLElementViewDelegate=function(){function HTMLElementViewDelegate(node){this.node=node}HTMLElementViewDelegate.prototype.set=function(view){this.unset();this.node.appendChild(view.render())};HTMLElementViewDelegate.prototype.unset=function(){var node=this.node;while(node.firstChild!=null)node.removeChild(node.firstChild)};return HTMLElementViewDelegate}();exports.HTMLElementViewDelegate=HTMLElementViewDelegate;var Show=function(){function Show(name,view,source){this.name=name;this.view=view;this.source=source}return Show}();exports.Show=Show;var Push=function(_super){__extends(Push,_super);function Push(){return _super!==null&&_super.apply(this,arguments)||this}return Push}(Show);exports.Push=Push;var Pop=function(){function Pop(source){this.source=source}return Pop}();exports.Pop=Pop;var Close=function(){function Close(source){this.source=source}return Close}();exports.Close=Close;var ViewShown=function(){function ViewShown(name){this.name=name}return ViewShown}();exports.ViewShown=ViewShown;var ViewStackEmpty=function(){function ViewStackEmpty(){}return ViewStackEmpty}();exports.ViewStackEmpty=ViewStackEmpty;var ViewRemoved=function(){function ViewRemoved(name){this.name=name}return ViewRemoved}();exports.ViewRemoved=ViewRemoved;var ViewService=function(_super){__extends(ViewService,_super);function ViewService(delegate,system){var _this=_super.call(this,system)||this;_this.delegate=delegate;_this.system=system;_this.stack=[];_this.receive=[new case_1.Case(Show,function(m){return _this.show(m)}),new case_1.Case(Push,function(m){return _this.push(m)}),new case_1.Case(Pop,function(m){return _this.pop(m)}),new case_1.Case(Close,function(){return _this.close()})];return _this}ViewService.prototype.show=function(m){if(!array_1.empty(this.stack))this.close();this.push(m)};ViewService.prototype.push=function(m){this.stack.push(m);this.delegate.set(m.view);this.tell(m.source,new ViewShown(m.name))};ViewService.prototype.pop=function(m){if(array_1.empty(this.stack)){this.tell(m.source,new ViewStackEmpty)}else{var current=this.stack.pop();this.delegate.unset();this.tell(current.source,new ViewRemoved(current.name));if(!array_1.empty(this.stack)){this.push(this.stack.pop())}}};ViewService.prototype.close=function(){var _this=this;this.delegate.unset();this.stack.forEach(function(m){_this.tell(m.source,new ViewRemoved(m.name))});this.stack=[]};ViewService.prototype.run=function(){};return ViewService}(resident_1.Immutable);exports.ViewService=ViewService},{"@quenk/noni/lib/data/array":57,"@quenk/potoo/lib/actor/resident":71,"@quenk/potoo/lib/actor/resident/case":70}],53:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.attempt=exports.raise=exports.convert=void 0;var either_1=require("../data/either");var convert=function(e){return e instanceof Error?e:new Error(e?e.message?e.message:undefined:undefined)};exports.convert=convert;var raise=function(e){if(e instanceof Error){throw e}else{throw new Error(e.message)}};exports.raise=raise;var attempt=function(f){try{return(0,either_1.right)(f())}catch(e){return(0,either_1.left)(e)}};exports.attempt=attempt},{"../data/either":59}],54:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var __generator=this&&this.__generator||function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(_)try{if(f=1,y&&(t=op[0]&2?y["return"]:op[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}};Object.defineProperty(exports,"__esModule",{value:true});exports.doFuture=exports.liftP=exports.fromExcept=exports.toPromise=exports.race=exports.reduce=exports.sequential=exports.parallel=exports.batch=exports.fromCallback=exports.fromAbortable=exports.wait=exports.delay=exports.attempt=exports.raise=exports.run=exports.voidPure=exports.pure=exports.Run=exports.Raise=exports.Trap=exports.Finally=exports.Catch=exports.Call=exports.Bind=exports.Pure=exports.Future=void 0;var function_1=require("../../data/function");var timer_1=require("../timer");var error_1=require("../error");var _1=require("./");var array_1=require("../../data/array");var Future=function(){function Future(){this.tag="Future"}Object.defineProperty(Future.prototype,Symbol.toStringTag,{get:function(){return"Future"},enumerable:false,configurable:true});Future.prototype.of=function(a){return new Pure(a)};Future.prototype.map=function(f){return new Bind(this,function(value){return new Pure(f(value))})};Future.prototype.ap=function(ft){return new Bind(this,function(value){return ft.map(function(f){return f(value)})})};Future.prototype.chain=function(f){return new Bind(this,f)};Future.prototype.trap=function(f){return new Catch(this,f)};Future.prototype.catch=function(f){return new Catch(this,function(e){return(0,exports.run)(function(onError,onSuccess){if(f){var result=f(e);switch(Object.prototype.toString.call(result)){case"[object Future]":var asFuture=result;asFuture.fork(function(e){return onError(e)},function(v){return onSuccess(v)});break;case"[object Promise]":var asPromise=result;asPromise.then(function(v){return onSuccess(v)},function(e){return onError(e)});break;default:onSuccess(result);break}}else{onSuccess(undefined)}return function_1.noop})})};Future.prototype.finally=function(f){return new Finally(this,f)};Future.prototype.then=function(onResolve,onReject){var _this=this;return new Promise(function(resolve,reject){_this.fork(reject,resolve)}).then(onResolve,onReject)};Future.prototype._fork=function(value,stack,onError,onSuccess){var _this=this;var pending=true;var failure=function(e){if(pending){stack.push(new Raise(e));pending=false;_this._fork(value,stack,onError,onSuccess)}else{console.warn(_this.tag+": onError called after task completed");console.trace()}};var success=function(val){if(pending){pending=false;if((0,array_1.empty)(stack))onSuccess(val);else _this._fork(val,stack,onError,onSuccess)}else{console.warn(_this.tag+": onSuccess called after task completed");console.trace()}};var _loop_1=function(){var next=stack.pop();if(next.tag==="Pure"){(0,timer_1.tick)(function(){return success(next.value)});return{value:function_1.noop}}else if(next.tag==="Bind"){var future=next;stack.push(new Call(future.func));stack.push(future.target)}else if(next.tag==="Call"){var future=next;stack.push(future.target(value))}else if(next.tag==="Catch"){var future=next;stack.push(new Trap(future.func));stack.push(future.target)}else if(next.tag==="Finally"){var future=next;stack.push(new Trap(future.func));stack.push(new Call(future.func));stack.push(future.target)}else if(next.tag==="Trap"){if((0,array_1.empty)(stack))onSuccess(value)}else if(next.tag==="Raise"){var future=next;var err=(0,error_1.convert)(future.value);while(!(0,array_1.empty)(stack)&&(0,array_1.tail)(stack).tag!=="Trap")stack.pop();if((0,array_1.empty)(stack)){onError(err);return{value:function_1.noop}}else{stack.push(stack.pop().func(err))}}else if(next.tag==="Run"){return{value:next.task(failure,success)}}};while(!(0,array_1.empty)(stack)){var state_1=_loop_1();if(typeof state_1==="object")return state_1.value}return function_1.noop};Future.prototype.fork=function(onError,onSuccess){if(onError===void 0){onError=function_1.noop}if(onSuccess===void 0){onSuccess=function_1.noop}return this._fork(undefined,[this],onError,onSuccess)};return Future}();exports.Future=Future;var Pure=function(_super){__extends(Pure,_super);function Pure(value){var _this=_super.call(this)||this;_this.value=value;_this.tag="Pure";return _this}Pure.prototype.map=function(f){return new Pure(f(this.value))};Pure.prototype.ap=function(ft){var _this=this;return ft.map(function(f){return f(_this.value)})};return Pure}(Future);exports.Pure=Pure;var Bind=function(_super){__extends(Bind,_super);function Bind(target,func){var _this=_super.call(this)||this;_this.target=target;_this.func=func;_this.tag="Bind";return _this}return Bind}(Future);exports.Bind=Bind;var Call=function(_super){__extends(Call,_super);function Call(target){var _this=_super.call(this)||this;_this.target=target;_this.tag="Call";return _this}return Call}(Future);exports.Call=Call;var Catch=function(_super){__extends(Catch,_super);function Catch(target,func){var _this=_super.call(this)||this;_this.target=target;_this.func=func;_this.tag="Catch";return _this}return Catch}(Future);exports.Catch=Catch;var Finally=function(_super){__extends(Finally,_super);function Finally(target,func){var _this=_super.call(this)||this;_this.target=target;_this.func=func;_this.tag="Finally";return _this}return Finally}(Future);exports.Finally=Finally;var Trap=function(_super){__extends(Trap,_super);function Trap(func){var _this=_super.call(this)||this;_this.func=func;_this.tag="Trap";return _this}return Trap}(Future);exports.Trap=Trap;var Raise=function(_super){__extends(Raise,_super);function Raise(value){var _this=_super.call(this)||this;_this.value=value;_this.tag="Raise";return _this}Raise.prototype.map=function(_){return new Raise(this.value)};Raise.prototype.ap=function(_){return new Raise(this.value)};Raise.prototype.chain=function(_){return new Raise(this.value)};return Raise}(Future);exports.Raise=Raise;var Run=function(_super){__extends(Run,_super);function Run(task){var _this=_super.call(this)||this;_this.task=task;_this.tag="Run";return _this}return Run}(Future);exports.Run=Run;var pure=function(a){return new Pure(a)};exports.pure=pure;exports.voidPure=new Pure(undefined);var run=function(task){return new Run(task)};exports.run=run;var raise=function(e){return new Raise(e)};exports.raise=raise;var attempt=function(f){return(0,exports.run)(function(onError,onSuccess){(0,timer_1.tick)(function(){try{onSuccess(f())}catch(e){onError(e)}});return function_1.noop})};exports.attempt=attempt;var delay=function(f,n){if(n===void 0){n=0}return(0,exports.run)(function(onError,onSuccess){setTimeout(function(){try{onSuccess(f())}catch(e){onError(e)}},n);return function_1.noop})};exports.delay=delay;var wait=function(n){return(0,exports.run)(function(_,onSuccess){setTimeout(function(){onSuccess(undefined)},n);return function_1.noop})};exports.wait=wait;var fromAbortable=function(abort){return function(f){return(0,exports.run)(function(onError,onSuccess){f(function(err,a){return err!=null?onError(err):onSuccess(a)});return abort})}};exports.fromAbortable=fromAbortable;var fromCallback=function(f){return(0,exports.fromAbortable)(function_1.noop)(f)};exports.fromCallback=fromCallback;var Tag=function(){function Tag(index,value){this.index=index;this.value=value}return Tag}();var batch=function(list){return(0,exports.sequential)(list.map(function(w){return(0,exports.parallel)(w)}))};exports.batch=batch;var parallel=function(list){return(0,exports.run)(function(onError,onSuccess){var completed=[];var finished=false;var aborters=[];var indexCmp=function(a,b){return a.index-b.index};var abortAll=function(){finished=true;aborters.map(function(f){return f()})};var onErr=function(e){if(!finished){abortAll();onError(e)}};var reconcile=function(){return completed.sort(indexCmp).map(function(t){return t.value})};var onSucc=function(t){if(!finished){completed.push(t);if(completed.length===list.length)onSuccess(reconcile())}};aborters.push.apply(aborters,list.map(function(f,i){return f.map(function(value){return new Tag(i,value)}).fork(onErr,onSucc)}));if((0,array_1.empty)(aborters))onSuccess([]);return function(){return abortAll()}})};exports.parallel=parallel;var sequential=function(list){return(0,exports.run)(function(onError,onSuccess){var i=0;var r=[];var onErr=function(e){return onError(e)};var success=function(a){r.push(a);next()};var abort;var next=function(){if(i<list.length)abort=list[i].fork(onErr,success);else onSuccess(r);i++};next();return function(){if(abort)abort()}})};exports.sequential=sequential;var reduce=function(list,initValue,f){return(0,exports.doFuture)(function(){var accumValue,i;return __generator(this,function(_a){switch(_a.label){case 0:accumValue=initValue;i=0;_a.label=1;case 1:if(!(i<list.length))return[3,4];return[4,f(accumValue,list[i],i)];case 2:accumValue=_a.sent();_a.label=3;case 3:i++;return[3,1];case 4:return[2,(0,exports.pure)(accumValue)]}})})};exports.reduce=reduce;var race=function(list){return(0,exports.run)(function(onError,onSuccess){var aborters=[];var finished=false;var abortAll=function(){finished=true;aborters.map(function(f){return f()})};var onErr=function(e){if(!finished){finished=true;abortAll();onError(e)}};var onSucc=function(t){if(!finished){finished=true;aborters.map(function(f,i){return i!==t.index?f():undefined});onSuccess(t.value)}};aborters.push.apply(aborters,list.map(function(f,i){return f.map(function(value){return new Tag(i,value)}).fork(onErr,onSucc)}));if(aborters.length===0)onError(new Error("race(): Cannot race an empty list!"));return function(){return abortAll()}})};exports.race=race;var toPromise=function(ft){return new Promise(function(yes,no){return ft.fork(no,yes)})};exports.toPromise=toPromise;var fromExcept=function(e){return e.fold(function(e){return(0,exports.raise)(e)},function(a){return(0,exports.pure)(a)})};exports.fromExcept=fromExcept;var liftP=function(f){return(0,exports.run)(function(onError,onSuccess){f().then(function(a){return onSuccess(a)}).catch(function(e){return onError(e)});return function_1.noop})};exports.liftP=liftP;var doFuture=function(f){return(0,_1.doN)(f)};exports.doFuture=doFuture},{"../../data/array":57,"../../data/function":60,"../error":53,"../timer":56,"./":55}],55:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.doMonad=exports.doN=exports.pipeN=exports.pipe=exports.compose=exports.join=void 0;var join=function(outer){return outer.chain(function(x){return x})};exports.join=join;var compose=function(g,f){return(0,exports.pipe)(f,g)};exports.compose=compose;var pipe=function(f,g){return function(value){return f(value).chain(function(b){return g(b)})}};exports.pipe=pipe;var pipeN=function(f){var list=[];for(var _i=1;_i<arguments.length;_i++){list[_i-1]=arguments[_i]}return function(value){return list.reduce(function(p,c){return p.chain(function(v){return c(v)})},f(value))}};exports.pipeN=pipeN;var doN=function(f){var gen=f();var next=function(val){var r=gen.next(val);if(r.done)return r.value;else return r.value.chain(next)};return next()};exports.doN=doN;exports.doMonad=exports.doN},{}],56:[function(require,module,exports){(function(process){(function(){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.throttle=exports.debounce=exports.tick=void 0;var tick=function(f){return typeof window=="undefined"?setTimeout(f,0):process.nextTick(f)};exports.tick=tick;var debounce=function(f,delay){var id=-1;return function(a){if(id===-1){id=setTimeout(function(){return f(a)},delay)}else{clearTimeout(id);id=setTimeout(function(){return f(a)},delay)}}};exports.debounce=debounce;var throttle=function(f,duration){var wait=false;return function(a){if(wait===false){f(a);wait=true;setTimeout(function(){return wait=false},duration)}}};exports.throttle=throttle}).call(this)}).call(this,require("_process"))},{_process:168}],57:[function(require,module,exports){"use strict";var __spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||arguments.length===2)for(var i=0,l=from.length,ar;i<l;i++){if(ar||!(i in from)){if(!ar)ar=Array.prototype.slice.call(from,0,i);ar[i]=from[i]}}return to.concat(ar||Array.prototype.slice.call(from))};Object.defineProperty(exports,"__esModule",{value:true});exports.compact=exports.flatten=exports.combine=exports.make=exports.removeAt=exports.remove=exports.dedupe=exports.distribute=exports.group=exports.partition=exports.concat=exports.flatMap=exports.map=exports.contains=exports.empty=exports.tail=exports.head=void 0;var record_1=require("../record");var math_1=require("../../math");var head=function(list){return list[0]};exports.head=head;var tail=function(list){return list[list.length-1]};exports.tail=tail;var empty=function(list){return list.length===0};exports.empty=empty;var contains=function(list,a){return list.indexOf(a)>-1};exports.contains=contains;var map=function(list){return function(f){return list.map(f)}};exports.map=map;var flatMap=function(list,f){return list.reduce(function(p,c,i){return p.concat(f(c,i,list))},[])};exports.flatMap=flatMap;var concat=function(list){var items=[];for(var _i=1;_i<arguments.length;_i++){items[_i-1]=arguments[_i]}return __spreadArray(__spreadArray([],list,true),items.filter(function(item){return item!=null}),true)};exports.concat=concat;var partition=function(list,f){return(0,exports.empty)(list)?[[],[]]:list.reduce(function(_a,c,i){var yes=_a[0],no=_a[1];return f(c,i,list)?[(0,exports.concat)(yes,c),no]:[yes,(0,exports.concat)(no,c)]},[[],[]])};exports.partition=partition;var group=function(list,f){return list.reduce(function(p,c,i){var _a;var g=f(c,i,list);return(0,record_1.merge)(p,(_a={},_a[g]=Array.isArray(p[g])?(0,exports.concat)(p[g],c):[c],_a))},{})};exports.group=group;var distribute=function(list,size){var r=list.reduce(function(p,c,i){return(0,math_1.isMultipleOf)(size,i+1)?[(0,exports.concat)(p[0],(0,exports.concat)(p[1],c)),[]]:[p[0],(0,exports.concat)(p[1],c)]},[[],[]]);return r[1].length===0?r[0]:(0,exports.concat)(r[0],r[1])};exports.distribute=distribute;var dedupe=function(list){return list.filter(function(e,i,l){return l.indexOf(e)===i})};exports.dedupe=dedupe;var remove=function(list,target){var idx=list.indexOf(target);if(idx===-1){return list.slice()}else{var a=list.slice();a.splice(idx,1);return a}};exports.remove=remove;var removeAt=function(list,idx){if(list.length>idx&&idx>-1){var a=list.slice();a.splice(idx,1);return a}else{return list.slice()}};exports.removeAt=removeAt;var make=function(size,f){var a=new Array(size);for(var i=0;i<size;i++)a[i]=f(i);return a};exports.make=make;var combine=function(list){return list.reduce(function(p,c){return p.concat(c)},[])};exports.combine=combine;var flatten=function(list){return list.reduce(function(p,c){return p.concat(Array.isArray(c)?(0,exports.flatten)(c):c)},[])};exports.flatten=flatten;var compact=function(list){return list.filter(function(v){return v!=null})};exports.compact=compact},{"../../math":66,"../record":62}],58:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.natural=exports.number=exports.string=exports.date=void 0;var date=function(a,b){var na=new Date(a).getTime();var nb=new Date(b).getTime();return na>nb?-1:na<nb?1:0};exports.date=date;var string=function(a,b){var la=String(a).replace(/\s+/,"").toLowerCase();var lb=String(b).replace(/\s+/,"").toLowerCase();return la>lb?-1:la<lb?1:0};exports.string=string;var number=function(a,b){var na=parseFloat(a);var nb=parseFloat(b);na=isNaN(a)?-Infinity:a;nb=isNaN(b)?-Infinity:b;return na>nb?-1:na<nb?1:0};exports.number=number;var natural=function(a,b){if(a===void 0){a=""}if(b===void 0){b=""}var reA=/[^a-zA-Z]/g;var reN=/[^0-9]/g;var aInt=parseInt(a,10);var bInt=parseInt(b,10);if(isNaN(aInt)&&isNaN(bInt)){var aA=String(a).replace(reA,"");var bA=String(b).replace(reA,"");if(aA===bA){var aN=parseInt(String(a).replace(reN,""),10);var bN=parseInt(String(b).replace(reN,""),10);return aN===bN?0:aN>bN?-1:1}else{return aA>bA?-1:1}}else if(isNaN(aInt)){return-1}else if(isNaN(bInt)){return 1}else{return aInt>bInt?-1:1}};exports.natural=natural},{}],59:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.either=exports.fromBoolean=exports.right=exports.left=exports.Right=exports.Left=exports.Either=void 0;var maybe_1=require("./maybe");var Either=function(){function Either(){}Either.prototype.of=function(value){return new Right(value)};return Either}();exports.Either=Either;var Left=function(_super){__extends(Left,_super);function Left(value){var _this=_super.call(this)||this;_this.value=value;return _this}Left.prototype.map=function(_){return new Left(this.value)};Left.prototype.lmap=function(f){return new Left(f(this.value))};Left.prototype.bimap=function(f,_){return new Left(f(this.value))};Left.prototype.alt=function(a){return a};Left.prototype.chain=function(_){return new Left(this.value)};Left.prototype.ap=function(_){return new Left(this.value)};Left.prototype.extend=function(_){return new Left(this.value)};Left.prototype.fold=function(f,_){return f(this.value)};Left.prototype.eq=function(m){return m instanceof Left&&m.value===this.value};Left.prototype.orElse=function(f){return f(this.value)};Left.prototype.orRight=function(f){return new Right(f(this.value))};Left.prototype.isLeft=function(){return true};Left.prototype.isRight=function(){return false};Left.prototype.takeLeft=function(){return this.value};Left.prototype.takeRight=function(){throw new TypeError("Not right!")};Left.prototype.toMaybe=function(){return(0,maybe_1.nothing)()};return Left}(Either);exports.Left=Left;var Right=function(_super){__extends(Right,_super);function Right(value){var _this=_super.call(this)||this;_this.value=value;return _this}Right.prototype.map=function(f){return new Right(f(this.value))};Right.prototype.lmap=function(_){return new Right(this.value)};Right.prototype.bimap=function(_,g){return new Right(g(this.value))};Right.prototype.alt=function(_){return this};Right.prototype.chain=function(f){return f(this.value)};Right.prototype.ap=function(e){var _this=this;return e.map(function(f){return f(_this.value)})};Right.prototype.extend=function(f){return new Right(f(this))};Right.prototype.eq=function(m){return m instanceof Right&&m.value===this.value};Right.prototype.fold=function(_,g){return g(this.value)};Right.prototype.orElse=function(_){return this};Right.prototype.orRight=function(_){return this};Right.prototype.isLeft=function(){return false};Right.prototype.isRight=function(){return true};Right.prototype.takeLeft=function(){throw new TypeError("Not left!")};Right.prototype.takeRight=function(){return this.value};Right.prototype.toMaybe=function(){return(0,maybe_1.just)(this.value)};return Right}(Either);exports.Right=Right;var left=function(a){return new Left(a)};exports.left=left;var right=function(b){return new Right(b)};exports.right=right;var fromBoolean=function(b){return b?(0,exports.right)(true):(0,exports.left)(false)};exports.fromBoolean=fromBoolean;var either=function(f){return function(g){return function(e){return e instanceof Right?g(e.takeRight()):f(e.takeLeft())}}};exports.either=either},{"./maybe":61}],60:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.noop=exports.curry5=exports.curry4=exports.curry3=exports.curry=exports.id=exports.identity=exports.flip=exports.cons=exports.compose5=exports.compose4=exports.compose3=exports.compose=void 0;var compose=function(f,g){return function(a){return g(f(a))}};exports.compose=compose;var compose3=function(f,g,h){return function(a){return h(g(f(a)))}};exports.compose3=compose3;var compose4=function(f,g,h,i){return function(a){return i(h(g(f(a))))}};exports.compose4=compose4;var compose5=function(f,g,h,i,j){return function(a){return j(i(h(g(f(a)))))}};exports.compose5=compose5;var cons=function(a){return function(_){return a}};exports.cons=cons;var flip=function(f){return function(b){return function(a){return f(a)(b)}}};exports.flip=flip;var identity=function(a){return a};exports.identity=identity;exports.id=exports.identity;var curry=function(f){return function(a){return function(b){return f(a,b)}}};exports.curry=curry;var curry3=function(f){return function(a){return function(b){return function(c){return f(a,b,c)}}}};exports.curry3=curry3;var curry4=function(f){return function(a){return function(b){return function(c){return function(d){return f(a,b,c,d)}}}}};exports.curry4=curry4;var curry5=function(f){return function(a){return function(b){return function(c){return function(d){return function(e){return f(a,b,c,d,e)}}}}}};exports.curry5=curry5;var noop=function(){};exports.noop=noop},{}],61:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.fromNaN=exports.fromNumber=exports.fromBoolean=exports.fromString=exports.fromObject=exports.fromArray=exports.fromNullable=exports.just=exports.nothing=exports.of=exports.Just=exports.Nothing=void 0;var Nothing=function(){function Nothing(){}Nothing.prototype.map=function(_){return new Nothing};Nothing.prototype.ap=function(_){return new Nothing};Nothing.prototype.of=function(a){return new Just(a)};Nothing.prototype.chain=function(_){return new Nothing};Nothing.prototype.alt=function(a){return a};Nothing.prototype.empty=function(){return new Nothing};Nothing.prototype.extend=function(_){return new Nothing};Nothing.prototype.eq=function(m){return m instanceof Nothing};Nothing.prototype.orJust=function(f){return new Just(f())};Nothing.prototype.orElse=function(f){return f()};Nothing.prototype.isNothing=function(){return true};Nothing.prototype.isJust=function(){return false};Nothing.prototype.get=function(){throw new TypeError("Cannot get a value from Nothing!")};return Nothing}();exports.Nothing=Nothing;var Just=function(){function Just(value){this.value=value}Just.prototype.map=function(f){return new Just(f(this.value))};Just.prototype.ap=function(mb){var _this=this;return mb.map(function(f){return f(_this.value)})};Just.prototype.of=function(a){return new Just(a)};Just.prototype.chain=function(f){return f(this.value)};Just.prototype.alt=function(_){return this};Just.prototype.empty=function(){return new Nothing};Just.prototype.extend=function(f){return new Just(f(this))};Just.prototype.eq=function(m){return m instanceof Just&&m.value===this.value};Just.prototype.orJust=function(_){return this};Just.prototype.orElse=function(_){return this};Just.prototype.isNothing=function(){return false};Just.prototype.isJust=function(){return true};Just.prototype.get=function(){return this.value};return Just}();exports.Just=Just;var of=function(a){return new Just(a)};exports.of=of;var nothing=function(){return new Nothing};exports.nothing=nothing;var just=function(a){return new Just(a)};exports.just=just;var fromNullable=function(a){return a==null?new Nothing:new Just(a)};exports.fromNullable=fromNullable;var fromArray=function(a){return a.length===0?new Nothing:new Just(a)};exports.fromArray=fromArray;var fromObject=function(o){return Object.keys(o).length===0?new Nothing:new Just(o)};exports.fromObject=fromObject;var fromString=function(s){return s===""?new Nothing:new Just(s)};exports.fromString=fromString;var fromBoolean=function(b){return b===false?new Nothing:new Just(b)};exports.fromBoolean=fromBoolean;var fromNumber=function(n){return n===0?new Nothing:new Just(n)};exports.fromNumber=fromNumber;var fromNaN=function(n){return isNaN(n)?new Nothing:new Just(n)};exports.fromNaN=fromNaN},{}],62:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.pickValue=exports.pickKey=exports.make=exports.rcompact=exports.compact=exports.isBadKey=exports.set=exports.every=exports.some=exports.empty=exports.count=exports.clone=exports.hasKey=exports.values=exports.group=exports.partition=exports.exclude=exports.rmerge5=exports.rmerge4=exports.rmerge3=exports.rmerge=exports.merge5=exports.merge4=exports.merge3=exports.merge=exports.filter=exports.reduce=exports.forEach=exports.mapTo=exports.map=exports.keys=exports.isRecord=exports.assign=exports.badKeys=void 0;var array_1=require("../array");var type_1=require("../type");var maybe_1=require("../maybe");exports.badKeys=["__proto__"];function assign(target){var _varArgs=[];for(var _i=1;_i<arguments.length;_i++){_varArgs[_i-1]=arguments[_i]}var to=Object(target);for(var index=1;index<arguments.length;index++){var nextSource=arguments[index];if(nextSource!=null)for(var nextKey in nextSource)if(Object.prototype.hasOwnProperty.call(nextSource,nextKey))(0,exports.set)(to,nextKey,nextSource[nextKey])}return to}exports.assign=assign;var isRecord=function(value){return typeof value==="object"&&value!=null&&!Array.isArray(value)&&!(value instanceof Date)&&!(value instanceof RegExp)};exports.isRecord=isRecord;var keys=function(obj){return Object.keys(obj)};exports.keys=keys;var map=function(rec,f){return(0,exports.keys)(rec).reduce(function(p,k){return(0,exports.merge)(p,(0,exports.set)({},k,f(rec[k],k,rec)))},{})};exports.map=map;var mapTo=function(rec,f){return(0,exports.keys)(rec).map(function(k){return f(rec[k],k,rec)})};exports.mapTo=mapTo;var forEach=function(rec,f){return(0,exports.keys)(rec).forEach(function(k){return f(rec[k],k,rec)})};exports.forEach=forEach;var reduce=function(rec,accum,f){return(0,exports.keys)(rec).reduce(function(p,k){return f(p,rec[k],k)},accum)};exports.reduce=reduce;var filter=function(rec,f){return(0,exports.keys)(rec).reduce(function(p,k){return f(rec[k],k,rec)?(0,exports.merge)(p,(0,exports.set)({},k,rec[k])):p},{})};exports.filter=filter;var merge=function(left,right){return assign({},left,right)};exports.merge=merge;var merge3=function(a,b,c){return assign({},a,b,c)};exports.merge3=merge3;var merge4=function(a,b,c,d){return assign({},a,b,c,d)};exports.merge4=merge4;var merge5=function(a,b,c,d,e){return assign({},a,b,c,d,e)};exports.merge5=merge5;var rmerge=function(left,right){return(0,exports.reduce)(right,left,deepMerge)};exports.rmerge=rmerge;var rmerge3=function(r,s,t){return[s,t].reduce(function(p,c){return(0,exports.reduce)(c,p,deepMerge)},r)};exports.rmerge3=rmerge3;var rmerge4=function(r,s,t,u){return[s,t,u].reduce(function(p,c){return(0,exports.reduce)(c,p,deepMerge)},r)};exports.rmerge4=rmerge4;var rmerge5=function(r,s,t,u,v){return[s,t,u,v].reduce(function(p,c){return(0,exports.reduce)(c,p,deepMerge)},r)};exports.rmerge5=rmerge5;var deepMerge=function(pre,curr,key){return(0,exports.isRecord)(curr)?(0,exports.merge)(pre,(0,exports.set)({},key,(0,exports.isRecord)(pre[key])?(0,exports.rmerge)(pre[key],curr):(0,exports.merge)({},curr))):(0,exports.merge)(pre,(0,exports.set)({},key,curr))};var exclude=function(rec,keys){var list=Array.isArray(keys)?keys:[keys];return(0,exports.reduce)(rec,{},function(p,c,k){return list.indexOf(k)>-1?p:(0,exports.merge)(p,(0,exports.set)({},k,c))})};exports.exclude=exclude;var partition=function(r,f){return(0,exports.reduce)(r,[{},{}],function(_a,c,k){var yes=_a[0],no=_a[1];return f(c,k,r)?[(0,exports.merge)(yes,(0,exports.set)({},k,c)),no]:[yes,(0,exports.merge)(no,(0,exports.set)({},k,c))]})};exports.partition=partition;var group=function(rec,f){return(0,exports.reduce)(rec,{},function(prev,curr,key){var category=f(curr,key,rec);var value=(0,exports.isRecord)(prev[category])?(0,exports.merge)(prev[category],(0,exports.set)({},key,curr)):(0,exports.set)({},key,curr);return(0,exports.merge)(prev,(0,exports.set)({},category,value))})};exports.group=group;var values=function(r){return(0,exports.reduce)(r,[],function(p,c){return(0,array_1.concat)(p,c)})};exports.values=values;var hasKey=function(r,key){return Object.hasOwnProperty.call(r,key)};exports.hasKey=hasKey;var clone=function(r){return(0,exports.reduce)(r,{},function(p,c,k){(0,exports.set)(p,k,_clone(c));return p})};exports.clone=clone;var _clone=function(a){if((0,type_1.isArray)(a))return a.map(_clone);else if((0,exports.isRecord)(a))return(0,exports.clone)(a);else return a};var count=function(r){return(0,exports.keys)(r).length};exports.count=count;var empty=function(r){return(0,exports.count)(r)===0};exports.empty=empty;var some=function(o,f){return(0,exports.keys)(o).some(function(k){return f(o[k],k,o)})};exports.some=some;var every=function(o,f){return(0,exports.keys)(o).every(function(k){return f(o[k],k,o)})};exports.every=every;var set=function(r,k,value){if(!(0,exports.isBadKey)(k))r[k]=value;return r};exports.set=set;var isBadKey=function(key){return exports.badKeys.indexOf(key)!==-1};exports.isBadKey=isBadKey;var compact=function(rec){var result={};for(var key in rec)if(rec.hasOwnProperty(key))if(rec[key]!=null)result=(0,exports.set)(result,key,rec[key]);return result};exports.compact=compact;var rcompact=function(rec){return(0,exports.compact)((0,exports.map)(rec,function(val){return(0,exports.isRecord)(val)?(0,exports.rcompact)(val):val}))};exports.rcompact=rcompact;var make=function(init){if(init===void 0){init={}}var rec={};Object.defineProperty(rec,"__proto__",{configurable:false,enumerable:false,set:function(){}});for(var key in init)if(init.hasOwnProperty(key))rec[key]=init[key];return rec};exports.make=make;var pickKey=function(rec,test){return(0,exports.reduce)(rec,(0,maybe_1.nothing)(),function(p,c,k){return p.isJust()?p:test(c,k,rec)?(0,maybe_1.just)(k):p})};exports.pickKey=pickKey;var pickValue=function(rec,test){return(0,exports.reduce)(rec,(0,maybe_1.nothing)(),function(p,c,k){return p.isJust()?p:test(c,k,rec)?(0,maybe_1.just)(c):p})};exports.pickValue=pickValue},{"../array":57,"../maybe":61,"../type":65}],63:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.project=exports.unflatten=exports.flatten=exports.unescapeRecord=exports.escapeRecord=exports.unescape=exports.escape=exports.set=exports.getString=exports.getDefault=exports.get=exports.unsafeGet=exports.tokenize=void 0;var maybe_1=require("../maybe");var _1=require("./");var TOKEN_DOT=".";var TOKEN_BRACKET_LEFT="[";var TOKEN_BRACKET_RIGHT="]";var TOKEN_ESCAPE="\\";var tokenize=function(str){var i=0;var buf="";var curr="";var next="";var tokens=[];while(i<str.length){curr=str[i];next=str[i+1];if(curr===TOKEN_ESCAPE){buf=""+buf+next;i++}else if(curr===TOKEN_DOT){if(buf!=="")tokens.push(buf);buf=""}else if(curr===TOKEN_BRACKET_LEFT&&next===TOKEN_BRACKET_RIGHT){i++}else if(curr===TOKEN_BRACKET_LEFT){var bracketBuf="";var firstDot=-1;var firstDotBuf="";i++;while(true){curr=str[i];next=str[i+1];if(curr===TOKEN_BRACKET_RIGHT&&next===TOKEN_BRACKET_RIGHT){bracketBuf=""+bracketBuf+TOKEN_BRACKET_RIGHT;i++}else if(curr===TOKEN_BRACKET_RIGHT){if(buf!=="")tokens.push(buf);tokens.push(bracketBuf);buf="";break}else if(curr==null){if(firstDot!==-1){i=firstDot;tokens.push(""+buf+TOKEN_BRACKET_LEFT+firstDotBuf);buf="";break}else{buf=""+buf+TOKEN_BRACKET_LEFT+bracketBuf;break}}if(curr===TOKEN_DOT&&firstDot===-1){firstDot=i;firstDotBuf=bracketBuf}bracketBuf=""+bracketBuf+curr;i++}}else{buf=""+buf+curr}i++}if(buf.length>0)tokens.push(buf);return tokens};exports.tokenize=tokenize;var unsafeGet=function(path,src){if(src==null)return undefined;var toks=(0,exports.tokenize)(path);var head=src[toks.shift()];return toks.reduce(function(p,c){return p==null?p:p[c]},head)};exports.unsafeGet=unsafeGet;var get=function(path,src){return(0,maybe_1.fromNullable)((0,exports.unsafeGet)(path,src))};exports.get=get;var getDefault=function(path,src,def){return(0,exports.get)(path,src).orJust(function(){return def}).get()};exports.getDefault=getDefault;var getString=function(path,src){return(0,exports.get)(path,src).map(function(v){return String(v)}).orJust(function(){return""}).get()};exports.getString=getString;var set=function(p,v,r){var toks=(0,exports.tokenize)(p);return _set(r,v,toks)};exports.set=set;var _set=function(r,value,toks){var o;if(toks.length===0)return value;o=(0,_1.isRecord)(r)?(0,_1.clone)(r):{};o=(0,_1.set)(o,toks[0],_set(o[toks[0]],value,toks.slice(1)));return o};var escape=function(p){var i=0;var buf="";var curr="";while(i<p.length){curr=p[i];if(curr===TOKEN_ESCAPE||curr===TOKEN_DOT)buf=""+buf+TOKEN_ESCAPE+curr;else buf=""+buf+curr;i++}return buf};exports.escape=escape;var unescape=function(p){var i=0;var curr="";var next="";var buf="";while(i<p.length){curr=p[i];next=p[i+1];if(curr===TOKEN_ESCAPE){buf=""+buf+next;i++}else{buf=""+buf+curr}i++}return buf};exports.unescape=unescape;var escapeRecord=function(r){return(0,_1.reduce)(r,{},function(p,c,k){if(typeof c==="object")p=(0,_1.set)(p,(0,exports.escape)(k),(0,exports.escapeRecord)(c));else p=(0,_1.set)(p,(0,exports.escape)(k),c);return p})};exports.escapeRecord=escapeRecord;var unescapeRecord=function(r){return(0,_1.reduce)(r,{},function(p,c,k){if((0,_1.isRecord)(c))p=(0,_1.set)(p,(0,exports.unescape)(k),(0,exports.unescapeRecord)(c));else p=(0,_1.set)(p,(0,exports.unescape)(k),c);return p})};exports.unescapeRecord=unescapeRecord;var flatten=function(r){return flatImpl("")({})(r)};exports.flatten=flatten;var flatImpl=function(pfix){return function(prev){return function(r){return(0,_1.reduce)(r,prev,function(p,c,k){return(0,_1.isRecord)(c)?flatImpl(prefix(pfix,k))(p)(c):(0,_1.merge)(p,(0,_1.set)({},prefix(pfix,k),c))})}}};var prefix=function(pfix,key){return pfix===""?(0,exports.escape)(key):pfix+"."+(0,exports.escape)(key)};var unflatten=function(r){return(0,_1.reduce)(r,{},function(p,c,k){return(0,exports.set)(k,c,p)})};exports.unflatten=unflatten;var project=function(spec,rec){return(0,_1.reduce)(spec,{},function(p,c,k){return c===true?(0,exports.set)(k,(0,exports.unsafeGet)(k,rec),p):p})};exports.project=project},{"../maybe":61,"./":62}],64:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.alphanumeric=exports.numeric=exports.alpha=exports.interpolate=exports.uncapitalize=exports.capitalize=exports.propercase=exports.modulecase=exports.classcase=exports.camelcase=exports.contains=exports.endsWith=exports.startsWith=void 0;var path_1=require("../record/path");var record_1=require("../record");var startsWith=function(str,search,pos){if(pos===void 0){pos=0}return str.substr(!pos||pos<0?0:+pos,search.length)===search};exports.startsWith=startsWith;var endsWith=function(str,search,this_len){if(this_len===void 0){this_len=str.length}return this_len===undefined||this_len>str.length?this_len=str.length:str.substring(this_len-search.length,this_len)===search};exports.endsWith=endsWith;var contains=function(str,match){return str.indexOf(match)>-1};exports.contains=contains;var seperator=/([\\\/._-]|\s)+/g;var camelcase=function(str){var i=0;var curr="";var prev="";var buf="";while(true){if(i===str.length)return buf;curr=i===0?str[i].toLowerCase():str[i];if(curr.match(seperator)){prev="-"}else{buf=buf.concat(prev==="-"?curr.toUpperCase():curr.toLowerCase());prev=""}i++}};exports.camelcase=camelcase;var classcase=function(str){return str===""?"":str[0].toUpperCase().concat((0,exports.camelcase)(str).slice(1))};exports.classcase=classcase;var modulecase=function(str){var i=0;var prev="";var curr="";var next="";var buf="";while(true){if(i===str.length)return buf;curr=str[i];next=str[i+1];if(curr.match(/[A-Z]/)&&i>0){if(prev!=="-")buf=buf.concat("-");prev=curr.toLowerCase();buf=buf.concat(prev)}else if(curr.match(seperator)){if(prev!=="-"&&next&&!seperator.test(next)){prev="-";buf=buf.concat(prev)}}else{prev=curr.toLowerCase();buf=buf.concat(prev)}i++}};exports.modulecase=modulecase;var propercase=function(str){return str.trim().toLowerCase().split(" ").map(function(tok){return tok.length>0?""+tok[0].toUpperCase()+tok.slice(1):tok}).join(" ")};exports.propercase=propercase;var capitalize=function(str){return str===""?"":""+str[0].toUpperCase()+str.slice(1)};exports.capitalize=capitalize;var uncapitalize=function(str){return str===""?"":""+str[0].toLowerCase()+str.slice(1)};exports.uncapitalize=uncapitalize;var interpolateDefaults={start:"{",end:"}",regex:"([\\w$.-]+)",leaveMissing:true,applyFunctions:false};var interpolate=function(str,data,opts){if(opts===void 0){opts={}}var options=(0,record_1.assign)({},interpolateDefaults,opts);var reg=new RegExp(""+options.start+options.regex+options.end,"g");return str.replace(reg,function(_,k){return(0,path_1.get)(k,data).map(function(v){if(typeof v==="function")return v(k);else return""+v}).orJust(function(){if(opts.leaveMissing)return k;else return""}).get()})};exports.interpolate=interpolate;var alpha=function(str){return str.replace(/[^a-zA-Z]/g,"")};exports.alpha=alpha;var numeric=function(str){return str.replace(/[^0-9]/g,"")};exports.numeric=numeric;var alphanumeric=function(str){return str.replace(/[\W]|[_]/g,"")};exports.alphanumeric=alphanumeric},{"../record":62,"../record/path":63}],65:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.toString=exports.show=exports.test=exports.is=exports.isPrim=exports.isFunction=exports.isBoolean=exports.isNumber=exports.isString=exports.isArray=exports.isObject=exports.Any=void 0;var prims=["string","number","boolean"];var Any=function(){function Any(){}return Any}();exports.Any=Any;var isObject=function(value){return typeof value==="object"&&!(0,exports.isArray)(value)};exports.isObject=isObject;exports.isArray=Array.isArray;var isString=function(value){return typeof value==="string"};exports.isString=isString;var isNumber=function(value){return typeof value==="number"&&!isNaN(value)};exports.isNumber=isNumber;var isBoolean=function(value){return typeof value==="boolean"};exports.isBoolean=isBoolean;var isFunction=function(value){return typeof value==="function"};exports.isFunction=isFunction;var isPrim=function(value){return!((0,exports.isObject)(value)||(0,exports.isArray)(value)||(0,exports.isFunction)(value))};exports.isPrim=isPrim;var is=function(expected){return function(value){return typeof value===expected}};exports.is=is;var test=function(value,t){if(prims.indexOf(typeof t)>-1&&value===t)return true;else if(typeof t==="function"&&(t===String&&typeof value==="string"||t===Number&&typeof value==="number"||t===Boolean&&typeof value==="boolean"||t===Array&&Array.isArray(value)||t===Any||value instanceof t))return true;else if(t instanceof RegExp&&(typeof value==="string"&&t.test(value)))return true;else if(typeof t==="object"&&typeof value==="object")return Object.keys(t).every(function(k){return Object.hasOwnProperty.call(value,k)?(0,exports.test)(value[k],t[k]):false});return false};exports.test=test;var show=function(value){if(typeof value==="object"){if(Array.isArray(value))return"["+value.map(exports.show)+"];";else if(value.constructor!==Object)return value.constructor.name||value.constructor;else return JSON.stringify(value)}else{return""+value}};exports.show=show;var toString=function(val){return val==null?"":String(val)};exports.toString=toString},{}],66:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.round=exports.isMultipleOf=void 0;var isMultipleOf=function(x,y){return y%x===0};exports.isMultipleOf=isMultipleOf;var round=function(x,n){if(n===void 0){n=0}var exp=Math.pow(10,n);var sign=x>=0?1:-1;var offset=n>0?1/Math.pow(10,n+1):0;return sign*(Math.round(Math.abs(x)*exp+offset)/exp)};exports.round=round},{}],67:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.randomID=exports.isGroup=exports.isChild=exports.getId=exports.getParent=exports.make=exports.isRestricted=exports.ADDRESS_RESTRICTED=exports.ADDRESS_EMPTY=exports.ADDRESS_SYSTEM=exports.ADDRESS_DISCARD=exports.SEPERATOR=void 0;var uuid=require("uuid");var array_1=require("@quenk/noni/lib/data/array");var string_1=require("@quenk/noni/lib/data/string");exports.SEPERATOR="/";exports.ADDRESS_DISCARD="?";exports.ADDRESS_SYSTEM="$";exports.ADDRESS_EMPTY="";exports.ADDRESS_RESTRICTED=[exports.ADDRESS_DISCARD,exports.ADDRESS_SYSTEM,exports.SEPERATOR];exports.isRestricted=function(id){return exports.ADDRESS_RESTRICTED.some(function(a){return id.indexOf(a)>-1})&&id!==exports.SEPERATOR};exports.make=function(parent,id){return parent===exports.SEPERATOR||parent===exports.ADDRESS_EMPTY?""+parent+id:parent===exports.ADDRESS_SYSTEM?id:""+parent+exports.SEPERATOR+id};exports.getParent=function(addr){if(addr===exports.ADDRESS_SYSTEM||addr===exports.ADDRESS_EMPTY||addr===exports.ADDRESS_DISCARD||addr===exports.SEPERATOR){return exports.ADDRESS_SYSTEM}else{var b4=addr.split(exports.SEPERATOR);if(b4.length===2&&b4[0]===""){return exports.SEPERATOR}else{var a=b4.reverse().slice(1).reverse().join(exports.SEPERATOR);return a===exports.ADDRESS_EMPTY?exports.ADDRESS_SYSTEM:a}}};exports.getId=function(addr){return addr===exports.ADDRESS_SYSTEM||addr===exports.ADDRESS_DISCARD||addr===exports.ADDRESS_EMPTY||addr===exports.SEPERATOR?addr:array_1.tail(addr.split(exports.SEPERATOR))};exports.isChild=function(parent,child){return parent===exports.ADDRESS_SYSTEM||parent!==child&&string_1.startsWith(child,parent)};exports.isGroup=function(addr){return addr[0]==="$"&&addr!=="$"};exports.randomID=function(){return uuid.v4().split("-").join("")}},{"@quenk/noni/lib/data/array":57,"@quenk/noni/lib/data/string":64,uuid:94}],68:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.isRouter=exports.isBuffered=exports.isImmutable=exports.FLAG_ROUTER=exports.FLAG_TEMPORARY=exports.FLAG_BUFFERED=exports.FLAG_IMMUTABLE=void 0;exports.FLAG_IMMUTABLE=1;exports.FLAG_BUFFERED=2;exports.FLAG_TEMPORARY=4;exports.FLAG_ROUTER=8;exports.isImmutable=function(f){return(f&exports.FLAG_IMMUTABLE)===exports.FLAG_IMMUTABLE};exports.isBuffered=function(f){return(f&exports.FLAG_BUFFERED)===exports.FLAG_BUFFERED};exports.isRouter=function(f){return(f&exports.FLAG_ROUTER)===exports.FLAG_ROUTER}},{}],69:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Envelope=void 0;var Envelope=function(){function Envelope(to,from,message){this.to=to;this.from=from;this.message=message}return Envelope}();exports.Envelope=Envelope},{}],70:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Default=exports.Case=void 0;var type_1=require("@quenk/noni/lib/data/type");var Case=function(){function Case(pattern,handler){this.pattern=pattern;this.handler=handler}Case.prototype.test=function(m){return type_1.test(m,this.pattern)};Case.prototype.apply=function(m){return this.handler(m)};return Case}();exports.Case=Case;var Default=function(_super){__extends(Default,_super);function Default(handler){var _this=_super.call(this,Object,handler)||this;_this.handler=handler;return _this}Default.prototype.test=function(_){return true};Default.prototype.apply=function(m){return this.handler(m)};return Default}(Case);exports.Default=Default},{"@quenk/noni/lib/data/type":65}],71:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.spawn=exports.ref=exports.Mutable=exports.Temp=exports.Immutable=exports.AbstractResident=void 0;var scripts=require("./scripts");var events=require("../system/vm/event");var record_1=require("@quenk/noni/lib/data/record");var type_1=require("@quenk/noni/lib/data/type");var info_1=require("../system/vm/script/info");var address_1=require("../address");var template_1=require("../template");var flags_1=require("../flags");var AbstractResident=function(){function AbstractResident(system){this.system=system;this.self=function(){return address_1.ADDRESS_DISCARD}}AbstractResident.prototype.notify=function(){this.system.exec(this,new scripts.Notify)};AbstractResident.prototype.accept=function(_){};AbstractResident.prototype.spawn=function(t){return exports.spawn(this.system,this,t)};AbstractResident.prototype.spawnGroup=function(group,tmpls){var _this=this;return record_1.map(tmpls,function(t){return _this.spawn(type_1.isObject(t)?record_1.merge(t,{group:group}):{group:group,create:t})})};AbstractResident.prototype.tell=function(ref,m){this.system.exec(this,new scripts.Tell(ref,m));return this};AbstractResident.prototype.raise=function(e){this.system.exec(this,new scripts.Raise(e.message));return this};AbstractResident.prototype.kill=function(addr){this.system.exec(this,new scripts.Kill(addr));return this};AbstractResident.prototype.exit=function(){this.system.exec(this,new scripts.Kill(this.self()))};AbstractResident.prototype.start=function(addr){this.self=function(){return addr};return this.run()};AbstractResident.prototype.stop=function(){};return AbstractResident}();exports.AbstractResident=AbstractResident;var Immutable=function(_super){__extends(Immutable,_super);function Immutable(){return _super!==null&&_super.apply(this,arguments)||this}Immutable.prototype.init=function(c){c.flags=c.flags|flags_1.FLAG_IMMUTABLE|flags_1.FLAG_BUFFERED;c.receivers.push(receiveFun(this.receive));return c};Immutable.prototype.select=function(_){return this};return Immutable}(AbstractResident);exports.Immutable=Immutable;var Temp=function(_super){__extends(Temp,_super);function Temp(){return _super!==null&&_super.apply(this,arguments)||this}Temp.prototype.init=function(c){c.flags=c.flags|flags_1.FLAG_TEMPORARY|flags_1.FLAG_BUFFERED;c.receivers.push(receiveFun(this.receive));return c};return Temp}(Immutable);exports.Temp=Temp;var Mutable=function(_super){__extends(Mutable,_super);function Mutable(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.receive=[];return _this}Mutable.prototype.init=function(c){c.flags=c.flags|flags_1.FLAG_BUFFERED;return c};Mutable.prototype.select=function(cases){this.system.exec(this,new scripts.Receive(receiveFun(cases)));return this};return Mutable}(AbstractResident);exports.Mutable=Mutable;exports.ref=function(res,addr){return function(m){return res.tell(addr,m)}};exports.spawn=function(sys,i,t){var tmpl=template_1.normalize(type_1.isObject(t)?t:{create:t});return sys.execNow(i,new scripts.Spawn(tmpl)).orJust(function(){return address_1.ADDRESS_DISCARD}).get()};var receiveFun=function(cases){return new info_1.NewForeignFunInfo("receive",1,function(r,m){if(cases.some(function(c){var ok=c.test(m);if(ok){var ft=c.apply(m);if(ft!=null)r.runTask(ft)}return ok})){r.vm.trigger(r.context.address,events.EVENT_MESSAGE_READ,m)}else{r.vm.trigger(r.context.address,events.EVENT_MESSAGE_DROPPED,m)}return 0})}},{"../address":67,"../flags":68,"../system/vm/event":74,"../system/vm/script/info":89,"../template":92,"./scripts":72,"@quenk/noni/lib/data/record":62,"@quenk/noni/lib/data/type":65}],72:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Kill=exports.Raise=exports.Notify=exports.Receive=exports.Tell=exports.Self=exports.Spawn=void 0;var op=require("../system/vm/runtime/op");var type_1=require("@quenk/noni/lib/data/type");var info_1=require("../system/vm/script/info");var es_1=require("../system/vm/runtime/heap/object/es");var templateType=new info_1.NewTypeInfo("Template",0,[]);var childrenInfo=new info_1.NewArrayTypeInfo("Children",templateType);templateType.properties[0]={name:"children",type:childrenInfo};var Spawn=function(){function Spawn(template){var _this=this;this.template=template;this.name="<spawn>";this.constants=[[],[]];this.immediate=true;this.info=[templateType,new info_1.NewForeignFunInfo("getTemp",0,function(r){return r.heap.addObject(new es_1.ESObject(r.heap,templateType,_this.template))}),new info_1.NewFunInfo("spawn",2,[op.STORE|0,op.STORE|1,op.LOAD|1,op.LOAD|0,op.ALLOC,op.STORE|2,op.LOAD|2,op.RUN,op.LOAD|0,op.GETPROP|0,op.DUP,op.IFZJMP|32,op.STORE|3,op.LOAD|3,op.ARLENGTH,op.STORE|4,op.PUSHUI32|0,op.STORE|5,op.LOAD|4,op.LOAD|5,op.CEQ,op.IFNZJMP|34,op.PUSHUI32|0,op.LOAD|5,op.LOAD|3,op.ARELM,op.LOAD|2,op.LDN|2,op.CALL,op.LOAD|5,op.PUSHUI32|1,op.ADDUI32,op.STORE|5,op.JMP|18,op.LOAD|2])];this.code=[op.LDN|1,op.CALL,op.SELF,op.LDN|2,op.CALL]}return Spawn}();exports.Spawn=Spawn;var Self=function(){function Self(){this.constants=[[],[]];this.name="<self>";this.immediate=true;this.info=[];this.code=[op.SELF]}return Self}();exports.Self=Self;var Tell=function(){function Tell(to,msg){var _this=this;this.to=to;this.msg=msg;this.constants=[[],[]];this.name="<tell>";this.info=[new info_1.NewForeignFunInfo("getAddress",0,function(){return _this.to}),new info_1.NewForeignFunInfo("getMessage",0,function(r){return type_1.isObject(_this.msg)?r.heap.addObject(new es_1.ESObject(r.heap,info_1.objectType,_this.msg)):_this.msg})];this.code=[op.LDN|0,op.CALL,op.LDN|1,op.CALL,op.SEND]}return Tell}();exports.Tell=Tell;var Receive=function(){function Receive(f){this.f=f;this.constants=[[],[]];this.name="receive";this.info=[this.f];this.code=[op.LDN|0,op.RECV]}return Receive}();exports.Receive=Receive;var Notify=function(){function Notify(){this.constants=[[],[]];this.name="<notify>";this.info=[];this.code=[op.MAILCOUNT,op.IFZJMP|6,op.RECVCOUNT,op.IFZJMP|6,op.MAILDQ,op.READ,op.NOP]}return Notify}();exports.Notify=Notify;var Raise=function(){function Raise(msg){var _this=this;this.msg=msg;this.name="<raise>";this.constants=[[],[]];this.info=[new info_1.NewForeignFunInfo("getMessage",0,function(){return _this.msg})];this.code=[op.LDN|0,op.CALL,op.RAISE]}return Raise}();exports.Raise=Raise;var Kill=function(){function Kill(addr){var _this=this;this.addr=addr;this.name="<kill>";this.constants=[[],[]];this.info=[new info_1.NewForeignFunInfo("getAddress",0,function(){return _this.addr})];this.code=[op.LDN|0,op.CALL,op.STOP]}return Kill}();exports.Kill=Kill},{"../system/vm/runtime/heap/object/es":80,"../system/vm/runtime/op":84,"../system/vm/script/info":89,"@quenk/noni/lib/data/type":65}],73:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.defaults=void 0;var log_1=require("./log");exports.defaults=function(){return{log:{level:log_1.LOG_LEVEL_ERROR,logger:console},on:{},accept:function(){}}}},{"./log":76}],74:[function(require,module,exports){"use strict";var _a;Object.defineProperty(exports,"__esModule",{value:true});exports.getLevel=exports.events=exports.EVENT_ACTOR_STOPPED=exports.EVENT_ACTOR_STARTED=exports.EVENT_ACTOR_CREATED=exports.EVENT_MESSAGE_DROPPED=exports.EVENT_MESSAGE_READ=exports.EVENT_EXEC_ACTOR_CHANGED=exports.EVENT_EXEC_ACTOR_GONE=exports.EVENT_EXEC_INSTANCE_STALE=exports.EVENT_SEND_FAILED=exports.EVENT_SEND_OK=void 0;var log_1=require("./log");exports.EVENT_SEND_OK="message-send-ok";exports.EVENT_SEND_FAILED="message-send-failed";exports.EVENT_EXEC_INSTANCE_STALE="exec-instance-stale";exports.EVENT_EXEC_ACTOR_GONE="exec-actor-gone";exports.EVENT_EXEC_ACTOR_CHANGED="exec-actor-changed";exports.EVENT_MESSAGE_READ="message-read";exports.EVENT_MESSAGE_DROPPED="message-dropped";exports.EVENT_ACTOR_CREATED="actor-created";exports.EVENT_ACTOR_STARTED="actor-started";exports.EVENT_ACTOR_STOPPED="actor-stopped";exports.events=(_a={},_a[exports.EVENT_ACTOR_CREATED]={level:log_1.LOG_LEVEL_INFO},_a[exports.EVENT_ACTOR_STARTED]={level:log_1.LOG_LEVEL_INFO},_a[exports.EVENT_SEND_OK]={level:log_1.LOG_LEVEL_INFO},_a[exports.EVENT_MESSAGE_READ]={level:log_1.LOG_LEVEL_INFO},_a[exports.EVENT_SEND_FAILED]={level:log_1.LOG_LEVEL_WARN},_a[exports.EVENT_MESSAGE_DROPPED]={level:log_1.LOG_LEVEL_WARN},_a[exports.EVENT_EXEC_INSTANCE_STALE]={level:log_1.LOG_LEVEL_WARN},_a[exports.EVENT_EXEC_ACTOR_GONE]={level:log_1.LOG_LEVEL_WARN},_a[exports.EVENT_EXEC_ACTOR_CHANGED]={level:log_1.LOG_LEVEL_WARN},_a[exports.EVENT_ACTOR_STOPPED]={level:log_1.LOG_LEVEL_WARN},_a);exports.getLevel=function(e){return exports.events.hasOwnProperty(e)?exports.events[e].level:log_1.LOG_LEVEL_DEBUG}},{"./log":76}],75:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.PVM=exports.MAX_WORK_LOAD=void 0;var template=require("../../template");var scripts=require("../../resident/scripts");var errors=require("./runtime/error");var events=require("./event");var future_1=require("@quenk/noni/lib/control/monad/future");var maybe_1=require("@quenk/noni/lib/data/maybe");var either_1=require("@quenk/noni/lib/data/either");var array_1=require("@quenk/noni/lib/data/array");var record_1=require("@quenk/noni/lib/data/record");var array_2=require("@quenk/noni/lib/data/array");var type_1=require("@quenk/noni/lib/data/type");var resident_1=require("../../resident");var address_1=require("../../address");var template_1=require("../../template");var flags_1=require("../../flags");var message_1=require("../../message");var state_1=require("./state");var context_1=require("./runtime/context");var thread_1=require("./runtime/thread");var heap_1=require("./runtime/heap");var conf_1=require("./conf");var op_1=require("./runtime/op");var log_1=require("./log");var event_1=require("./event");exports.MAX_WORK_LOAD=25;var PVM=function(){function PVM(system,conf){var _this=this;if(conf===void 0){conf=conf_1.defaults()}this.system=system;this.conf=conf;this.state={runtimes:{$:new thread_1.Thread(this,new heap_1.Heap,context_1.newContext(this,"$",{create:function(){return _this}}))},routers:{},groups:{}};this.runQ=[];this.waitQ=[];this.blocked=[];this.running=false}PVM.create=function(s,conf){return new PVM(s,record_1.rmerge(conf_1.defaults(),conf))};PVM.prototype.init=function(c){return c};PVM.prototype.accept=function(m){return this.conf.accept(m)};PVM.prototype.start=function(){};PVM.prototype.notify=function(){};PVM.prototype.stop=function(){return this.kill(address_1.ADDRESS_SYSTEM,address_1.ADDRESS_SYSTEM)};PVM.prototype.allocate=function(parent,t){var _this=this;var temp=template_1.normalize(t);if(address_1.isRestricted(temp.id))return either_1.left(new errors.InvalidIdErr(temp.id));var addr=address_1.make(parent,temp.id);if(this.getRuntime(addr).isJust())return either_1.left(new errors.DuplicateAddressErr(addr));var args=Array.isArray(t.args)?t.args:[];var act=t.create.apply(t,__spreadArrays([this.system,t],args));var thr=new thread_1.Thread(this,new heap_1.Heap,act.init(context_1.newContext(act,addr,t)));this.putRuntime(addr,thr);this.trigger(addr,events.EVENT_ACTOR_CREATED);if(flags_1.isRouter(thr.context.flags))this.putRoute(addr,addr);if(temp.group){var groups=typeof temp.group==="string"?[temp.group]:temp.group;groups.forEach(function(g){return _this.putMember(g,addr)})}return either_1.right(addr)};PVM.prototype.runActor=function(target){var mrtime=this.getRuntime(target);if(mrtime.isNothing())return future_1.raise(new errors.UnknownAddressErr(target));var rtime=mrtime.get();var ft=rtime.context.actor.start(target);this.trigger(rtime.context.address,events.EVENT_ACTOR_STARTED);return ft!=null?ft:future_1.pure(undefined)};PVM.prototype.runTask=function(addr,ft){var _this=this;this.blocked=array_1.dedupe(this.blocked.concat(addr));ft.fork(function(e){_this.blocked=array_2.remove(_this.blocked,addr);_this.raise(addr,e)},function(){_this.blocked=array_2.remove(_this.blocked,addr);_this.run()})};PVM.prototype.sendMessage=function(to,from,m){var mRouter=this.getRouter(to);var mctx=mRouter.isJust()?mRouter:this.getRuntime(to).map(function(r){return r.context});var msg=type_1.isObject(m)?m.promote():m;var actualMessage=mRouter.isJust()?new message_1.Envelope(to,from,msg):msg;if(mctx.isJust()){var ctx=mctx.get();if(flags_1.isBuffered(ctx.flags)){ctx.mailbox.push(actualMessage);ctx.actor.notify()}else{ctx.actor.accept(actualMessage)}this.trigger(from,events.EVENT_SEND_OK,to,msg);return true}else{this.trigger(from,events.EVENT_SEND_FAILED,to,msg);return false}};PVM.prototype.getRuntime=function(addr){return state_1.get(this.state,addr)};PVM.prototype.getRouter=function(addr){return state_1.getRouter(this.state,addr).map(function(r){return r.context})};PVM.prototype.getGroup=function(name){return state_1.getGroup(this.state,name.split("$").join(""))};PVM.prototype.getChildren=function(addr){return maybe_1.fromNullable(state_1.getChildren(this.state,addr))};PVM.prototype.putRuntime=function(addr,r){this.state=state_1.put(this.state,addr,r);return this};PVM.prototype.putMember=function(group,addr){state_1.putMember(this.state,group,addr);return this};PVM.prototype.putRoute=function(target,router){state_1.putRoute(this.state,target,router);return this};PVM.prototype.remove=function(addr){var _this=this;this.state=state_1.remove(this.state,addr);record_1.map(this.state.routers,function(r,k){if(r===addr)delete _this.state.routers[k]});return this};PVM.prototype.removeRoute=function(target){state_1.removeRoute(this.state,target);return this};PVM.prototype.raise=function(addr,err){var _this=this;var next=addr;var _loop_1=function(){var mrtime=this_1.getRuntime(next);if(next===address_1.ADDRESS_SYSTEM){if(err instanceof Error)throw err;throw new Error(err.message)}if(mrtime.isNothing())return{value:void 0};var rtime=mrtime.get();var trap=rtime.context.template.trap||function(){return template.ACTION_RAISE};switch(trap(err)){case template.ACTION_IGNORE:return"break-loop";case template.ACTION_RESTART:this_1.runTask(next,this_1.kill(next,next).chain(function(){var eRes=_this.allocate(address_1.getParent(next),rtime.context.template);return eRes.isLeft()?future_1.raise(new Error(eRes.takeLeft().message)):_this.runActor(eRes.takeRight())}));return"break-loop";case template.ACTION_STOP:this_1.runTask(next,this_1.kill(next,next));return"break-loop";default:next=address_1.getParent(next);break}};var this_1=this;loop:while(true){var state_2=_loop_1();if(typeof state_2==="object")return state_2.value;switch(state_2){case"break-loop":break loop}}};PVM.prototype.trigger=function(addr,evt){var args=[];for(var _i=2;_i<arguments.length;_i++){args[_i-2]=arguments[_i]}var elvl=event_1.getLevel(evt);var _a=this.conf.log,level=_a.level,logger=_a.logger;if(level>=elvl){switch(elvl){case log_1.LOG_LEVEL_DEBUG:logger.debug(addr,evt,args);break;case log_1.LOG_LEVEL_INFO:logger.info(addr,evt,args);break;case log_1.LOG_LEVEL_NOTICE:case log_1.LOG_LEVEL_WARN:logger.warn(addr,evt,args);break;case log_1.LOG_LEVEL_ERROR:logger.error(addr,evt,args);break;default:break}}if(this.conf.on[evt]!=null)this.conf.on[evt].apply(null,__spreadArrays([addr,evt],args))};PVM.prototype.logOp=function(r,f,op,oper){if(this.conf.log.level>=log_1.LOG_LEVEL_DEBUG)this.conf.log.logger.debug.apply(null,__spreadArrays(["["+r.context.address+"]","("+f.script.name+")"],op_1.toLog(op,r,f,oper)))};PVM.prototype.kill=function(parent,target){var _this=this;var addrs=address_1.isGroup(target)?this.getGroup(target).orJust(function(){return[]}).get():[target];return scheduleFutures(addrs.map(function(addr){if(!address_1.isChild(parent,target)&&target!==parent)return future_1.raise(new Error("IllegalStopErr: Actor "+parent+" "+("cannot kill non-child "+addr+"!")));var mrun=_this.getRuntime(addr);if(mrun.isNothing())return future_1.pure(undefined);var run=mrun.get();var mchilds=_this.getChildren(target);var childs=mchilds.isJust()?mchilds.get():{};var cwork=record_1.mapTo(record_1.map(childs,function(r,k){return r.die().chain(function(){_this.remove(k);return future_1.pure(undefined)})}),function(f){return f});return scheduleFutures(cwork).chain(function(){return addr===address_1.ADDRESS_SYSTEM?future_1.pure(undefined):run.die()}).chain(function(){_this.trigger(run.context.address,events.EVENT_ACTOR_STOPPED);if(addr!==address_1.ADDRESS_SYSTEM)_this.remove(addr);return future_1.pure(undefined)})}))};PVM.prototype.spawn=function(t){return resident_1.spawn(this.system,this,t)};PVM.prototype.tell=function(ref,m){this.system.exec(this,new scripts.Tell(ref,m));return this};PVM.prototype.execNow=function(i,s){var mslot=getSlot(this.state,i);if(mslot.isNothing()){this.trigger(address_1.ADDRESS_SYSTEM,events.EVENT_EXEC_INSTANCE_STALE);return maybe_1.nothing()}else{var _a=mslot.get(),rtime=_a[1];return new thread_1.Thread(this,rtime.heap,rtime.context).exec(s)}};PVM.prototype.exec=function(i,s){var mslot=getSlot(this.state,i);if(mslot.isNothing()){this.trigger(address_1.ADDRESS_SYSTEM,events.EVENT_EXEC_INSTANCE_STALE)}else{var _a=mslot.get(),addr=_a[0],rtime=_a[1];this.runQ.push([addr,s,rtime]);this.run()}};PVM.prototype.run=function(){var _this=this;if(this.running===true)return;this.running=true;doRun:while(this.running){while(!array_1.empty(this.runQ)){var next=this.runQ.shift();var addr=next[0],script=next[1],rtime=next[2];var mctime=this.getRuntime(addr);if(mctime.isNothing()){this.trigger(addr,events.EVENT_EXEC_ACTOR_GONE)}else if(mctime.get()!==rtime){this.trigger(addr,events.EVENT_EXEC_ACTOR_CHANGED)}else if(array_1.contains(this.blocked,addr)){this.waitQ.push(next)}else{rtime.exec(script)}}var _a=array_1.partition(this.waitQ,function(s){return!array_1.contains(_this.blocked,s[0])}),unblocked=_a[0],blocked=_a[1];this.waitQ=blocked;if(unblocked.length>0){this.runQ=this.runQ.concat(unblocked);continue doRun}this.running=false}};return PVM}();exports.PVM=PVM;var getSlot=function(s,actor){return record_1.reduce(s.runtimes,maybe_1.nothing(),function(p,c,k){return c.context.actor===actor?maybe_1.fromNullable([k,c]):p})};var scheduleFutures=function(work){return future_1.batch(array_1.distribute(work,exports.MAX_WORK_LOAD)).chain(function(){return future_1.pure(undefined)})}},{"../../address":67,"../../flags":68,"../../message":69,"../../resident":71,"../../resident/scripts":72,"../../template":92,"./conf":73,"./event":74,"./log":76,"./runtime/context":77,"./runtime/error":78,"./runtime/heap":79,"./runtime/op":84,"./runtime/thread":87,"./state":90,"@quenk/noni/lib/control/monad/future":54,"@quenk/noni/lib/data/array":57,"@quenk/noni/lib/data/either":59,"@quenk/noni/lib/data/maybe":61,"@quenk/noni/lib/data/record":62,"@quenk/noni/lib/data/type":65}],76:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.LOG_LEVEL_ERROR=exports.LOG_LEVEL_WARN=exports.LOG_LEVEL_NOTICE=exports.LOG_LEVEL_INFO=exports.LOG_LEVEL_DEBUG=void 0;exports.LOG_LEVEL_DEBUG=7;exports.LOG_LEVEL_INFO=6;exports.LOG_LEVEL_NOTICE=5;exports.LOG_LEVEL_WARN=4;exports.LOG_LEVEL_ERROR=3},{}],77:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.newContext=void 0;exports.newContext=function(actor,address,template){return{mailbox:[],actor:actor,receivers:[],flags:0,address:address,template:template}}},{}],78:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.InvalidFunctionErr=exports.InvalidConstructorErr=exports.MissingInfoErr=exports.InvalidPropertyIndex=exports.StackEmptyErr=exports.IntegerOverflowErr=exports.MissingSymbolErr=exports.UnknownAddressErr=exports.EmptyMailboxErr=exports.NoMailboxErr=exports.NoReceiveErr=exports.IllegalStopErr=exports.UnexpectedDataType=exports.NullPointerErr=exports.JumpOutOfBoundsErr=exports.NullFunctionPointerErr=exports.NullTemplatePointerErr=exports.DuplicateAddressErr=exports.UnknownParentAddressErr=exports.InvalidIdErr=exports.Error=void 0;var address_1=require("../../../address");var frame_1=require("./stack/frame");var Error=function(){function Error(message){this.message=message}return Error}();exports.Error=Error;var InvalidIdErr=function(_super){__extends(InvalidIdErr,_super);function InvalidIdErr(id){var _this=_super.call(this,'The id "'+id+" must not contain"+(address_1.ADDRESS_RESTRICTED+" or be an empty string!"))||this;_this.id=id;return _this}return InvalidIdErr}(Error);exports.InvalidIdErr=InvalidIdErr;var UnknownParentAddressErr=function(_super){__extends(UnknownParentAddressErr,_super);function UnknownParentAddressErr(address){var _this=_super.call(this,'The parent address "'+address+'" is not part of the system!')||this;_this.address=address;return _this}return UnknownParentAddressErr}(Error);exports.UnknownParentAddressErr=UnknownParentAddressErr;var DuplicateAddressErr=function(_super){__extends(DuplicateAddressErr,_super);function DuplicateAddressErr(address){var _this=_super.call(this,'Duplicate address "'+address+'" detected!')||this;_this.address=address;return _this}return DuplicateAddressErr}(Error);exports.DuplicateAddressErr=DuplicateAddressErr;var NullTemplatePointerErr=function(_super){__extends(NullTemplatePointerErr,_super);function NullTemplatePointerErr(index){var _this=_super.call(this,'The index "'+index+'" does not exist in the Template table!')||this;_this.index=index;return _this}return NullTemplatePointerErr}(Error);exports.NullTemplatePointerErr=NullTemplatePointerErr;var NullFunctionPointerErr=function(_super){__extends(NullFunctionPointerErr,_super);function NullFunctionPointerErr(index){var _this=_super.call(this,'The index "'+index+'" does not exist in the function table!')||this;_this.index=index;return _this}return NullFunctionPointerErr}(Error);exports.NullFunctionPointerErr=NullFunctionPointerErr;var JumpOutOfBoundsErr=function(_super){__extends(JumpOutOfBoundsErr,_super);function JumpOutOfBoundsErr(location,size){var _this=_super.call(this,'Cannot jump to location "'+location+'"! Max location: '+size+"!")||this;_this.location=location;_this.size=size;return _this}return JumpOutOfBoundsErr}(Error);exports.JumpOutOfBoundsErr=JumpOutOfBoundsErr;var NullPointerErr=function(_super){__extends(NullPointerErr,_super);function NullPointerErr(data){var _this=_super.call(this,"Value: ["+data.toString(16)+"]")||this;_this.data=data;return _this}return NullPointerErr}(Error);exports.NullPointerErr=NullPointerErr;var UnexpectedDataType=function(_super){__extends(UnexpectedDataType,_super);function UnexpectedDataType(expected,got){var _this=_super.call(this,"Expected: "+expected+", Received: "+got)||this;_this.expected=expected;_this.got=got;return _this}return UnexpectedDataType}(Error);exports.UnexpectedDataType=UnexpectedDataType;var IllegalStopErr=function(_super){__extends(IllegalStopErr,_super);function IllegalStopErr(parent,child){var _this=_super.call(this,'The actor at address "'+parent+'" can not kill "'+child+'"!')||this;_this.parent=parent;_this.child=child;return _this}return IllegalStopErr}(Error);exports.IllegalStopErr=IllegalStopErr;var NoReceiveErr=function(_super){__extends(NoReceiveErr,_super);function NoReceiveErr(actor){var _this=_super.call(this,"Actor "+actor+" tried to read without a handler!")||this;_this.actor=actor;return _this}return NoReceiveErr}(Error);exports.NoReceiveErr=NoReceiveErr;var NoMailboxErr=function(_super){__extends(NoMailboxErr,_super);function NoMailboxErr(actor){var _this=_super.call(this,"Actor "+actor+" has no mailbox!")||this;_this.actor=actor;return _this}return NoMailboxErr}(Error);exports.NoMailboxErr=NoMailboxErr;var EmptyMailboxErr=function(_super){__extends(EmptyMailboxErr,_super);function EmptyMailboxErr(){return _super.call(this,"Mailbox empty.")||this}return EmptyMailboxErr}(Error);exports.EmptyMailboxErr=EmptyMailboxErr;var UnknownAddressErr=function(_super){__extends(UnknownAddressErr,_super);function UnknownAddressErr(actor){var _this=_super.call(this,'The system has no actor for address "'+actor+'"!')||this;_this.actor=actor;return _this}return UnknownAddressErr}(Error);exports.UnknownAddressErr=UnknownAddressErr;var MissingSymbolErr=function(_super){__extends(MissingSymbolErr,_super);function MissingSymbolErr(index){var _this=_super.call(this,"Cannot locate symbol at index 0x"+index.toString(16))||this;_this.index=index;return _this}return MissingSymbolErr}(Error);exports.MissingSymbolErr=MissingSymbolErr;var IntegerOverflowErr=function(_super){__extends(IntegerOverflowErr,_super);function IntegerOverflowErr(){return _super.call(this,"DATA_MAX_SAFE_UINT32="+frame_1.DATA_MAX_SAFE_UINT32)||this}return IntegerOverflowErr}(Error);exports.IntegerOverflowErr=IntegerOverflowErr;var StackEmptyErr=function(_super){__extends(StackEmptyErr,_super);function StackEmptyErr(){return _super.call(this,"Stack is empty.")||this}return StackEmptyErr}(Error);exports.StackEmptyErr=StackEmptyErr;var InvalidPropertyIndex=function(_super){__extends(InvalidPropertyIndex,_super);function InvalidPropertyIndex(cons,idx){var _this=_super.call(this,"Constructor: "+cons.name+", index: "+idx)||this;_this.cons=cons;_this.idx=idx;return _this}return InvalidPropertyIndex}(Error);exports.InvalidPropertyIndex=InvalidPropertyIndex;var MissingInfoErr=function(_super){__extends(MissingInfoErr,_super);function MissingInfoErr(idx){var _this=_super.call(this,"No info object index: "+idx+"!")||this;_this.idx=idx;return _this}return MissingInfoErr}(Error);exports.MissingInfoErr=MissingInfoErr;var InvalidConstructorErr=function(_super){__extends(InvalidConstructorErr,_super);function InvalidConstructorErr(name){var _this=_super.call(this,'Named object "'+name+'" cannot be used as a constructor!')||this;_this.name=name;return _this}return InvalidConstructorErr}(Error);exports.InvalidConstructorErr=InvalidConstructorErr;var InvalidFunctionErr=function(_super){__extends(InvalidFunctionErr,_super);function InvalidFunctionErr(name){var _this=_super.call(this,'Named object "'+name+'" cannot be used as a function!')||this;_this.name=name;return _this}return InvalidFunctionErr}(Error);exports.InvalidFunctionErr=InvalidFunctionErr},{"../../../address":67,"./stack/frame":86}],79:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Heap=void 0;var maybe_1=require("@quenk/noni/lib/data/maybe");var type_1=require("@quenk/noni/lib/data/type");var frame_1=require("../stack/frame");var Heap=function(){function Heap(objects,strings){if(objects===void 0){objects=[]}if(strings===void 0){strings=[]}this.objects=objects;this.strings=strings}Heap.prototype.addObject=function(h){return this.objects.push(h)-1|frame_1.DATA_TYPE_HEAP_OBJECT};Heap.prototype.addString=function(value){var idx=this.strings.indexOf(value);if(idx===-1){this.strings.push(value);idx=this.strings.length-1}return idx|frame_1.DATA_TYPE_HEAP_STRING};Heap.prototype.getObject=function(r){return maybe_1.fromNullable(this.objects[r&frame_1.DATA_MASK_VALUE24])};Heap.prototype.getString=function(r){var value=this.strings[r&frame_1.DATA_MASK_VALUE24];return value!=null?value:""};Heap.prototype.getAddress=function(v){if(type_1.isString(v)){return this.addString(v)}else if(type_1.isObject(v)){var idx=this.objects.indexOf(v);return idx!==-1?frame_1.DATA_TYPE_HEAP_OBJECT|idx:0}else if(type_1.isNumber(v)){return v}else{return 0}};Heap.prototype.exists=function(o){return this.objects.some(function(eo){return o===eo})};Heap.prototype.release=function(){this.objects=[];this.strings=[]};return Heap}();exports.Heap=Heap},{"../stack/frame":86,"@quenk/noni/lib/data/maybe":61,"@quenk/noni/lib/data/type":65}],80:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ESArray=exports.ESObject=void 0;var types=require("../../../type");var maybe_1=require("@quenk/noni/lib/data/maybe");var record_1=require("@quenk/noni/lib/data/record");var type_1=require("@quenk/noni/lib/data/type");var type_2=require("../../../type");var ESObject=function(){function ESObject(heap,cons,value){this.heap=heap;this.cons=cons;this.value=value}ESObject.prototype.set=function(idx,value){var key=this.cons.properties[idx];if(key!=null)this.value[key.name]=value};ESObject.prototype.get=function(idx){var prop=this.cons.properties[idx];if(prop==null)return maybe_1.nothing();return marshal(this.heap,prop.type,this.value[prop.name])};ESObject.prototype.getCount=function(){return record_1.count(this.value)};ESObject.prototype.toAddress=function(){return this.heap.getAddress(this)};ESObject.prototype.promote=function(){return this.value};return ESObject}();exports.ESObject=ESObject;var ESArray=function(){function ESArray(heap,cons,value){this.heap=heap;this.cons=cons;this.value=value}ESArray.prototype.set=function(key,value){this.value[key]=value};ESArray.prototype.get=function(idx){return marshal(this.heap,this.cons.elements,this.value[idx])};ESArray.prototype.getCount=function(){return this.value.length};ESArray.prototype.toAddress=function(){return this.heap.getAddress(this)};ESArray.prototype.promote=function(){return this.value.slice()};return ESArray}();exports.ESArray=ESArray;var marshal=function(heap,typ,val){if(val==null)return maybe_1.nothing();switch(type_2.getType(typ.descriptor)){case types.TYPE_UINT8:case types.TYPE_UINT16:case types.TYPE_UINT32:case types.TYPE_INT8:case types.TYPE_INT16:case types.TYPE_INT32:return maybe_1.just(Number(val));case types.TYPE_BOOLEAN:return maybe_1.just(Boolean(val)===true?1:0);case types.TYPE_STRING:heap.addString(String(val));return maybe_1.just(val);case types.TYPE_ARRAY:var ea=new ESArray(heap,typ,Array.isArray(val)?val:[]);if(!heap.exists(ea))heap.addObject(ea);return maybe_1.just(ea);case types.TYPE_OBJECT:var eo=new ESObject(heap,typ,type_1.isObject(val)?val:{});if(!heap.exists(eo))heap.addObject(eo);return maybe_1.just(eo);default:return maybe_1.nothing();break}}},{"../../../type":91,"@quenk/noni/lib/data/maybe":61,"@quenk/noni/lib/data/record":62,"@quenk/noni/lib/data/type":65}],81:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.MAX_INSTRUCTION=exports.OPERAND_RANGE_END=exports.OPERAND_RANGE_START=exports.OPCODE_RANGE_END=exports.OPCODE_RANGE_START=exports.OPERAND_MASK=exports.OPCODE_MASK=void 0;exports.OPCODE_MASK=4278190080;exports.OPERAND_MASK=16777215;exports.OPCODE_RANGE_START=16777216;exports.OPCODE_RANGE_END=4278190080;exports.OPERAND_RANGE_START=0;exports.OPERAND_RANGE_END=16777215;exports.MAX_INSTRUCTION=4294967295},{}],82:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.stop=exports.read=exports.maildq=exports.mailcount=exports.recvcount=exports.recv=exports.send=exports.run=exports.self=exports.alloc=void 0;var error=require("../error");var flags_1=require("../../../../flags");exports.alloc=function(r,f,_){var eTemp=f.popObject();if(eTemp.isLeft())return r.raise(eTemp.takeLeft());var temp=eTemp.takeRight().promote();var eParent=f.popString();if(eParent.isLeft())return r.raise(eParent.takeLeft());var eresult=r.vm.allocate(eParent.takeRight(),temp);if(eresult.isLeft()){r.raise(eresult.takeLeft())}else{f.push(f.heap.addString(eresult.takeRight()))}};exports.self=function(_,f,__){f.pushSelf()};exports.run=function(r,f,_){var eTarget=f.popString();if(eTarget.isLeft())return r.raise(eTarget.takeLeft());var target=eTarget.takeRight();r.vm.runTask(target,r.vm.runActor(target))};exports.send=function(r,f,_){var eMsg=f.popValue();if(eMsg.isLeft())return r.raise(eMsg.takeLeft());var eAddr=f.popString();if(eAddr.isLeft())return r.raise(eAddr.takeLeft());if(r.vm.sendMessage(eAddr.takeRight(),r.context.address,eMsg.takeRight()))f.pushUInt8(1);else f.pushUInt8(0)};exports.recv=function(r,f,_){var einfo=f.popFunction();if(einfo.isLeft())return r.raise(einfo.takeLeft());r.context.receivers.push(einfo.takeRight());if(r.context.mailbox.length>0)r.context.actor.notify()};exports.recvcount=function(r,f,_){f.push(r.context.receivers.length)};exports.mailcount=function(r,f,_){f.push(r.context.mailbox.length)};exports.maildq=function(_,f,__){f.pushMessage()};exports.read=function(r,f,__){var func=flags_1.isImmutable(r.context.flags)?r.context.receivers[0]:r.context.receivers.shift();if(func==null)return r.raise(new error.NoReceiveErr(r.context.address));if(func.foreign===true){var emsg=f.popValue();if(emsg.isLeft())return r.raise(emsg.takeLeft());var msg=emsg.takeRight();r.invokeForeign(f,func,[msg])}else{r.invokeVM(f,func)}};exports.stop=function(r,f,_){var eaddr=f.popString();if(eaddr.isLeft())return r.raise(eaddr.takeLeft());r.kill(eaddr.takeRight())}},{"../../../../flags":68,"../error":78}],83:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.ifneqjmp=exports.ifeqjmp=exports.ifnzjmp=exports.ifzjmp=exports.jmp=exports.raise=exports.call=exports.addui32=exports.ceq=exports.load=exports.store=exports.dup=exports.ldn=exports.lds=exports.pushui32=exports.pushui16=exports.pushui8=exports.nop=void 0;var error=require("../error");var array_1=require("@quenk/noni/lib/data/array");var frame_1=require("../stack/frame");exports.nop=function(_,__,___){};exports.pushui8=function(_,f,oper){f.pushUInt8(oper)};exports.pushui16=function(_,f,oper){f.pushUInt16(oper)};exports.pushui32=function(_,f,oper){f.pushUInt32(oper)};exports.lds=function(_,f,idx){f.pushString(idx)};exports.ldn=function(_,f,idx){f.pushName(idx)};exports.dup=function(_,f,__){f.duplicate()};exports.store=function(_,f,idx){f.locals[idx]=f.pop()};exports.load=function(_,f,idx){var d=f.locals[idx];f.push(d==null?0:d)};exports.ceq=function(r,f,__){var eLhs=f.popValue();var eRhs=f.popValue();if(eLhs.isLeft())return r.raise(eLhs.takeLeft());if(eRhs.isLeft())return r.raise(eRhs.takeLeft());if(eLhs.takeRight()===eRhs.takeRight())f.push(1);else f.push(0)};exports.addui32=function(r,f,_){var val=f.pop()+f.pop();if(val>frame_1.DATA_MAX_SAFE_UINT32)return r.raise(new error.IntegerOverflowErr);f.push(val)};exports.call=function(r,f,_){var einfo=f.popFunction();if(einfo.isLeft())return r.raise(einfo.takeLeft());var fn=einfo.takeRight();if(fn.foreign===true){var args=array_1.make(fn.argc||0,function(){return f.popValue().takeRight()});r.invokeForeign(f,fn,args)}else{r.invokeVM(f,fn)}};exports.raise=function(r,f,_){var emsg=f.popString();r.raise(new Error(emsg.takeRight()))};exports.jmp=function(_,f,oper){f.seek(oper)};exports.ifzjmp=function(_,f,oper){var eValue=f.popValue();if(eValue.isLeft()||eValue.takeRight()===0)f.seek(oper)};exports.ifnzjmp=function(_,f,oper){var eValue=f.popValue();if(eValue.isRight()&&eValue.takeRight()!==0)f.seek(oper)};exports.ifeqjmp=function(r,f,oper){var eLhs=f.popValue();var eRhs=f.popValue();if(eLhs.isLeft())r.raise(eLhs.takeLeft());else if(eRhs.isLeft())r.raise(eRhs.takeLeft());else if(eLhs.takeRight()===eRhs.takeRight())f.seek(oper)};exports.ifneqjmp=function(r,f,oper){var eLhs=f.popValue();var eRhs=f.popValue();if(eLhs.isLeft())r.raise(eLhs.takeLeft());else if(eRhs.isLeft())r.raise(eRhs.takeLeft());else if(eLhs.takeRight()!==eRhs.takeRight())f.seek(oper)}},{"../error":78,"../stack/frame":86,"@quenk/noni/lib/data/array":57}],84:[function(require,module,exports){"use strict";var _a;Object.defineProperty(exports,"__esModule",{value:true});exports.toLog=exports.toName=exports.handlers=exports.opcodes=exports.ARELM=exports.ARLENGTH=exports.GETPROP=exports.STOP=exports.READ=exports.SELF=exports.MAILDQ=exports.MAILCOUNT=exports.RECVCOUNT=exports.RECV=exports.SEND=exports.RUN=exports.ALLOC=exports.IFNEQJMP=exports.IFEQJMP=exports.IFNZJMP=exports.IFZJMP=exports.JMP=exports.RAISE=exports.CALL=exports.ADDUI32=exports.CEQ=exports.LOAD=exports.STORE=exports.DUP=exports.LDN=exports.LDS=exports.PUSHUI32=exports.PUSHUI16=exports.PUSHUI8=exports.NOP=exports.OP_CODE_RANGE_STEP=exports.OP_CODE_RANGE_HIGH=exports.OP_CODE_RANGE_LOW=void 0;var base=require("./base");var actor=require("./actor");var obj=require("./object");var record_1=require("@quenk/noni/lib/data/record");var frame_1=require("../stack/frame");exports.OP_CODE_RANGE_LOW=16777216;exports.OP_CODE_RANGE_HIGH=4278190080;exports.OP_CODE_RANGE_STEP=16777216;exports.NOP=exports.OP_CODE_RANGE_STEP;exports.PUSHUI8=exports.OP_CODE_RANGE_STEP*2;exports.PUSHUI16=exports.OP_CODE_RANGE_STEP*3;exports.PUSHUI32=exports.OP_CODE_RANGE_STEP*4;exports.LDS=exports.OP_CODE_RANGE_STEP*5;exports.LDN=exports.OP_CODE_RANGE_STEP*6;exports.DUP=exports.OP_CODE_RANGE_STEP*15;exports.STORE=exports.OP_CODE_RANGE_STEP*16;exports.LOAD=exports.OP_CODE_RANGE_STEP*20;exports.CEQ=exports.OP_CODE_RANGE_STEP*42;exports.ADDUI32=exports.OP_CODE_RANGE_STEP*52;exports.CALL=exports.OP_CODE_RANGE_STEP*62;exports.RAISE=exports.OP_CODE_RANGE_STEP*63;exports.JMP=exports.OP_CODE_RANGE_STEP*72;exports.IFZJMP=exports.OP_CODE_RANGE_STEP*73;exports.IFNZJMP=exports.OP_CODE_RANGE_STEP*80;exports.IFEQJMP=exports.OP_CODE_RANGE_STEP*81;exports.IFNEQJMP=exports.OP_CODE_RANGE_STEP*82;exports.ALLOC=exports.OP_CODE_RANGE_STEP*92;exports.RUN=exports.OP_CODE_RANGE_STEP*93;exports.SEND=exports.OP_CODE_RANGE_STEP*94;exports.RECV=exports.OP_CODE_RANGE_STEP*95;exports.RECVCOUNT=exports.OP_CODE_RANGE_STEP*96;exports.MAILCOUNT=exports.OP_CODE_RANGE_STEP*97;exports.MAILDQ=exports.OP_CODE_RANGE_STEP*98;exports.SELF=exports.OP_CODE_RANGE_STEP*99;exports.READ=exports.OP_CODE_RANGE_STEP*100;exports.STOP=exports.OP_CODE_RANGE_STEP*101;exports.GETPROP=exports.OP_CODE_RANGE_STEP*110;exports.ARLENGTH=exports.OP_CODE_RANGE_STEP*111;exports.ARELM=exports.OP_CODE_RANGE_STEP*112;exports.opcodes=(_a={},_a[exports.NOP]={name:"nop",handler:base.nop,log:function(){return["nop"]}},_a[exports.PUSHUI8]={name:"pushui8",handler:base.pushui8,log:function(_,__,oper){return["pushui8",oper]}},_a[exports.PUSHUI16]={name:"pushui16",handler:base.pushui16,log:function(_,__,oper){return["pushui16",oper]}},_a[exports.PUSHUI32]={name:"pushui32",handler:base.pushui32,log:function(_,__,oper){return["pushui32",oper]}},_a[exports.LDS]={name:"lds",handler:base.lds,log:function(_,f,oper){return["lds",oper,eToLog(f.resolve(frame_1.DATA_TYPE_STRING|oper))]}},_a[exports.LDN]={name:"ldn",handler:base.ldn,log:function(_,f,oper){return["ldn",oper,eToLog(f.resolve(frame_1.DATA_TYPE_INFO|oper))]}},_a[exports.DUP]={name:"dup",handler:base.dup,log:function(_,__,___){return["dup"]}},_a[exports.STORE]={name:"store",handler:base.store,log:function(_,__,oper){return["store",oper]}},_a[exports.LOAD]={name:"load",handler:base.load,log:function(_,f,oper){return["load",oper,eToLog(f.resolve(frame_1.DATA_TYPE_LOCAL|oper))]}},_a[exports.CEQ]={name:"ceq",handler:base.ceq,log:function(_,__,___){return["ceq"]}},_a[exports.ADDUI32]={name:"addui32",handler:base.addui32,log:function(_,__,___){return["addui32"]}},_a[exports.CALL]={name:"call",handler:base.call,log:function(_,__,___){return["call"]}},_a[exports.RAISE]={name:"raise",handler:base.raise,log:function(_,__,___){return["raise"]}},_a[exports.JMP]={name:"jmp",handler:base.jmp,log:function(_,__,oper){return["jmp",oper]}},_a[exports.IFZJMP]={name:"ifzjmp",handler:base.ifzjmp,log:function(_,__,oper){return["ifzjmp",oper]}},_a[exports.IFNZJMP]={name:"ifnzjmp",handler:base.ifnzjmp,log:function(_,__,oper){return["ifnzjmp",oper]}},_a[exports.IFEQJMP]={name:"ifeqjmp",handler:base.ifeqjmp,log:function(_,__,oper){return["ifeqjmp",oper]}},_a[exports.IFNEQJMP]={name:"ifneqjmp",handler:base.ifneqjmp,log:function(_,__,oper){return["ifneqjmp",oper]}},_a[exports.ALLOC]={name:"alloc",handler:actor.alloc,log:function(_,__,___){return["alloc"]}},_a[exports.RUN]={name:"run",handler:actor.run,log:function(_,__,___){return["run"]}},_a[exports.SEND]={name:"send",handler:actor.send,log:function(_,__,___){return["send"]}},_a[exports.RECV]={name:"recv",handler:actor.recv,log:function(_,f,oper){return["recv",oper,eToLog(f.resolve(frame_1.DATA_TYPE_INFO|oper))]}},_a[exports.RECVCOUNT]={name:"recvcount",handler:actor.recvcount,log:function(_,__,___){return["recvcount"]}},_a[exports.MAILCOUNT]={name:"mailcount",handler:actor.mailcount,log:function(_,__,___){return["mailcount"]}},_a[exports.MAILDQ]={name:"maildq",handler:actor.maildq,log:function(_,__,___){return["maildq"]}},_a[exports.SELF]={name:"self",handler:actor.self,log:function(_,__,___){return["self"]}},_a[exports.READ]={name:"read",handler:actor.read,log:function(_,__,___){return["read"]}},_a[exports.STOP]={name:"stop",handler:actor.stop,log:function(_,__,___){return["stop"]}},_a[exports.GETPROP]={name:"getprop",handler:obj.getprop,log:function(_,__,oper){return["getprop",oper]}},_a[exports.ARELM]={name:"arelm",handler:obj.arelm,log:function(_,__,oper){return["arelm",oper]}},_a[exports.ARLENGTH]={name:"arlength",handler:obj.arlength,log:function(_,__,___){return["arlength"]}},_a);var eToLog=function(e){return e.isLeft()?e.takeLeft().message:e.takeRight()};exports.handlers=record_1.map(exports.opcodes,function(i){return i.handler});exports.toName=function(op){return exports.opcodes.hasOwnProperty(op)?exports.opcodes[op].name:"<unknown>"};exports.toLog=function(op,r,f,oper){return exports.opcodes.hasOwnProperty(op)?exports.opcodes[op].log(r,f,oper):[]}},{"../stack/frame":86,"./actor":82,"./base":83,"./object":85,"@quenk/noni/lib/data/record":62}],85:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.arelm=exports.arlength=exports.getprop=void 0;exports.getprop=function(r,f,idx){var eobj=f.popObject();if(eobj.isLeft())return r.raise(eobj.takeLeft());var obj=eobj.takeRight();var mval=obj.get(idx);if(mval.isJust()){f.push(r.heap.getAddress(mval.get()))}else{f.push(0)}};exports.arlength=function(r,f,_){var eobj=f.popObject();if(eobj.isLeft())return r.raise(eobj.takeLeft());var obj=eobj.takeRight();f.push(obj.getCount())};exports.arelm=function(r,f,_){var earr=f.popObject();if(earr.isLeft())return r.raise(earr.takeLeft());var arr=earr.takeRight();var melm=arr.get(f.pop());if(melm.isJust()){f.push(r.heap.getAddress(melm.get()))}else{f.push(0)}}},{}],86:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.StackFrame=exports.BYTE_CONSTANT_INFO=exports.BYTE_CONSTANT_STR=exports.BYTE_CONSTANT_NUM=exports.DATA_TYPE_SELF=exports.DATA_TYPE_MAILBOX=exports.DATA_TYPE_LOCAL=exports.DATA_TYPE_HEAP_STRING=exports.DATA_TYPE_HEAP_OBJECT=exports.DATA_TYPE_INFO=exports.DATA_TYPE_STRING=exports.DATA_MAX_SAFE_UINT32=exports.DATA_MAX_SIZE=exports.DATA_MASK_VALUE32=exports.DATA_MASK_VALUE24=exports.DATA_MASK_VALUE16=exports.DATA_MASK_VALUE8=exports.DATA_MASK_TYPE=exports.DATA_RANGE_TYPE_STEP=exports.DATA_RANGE_TYPE_LOW=exports.DATA_RANGE_TYPE_HIGH=void 0;var indexes=require("../../script");var error=require("../error");var either_1=require("@quenk/noni/lib/data/either");var maybe_1=require("@quenk/noni/lib/data/maybe");var type_1=require("../../type");exports.DATA_RANGE_TYPE_HIGH=4026531840;exports.DATA_RANGE_TYPE_LOW=16777216;exports.DATA_RANGE_TYPE_STEP=16777216;exports.DATA_MASK_TYPE=4278190080;exports.DATA_MASK_VALUE8=255;exports.DATA_MASK_VALUE16=65535;exports.DATA_MASK_VALUE24=16777215;exports.DATA_MASK_VALUE32=4294967295;exports.DATA_MAX_SIZE=4294967295;exports.DATA_MAX_SAFE_UINT32=2147483647;exports.DATA_TYPE_STRING=exports.DATA_RANGE_TYPE_STEP*3;exports.DATA_TYPE_INFO=exports.DATA_RANGE_TYPE_STEP*4;exports.DATA_TYPE_HEAP_OBJECT=exports.DATA_RANGE_TYPE_STEP*6;exports.DATA_TYPE_HEAP_STRING=exports.DATA_RANGE_TYPE_STEP*7;exports.DATA_TYPE_LOCAL=exports.DATA_RANGE_TYPE_STEP*8;exports.DATA_TYPE_MAILBOX=exports.DATA_RANGE_TYPE_STEP*9;exports.DATA_TYPE_SELF=exports.DATA_RANGE_TYPE_STEP*10;exports.BYTE_CONSTANT_NUM=65536;exports.BYTE_CONSTANT_STR=131072;exports.BYTE_CONSTANT_INFO=196608;var StackFrame=function(){function StackFrame(name,script,context,heap,code,data,locals,ip){if(code===void 0){code=[]}if(data===void 0){data=[]}if(locals===void 0){locals=[]}if(ip===void 0){ip=0}this.name=name;this.script=script;this.context=context;this.heap=heap;this.code=code;this.data=data;this.locals=locals;this.ip=ip}StackFrame.prototype.getPosition=function(){return this.ip};StackFrame.prototype.push=function(d){this.data.push(d);return this};StackFrame.prototype.pushUInt8=function(value){return this.push(value>>>0&exports.DATA_MASK_VALUE8)};StackFrame.prototype.pushUInt16=function(value){return this.push(value>>>0&exports.DATA_MASK_VALUE16)};StackFrame.prototype.pushUInt32=function(value){return this.push(value>>>0)};StackFrame.prototype.pushString=function(idx){return this.push(idx|exports.DATA_TYPE_STRING)};StackFrame.prototype.pushName=function(idx){return this.push(idx|exports.DATA_TYPE_INFO)};StackFrame.prototype.pushMessage=function(){return this.push(0|exports.DATA_TYPE_MAILBOX)};StackFrame.prototype.pushSelf=function(){return this.push(exports.DATA_TYPE_SELF)};StackFrame.prototype.peek=function(n){if(n===void 0){n=0}return maybe_1.fromNullable(this.data.length-(n+1))};StackFrame.prototype.resolve=function(data){var context=this.context;var typ=data&exports.DATA_MASK_TYPE;var value=data&exports.DATA_MASK_VALUE24;switch(typ){case exports.DATA_TYPE_STRING:case exports.DATA_TYPE_HEAP_STRING:this.push(data);return this.popString();case exports.DATA_TYPE_HEAP_OBJECT:this.push(data);return this.popObject();case exports.DATA_TYPE_INFO:this.push(data);return this.popName();case exports.DATA_TYPE_LOCAL:var mRef=maybe_1.fromNullable(this.locals[value]);if(mRef.isNothing())return nullErr(data);return this.resolve(mRef.get());case exports.DATA_TYPE_MAILBOX:if(context.mailbox.length===0)return nullErr(data);return either_1.right(context.mailbox.shift());case exports.DATA_TYPE_SELF:return either_1.right(context.address);default:return either_1.right(value)}};StackFrame.prototype.pop=function(){return this.data.pop()|0};StackFrame.prototype.popValue=function(){return this.data.length===0?either_1.left(new error.StackEmptyErr):this.resolve(this.pop())};StackFrame.prototype.popString=function(){var data=this.pop();var typ=data&exports.DATA_MASK_TYPE;var idx=data&exports.DATA_MASK_VALUE24;if(typ===exports.DATA_TYPE_STRING){var s=this.script.constants[indexes.CONSTANTS_INDEX_STRING][idx];if(s==null)return missingSymbol(data);return either_1.right(s)}else if(typ===exports.DATA_TYPE_HEAP_STRING){return either_1.right(this.heap.getString(idx))}else if(typ===exports.DATA_TYPE_SELF){return either_1.right(this.context.address)}else{return wrongType(exports.DATA_TYPE_STRING,typ)}};StackFrame.prototype.popName=function(){var data=this.pop();var typ=data&exports.DATA_MASK_TYPE;var idx=data&exports.DATA_MASK_VALUE24;if(typ===exports.DATA_TYPE_INFO){var info=this.script.info[idx];if(info==null)return nullErr(data);return either_1.right(info)}else{return wrongType(exports.DATA_TYPE_INFO,data)}};StackFrame.prototype.popFunction=function(){return this.popName().chain(function(nfo){if((nfo.descriptor&type_1.BYTE_TYPE)!==type_1.TYPE_FUN)return notAFunction(nfo.name);return either_1.right(nfo)})};StackFrame.prototype.popObject=function(){var data=this.pop();var typ=data&exports.DATA_MASK_TYPE;var idx=data&exports.DATA_MASK_VALUE24;if(typ===exports.DATA_TYPE_HEAP_OBJECT){var mho=this.heap.getObject(idx);if(mho.isNothing())return nullErr(data);return either_1.right(mho.get())}else{return wrongType(exports.DATA_TYPE_HEAP_OBJECT,typ)}};StackFrame.prototype.duplicate=function(){var top=this.data.pop();this.data.push(top);this.data.push(top);return this};StackFrame.prototype.advance=function(){this.ip=this.ip+1;return this};StackFrame.prototype.seek=function(loc){this.ip=loc;return this};StackFrame.prototype.isFinished=function(){return this.ip>=this.code.length};return StackFrame}();exports.StackFrame=StackFrame;var nullErr=function(data){return either_1.left(new error.NullPointerErr(data))};var wrongType=function(expect,got){return either_1.left(new error.UnexpectedDataType(expect,got))};var notAFunction=function(name){return either_1.left(new error.InvalidFunctionErr(name))};var missingSymbol=function(data){return either_1.left(new error.MissingSymbolErr(data))}},{"../../script":88,"../../type":91,"../error":78,"@quenk/noni/lib/data/either":59,"@quenk/noni/lib/data/maybe":61}],87:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.Thread=void 0;var array_1=require("@quenk/noni/lib/data/array");var maybe_1=require("@quenk/noni/lib/data/maybe");var future_1=require("@quenk/noni/lib/control/monad/future");var frame_1=require("./stack/frame");var op_1=require("./op");var _1=require("./");var Thread=function(){function Thread(vm,heap,context,fstack,rstack,sp){if(fstack===void 0){fstack=[]}if(rstack===void 0){rstack=[]}if(sp===void 0){sp=0}this.vm=vm;this.heap=heap;this.context=context;this.fstack=fstack;this.rstack=rstack;this.sp=sp}Thread.prototype.raise=function(e){this.vm.raise(this.context.address,e)};Thread.prototype.invokeVM=function(p,f){var frm=new frame_1.StackFrame(f.name,p.script,this.context,this.heap,f.code.slice());for(var i=0;i<f.argc;i++)frm.push(p.pop());this.fstack.push(frm);this.sp=this.fstack.length-1};Thread.prototype.invokeForeign=function(p,f,args){var val=f.exec.apply(null,__spreadArrays([this],args));p.push(this.heap.getAddress(val))};Thread.prototype.die=function(){var _this=this;return future_1.pure(undefined).chain(function(){var ret=_this.context.actor.stop();return ret!=null?ret:future_1.pure(undefined)}).chain(function(){_this.heap.release();return future_1.pure(undefined)})};Thread.prototype.kill=function(target){this.vm.runTask(this.context.address,this.vm.kill(this.context.address,target))};Thread.prototype.exec=function(s){this.fstack.push(new frame_1.StackFrame("main",s,this.context,this.heap,s.code.slice()));return this.run()};Thread.prototype.runTask=function(ft){return this.vm.runTask(this.context.address,ft)};Thread.prototype.run=function(){var ret=maybe_1.nothing();while(!array_1.empty(this.fstack)){var sp=this.sp;var frame=this.fstack[sp];if(!array_1.empty(this.rstack))frame.data.push(this.rstack.pop());while(!frame.isFinished()){var pos=frame.getPosition();var next=frame.code[pos]>>>0;var opcode=next&_1.OPCODE_MASK;var operand=next&_1.OPERAND_MASK;this.vm.logOp(this,frame,opcode,operand);op_1.handlers[opcode](this,frame,operand);if(pos===frame.getPosition())frame.advance();if(sp!==this.sp)break}if(sp===this.sp){this.fstack.pop();this.sp--;this.rstack.push(frame.data.pop());if(array_1.empty(this.fstack)){ret=frame.resolve(array_1.tail(this.rstack)).toMaybe()}}}this.heap.release();this.sp=0;return ret};return Thread}();exports.Thread=Thread},{"./":81,"./op":84,"./stack/frame":86,"@quenk/noni/lib/control/monad/future":54,"@quenk/noni/lib/data/array":57,"@quenk/noni/lib/data/maybe":61}],88:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getInfo=exports.PScript=exports.CONSTANTS_INDEX_STRING=exports.CONSTANTS_INDEX_NUMBER=void 0;var either_1=require("@quenk/noni/lib/data/either");var error_1=require("../runtime/error");exports.CONSTANTS_INDEX_NUMBER=0;exports.CONSTANTS_INDEX_STRING=1;var PScript=function(){function PScript(name,constants,info,code){if(constants===void 0){constants=[[],[]]}if(info===void 0){info=[]}if(code===void 0){code=[]}this.name=name;this.constants=constants;this.info=info;this.code=code}return PScript}();exports.PScript=PScript;exports.getInfo=function(s,idx){if(s.info[idx]==null)return either_1.left(new error_1.MissingInfoErr(idx));return either_1.right(s.info[idx])}},{"../runtime/error":78,"@quenk/noni/lib/data/either":59}],89:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.funType=exports.objectType=exports.arrayType=exports.stringType=exports.booleanType=exports.uint32Type=exports.uint16Type=exports.uint8Type=exports.int32Type=exports.int16Type=exports.int8Type=exports.voidType=exports.NewPropInfo=exports.NewArrayTypeInfo=exports.NewTypeInfo=exports.NewForeignFunInfo=exports.NewFunInfo=exports.NewArrayInfo=exports.NewObjectInfo=exports.NewStringInfo=exports.NewBooleanInfo=exports.Int32Info=exports.NewInt16Info=exports.NewInt8Info=exports.NewUInt32Info=exports.NewUInt16Info=exports.NewUInt8Info=exports.VoidInfo=void 0;var types=require("../type");var VoidInfo=function(){function VoidInfo(name){this.name=name;this.type=exports.voidType;this.descriptor=types.TYPE_VOID}return VoidInfo}();exports.VoidInfo=VoidInfo;var NewUInt8Info=function(){function NewUInt8Info(name){this.name=name;this.type=exports.uint8Type;this.descriptor=types.TYPE_UINT8}return NewUInt8Info}();exports.NewUInt8Info=NewUInt8Info;var NewUInt16Info=function(){function NewUInt16Info(name){this.name=name;this.type=exports.uint16Type;this.descriptor=types.TYPE_UINT16}return NewUInt16Info}();exports.NewUInt16Info=NewUInt16Info;var NewUInt32Info=function(){function NewUInt32Info(name){this.name=name;this.type=exports.uint32Type;this.descriptor=types.TYPE_UINT32}return NewUInt32Info}();exports.NewUInt32Info=NewUInt32Info;var NewInt8Info=function(){function NewInt8Info(name){this.name=name;this.type=exports.int8Type;this.descriptor=types.TYPE_INT8}return NewInt8Info}();exports.NewInt8Info=NewInt8Info;var NewInt16Info=function(){function NewInt16Info(name){this.name=name;this.type=exports.int16Type;this.descriptor=types.TYPE_INT16}return NewInt16Info}();exports.NewInt16Info=NewInt16Info;var Int32Info=function(){function Int32Info(name){this.name=name;this.type=exports.int32Type;this.descriptor=types.TYPE_INT32}return Int32Info}();exports.Int32Info=Int32Info;var NewBooleanInfo=function(){function NewBooleanInfo(name){this.name=name;this.type=exports.booleanType;this.descriptor=types.TYPE_BOOLEAN}return NewBooleanInfo}();exports.NewBooleanInfo=NewBooleanInfo;var NewStringInfo=function(){function NewStringInfo(name){this.name=name;this.type=exports.stringType;this.descriptor=types.TYPE_STRING}return NewStringInfo}();exports.NewStringInfo=NewStringInfo;var NewObjectInfo=function(){function NewObjectInfo(name){this.name=name;this.type=exports.objectType;this.descriptor=types.TYPE_OBJECT}return NewObjectInfo}();exports.NewObjectInfo=NewObjectInfo;var NewArrayInfo=function(){function NewArrayInfo(name,type){this.name=name;this.type=type;this.descriptor=types.TYPE_ARRAY}return NewArrayInfo}();exports.NewArrayInfo=NewArrayInfo;var NewFunInfo=function(){function NewFunInfo(name,argc,code){this.name=name;this.argc=argc;this.code=code;this.type=exports.funType;this.descriptor=types.TYPE_FUN;this.foreign=false}return NewFunInfo}();exports.NewFunInfo=NewFunInfo;var NewForeignFunInfo=function(){function NewForeignFunInfo(name,argc,exec){this.name=name;this.argc=argc;this.exec=exec;this.type=exports.funType;this.descriptor=types.TYPE_FUN;this.foreign=true;this.code=[]}return NewForeignFunInfo}();exports.NewForeignFunInfo=NewForeignFunInfo;var NewTypeInfo=function(){function NewTypeInfo(name,argc,properties,descriptor){if(descriptor===void 0){descriptor=types.TYPE_OBJECT}this.name=name;this.argc=argc;this.properties=properties;this.descriptor=descriptor;this.type=exports.funType;this.code=[]}return NewTypeInfo}();exports.NewTypeInfo=NewTypeInfo;var NewArrayTypeInfo=function(){function NewArrayTypeInfo(name,elements){this.name=name;this.elements=elements;this.type=exports.funType;this.argc=0;this.properties=[];this.code=[];this.descriptor=types.TYPE_ARRAY}return NewArrayTypeInfo}();exports.NewArrayTypeInfo=NewArrayTypeInfo;var NewPropInfo=function(){function NewPropInfo(name,type){this.name=name;this.type=type}return NewPropInfo}();exports.NewPropInfo=NewPropInfo;exports.voidType=new NewTypeInfo("void",0,[],types.TYPE_VOID);exports.int8Type=new NewTypeInfo("int8",1,[],types.TYPE_INT8);exports.int16Type=new NewTypeInfo("int16",1,[],types.TYPE_INT16);exports.int32Type=new NewTypeInfo("int32",1,[],types.TYPE_INT32);exports.uint8Type=new NewTypeInfo("uint8",1,[],types.TYPE_UINT8);exports.uint16Type=new NewTypeInfo("uint16",1,[],types.TYPE_UINT16);exports.uint32Type=new NewTypeInfo("uint32",1,[],types.TYPE_UINT32);exports.booleanType=new NewTypeInfo("boolean",1,[],types.TYPE_BOOLEAN);exports.stringType=new NewTypeInfo("string",1,[],types.TYPE_STRING);exports.arrayType=new NewTypeInfo("array",0,[],types.TYPE_ARRAY);exports.objectType=new NewTypeInfo("object",0,[],types.TYPE_OBJECT);exports.funType=new NewTypeInfo("function",0,[],types.TYPE_FUN)},{"../type":91}],90:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.removeMember=exports.putMember=exports.getGroup=exports.removeGroup=exports.removeRoute=exports.putRoute=exports.getRouter=exports.getParent=exports.getChildren=exports.getAddress=exports.remove=exports.put=exports.get=exports.exists=void 0;var maybe_1=require("@quenk/noni/lib/data/maybe");var record_1=require("@quenk/noni/lib/data/record");var string_1=require("@quenk/noni/lib/data/string");var address_1=require("../../address");exports.exists=function(s,addr){return record_1.hasKey(s.runtimes,addr)};exports.get=function(s,addr){return maybe_1.fromNullable(s.runtimes[addr])};exports.put=function(s,addr,r){s.runtimes[addr]=r;return s};exports.remove=function(s,addr){delete s.runtimes[addr];return s};exports.getAddress=function(s,actor){return record_1.reduce(s.runtimes,maybe_1.nothing(),function(p,c,k){return c.context.actor===actor?maybe_1.fromString(k):p})};exports.getChildren=function(s,addr){return addr===address_1.ADDRESS_SYSTEM?record_1.exclude(s.runtimes,address_1.ADDRESS_SYSTEM):record_1.partition(s.runtimes,function(_,key){return string_1.startsWith(key,addr)&&key!==addr})[0]};exports.getParent=function(s,addr){return maybe_1.fromNullable(s.runtimes[address_1.getParent(addr)])};exports.getRouter=function(s,addr){return record_1.reduce(s.routers,maybe_1.nothing(),function(p,k){return string_1.startsWith(addr,k)?maybe_1.fromNullable(s.runtimes[k]):p})};exports.putRoute=function(s,target,router){s.routers[target]=router;return s};exports.removeRoute=function(s,target){delete s.routers[target];return s};exports.removeGroup=function(s,target){delete s.groups[target];return s};exports.getGroup=function(s,name){return s.groups.hasOwnProperty(name)?maybe_1.fromArray(s.groups[name]):maybe_1.nothing()};exports.putMember=function(s,group,member){if(s.groups[group]==null)s.groups[group]=[];s.groups[group].push(member);return s};exports.removeMember=function(s,group,member){if(s.groups[group]!=null)s.groups[group]=s.groups[group].filter(function(m){return m!=member});return s}},{"../../address":67,"@quenk/noni/lib/data/maybe":61,"@quenk/noni/lib/data/record":62,"@quenk/noni/lib/data/string":64}],91:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getType=exports.TYPE_CONS=exports.TYPE_FUN=exports.TYPE_ARRAY=exports.TYPE_OBJECT=exports.TYPE_STRING=exports.TYPE_BOOLEAN=exports.TYPE_INT32=exports.TYPE_INT16=exports.TYPE_INT8=exports.TYPE_UINT32=exports.TYPE_UINT16=exports.TYPE_UINT8=exports.TYPE_VOID=exports.BYTE_INDEX=exports.BYTE_TYPE=exports.TYPE_STEP=void 0;exports.TYPE_STEP=16777216;exports.BYTE_TYPE=4278190080;exports.BYTE_INDEX=16777215;exports.TYPE_VOID=0;exports.TYPE_UINT8=exports.TYPE_STEP;exports.TYPE_UINT16=exports.TYPE_STEP*2;exports.TYPE_UINT32=exports.TYPE_STEP*3;exports.TYPE_INT8=exports.TYPE_STEP*4;exports.TYPE_INT16=exports.TYPE_STEP*5;exports.TYPE_INT32=exports.TYPE_STEP*6;exports.TYPE_BOOLEAN=exports.TYPE_STEP*7;exports.TYPE_STRING=exports.TYPE_STEP*8;exports.TYPE_OBJECT=exports.TYPE_STEP*9;exports.TYPE_ARRAY=exports.TYPE_STEP*10;exports.TYPE_FUN=exports.TYPE_STEP*11;exports.TYPE_CONS=exports.TYPE_STEP*12;exports.getType=function(d){return d&exports.BYTE_TYPE}},{}],92:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.normalize=exports.ACTION_STOP=exports.ACTION_RESTART=exports.ACTION_IGNORE=exports.ACTION_RAISE=void 0;var record_1=require("@quenk/noni/lib/data/record");var address_1=require("./address");exports.ACTION_RAISE=-1;exports.ACTION_IGNORE=0;exports.ACTION_RESTART=1;exports.ACTION_STOP=2;exports.normalize=function(t){return record_1.merge(t,{id:t.id?t.id:address_1.randomID(),children:record_1.isRecord(t.children)?record_1.mapTo(t.children,function(c,k){return record_1.merge(c,{id:k})}):t.children})}},{"./address":67,"@quenk/noni/lib/data/record":62}],93:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var byteToHex=[];for(var i=0;i<256;++i){byteToHex[i]=(i+256).toString(16).substr(1)}function bytesToUuid(buf,offset){var i=offset||0;var bth=byteToHex;return[bth[buf[i++]],bth[buf[i++]],bth[buf[i++]],bth[buf[i++]],"-",bth[buf[i++]],bth[buf[i++]],"-",bth[buf[i++]],bth[buf[i++]],"-",bth[buf[i++]],bth[buf[i++]],"-",bth[buf[i++]],bth[buf[i++]],bth[buf[i++]],bth[buf[i++]],bth[buf[i++]],bth[buf[i++]]].join("")}var _default=bytesToUuid;exports.default=_default;module.exports=exports.default},{}],94:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"v1",{enumerable:true,get:function(){return _v.default}});Object.defineProperty(exports,"v3",{enumerable:true,get:function(){return _v2.default}});Object.defineProperty(exports,"v4",{enumerable:true,get:function(){return _v3.default}});Object.defineProperty(exports,"v5",{enumerable:true,get:function(){return _v4.default}});var _v=_interopRequireDefault(require("./v1.js"));var _v2=_interopRequireDefault(require("./v3.js"));var _v3=_interopRequireDefault(require("./v4.js"));var _v4=_interopRequireDefault(require("./v5.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}},{"./v1.js":98,"./v3.js":99,"./v4.js":101,"./v5.js":102}],95:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;function md5(bytes){if(typeof bytes=="string"){var msg=unescape(encodeURIComponent(bytes));bytes=new Array(msg.length);for(var i=0;i<msg.length;i++)bytes[i]=msg.charCodeAt(i)}return md5ToHexEncodedArray(wordsToMd5(bytesToWords(bytes),bytes.length*8))}function md5ToHexEncodedArray(input){var i;var x;var output=[];var length32=input.length*32;var hexTab="0123456789abcdef";var hex;for(i=0;i<length32;i+=8){x=input[i>>5]>>>i%32&255;hex=parseInt(hexTab.charAt(x>>>4&15)+hexTab.charAt(x&15),16);output.push(hex)}return output}function wordsToMd5(x,len){x[len>>5]|=128<<len%32;x[(len+64>>>9<<4)+14]=len;var i;var olda;var oldb;var oldc;var oldd;var a=1732584193;var b=-271733879;var c=-1732584194;var d=271733878;for(i=0;i<x.length;i+=16){olda=a;oldb=b;oldc=c;oldd=d;a=md5ff(a,b,c,d,x[i],7,-680876936);d=md5ff(d,a,b,c,x[i+1],12,-389564586);c=md5ff(c,d,a,b,x[i+2],17,606105819);b=md5ff(b,c,d,a,x[i+3],22,-1044525330);a=md5ff(a,b,c,d,x[i+4],7,-176418897);d=md5ff(d,a,b,c,x[i+5],12,1200080426);c=md5ff(c,d,a,b,x[i+6],17,-1473231341);b=md5ff(b,c,d,a,x[i+7],22,-45705983);a=md5ff(a,b,c,d,x[i+8],7,1770035416);d=md5ff(d,a,b,c,x[i+9],12,-1958414417);c=md5ff(c,d,a,b,x[i+10],17,-42063);b=md5ff(b,c,d,a,x[i+11],22,-1990404162);a=md5ff(a,b,c,d,x[i+12],7,1804603682);d=md5ff(d,a,b,c,x[i+13],12,-40341101);c=md5ff(c,d,a,b,x[i+14],17,-1502002290);b=md5ff(b,c,d,a,x[i+15],22,1236535329);a=md5gg(a,b,c,d,x[i+1],5,-165796510);d=md5gg(d,a,b,c,x[i+6],9,-1069501632);c=md5gg(c,d,a,b,x[i+11],14,643717713);b=md5gg(b,c,d,a,x[i],20,-373897302);a=md5gg(a,b,c,d,x[i+5],5,-701558691);d=md5gg(d,a,b,c,x[i+10],9,38016083);c=md5gg(c,d,a,b,x[i+15],14,-660478335);b=md5gg(b,c,d,a,x[i+4],20,-405537848);a=md5gg(a,b,c,d,x[i+9],5,568446438);d=md5gg(d,a,b,c,x[i+14],9,-1019803690);c=md5gg(c,d,a,b,x[i+3],14,-187363961);b=md5gg(b,c,d,a,x[i+8],20,1163531501);a=md5gg(a,b,c,d,x[i+13],5,-1444681467);d=md5gg(d,a,b,c,x[i+2],9,-51403784);c=md5gg(c,d,a,b,x[i+7],14,1735328473);b=md5gg(b,c,d,a,x[i+12],20,-1926607734);a=md5hh(a,b,c,d,x[i+5],4,-378558);d=md5hh(d,a,b,c,x[i+8],11,-2022574463);c=md5hh(c,d,a,b,x[i+11],16,1839030562);b=md5hh(b,c,d,a,x[i+14],23,-35309556);a=md5hh(a,b,c,d,x[i+1],4,-1530992060);d=md5hh(d,a,b,c,x[i+4],11,1272893353);c=md5hh(c,d,a,b,x[i+7],16,-155497632);b=md5hh(b,c,d,a,x[i+10],23,-1094730640);a=md5hh(a,b,c,d,x[i+13],4,681279174);d=md5hh(d,a,b,c,x[i],11,-358537222);c=md5hh(c,d,a,b,x[i+3],16,-722521979);b=md5hh(b,c,d,a,x[i+6],23,76029189);a=md5hh(a,b,c,d,x[i+9],4,-640364487);d=md5hh(d,a,b,c,x[i+12],11,-421815835);c=md5hh(c,d,a,b,x[i+15],16,530742520);b=md5hh(b,c,d,a,x[i+2],23,-995338651);a=md5ii(a,b,c,d,x[i],6,-198630844);d=md5ii(d,a,b,c,x[i+7],10,1126891415);c=md5ii(c,d,a,b,x[i+14],15,-1416354905);b=md5ii(b,c,d,a,x[i+5],21,-57434055);a=md5ii(a,b,c,d,x[i+12],6,1700485571);d=md5ii(d,a,b,c,x[i+3],10,-1894986606);c=md5ii(c,d,a,b,x[i+10],15,-1051523);b=md5ii(b,c,d,a,x[i+1],21,-2054922799);a=md5ii(a,b,c,d,x[i+8],6,1873313359);d=md5ii(d,a,b,c,x[i+15],10,-30611744);c=md5ii(c,d,a,b,x[i+6],15,-1560198380);b=md5ii(b,c,d,a,x[i+13],21,1309151649);a=md5ii(a,b,c,d,x[i+4],6,-145523070);d=md5ii(d,a,b,c,x[i+11],10,-1120210379);c=md5ii(c,d,a,b,x[i+2],15,718787259);b=md5ii(b,c,d,a,x[i+9],21,-343485551);a=safeAdd(a,olda);b=safeAdd(b,oldb);c=safeAdd(c,oldc);d=safeAdd(d,oldd)}return[a,b,c,d]}function bytesToWords(input){var i;var output=[];output[(input.length>>2)-1]=undefined;for(i=0;i<output.length;i+=1){output[i]=0}var length8=input.length*8;for(i=0;i<length8;i+=8){output[i>>5]|=(input[i/8]&255)<<i%32}return output}function safeAdd(x,y){var lsw=(x&65535)+(y&65535);var msw=(x>>16)+(y>>16)+(lsw>>16);return msw<<16|lsw&65535}function bitRotateLeft(num,cnt){return num<<cnt|num>>>32-cnt}function md5cmn(q,a,b,x,s,t){return safeAdd(bitRotateLeft(safeAdd(safeAdd(a,q),safeAdd(x,t)),s),b)}function md5ff(a,b,c,d,x,s,t){return md5cmn(b&c|~b&d,a,b,x,s,t)}function md5gg(a,b,c,d,x,s,t){return md5cmn(b&d|c&~d,a,b,x,s,t)}function md5hh(a,b,c,d,x,s,t){return md5cmn(b^c^d,a,b,x,s,t)}function md5ii(a,b,c,d,x,s,t){return md5cmn(c^(b|~d),a,b,x,s,t)}var _default=md5;exports.default=_default;module.exports=exports.default},{}],96:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=rng;var getRandomValues=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);var rnds8=new Uint8Array(16);function rng(){if(!getRandomValues){throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported")}return getRandomValues(rnds8)}module.exports=exports.default},{}],97:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;function f(s,x,y,z){switch(s){case 0:return x&y^~x&z;case 1:return x^y^z;case 2:return x&y^x&z^y&z;case 3:return x^y^z}}function ROTL(x,n){return x<<n|x>>>32-n}function sha1(bytes){var K=[1518500249,1859775393,2400959708,3395469782];var H=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof bytes=="string"){var msg=unescape(encodeURIComponent(bytes));bytes=new Array(msg.length);for(var i=0;i<msg.length;i++)bytes[i]=msg.charCodeAt(i)}bytes.push(128);var l=bytes.length/4+2;var N=Math.ceil(l/16);var M=new Array(N);for(var i=0;i<N;i++){M[i]=new Array(16);for(var j=0;j<16;j++){M[i][j]=bytes[i*64+j*4]<<24|bytes[i*64+j*4+1]<<16|bytes[i*64+j*4+2]<<8|bytes[i*64+j*4+3]}}M[N-1][14]=(bytes.length-1)*8/Math.pow(2,32);M[N-1][14]=Math.floor(M[N-1][14]);M[N-1][15]=(bytes.length-1)*8&4294967295;for(var i=0;i<N;i++){var W=new Array(80);for(var t=0;t<16;t++)W[t]=M[i][t];for(var t=16;t<80;t++){W[t]=ROTL(W[t-3]^W[t-8]^W[t-14]^W[t-16],1)}var a=H[0];var b=H[1];var c=H[2];var d=H[3];var e=H[4];for(var t=0;t<80;t++){var s=Math.floor(t/20);var T=ROTL(a,5)+f(s,b,c,d)+e+K[s]+W[t]>>>0;e=d;d=c;c=ROTL(b,30)>>>0;b=a;a=T}H[0]=H[0]+a>>>0;H[1]=H[1]+b>>>0;H[2]=H[2]+c>>>0;H[3]=H[3]+d>>>0;H[4]=H[4]+e>>>0}return[H[0]>>24&255,H[0]>>16&255,H[0]>>8&255,H[0]&255,H[1]>>24&255,H[1]>>16&255,H[1]>>8&255,H[1]&255,H[2]>>24&255,H[2]>>16&255,H[2]>>8&255,H[2]&255,H[3]>>24&255,H[3]>>16&255,H[3]>>8&255,H[3]&255,H[4]>>24&255,H[4]>>16&255,H[4]>>8&255,H[4]&255]}var _default=sha1;exports.default=_default;module.exports=exports.default},{}],98:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _rng=_interopRequireDefault(require("./rng.js"));var _bytesToUuid=_interopRequireDefault(require("./bytesToUuid.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var _nodeId;var _clockseq;var _lastMSecs=0;var _lastNSecs=0;function v1(options,buf,offset){var i=buf&&offset||0;var b=buf||[];options=options||{};var node=options.node||_nodeId;var clockseq=options.clockseq!==undefined?options.clockseq:_clockseq;if(node==null||clockseq==null){var seedBytes=options.random||(options.rng||_rng.default)();if(node==null){node=_nodeId=[seedBytes[0]|1,seedBytes[1],seedBytes[2],seedBytes[3],seedBytes[4],seedBytes[5]]}if(clockseq==null){clockseq=_clockseq=(seedBytes[6]<<8|seedBytes[7])&16383}}var msecs=options.msecs!==undefined?options.msecs:(new Date).getTime();var nsecs=options.nsecs!==undefined?options.nsecs:_lastNSecs+1;var dt=msecs-_lastMSecs+(nsecs-_lastNSecs)/1e4;if(dt<0&&options.clockseq===undefined){clockseq=clockseq+1&16383}if((dt<0||msecs>_lastMSecs)&&options.nsecs===undefined){nsecs=0}if(nsecs>=1e4){throw new Error("uuid.v1(): Can't create more than 10M uuids/sec")}_lastMSecs=msecs;_lastNSecs=nsecs;_clockseq=clockseq;msecs+=122192928e5;var tl=((msecs&268435455)*1e4+nsecs)%4294967296;b[i++]=tl>>>24&255;b[i++]=tl>>>16&255;b[i++]=tl>>>8&255;b[i++]=tl&255;var tmh=msecs/4294967296*1e4&268435455;b[i++]=tmh>>>8&255;b[i++]=tmh&255;b[i++]=tmh>>>24&15|16;b[i++]=tmh>>>16&255;b[i++]=clockseq>>>8|128;b[i++]=clockseq&255;for(var n=0;n<6;++n){b[i+n]=node[n]}return buf?buf:(0,_bytesToUuid.default)(b)}var _default=v1;exports.default=_default;module.exports=exports.default},{"./bytesToUuid.js":93,"./rng.js":96}],99:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _v=_interopRequireDefault(require("./v35.js"));var _md=_interopRequireDefault(require("./md5.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}const v3=(0,_v.default)("v3",48,_md.default);var _default=v3;exports.default=_default;module.exports=exports.default},{"./md5.js":95,"./v35.js":100}],100:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=_default;exports.URL=exports.DNS=void 0;var _bytesToUuid=_interopRequireDefault(require("./bytesToUuid.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function uuidToBytes(uuid){var bytes=[];uuid.replace(/[a-fA-F0-9]{2}/g,function(hex){bytes.push(parseInt(hex,16))});return bytes}function stringToBytes(str){str=unescape(encodeURIComponent(str));var bytes=new Array(str.length);for(var i=0;i<str.length;i++){bytes[i]=str.charCodeAt(i)}return bytes}const DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8";exports.DNS=DNS;const URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8";exports.URL=URL;function _default(name,version,hashfunc){var generateUUID=function(value,namespace,buf,offset){var off=buf&&offset||0;if(typeof value=="string")value=stringToBytes(value);if(typeof namespace=="string")namespace=uuidToBytes(namespace);if(!Array.isArray(value))throw TypeError("value must be an array of bytes");if(!Array.isArray(namespace)||namespace.length!==16)throw TypeError("namespace must be uuid string or an Array of 16 byte values");var bytes=hashfunc(namespace.concat(value));bytes[6]=bytes[6]&15|version;bytes[8]=bytes[8]&63|128;if(buf){for(var idx=0;idx<16;++idx){buf[off+idx]=bytes[idx]}}return buf||(0,_bytesToUuid.default)(bytes)};try{generateUUID.name=name}catch(err){}generateUUID.DNS=DNS;generateUUID.URL=URL;return generateUUID}},{"./bytesToUuid.js":93}],101:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _rng=_interopRequireDefault(require("./rng.js"));var _bytesToUuid=_interopRequireDefault(require("./bytesToUuid.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function v4(options,buf,offset){var i=buf&&offset||0;if(typeof options=="string"){buf=options==="binary"?new Array(16):null;options=null}options=options||{};var rnds=options.random||(options.rng||_rng.default)();rnds[6]=rnds[6]&15|64;rnds[8]=rnds[8]&63|128;if(buf){for(var ii=0;ii<16;++ii){buf[i+ii]=rnds[ii]}}return buf||(0,_bytesToUuid.default)(rnds)}var _default=v4;exports.default=_default;module.exports=exports.default},{"./bytesToUuid.js":93,"./rng.js":96}],102:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.default=void 0;var _v=_interopRequireDefault(require("./v35.js"));var _sha=_interopRequireDefault(require("./sha1.js"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}const v5=(0,_v.default)("v5",80,_sha.default);var _default=v5;exports.default=_default;module.exports=exports.default},{"./sha1.js":97,"./v35.js":100}],103:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Caret=exports.CARET=void 0;var views=require("./wml/caret");var wml_1=require("@quenk/wml");var util_1=require("../../util");exports.CARET="ww-caret";var Caret=function(_super){__extends(Caret,_super);function Caret(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.Main(_this);_this.values={root:{id:_this.attrs.ww&&_this.attrs.ww.id?_this.attrs.ww.id:"",className:util_1.concat(exports.CARET,_this.attrs.ww&&_this.attrs.ww.className?_this.attrs.ww.className:"")}};return _this}return Caret}(wml_1.Component);exports.Caret=Caret},{"../../util":154,"./wml/caret":104,"@quenk/wml":156}],104:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("span",{id:__context.values.root.id,class:__context.values.root.className},[])}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"@quenk/noni/lib/data/maybe":61,"@quenk/wml/lib/dom":155}],105:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Link=exports.LinkClickedEvent=exports.LINK=void 0;var wml=require("@quenk/wml");var views=require("./wml/link");var util_1=require("../../util");var active_1=require("../state/active");exports.LINK="ww-link";var LinkClickedEvent=function(){function LinkClickedEvent(name,href){this.name=name;this.href=href}return LinkClickedEvent}();exports.LinkClickedEvent=LinkClickedEvent;var Link=function(_super){__extends(Link,_super);function Link(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.Main(_this);_this.name=_this.attrs.ww&&_this.attrs.ww.name?_this.attrs.ww.name:"";_this.title=_this.attrs.ww&&_this.attrs.ww.title?_this.attrs.ww.title:"";_this.href=_this.attrs.ww&&_this.attrs.ww.href?_this.attrs.ww.href:"";_this.values={a:{id:_this.attrs.ww&&_this.attrs.ww.id?_this.attrs.ww.id:"",disabled:_this.attrs.ww&&_this.attrs.ww.disabled?_this.attrs.ww.disabled:null,className:util_1.concat(exports.LINK,_this.attrs.ww&&_this.attrs.ww.className?_this.attrs.ww.className:"",_this.attrs.ww&&_this.attrs.ww.active?active_1.ACTIVE:""),title:_this.attrs.ww&&_this.attrs.ww.title?_this.attrs.ww.title:null,name:_this.attrs.ww&&_this.attrs.ww.name?_this.attrs.ww.name:null,href:_this.attrs.ww&&_this.attrs.ww.href?_this.attrs.ww.href:"#",active:_this.attrs.ww&&_this.attrs.ww.active?_this.attrs.ww.active:false,content:_this.attrs.ww&&_this.attrs.ww.text?[document.createTextNode(_this.attrs.ww.text)]:_this.children,clicked:function(e){if(_this.attrs.ww){var _a=_this.attrs.ww,name_1=_a.name,href=_a.href,onClick=_a.onClick;if(!href)e.preventDefault();if(onClick)onClick(new LinkClickedEvent(name_1,href))}}}};return _this}Link.prototype.activate=function(){var m=util_1.getById(this.view,this.values.a.id);if(m.isJust()){var e=m.get();e.classList.remove(active_1.ACTIVE);e.classList.add(active_1.ACTIVE)}return this};Link.prototype.deactivate=function(){var m=util_1.getById(this.view,this.values.a.id);if(m.isJust())m.get().classList.remove(active_1.ACTIVE);return this};return Link}(wml.Component);exports.Link=Link},{"../../util":154,"../state/active":109,"./wml/link":106,"@quenk/wml":156}],106:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("a",{id:__context.values.a.id,class:__context.values.a.className,href:__context.values.a.href,title:__context.values.a.title,disabled:__context.values.a.disabled,onclick:__context.values.a.clicked},__spreadArrays(__context.values.a.content))}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"@quenk/noni/lib/data/maybe":61,"@quenk/wml/lib/dom":155}],107:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getBlockClassName=exports.BOTTOM=exports.MIDDLE=exports.HORIZONTAL=exports.RIGHT=exports.LEFT=exports.JUSTIFIED=exports.CLEARFIX=exports.BLOCK=exports.POSITIONED=exports.PUSHABLE=exports.VERTICAL=void 0;exports.VERTICAL="-vertical";exports.PUSHABLE="-pushable";exports.POSITIONED="-positioned";exports.BLOCK="-block";exports.CLEARFIX="-clearfix";exports.JUSTIFIED="-justified";exports.LEFT="-left";exports.RIGHT="-right";exports.HORIZONTAL="-horizontal";exports.MIDDLE="-middle";exports.BOTTOM="-bottom";exports.getBlockClassName=function(attrs){return attrs.ww&&attrs.ww.block===true?exports.BLOCK:""}},{}],108:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getSizeClassName=exports.Size=exports.EXTRA_LARGE=exports.LARGE=exports.MEDIUM=exports.SMALL=exports.EXTRA_SMALL=void 0;exports.EXTRA_SMALL="-extra-small";exports.SMALL="-small";exports.MEDIUM="-medium";exports.LARGE="-large";exports.EXTRA_LARGE="-extra-large";var Size;(function(Size){Size["ExtraSmall"]="extra-small";Size["Small"]="small";Size["Medium"]="medium";Size["Large"]="large";Size["ExtraLarge"]="extra-large"})(Size=exports.Size||(exports.Size={}));exports.getSizeClassName=function(s){if(s===Size.ExtraSmall)return exports.EXTRA_SMALL;else if(s===Size.Small)return exports.SMALL;else if(s===Size.Medium)return exports.MEDIUM;else if(s===Size.Large)return exports.LARGE;else if(s===Size.ExtraLarge)return exports.EXTRA_LARGE;return""}},{}],109:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.isActive=exports.deactivate=exports.activate=exports.ACTIVE=void 0;var util_1=require("../../util");exports.ACTIVE="-active";exports.activate=function(view,id){return util_1.getById(view,id).map(function(e){e.classList.remove(exports.ACTIVE);e.classList.add(exports.ACTIVE)})};exports.deactivate=function(view,id){return util_1.getById(view,id).map(function(e){return e.classList.remove(exports.ACTIVE)})};exports.isActive=function(view,id){return util_1.getById(view,id).map(function(e){return e.classList.contains(exports.ACTIVE)}).orJust(function(){return false}).get()}},{"../../util":154}],110:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.toggle=exports.show=exports.hide=exports.isHidden=exports.HIDDEN=void 0;var util_1=require("../../util");exports.HIDDEN="-ww-hidden";exports.isHidden=function(view,id){var m=view.findById(id);if(m.isNothing()){util_1.warnMissing(view,id);return true}else{return m.get().classList.contains(exports.HIDDEN)}};exports.hide=function(view,id){var m=view.findById(id);if(m.isNothing()){return util_1.warnMissing(view,id)}else{var e=m.get();e.classList.remove(exports.HIDDEN);e.classList.add(exports.HIDDEN)}};exports.show=function(view,id){var m=view.findById(id);if(m.isNothing()){return util_1.warnMissing(view,id)}else{m.get().classList.remove(exports.HIDDEN)}};exports.toggle=function(view,id){var m=view.findById(id);if(m.isNothing()){return util_1.warnMissing(view,id)}else{m.get().classList.toggle(exports.HIDDEN)}}},{"../../util":154}],111:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getStyleClassName=exports.styles=exports.Style=exports.OUTLINE=exports.ERROR=exports.WARNING=exports.INFO=exports.SUCCESS=exports.PRIMARY=exports.DEFAULT=void 0;exports.DEFAULT="-default";exports.PRIMARY="-primary";exports.SUCCESS="-success";exports.INFO="-info";exports.WARNING="-warning";exports.ERROR="-error";exports.OUTLINE="-outline";var Style;(function(Style){Style["Default"]="default";Style["Primary"]="primary";Style["Success"]="success";Style["Info"]="info";Style["Warning"]="warning";Style["Error"]="error"})(Style=exports.Style||(exports.Style={}));exports.styles=[Style.Default,Style.Success,Style.Info,Style.Warning,Style.Error];exports.getStyleClassName=function(s){switch(s){case Style.Default:return exports.DEFAULT;case Style.Primary:return exports.PRIMARY;case Style.Success:return exports.SUCCESS;case Style.Info:return exports.INFO;case Style.Warning:return exports.WARNING;case Style.Error:return exports.ERROR}return exports.DEFAULT}},{}],112:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.ButtonGroup=exports.BUTTON_GROUP_COMPAT=exports.BUTTON_GROUP_BUTTON=exports.BUTTON_GROUP=void 0;var views=require("./wml/button-group");var wml_1=require("@quenk/wml");var util_1=require("../../util");var toolbar_1=require("../toolbar");var __1=require("../../");exports.BUTTON_GROUP="ww-button-group";exports.BUTTON_GROUP_BUTTON="ww-button-group__button";exports.BUTTON_GROUP_COMPAT="ww-button-group-compat";var ButtonGroup=function(_super){__extends(ButtonGroup,_super);function ButtonGroup(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.Main(_this);_this.values={root:{id:__1.getId(_this.attrs),className:util_1.concat(exports.BUTTON_GROUP,toolbar_1.TOOLBAR_COMPAT,__1.getClassName(_this.attrs))}};return _this}return ButtonGroup}(wml_1.Component);exports.ButtonGroup=ButtonGroup},{"../../":139,"../../util":154,"../toolbar":130,"./wml/button-group":113,"@quenk/wml":156}],113:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{id:__context.values.root.id,class:__context.values.root.className},__spreadArrays(__context.children))}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"@quenk/noni/lib/data/maybe":61,"@quenk/wml/lib/dom":155}],114:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Button=exports.ButtonClickedEvent=exports.BUTTON=exports.Style=void 0;var views=require("./wml/button");var dom_1=require("@quenk/wml/lib/dom");var toolbar_1=require("../toolbar");var active_1=require("../../content/state/active");var orientation_1=require("../../content/orientation");var style_1=require("../../content/style");Object.defineProperty(exports,"Style",{enumerable:true,get:function(){return style_1.Style}});var size_1=require("../../content/size");var util_1=require("../../util");var __1=require("../../");var __2=require("../");exports.BUTTON="ww-button";var ButtonClickedEvent=function(_super){__extends(ButtonClickedEvent,_super);function ButtonClickedEvent(){return _super!==null&&_super.apply(this,arguments)||this}return ButtonClickedEvent}(__2.Event);exports.ButtonClickedEvent=ButtonClickedEvent;var Button=function(_super){__extends(Button,_super);function Button(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=_this.attrs.ww&&_this.attrs.ww.anchor?new views.AnchorView(_this):new views.ButtonView(_this);_this.values={button:{wml:{id:"button"},id:__1.getId(_this.attrs),className:util_1.concat(exports.BUTTON,__1.getClassName(_this.attrs),toolbar_1.TOOLBAR_COMPAT,_this.attrs.ww&&_this.attrs.ww.style?style_1.getStyleClassName(_this.attrs.ww.style):style_1.DEFAULT,_this.attrs.ww&&_this.attrs.ww.size?size_1.getSizeClassName(_this.attrs.ww.size):"",_this.attrs.ww&&_this.attrs.ww.outline?style_1.OUTLINE:"",_this.attrs.ww&&_this.attrs.ww.block?orientation_1.BLOCK:"",_this.attrs.ww&&_this.attrs.ww.active?active_1.ACTIVE:""),type:_this.attrs.ww&&_this.attrs.ww.type?_this.attrs.ww.type:"button",name:_this.attrs.ww&&_this.attrs.ww.name?_this.attrs.ww.name:"",disabled:_this.attrs.ww&&_this.attrs.ww.disabled?true:null,anchor:_this.attrs.ww&&_this.attrs.ww.anchor?_this.attrs.ww.anchor:false,onclick:function(e){e.preventDefault();_this.attrs.ww&&_this.attrs.ww.onClick&&_this.attrs.ww.onClick(new ButtonClickedEvent(_this.attrs.ww&&_this.attrs.ww.name?_this.attrs.ww.name:"",_this.attrs.ww.value))},content:function(){return _this.attrs.ww&&_this.attrs.ww.text?[dom_1.text(_this.attrs.ww.text)]:_this.children}}};return _this}Button.prototype.disable=function(){util_1.getById(this.view,this.values.button.wml.id).map(function(b){return b.setAttribute("disabled","disabled")})};Button.prototype.enable=function(){util_1.getById(this.view,this.values.button.wml.id).map(function(b){return b.removeAttribute("disabled")})};Button.prototype.toggle=function(){var _this=this;util_1.getById(this.view,this.values.button.wml.id).map(function(b){return b.hasAttribute("disabled")?_this.enable():_this.disable()})};return Button}(__2.AbstractControl);exports.Button=Button},{"../":123,"../../":139,"../../content/orientation":107,"../../content/size":108,"../../content/state/active":109,"../../content/style":111,"../../util":154,"../toolbar":130,"./wml/button":115,"@quenk/wml/lib/dom":155}],115:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.AnchorView=exports.ButtonView=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var ButtonView=function(){function ButtonView(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("button",{wml:{id:__context.values.button.wml.id},id:__context.values.button.id,type:__context.values.button.type,name:__context.values.button.name,disabled:__context.values.button.disabled,class:__context.values.button.className,onclick:__context.values.button.onclick},__spreadArrays(__context.values.button.content()))}}ButtonView.prototype.registerView=function(v){this.views.push(v);return v};ButtonView.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};ButtonView.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};ButtonView.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};ButtonView.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};ButtonView.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};ButtonView.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};ButtonView.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return ButtonView}();exports.ButtonView=ButtonView;var AnchorView=function(){function AnchorView(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("a",{wml:{id:__context.values.button.wml.id},id:__context.values.button.id,type:__context.values.button.type,href:"#",name:__context.values.button.name,disabled:__context.values.button.disabled,class:__context.values.button.className,onclick:__context.values.button.onclick},__spreadArrays(__context.values.button.content()))}}AnchorView.prototype.registerView=function(v){this.views.push(v);return v};AnchorView.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};AnchorView.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};AnchorView.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};AnchorView.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};AnchorView.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};AnchorView.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};AnchorView.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return AnchorView}();exports.AnchorView=AnchorView},{"@quenk/noni/lib/data/maybe":61,"@quenk/wml/lib/dom":155}],116:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.DropDown=exports.DROP_DOWN_CONTENT=exports.DROP_DOWN_TOGGLE=exports.DROP_DOWN=void 0;var views=require("./wml/drop-down");var hidden=require("../../content/state/hidden");var style=require("../../content/style");var wml_1=require("@quenk/wml");var button_group_1=require("../button-group");var util_1=require("../../util");var __1=require("../../");exports.DROP_DOWN="ww-drop-down-menu";exports.DROP_DOWN_TOGGLE="ww-drop-down-menu__toggle";exports.DROP_DOWN_CONTENT="ww-drop-down__content";var DropDown=function(_super){__extends(DropDown,_super);function DropDown(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.Main(_this);_this.values={root:{wml:{id:"root"},id:__1.getId(_this.attrs),className:util_1.concat(exports.DROP_DOWN,button_group_1.BUTTON_GROUP_COMPAT,__1.getClassName(_this.attrs))},button:{text:_this.attrs.ww&&_this.attrs.ww.buttonText?_this.attrs.ww.buttonText:"",anchor:_this.attrs.ww&&_this.attrs.ww.anchor?_this.attrs.ww.anchor:false,className:util_1.concat(exports.DROP_DOWN_TOGGLE,style.DEFAULT,_this.attrs.ww&&_this.attrs.ww.buttonClassName?_this.attrs.ww.buttonClassName:""),disabled:_this.attrs.ww&&_this.attrs.ww.disabled?_this.attrs.ww.disabled:undefined,template:function(){return _this.attrs.ww&&_this.attrs.ww.buttonTemplate?_this.attrs.ww.buttonTemplate:views.button},onClick:function(){var mayRoot=util_1.getById(_this.view,_this.values.root.wml.id);if(mayRoot.isJust()){var e=mayRoot.get();if(_this.values.content.autoClose){var hide=_this.values.content.hide;for(var i=0;i<e.children.length;i++){e.children[i].removeEventListener("click",hide);e.children[i].addEventListener("click",hide)}}_this.toggle();window.addEventListener("click",_this)}}},content:{wml:{id:"content"},className:util_1.concat(exports.DROP_DOWN_CONTENT,hidden.HIDDEN),autoClose:_this.attrs.ww&&_this.attrs.ww.autoClose===false?false:true,render:function(){return _this.children},hide:function(){return _this.hide()}}};return _this}DropDown.prototype.isHidden=function(){return hidden.isHidden(this.view,this.values.content.wml.id)};DropDown.prototype.hide=function(){hidden.hide(this.view,this.values.content.wml.id);return this};DropDown.prototype.show=function(){hidden.show(this.view,this.values.content.wml.id);return this};DropDown.prototype.toggle=function(){hidden.toggle(this.view,this.values.content.wml.id);return this};DropDown.prototype.handleEvent=function(e){var _this=this;util_1.getById(this.view,this.values.root.wml.id).map(function(root){if(!document.body.contains(root))document.removeEventListener("click",_this);if(!root.contains(e.target))_this.hide()})};return DropDown}(wml_1.Component);exports.DropDown=DropDown},{"../../":139,"../../content/state/hidden":110,"../../content/style":111,"../../util":154,"../button-group":112,"./wml/drop-down":117,"@quenk/wml":156}],117:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.Main=exports.button=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var button_1=require("../../button");var caret_1=require("../../../content/caret");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};exports.button=function(d){return function(__this){return[__this.widget(new button_1.Button({ww:{className:d.values.button.className,anchor:d.values.button.anchor,disabled:d.values.button.disabled,onClick:d.values.button.onClick}},[text(d.values.button.text+" "),__this.widget(new caret_1.Caret({},[]),{})]),{ww:{className:d.values.button.className,anchor:d.values.button.anchor,disabled:d.values.button.disabled,onClick:d.values.button.onClick}})]}};var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{wml:{id:__context.values.root.wml.id},class:__context.values.root.className},__spreadArrays(__context.values.button.template()(__context)(__this),[__this.node("div",{wml:{id:__context.values.content.wml.id},class:__context.values.content.className},__spreadArrays(__context.values.content.render()))]))}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"../../../content/caret":103,"../../button":114,"@quenk/noni/lib/data/maybe":61,"@quenk/wml/lib/dom":155}],118:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.validationState2ClassName=exports.getMessage=exports.getValidityClassName=exports.getValidationState=exports.removeValidationState=exports.setValidationState=exports.removeMessage=exports.setMessage=exports.AbstractFeedbackControl=exports.ValidationState=void 0;var style=require("../content/style");var util_1=require("../util");var control_1=require("../control");var ValidationState;(function(ValidationState){ValidationState["Neutral"]="neutral";ValidationState["Error"]="error";ValidationState["Success"]="success";ValidationState["Warning"]="warning"})(ValidationState=exports.ValidationState||(exports.ValidationState={}));var AbstractFeedbackControl=function(_super){__extends(AbstractFeedbackControl,_super);function AbstractFeedbackControl(){return _super!==null&&_super.apply(this,arguments)||this}AbstractFeedbackControl.prototype.setMessage=function(msg){exports.setMessage(this.view,this.values.messages.wml.id,msg);return this};AbstractFeedbackControl.prototype.removeMessage=function(){exports.removeMessage(this.view,this.values.messages.wml.id);return this};AbstractFeedbackControl.prototype.setValidationState=function(state){exports.setValidationState(this.view,this.values.control.wml.id,state);return this};AbstractFeedbackControl.prototype.removeValidationState=function(){exports.removeValidationState(this.view,this.values.control.wml.id);return this};AbstractFeedbackControl.prototype.getValidationState=function(){return exports.getValidationState(this.view,this.values.control.wml.id)};return AbstractFeedbackControl}(control_1.AbstractControl);exports.AbstractFeedbackControl=AbstractFeedbackControl;exports.setMessage=function(view,id,msg){return util_1.getById(view,id).map(function(messages){var node=document.createTextNode(msg);while(messages.lastChild)messages.removeChild(messages.lastChild);messages.appendChild(node)})};exports.removeMessage=function(view,id){return util_1.getById(view,id).map(function(messages){while(messages.lastChild)messages.removeChild(messages.lastChild)})};exports.setValidationState=function(view,id,state){exports.removeValidationState(view,id);if(state!==ValidationState.Neutral)util_1.getById(view,id).map(function(e){return e.classList.add(exports.validationState2ClassName(state))})};exports.removeValidationState=function(view,id){util_1.getById(view,id).map(function(h){h.classList.remove(style.SUCCESS);h.classList.remove(style.ERROR);h.classList.remove(style.WARNING)})};exports.getValidationState=function(view,id){return util_1.getById(view,id).map(function(h){if(h.classList.contains(style.SUCCESS))return ValidationState.Success;else if(h.classList.contains(style.WARNING))return ValidationState.Warning;else if(h.classList.contains(style.ERROR))return ValidationState.Error;else return ValidationState.Neutral}).get()};exports.getValidityClassName=function(attrs){if(attrs.ww){if(attrs.ww.error&&attrs.ww.error!="")return style.ERROR;if(attrs.ww.warning&&attrs.ww.warning!="")return style.WARNING;if(attrs.ww.success&&attrs.ww.success!="")return style.SUCCESS}return""};exports.getMessage=function(attrs){if(attrs.ww){if(attrs.ww.error&&attrs.ww.error!="")return attrs.ww.error;if(attrs.ww.warning&&attrs.ww.warning!="")return attrs.ww.warning;if(attrs.ww.success&&attrs.ww.success!="")return attrs.ww.success;if(attrs.ww.message&&attrs.ww.message!="")return attrs.ww.message}return""};exports.validationState2ClassName=function(state){if(state===ValidationState.Success)return style.SUCCESS;else if(state===ValidationState.Warning)return style.WARNING;else if(state===ValidationState.Error)return style.ERROR;else return""}},{"../content/style":111,"../control":123,"../util":154}],119:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.focus=exports.FocusLostEvent=exports.FocusGainedEvent=void 0;var util_1=require("../util");var FocusGainedEvent=function(){function FocusGainedEvent(name){this.name=name}return FocusGainedEvent}();exports.FocusGainedEvent=FocusGainedEvent;var FocusLostEvent=function(){function FocusLostEvent(name){this.name=name}return FocusLostEvent}();exports.FocusLostEvent=FocusLostEvent;exports.focus=function(view,id){util_1.getById(view,id).map(function(e){return e.focus()})}},{"../util":154}],120:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.removeMessage=exports.setMessage=exports.getLabel=exports.AbstractFormControl=void 0;var util_1=require("../util");var feedback_1=require("./feedback");var AbstractFormControl=function(_super){__extends(AbstractFormControl,_super);function AbstractFormControl(){return _super!==null&&_super.apply(this,arguments)||this}return AbstractFormControl}(feedback_1.AbstractFeedbackControl);exports.AbstractFormControl=AbstractFormControl;exports.getLabel=function(attrs){return attrs.ww&&attrs.ww.label?attrs.ww.label:""};exports.setMessage=function(view,id,msg){util_1.getById(view,id).map(function(h){h.setMessage(msg)})};exports.removeMessage=function(view,id){util_1.getById(view,id).map(function(h){h.removeMessage()})}},{"../util":154,"./feedback":118}],121:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Help=exports.HELP=void 0;var wml_1=require("@quenk/wml");var util_1=require("../../util");var feedback_1=require("../feedback");var __1=require("../../");var help_1=require("./wml/help");exports.HELP="ww-help";var Help=function(_super){__extends(Help,_super);function Help(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new help_1.Main(_this);_this.values={help:{wml:{id:"help"},id:_this.attrs.ww&&_this.attrs.ww.id?_this.attrs.ww.id:"",className:util_1.concat(exports.HELP,__1.getClassName(_this.attrs)),text:_this.attrs.ww&&_this.attrs.ww.text?[document.createTextNode(_this.attrs.ww.text)]:_this.children}};return _this}Help.prototype.setMessage=function(msg){feedback_1.setMessage(this.view,this.values.help.wml.id,msg);return this};Help.prototype.removeMessage=function(){feedback_1.removeMessage(this.view,this.values.help.wml.id);return this};return Help}(wml_1.Component);exports.Help=Help},{"../../":139,"../../util":154,"../feedback":118,"./wml/help":122,"@quenk/wml":156}],122:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("span",{wml:{id:__context.values.help.wml.id},id:__context.values.help.id,class:__context.values.help.className},__spreadArrays(__context.values.help.text))}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"@quenk/noni/lib/data/maybe":61,"@quenk/wml/lib/dom":155}],123:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.getValue=exports.getDisabled=exports.getName=exports.AbstractControl=exports.Event=void 0;var wml_1=require("@quenk/wml");var maybe_1=require("@quenk/noni/lib/data/maybe");var Event=function(){function Event(name,value){this.name=name;this.value=value}return Event}();exports.Event=Event;var AbstractControl=function(_super){__extends(AbstractControl,_super);function AbstractControl(){return _super!==null&&_super.apply(this,arguments)||this}return AbstractControl}(wml_1.Component);exports.AbstractControl=AbstractControl;exports.getName=function(attrs){return attrs.ww&&attrs.ww.name?attrs.ww.name:""};exports.getDisabled=function(attrs){return attrs.ww&&attrs.ww.disabled?attrs.ww.disabled:undefined};exports.getValue=function(attrs){return attrs.ww&&attrs.ww.value?maybe_1.just(attrs.ww.value):maybe_1.nothing()}},{"@quenk/noni/lib/data/maybe":61,"@quenk/wml":156}],124:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Label=exports.LABEL=void 0;var wml_1=require("@quenk/wml");var util_1=require("../../util");var __1=require("../../");var label_1=require("./wml/label");exports.LABEL="ww-label";var Label=function(_super){__extends(Label,_super);function Label(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new label_1.Main(_this);_this.values={label:{className:util_1.concat(exports.LABEL,__1.getClassName(_this.attrs)),for:_this.attrs.ww&&_this.attrs.ww.for?_this.attrs.ww.for:"",text:_this.attrs.ww&&_this.attrs.ww.text?[document.createTextNode(_this.attrs.ww.text)]:_this.children}};return _this}return Label}(wml_1.Component);exports.Label=Label},{"../../":139,"../../util":154,"./wml/label":125,"@quenk/wml":156}],125:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("label",{for:__context.values.label.for,class:__context.values.label.className},__spreadArrays(__context.values.label.text))}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"@quenk/noni/lib/data/maybe":61,"@quenk/wml/lib/dom":155}],126:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.TextField=exports.TEXT_FIELD=exports.TextChangedEvent=void 0;var views=require("./wml/text-field");var util_1=require("../../util");var feedback_1=require("../feedback");var form_1=require("../form");var text_input_1=require("../text-input");Object.defineProperty(exports,"TextChangedEvent",{enumerable:true,get:function(){return text_input_1.TextChangedEvent}});var __1=require("../../");var __2=require("../");exports.TEXT_FIELD="ww-text-field";var TextField=function(_super){__extends(TextField,_super);function TextField(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.Main(_this);_this.values={root:{wml:{id:"root"},className:util_1.concat(exports.TEXT_FIELD,__1.getClassName(_this.attrs),feedback_1.getValidityClassName(_this.attrs))},messages:{wml:{id:"message"},text:feedback_1.getMessage(_this.attrs)},label:{id:__2.getName(_this.attrs),text:form_1.getLabel(_this.attrs)},control:{wml:{id:"root"},id:__1.getId(_this.attrs),name:__2.getName(_this.attrs),type:_this.attrs.ww&&_this.attrs.ww.type?_this.attrs.ww.type:"text",min:_this.attrs.ww&&_this.attrs.ww.min?_this.attrs.ww.min:undefined,max:_this.attrs.ww&&_this.attrs.ww.max?_this.attrs.ww.max:undefined,focus:_this.attrs.ww&&_this.attrs.ww.focus?_this.attrs.ww.focus:undefined,placeholder:_this.attrs.ww&&_this.attrs.ww.placeholder?_this.attrs.ww.placeholder:"",match:_this.attrs.ww&&_this.attrs.ww.match?_this.attrs.ww.match:undefined,length:_this.attrs.ww&&_this.attrs.ww.length?_this.attrs.ww.length:undefined,value:_this.attrs.ww&&_this.attrs.ww.value?_this.attrs.ww.value:"",disabled:_this.attrs.ww&&_this.attrs.ww.disabled?true:undefined,readOnly:_this.attrs.ww&&_this.attrs.ww.readOnly?true:undefined,rows:_this.attrs.ww&&_this.attrs.ww.rows?_this.attrs.ww.rows:1,oninput:_this.attrs.ww&&_this.attrs.ww.onChange?oninput(_this):function(){},onChange:_this.attrs.ww&&_this.attrs.ww.onChange?_this.attrs.ww.onChange:function(){}}};return _this}TextField.prototype.setMessage=function(msg){getHelp(this).map(function(h){return h.setMessage(msg)});return this};TextField.prototype.removeMessage=function(){getHelp(this).map(function(h){return h.removeMessage()});return this};return TextField}(form_1.AbstractFormControl);exports.TextField=TextField;var getHelp=function(t){return util_1.getById(t.view,t.values.messages.wml.id)};var oninput=function(f){return function(e){if(f.attrs.ww&&f.attrs.ww&&f.attrs.ww.onChange)f.attrs.ww.onChange(new text_input_1.TextChangedEvent(f.attrs.ww&&f.attrs.ww.name?f.attrs.ww.name:"",e.target.value))}}},{"../":123,"../../":139,"../../util":154,"../feedback":118,"../form":120,"../text-input":128,"./wml/text-field":127}],127:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var label_1=require("../../label");var help_1=require("../../help");var text_input_1=require("../../text-input");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{wml:{id:__context.values.root.wml.id},class:__context.values.root.className},[__this.widget(new label_1.Label({ww:{for:__context.values.control.id,text:__context.values.label.text}},[]),{ww:{for:__context.values.control.id,text:__context.values.label.text}}),__this.widget(new text_input_1.TextInput({ww:{id:__context.values.control.id,name:__context.values.control.name,focus:__context.values.control.focus,placeholder:__context.values.control.placeholder,onChange:__context.values.control.onChange,block:true,type:__context.values.control.type,min:__context.values.control.min,max:__context.values.control.max,match:__context.values.control.match,length:__context.values.control.length,value:__context.values.control.value,rows:__context.values.control.rows,disabled:__context.values.control.disabled,readOnly:__context.values.control.readOnly}},[]),{ww:{id:__context.values.control.id,name:__context.values.control.name,focus:__context.values.control.focus,placeholder:__context.values.control.placeholder,onChange:__context.values.control.onChange,block:true,type:__context.values.control.type,min:__context.values.control.min,max:__context.values.control.max,match:__context.values.control.match,length:__context.values.control.length,value:__context.values.control.value,rows:__context.values.control.rows,disabled:__context.values.control.disabled,readOnly:__context.values.control.readOnly}}),__this.widget(new help_1.Help({wml:{id:__context.values.messages.wml.id},ww:{text:__context.values.messages.text}},[]),{wml:{id:__context.values.messages.wml.id},ww:{text:__context.values.messages.text}})])}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"../../help":121,"../../label":124,"../../text-input":128,"@quenk/noni/lib/data/maybe":61,"@quenk/wml/lib/dom":155}],128:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.TextInput=exports.TextChangedEvent=exports.TEXT_INPUT=void 0;var views=require("./wml/text-input");var timer_1=require("@quenk/noni/lib/control/timer");var util_1=require("../../util");var orientation_1=require("../../content/orientation");var size_1=require("../../content/size");var focus_1=require("../focus");var __1=require("../../");var __2=require("../");exports.TEXT_INPUT="ww-text-input";var TextChangedEvent=function(_super){__extends(TextChangedEvent,_super);function TextChangedEvent(){return _super!==null&&_super.apply(this,arguments)||this}return TextChangedEvent}(__2.Event);exports.TextChangedEvent=TextChangedEvent;var TextInput=function(_super){__extends(TextInput,_super);function TextInput(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=_this.attrs.ww&&_this.attrs.ww.rows&&_this.attrs.ww.rows>1?new views.Textarea(_this):new views.Input(_this);_this.values={control:{wml:{id:"root"}},id:__1.getId(_this.attrs),className:util_1.concat(exports.TEXT_INPUT,__1.getClassName(_this.attrs),_this.attrs.ww&&_this.attrs.ww.size?size_1.getSizeClassName(_this.attrs.ww.size):"",_this.attrs.ww&&_this.attrs.ww.block?orientation_1.BLOCK:""),name:__2.getName(_this.attrs),type:_this.attrs.ww&&_this.attrs.ww.type?_this.attrs.ww.type:"text",min:_this.attrs.ww&&_this.attrs.ww.min?String(_this.attrs.ww.min):null,max:_this.attrs.ww&&_this.attrs.ww.max?String(_this.attrs.ww.max):null,match:new RegExp(_this.attrs.ww&&_this.attrs.ww.match?_this.attrs.ww.match:"."),length:_this.attrs.ww&&_this.attrs.ww.length?_this.attrs.ww.length:Infinity,placeholder:_this.attrs.ww&&_this.attrs.ww.placeholder?_this.attrs.ww.placeholder:"",value:_this.attrs.ww&&_this.attrs.ww.value?_this.attrs.ww.value:"",rows:String(_this.attrs.ww&&_this.attrs.ww.rows?_this.attrs.ww.rows:1),disabled:_this.attrs.ww&&_this.attrs.ww.disabled===true?true:null,readOnly:_this.attrs.ww&&_this.attrs.ww.readOnly===true?true:null,onkeydown:function(e){if(e.key.length===1){var value=e.target.value||"";if(!_this.values.match.test(e.key)||value.length>_this.values.length)e.preventDefault()}},oninput:dispatchInput(_this),autofocus:_this.attrs.ww&&_this.attrs.ww.focus?true:undefined,onfocus:function(){if(_this.attrs.ww&&_this.attrs.ww.onFocusGained)_this.attrs.ww.onFocusGained(new focus_1.FocusGainedEvent(__2.getName(_this.attrs)))},onblur:function(){if(_this.attrs.ww&&_this.attrs.ww.onFocusLost)_this.attrs.ww.onFocusLost(new focus_1.FocusLostEvent(__2.getName(_this.attrs)))}};return _this}TextInput.prototype.rendered=function(){if(this.values.autofocus===true)this.focus()};TextInput.prototype.focus=function(){var _this=this;return timer_1.tick(function(){return focus_1.focus(_this.view,_this.values.control.wml.id)})};return TextInput}(__2.AbstractControl);exports.TextInput=TextInput;var dispatchInput=function(i){return function(e){if(i.attrs.ww&&i.attrs.ww.onChange)i.attrs.ww.onChange(new TextChangedEvent(i.attrs&&i.attrs.ww.name?i.attrs.ww.name:"",e.target.value))}}},{"../":123,"../../":139,"../../content/orientation":107,"../../content/size":108,"../../util":154,"../focus":119,"./wml/text-input":129,"@quenk/noni/lib/control/timer":56}],129:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.Input=exports.Textarea=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var Textarea=function(){function Textarea(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("textarea",{wml:{id:__context.values.control.wml.id},id:__context.values.id,name:__context.values.name,placeholder:__context.values.placeholder,oninput:__context.values.oninput,value:__context.values.value,disabled:__context.values.disabled,readonly:__context.values.readOnly,rows:__context.values.rows,class:__context.values.className},[document.createTextNode(__context.values.value)])}}Textarea.prototype.registerView=function(v){this.views.push(v);return v};Textarea.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Textarea.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Textarea.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Textarea.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Textarea.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Textarea.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Textarea.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Textarea}();exports.Textarea=Textarea;var Input=function(){function Input(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("input",{wml:{id:__context.values.control.wml.id},id:__context.values.id,name:__context.values.name,type:__context.values.type,min:__context.values.min,max:__context.values.max,placeholder:__context.values.placeholder,oninput:__context.values.oninput,onkeydown:__context.values.onkeydown,autofocus:__context.values.autofocus,value:__context.values.value,disabled:__context.values.disabled,readonly:__context.values.readOnly,class:__context.values.className},[])}}Input.prototype.registerView=function(v){this.views.push(v);return v};Input.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Input.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Input.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Input.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Input.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Input.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Input.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Input}();exports.Input=Input},{"@quenk/noni/lib/data/maybe":61,"@quenk/wml/lib/dom":155}],130:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Toolbar=exports.TOOLBAR_COMPAT=exports.TOOLBAR=void 0;var views=require("./wml/toolbar");var wml_1=require("@quenk/wml");var util_1=require("../../util");var __1=require("../../");exports.TOOLBAR="ww-toolbar";exports.TOOLBAR_COMPAT="-toolbar-compat";var Toolbar=function(_super){__extends(Toolbar,_super);function Toolbar(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.Main(_this);_this.values={root:{id:__1.getId(_this.attrs),className:util_1.concat(exports.TOOLBAR,__1.getClassName(_this.attrs))}};return _this}return Toolbar}(wml_1.Component);exports.Toolbar=Toolbar},{"../../":139,"../../util":154,"./wml/toolbar":131,"@quenk/wml":156}],131:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{id:__context.values.root.id,class:__context.values.root.className},__spreadArrays(__context.children))}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"@quenk/noni/lib/data/maybe":61,"@quenk/wml/lib/dom":155}],132:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.sortById=exports.SortRequest=void 0;var path_1=require("@quenk/noni/lib/data/record/path");var sort_1=require("@quenk/noni/lib/data/array/sort");var SortRequest=function(){function SortRequest(column,data,key){this.column=column;this.data=data;this.key=key}return SortRequest}();exports.SortRequest=SortRequest;exports.sortById=function(cols,key,data,id){var spec=cols[id];var current=data[0],original=data[1];if(spec===undefined)return[current,key];if(!spec.sort)return[current,key];if(key[0]===id){return[current.reverse(),[key[0],key[1]*-1]]}else{var strategy=getSortStrategy(spec.sort);var alias=spec.alias?spec.alias:spec.name;return[doSort(original.slice(),strategy,alias),[id,-1]]}};var getSortStrategy=function(s){if(typeof s==="function")return s;if(s==="date")return sort_1.date;if(s==="number")return sort_1.number;if(s==="string")return sort_1.string;return sort_1.natural};var doSort=function(data,s,alias){return data.sort(function(a,b){return s(getAny(alias,a),getAny(alias,b))})};var getAny=function(path,src){return path_1.getDefault(path,src,undefined)}},{"@quenk/noni/lib/data/array/sort":58,"@quenk/noni/lib/data/record/path":63}],133:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.DataChangedEvent=exports.CellClickedEvent=exports.HeadingClickedEvent=void 0;var HeadingClickedEvent=function(){function HeadingClickedEvent(column){this.column=column}return HeadingClickedEvent}();exports.HeadingClickedEvent=HeadingClickedEvent;var CellClickedEvent=function(){function CellClickedEvent(column,row){this.column=column;this.row=row}return CellClickedEvent}();exports.CellClickedEvent=CellClickedEvent;var DataChangedEvent=function(){function DataChangedEvent(name,data,key){this.name=name;this.data=data;this.key=key}return DataChangedEvent}();exports.DataChangedEvent=DataChangedEvent},{}],134:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.DataTable=exports.NewCellContext=exports.NewBodyContext=exports.NewHeadingContext=exports.NewHeadContext=exports.DESC=exports.ASC=exports.DATA_TABLE_CELL=exports.DATA_TABLE_BODY=exports.DATA_TABLE_HEADING=exports.DATA_TABLE_HEAD=exports.DATA_TABLE=exports.HeadingClickedEvent=exports.CellClickedEvent=exports.DataChangedEvent=exports.SortRequest=void 0;var views=require("./wml/table");var wml_1=require("@quenk/wml");var array_1=require("@quenk/noni/lib/data/array");var path_1=require("@quenk/noni/lib/data/record/path");var util_1=require("../../util");var __1=require("../../");var sort_1=require("./column/sort");Object.defineProperty(exports,"SortRequest",{enumerable:true,get:function(){return sort_1.SortRequest}});var event_1=require("./event");Object.defineProperty(exports,"DataChangedEvent",{enumerable:true,get:function(){return event_1.DataChangedEvent}});Object.defineProperty(exports,"CellClickedEvent",{enumerable:true,get:function(){return event_1.CellClickedEvent}});Object.defineProperty(exports,"HeadingClickedEvent",{enumerable:true,get:function(){return event_1.HeadingClickedEvent}});var range_1=require("./range");exports.DATA_TABLE="ww-data-table";exports.DATA_TABLE_HEAD="ww-data-table__head";exports.DATA_TABLE_HEADING="ww-data-table__heading";exports.DATA_TABLE_BODY="ww-data-table__body";exports.DATA_TABLE_CELL="ww-data-table__cell";exports.ASC="-asc";exports.DESC="-desc";var NewHeadContext=function(){function NewHeadContext(table){var _this=this;this.table=table;this.className=util_1.concat(exports.DATA_TABLE_HEAD,this.table.attrs.ww&&this.table.attrs.ww.headClassName||"");this.columns=this.table.values.columns;this.data=this.table.values.dataset[0];this.heading=function(c,i){return getHeadingView(_this.table,new NewHeadingContext(_this.table,_this,c,i),c).render()}}return NewHeadContext}();exports.NewHeadContext=NewHeadContext;var NewHeadingContext=function(){function NewHeadingContext(table,headContext,column,index){var _this=this;this.table=table;this.headContext=headContext;this.column=column;this.index=index;this.className=util_1.concat(exports.DATA_TABLE_HEADING,this.table.attrs.ww&&this.table.attrs.ww.headingClassName||"",this.column.headingClassName,getSortClassName(this.table.values.sortKey,this.index));this.onclick=function(_){if(_this.column.sort)_this.table.values.sort(_this.index);if(_this.column.onHeadingClicked)_this.column.onHeadingClicked(new event_1.HeadingClickedEvent(_this.index));if(_this.table.attrs.ww&&_this.table.attrs.ww.onHeadingClicked)_this.table.attrs.ww.onHeadingClicked(new event_1.HeadingClickedEvent(_this.index))}}return NewHeadingContext}();exports.NewHeadingContext=NewHeadingContext;var NewBodyContext=function(){function NewBodyContext(table){var _this=this;this.table=table;this.className=util_1.concat(exports.DATA_TABLE_BODY,this.table.attrs.ww&&this.table.attrs.ww.bodyClassName||"");this.columns=this.table.values.columns;this.data=this.table.values.dataset[0];this.cell=function(c,id,row){return getCellView(_this.table,new NewCellContext(_this.table,_this,c,id,row),c).render()}}return NewBodyContext}();exports.NewBodyContext=NewBodyContext;var NewCellContext=function(){function NewCellContext(table,bodyContext,spec,column,row){var _this=this;this.table=table;this.bodyContext=bodyContext;this.spec=spec;this.column=column;this.row=row;this.id=cellId(this.column,this.row);this.className=util_1.concat(exports.DATA_TABLE_CELL,this.table.attrs.ww&&this.table.attrs.ww.cellClassName||"",this.spec.cellClassName,getSortClassName(this.table.values.sortKey,this.column));this.value=path_1.unsafeGet(this.spec.name,this.table.values.dataset[0][this.row]);this.datum=this.table.values.dataset[0][this.row];this.format=this.spec.format?this.spec.format:function(c){return String(c==null?"":c)};this.onclick=function(){if(_this.spec.onCellClicked)_this.spec.onCellClicked(new event_1.CellClickedEvent(_this.column,_this.row));if(_this.table.attrs.ww&&_this.table.attrs.ww.onCellClicked)_this.table.attrs.ww.onCellClicked(new event_1.CellClickedEvent(_this.column,_this.row))}}return NewCellContext}();exports.NewCellContext=NewCellContext;var DataTable=function(_super){__extends(DataTable,_super);function DataTable(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.Main(_this);_this.theadView=new views.EmptyView({});_this.tbodyView=new views.EmptyView({});_this.values={wml:{id:"table"},id:__1.getId(_this.attrs),className:util_1.concat(exports.DATA_TABLE,__1.getClassName(_this.attrs)),name:_this.attrs.ww&&_this.attrs.ww.name||"",sortable:_this.attrs.ww&&_this.attrs.ww.sortable!=null?_this.attrs.ww.sortable:true,sortKey:_this.attrs.ww&&_this.attrs.ww.sortKey?_this.attrs.ww.sortKey:[-1,1],sort:function(col){if(_this.values.sortable)_this.sort(col)},dataset:_this.attrs.ww&&_this.attrs.ww.data?[_this.attrs.ww.data.slice(),_this.attrs.ww.data.slice()]:[[],[]],columns:_this.attrs.ww&&_this.attrs.ww.columns?_this.attrs.ww.columns:[],thead:function(){_this.theadView=getHeadView(_this,new NewHeadContext(_this));return _this.theadView.render()},tbody:function(){_this.tbodyView=getBodyView(_this,new NewBodyContext(_this));return _this.tbodyView.render()}};return _this}DataTable.prototype.fireChange=function(){if(this.attrs.ww&&this.attrs.ww.onChange)this.attrs.ww.onChange(new event_1.DataChangedEvent(this.values.name,this.values.dataset[0].slice(),this.values.sortKey.slice()))};DataTable.prototype.update=function(data){this.values.dataset=[data.slice(),data.slice()];this.view.invalidate();this.fireChange();return this};DataTable.prototype.updateWithSortKey=function(data,key){this.values.sortKey=key;this.update(data);return this};DataTable.prototype.sort=function(id){var _a=this.values,sortKey=_a.sortKey,dataset=_a.dataset;var del=getSortDelegate(this);var _b=del(new sort_1.SortRequest(id,dataset[1],sortKey)),data=_b[0],key=_b[1];this.values.dataset[0]=data;this.values.sortKey=key;this.view.invalidate();this.fireChange();return this};DataTable.prototype.getRow=function(row){var mTr=util_1.getById(this.tbodyView,""+row);if(mTr.isNothing())return new range_1.RangeInstance([]);var tr=mTr.get();return new range_1.RangeInstance(array_1.make(tr.cells.length,function(n){return tr.cells[n]}))};DataTable.prototype.getCell=function(column,row){var cells=this.getRow(row).cells;if(!cells[column])return new range_1.RangeInstance([]);return new range_1.RangeInstance([cells[column]])};return DataTable}(wml_1.Component);exports.DataTable=DataTable;var getHeadView=function(table,ctx){return table.attrs.ww&&table.attrs.ww.headFragment?table.attrs.ww.headFragment(ctx):new views.HeadView(ctx)};var getHeadingView=function(table,ctx,c){return c.headingFragment?c.headingFragment(ctx):table.attrs.ww&&table.attrs.ww.headingFragment?table.attrs.ww.headingFragment(ctx):new views.HeadingView(ctx)};var getBodyView=function(table,ctx){return table.attrs.ww&&table.attrs.ww.bodyFragment?table.attrs.ww.bodyFragment(ctx):new views.BodyView(ctx)};var getCellView=function(table,ctx,c){return c.cellFragment?c.cellFragment(ctx):table.attrs.ww&&table.attrs.ww.cellFragment?table.attrs.ww.cellFragment(ctx):new views.CellView(ctx)};var getSortDelegate=function(table){return table.attrs.ww&&table.attrs.ww.sortDelegate?table.attrs.ww.sortDelegate:function(r){return sort_1.sortById(table.values.columns,r.key,[table.values.dataset[0],r.data],r.column)}};var getSortClassName=function(key,index){return key[0]===index?key[1]===1?exports.ASC:exports.DESC:""};var cellId=function(column,row){return column+","+row}},{"../../":139,"../../util":154,"./column/sort":132,"./event":133,"./range":135,"./wml/table":136,"@quenk/noni/lib/data/array":57,"@quenk/noni/lib/data/record/path":63,"@quenk/wml":156}],135:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.RangeInstance=void 0;var RangeInstance=function(){function RangeInstance(cells){this.cells=cells}return RangeInstance}();exports.RangeInstance=RangeInstance},{}],136:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.Main=exports.CellView=exports.BodyView=exports.HeadingView=exports.HeadView=exports.EmptyView=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var table_1=require("../../../layout/table");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var EmptyView=function(){function EmptyView(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{},[])}}EmptyView.prototype.registerView=function(v){this.views.push(v);return v};EmptyView.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};EmptyView.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};EmptyView.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};EmptyView.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};EmptyView.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};EmptyView.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};EmptyView.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return EmptyView}();exports.EmptyView=EmptyView;var HeadView=function(){function HeadView(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("thead",{class:__context.className},[__this.node("tr",{},__spreadArrays(__forIn(__context.columns,function(col,idx,_$$all){return[__context.heading(col,idx)]},function(){return[]})))])}}HeadView.prototype.registerView=function(v){this.views.push(v);return v};HeadView.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};HeadView.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};HeadView.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};HeadView.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};HeadView.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};HeadView.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};HeadView.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return HeadView}();exports.HeadView=HeadView;var HeadingView=function(){function HeadingView(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("th",{class:__context.className,onclick:__context.onclick},[text(__context.column.heading)])}}HeadingView.prototype.registerView=function(v){this.views.push(v);return v};HeadingView.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};HeadingView.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};HeadingView.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};HeadingView.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};HeadingView.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};HeadingView.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};HeadingView.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return HeadingView}();exports.HeadingView=HeadingView;var BodyView=function(){function BodyView(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("tbody",{class:__context.className},__spreadArrays(__forIn(__context.data,function(_,row,_$$all){return[__this.node("tr",{wml:{id:String(row)}},__spreadArrays(__forIn(__context.columns,function(col,idx,_$$all){return[__context.cell(col,idx,row)]},function(){return[]})))]},function(){return[]})))}}BodyView.prototype.registerView=function(v){this.views.push(v);return v};BodyView.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};BodyView.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};BodyView.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};BodyView.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};BodyView.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};BodyView.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};BodyView.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return BodyView}();exports.BodyView=BodyView;var CellView=function(){function CellView(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("td",{wml:{id:__context.id},class:__context.className,onclick:__context.onclick},[text(__context.format(__context.value))])}}CellView.prototype.registerView=function(v){this.views.push(v);return v};CellView.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};CellView.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};CellView.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};CellView.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};CellView.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};CellView.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};CellView.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return CellView}();exports.CellView=CellView;var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.widget(new table_1.TableLayout({wml:{id:__context.values.wml.id},ww:{id:__context.values.id,className:__context.values.className}},[__context.values.thead(),__context.values.tbody()]),{wml:{id:__context.values.wml.id},ww:{id:__context.values.id,className:__context.values.className}})}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"../../../layout/table":147,"@quenk/noni/lib/data/maybe":61,"@quenk/wml/lib/dom":155}],137:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.ModalFooter=exports.ModalBody=exports.ModalHeader=exports.Modal=exports.MODAL_FOOTER=exports.MODAL_BODY=exports.MODAL_HEADER=exports.MODAL_CONTENT=exports.MODAL_POSITION=exports.MODAL=void 0;var views=require("./wml/modal");var wml_1=require("@quenk/wml");var util_1=require("../../util");var __1=require("../../");exports.MODAL="ww-modal";exports.MODAL_POSITION="ww-modal__position";exports.MODAL_CONTENT="ww-modal__content";exports.MODAL_HEADER="ww-modal__header";exports.MODAL_BODY="ww-modal__body";exports.MODAL_FOOTER="ww-modal__footer";var Modal=function(_super){__extends(Modal,_super);function Modal(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.Modal(_this);_this.values={wml:{id:"root"},id:__1.getId(_this.attrs),className:util_1.concat(exports.MODAL,__1.getClassName(_this.attrs)),content:{className:exports.MODAL_CONTENT},position:{className:exports.MODAL_POSITION}};return _this}Modal.prototype.close=function(){var mO=util_1.getById(this.view,this.values.wml.id);if(mO.isJust()){var n=mO.get();if(n.parentNode)n.parentNode.removeChild(n)}};return Modal}(wml_1.Component);exports.Modal=Modal;var ModalHeader=function(_super){__extends(ModalHeader,_super);function ModalHeader(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.ModalHeader(_this);_this.values={wml:{id:"root"},id:__1.getId(_this.attrs),className:util_1.concat(exports.MODAL_HEADER,__1.getClassName(_this.attrs))};return _this}return ModalHeader}(wml_1.Component);exports.ModalHeader=ModalHeader;var ModalBody=function(_super){__extends(ModalBody,_super);function ModalBody(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.ModalBody(_this);_this.values={wml:{id:"root"},id:__1.getId(_this.attrs),className:util_1.concat(exports.MODAL_BODY,__1.getClassName(_this.attrs))};return _this}return ModalBody}(wml_1.Component);exports.ModalBody=ModalBody;var ModalFooter=function(_super){__extends(ModalFooter,_super);function ModalFooter(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.ModalFooter(_this);_this.values={wml:{id:"root"},id:__1.getId(_this.attrs),className:util_1.concat(exports.MODAL_FOOTER,__1.getClassName(_this.attrs))};return _this}return ModalFooter}(wml_1.Component);exports.ModalFooter=ModalFooter},{"../../":139,"../../util":154,"./wml/modal":138,"@quenk/wml":156}],138:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.ModalFooter=exports.ModalBody=exports.ModalHeader=exports.Modal=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var Modal=function(){function Modal(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{wml:{id:__context.values.wml.id},id:__context.values.id,class:__context.values.className},[__this.node("div",{class:__context.values.position.className},[__this.node("div",{class:__context.values.content.className},__spreadArrays(__context.children))])])}}Modal.prototype.registerView=function(v){this.views.push(v);return v};Modal.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Modal.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Modal.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Modal.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Modal.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Modal.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Modal.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Modal}();exports.Modal=Modal;var ModalHeader=function(){function ModalHeader(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{wml:{id:__context.values.wml.id},id:__context.values.id,class:__context.values.className},__spreadArrays(__context.children))}}ModalHeader.prototype.registerView=function(v){this.views.push(v);return v};ModalHeader.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};ModalHeader.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};ModalHeader.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};ModalHeader.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};ModalHeader.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};ModalHeader.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};ModalHeader.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return ModalHeader}();exports.ModalHeader=ModalHeader;var ModalBody=function(){function ModalBody(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{wml:{id:__context.values.wml.id},id:__context.values.id,class:__context.values.className},__spreadArrays(__context.children))}}ModalBody.prototype.registerView=function(v){this.views.push(v);return v};ModalBody.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};ModalBody.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};ModalBody.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};ModalBody.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};ModalBody.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};ModalBody.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};ModalBody.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return ModalBody}();exports.ModalBody=ModalBody;var ModalFooter=function(){function ModalFooter(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{wml:{id:__context.values.wml.id},id:__context.values.id,class:__context.values.className},__spreadArrays(__context.children))}}ModalFooter.prototype.registerView=function(v){this.views.push(v);return v};ModalFooter.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};ModalFooter.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};ModalFooter.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};ModalFooter.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};ModalFooter.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};ModalFooter.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};ModalFooter.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return ModalFooter}();exports.ModalFooter=ModalFooter},{"@quenk/noni/lib/data/maybe":61,"@quenk/wml/lib/dom":155}],139:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.getClassName=exports.getId=void 0;exports.getId=function(attrs){return attrs.ww&&attrs.ww.id?attrs.ww.id:""};exports.getClassName=function(attrs){var asHtmlAttrs=attrs;var asWidgetAttrs=attrs.ww;return asHtmlAttrs.className||asWidgetAttrs&&asWidgetAttrs.className||""}},{}],140:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.ActionBar=exports.ACTION_BAR_CONTENT=exports.ACTION_BAR=void 0;var orientation=require("../../content/orientation");var __1=require("../..");var util_1=require("../../util");var __2=require("../");var action_bar_1=require("./wml/action-bar");exports.ACTION_BAR="ww-action-bar";exports.ACTION_BAR_CONTENT="ww-action-bar__content";var ActionBar=function(_super){__extends(ActionBar,_super);function ActionBar(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new action_bar_1.Main(_this);_this.values={root:{wml:{id:"root"},id:_this.attrs.ww&&_this.attrs.ww.id?_this.attrs.ww.id:"",className:util_1.concat(exports.ACTION_BAR,__2.LAYOUT,orientation.POSITIONED,__1.getClassName(_this.attrs))},content:{wml:{id:"content"},class:exports.ACTION_BAR_CONTENT}};return _this}return ActionBar}(__2.AbstractLayout);exports.ActionBar=ActionBar},{"../":144,"../..":139,"../../content/orientation":107,"../../util":154,"./wml/action-bar":141}],141:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{wml:{id:__context.values.root.wml.id},id:__context.values.root.id,class:__context.values.root.className},[__this.node("div",{wml:{id:__context.values.content.wml.id},class:__context.values.content.class},__spreadArrays(__context.children))])}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"@quenk/noni/lib/data/maybe":61,"@quenk/wml/lib/dom":155}],142:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Column=exports.Row=exports.GridLayout=exports.GRID_LAYOUT_COLUMN=exports.GRID_LAYOUT_ROW=exports.GRID_LAYOUT=void 0;var views=require("./wml/grid");var util_1=require("../../util");var __1=require("../");exports.GRID_LAYOUT="ww-grid-layout";exports.GRID_LAYOUT_ROW="ww-grid-layout__row";exports.GRID_LAYOUT_COLUMN="ww-grid-layout__column";var GridLayout=function(_super){__extends(GridLayout,_super);function GridLayout(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.GridLayout(_this);_this.values={content:{id:_this.attrs.ww&&_this.attrs.ww.id,wml:{id:"root"},className:function(){var c=_this.attrs.ww&&_this.attrs.ww.className?_this.attrs.ww.className:"";return util_1.concat(exports.GRID_LAYOUT,__1.LAYOUT,c)}}};return _this}return GridLayout}(__1.AbstractLayout);exports.GridLayout=GridLayout;var Row=function(_super){__extends(Row,_super);function Row(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.Row(_this);_this.values={content:{id:_this.attrs.ww&&_this.attrs.ww.id,wml:{id:"row"},className:function(){var c=_this.attrs.ww&&_this.attrs.ww.className?_this.attrs.ww.className:"";return util_1.concat(exports.GRID_LAYOUT_ROW,c)}}};return _this}return Row}(__1.AbstractLayout);exports.Row=Row;var Column=function(_super){__extends(Column,_super);function Column(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.Column(_this);_this.values={content:{id:_this.attrs.ww&&_this.attrs.ww.id,wml:{id:"column"},className:function(){if(_this.attrs.ww!=null){return util_1.concat(exports.GRID_LAYOUT_COLUMN,_this.attrs.ww.span?"-span"+_this.attrs.ww.span:"-span12",_this.attrs.ww.offset?"-offset"+_this.attrs.ww.offset:"",_this.attrs.ww.className)}else{return util_1.concat(exports.GRID_LAYOUT_COLUMN,"-span12")}}}};return _this}return Column}(__1.AbstractLayout);exports.Column=Column},{"../":144,"../../util":154,"./wml/grid":143}],143:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.Column=exports.Row=exports.GridLayout=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var GridLayout=function(){function GridLayout(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{wml:{id:__context.values.content.wml.id},id:__context.values.content.id,class:__context.values.content.className()},__spreadArrays(__context.children))}}GridLayout.prototype.registerView=function(v){this.views.push(v);return v};GridLayout.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};GridLayout.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};GridLayout.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};GridLayout.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};GridLayout.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};GridLayout.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};GridLayout.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return GridLayout}();exports.GridLayout=GridLayout;var Row=function(){function Row(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{wml:{id:__context.values.content.wml.id},id:__context.values.content.id,class:__context.values.content.className()},__spreadArrays(__context.children))}}Row.prototype.registerView=function(v){this.views.push(v);return v};Row.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Row.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Row.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Row.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Row.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Row.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Row.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Row}();exports.Row=Row;var Column=function(){function Column(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{wml:{id:__context.values.content.wml.id},id:__context.values.content.id,class:__context.values.content.className()},__spreadArrays(__context.children))}}Column.prototype.registerView=function(v){this.views.push(v);return v};Column.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Column.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Column.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Column.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Column.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Column.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Column.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Column}();exports.Column=Column},{"@quenk/noni/lib/data/maybe":61,"@quenk/wml/lib/dom":155}],144:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.doRemoveContent=exports.doSetContent=exports.AbstractLayout=exports.LAYOUT=void 0;var wml_1=require("@quenk/wml");var util_1=require("../util");exports.LAYOUT="-layout";var AbstractLayout=function(_super){__extends(AbstractLayout,_super);function AbstractLayout(){return _super!==null&&_super.apply(this,arguments)||this}AbstractLayout.prototype.setContent=function(c){exports.doSetContent(this.view,this.values.content.wml.id,c);return this};AbstractLayout.prototype.removeContent=function(){exports.doRemoveContent(this.view,this.values.content.wml.id);return this};return AbstractLayout}(wml_1.Component);exports.AbstractLayout=AbstractLayout;exports.doSetContent=function(view,id,content){var maybeRoot=view.findById(id);if(maybeRoot.isNothing())return util_1.warnMissing(view,id);var n=maybeRoot.get();while(n.firstChild)n.removeChild(n.firstChild);for(var i=0;i<content.length;i++)n.appendChild(content[i])};exports.doRemoveContent=function(view,id){var maybeNode=view.findById(id);if(maybeNode.isNothing())return util_1.warnMissing(view,id);var n=maybeNode.get();while(n.firstChild)n.removeChild(n.firstChild)}},{"../util":154,"@quenk/wml":156}],145:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.MainLayout=exports.MAIN_LAYOUT=void 0;var views=require("./wml/main");var util_1=require("../../util");var __1=require("../");exports.MAIN_LAYOUT="ww-main-layout";var MainLayout=function(_super){__extends(MainLayout,_super);function MainLayout(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.Main(_this);_this.values={content:{wml:{id:"main"},id:_this.attrs&&_this.attrs.ww?_this.attrs.ww.id:"",className:util_1.concat(exports.MAIN_LAYOUT,__1.LAYOUT,_this.attrs&&_this.attrs.ww?_this.attrs.ww.className:"")}};return _this}return MainLayout}(__1.AbstractLayout);exports.MainLayout=MainLayout},{"../":144,"../../util":154,"./wml/main":146}],146:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{wml:{id:__context.values.content.wml.id},id:__context.values.content.id,class:__context.values.content.className},__spreadArrays(__context.children))}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"@quenk/noni/lib/data/maybe":61,"@quenk/wml/lib/dom":155}],147:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.TableLayout=exports.TableWindow=exports.TableCell=exports.TableHeading=exports.TableRow=exports.TableFooter=exports.TableBody=exports.TableHeader=exports.HOVERABLE=exports.ALTERNATE=exports.COMPACT=exports.BORDERED=exports.TABLE_WINDOW=exports.TABLE_LAYOUT=exports.TABLE_CELL=exports.TABLE_HEADING=exports.TABLE_ROW=exports.TABLE_FOOTER=exports.TABLE_BODY=exports.TABLE_HEADER=void 0;var views=require("./wml/table");var wml_1=require("@quenk/wml");var util_1=require("../../util");var __1=require("../../");exports.TABLE_HEADER="ww-table-layout__header";exports.TABLE_BODY="ww-table-layout__body";exports.TABLE_FOOTER="ww-table-layout__footer";exports.TABLE_ROW="ww-table-layout__row";exports.TABLE_HEADING="ww-table-layout _heading";exports.TABLE_CELL="ww-table-layout__cell";exports.TABLE_LAYOUT="ww-table-layout";exports.TABLE_WINDOW="ww-table-window";exports.BORDERED="-bordered";exports.COMPACT="-compact";exports.ALTERNATE="-alternate";exports.HOVERABLE="-hoverable";var TableHeader=function(_super){__extends(TableHeader,_super);function TableHeader(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.TableHeader(_this);_this.values={id:__1.getId(_this.attrs),className:util_1.concat(exports.TABLE_HEADER,__1.getClassName(_this.attrs))};return _this}return TableHeader}(wml_1.Component);exports.TableHeader=TableHeader;var TableBody=function(_super){__extends(TableBody,_super);function TableBody(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.TableBody(_this);_this.values={id:__1.getId(_this.attrs),className:util_1.concat(exports.TABLE_BODY,__1.getClassName(_this.attrs))};return _this}return TableBody}(wml_1.Component);exports.TableBody=TableBody;var TableFooter=function(_super){__extends(TableFooter,_super);function TableFooter(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.TableFooter(_this);_this.values={id:__1.getId(_this.attrs),className:util_1.concat(exports.TABLE_FOOTER,__1.getClassName(_this.attrs))};return _this}return TableFooter}(wml_1.Component);exports.TableFooter=TableFooter;var TableRow=function(_super){__extends(TableRow,_super);function TableRow(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.TableRow(_this);_this.values={id:__1.getId(_this.attrs),className:util_1.concat(exports.TABLE_ROW,__1.getClassName(_this.attrs)),onclick:_this.attrs.ww&&_this.attrs.ww.onclick?_this.attrs.ww.onclick:undefined};return _this}return TableRow}(wml_1.Component);exports.TableRow=TableRow;var TableHeading=function(_super){__extends(TableHeading,_super);function TableHeading(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.TableHeading(_this);_this.values={id:__1.getId(_this.attrs),className:util_1.concat(exports.TABLE_HEADING,__1.getClassName(_this.attrs)),onclick:_this.attrs.ww&&_this.attrs.ww.onclick?_this.attrs.ww.onclick:undefined};return _this}return TableHeading}(wml_1.Component);exports.TableHeading=TableHeading;var TableCell=function(_super){__extends(TableCell,_super);function TableCell(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.TableCell(_this);_this.values={id:__1.getId(_this.attrs),className:util_1.concat(exports.TABLE_CELL,__1.getClassName(_this.attrs)),colspan:_this.attrs.ww&&_this.attrs.ww.colspan?_this.attrs.ww.colspan:1,rowspan:_this.attrs.ww&&_this.attrs.ww.rowspan?_this.attrs.ww.rowspan:1,onclick:_this.attrs.ww&&_this.attrs.ww.onclick?_this.attrs.ww.onclick:undefined};return _this}return TableCell}(wml_1.Component);exports.TableCell=TableCell;var TableWindow=function(_super){__extends(TableWindow,_super);function TableWindow(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.TableWindow(_this);_this.values={id:__1.getId(_this.attrs),className:util_1.concat(exports.TABLE_WINDOW,__1.getClassName(_this.attrs))};return _this}return TableWindow}(wml_1.Component);exports.TableWindow=TableWindow;var TableLayout=function(_super){__extends(TableLayout,_super);function TableLayout(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.TableLayout(_this);_this.values={wml:{id:"table"},id:__1.getId(_this.attrs),className:util_1.concat(exports.TABLE_LAYOUT,__1.getClassName(_this.attrs),_this.attrs.ww&&_this.attrs.ww.alternate?exports.ALTERNATE:"",_this.attrs.ww&&_this.attrs.ww.bordered?exports.BORDERED:"",_this.attrs.ww&&_this.attrs.ww.compact?exports.COMPACT:"",_this.attrs.ww&&_this.attrs.ww.hoverable?exports.HOVERABLE:"")};return _this}return TableLayout}(wml_1.Component);exports.TableLayout=TableLayout},{"../../":139,"../../util":154,"./wml/table":148,"@quenk/wml":156}],148:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.TableLayout=exports.TableWindow=exports.TableCell=exports.TableHeading=exports.TableRow=exports.TableFooter=exports.TableBody=exports.TableHeader=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var TableHeader=function(){function TableHeader(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("thead",{id:__context.values.id,class:__context.values.className},__spreadArrays(__context.children))}}TableHeader.prototype.registerView=function(v){this.views.push(v);return v};TableHeader.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};TableHeader.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};TableHeader.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};TableHeader.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};TableHeader.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};TableHeader.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};TableHeader.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return TableHeader}();exports.TableHeader=TableHeader;var TableBody=function(){function TableBody(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("tbody",{id:__context.values.id,class:__context.values.className},__spreadArrays(__context.children))}}TableBody.prototype.registerView=function(v){this.views.push(v);return v};TableBody.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};TableBody.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};TableBody.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};TableBody.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};TableBody.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};TableBody.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};TableBody.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return TableBody}();exports.TableBody=TableBody;var TableFooter=function(){function TableFooter(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("tfoot",{id:__context.values.id,class:__context.values.className},__spreadArrays(__context.children))}}TableFooter.prototype.registerView=function(v){this.views.push(v);return v};TableFooter.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};TableFooter.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};TableFooter.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};TableFooter.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};TableFooter.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};TableFooter.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};TableFooter.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return TableFooter}();exports.TableFooter=TableFooter;var TableRow=function(){function TableRow(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("tr",{id:__context.values.id,class:__context.values.className,onclick:__context.values.onclick},__spreadArrays(__context.children))}}TableRow.prototype.registerView=function(v){this.views.push(v);return v};TableRow.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};TableRow.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};TableRow.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};TableRow.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};TableRow.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};TableRow.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};TableRow.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return TableRow}();exports.TableRow=TableRow;var TableHeading=function(){function TableHeading(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("th",{id:__context.values.id,class:__context.values.className,onclick:__context.values.onclick},__spreadArrays(__context.children))}}TableHeading.prototype.registerView=function(v){this.views.push(v);return v};TableHeading.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};TableHeading.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};TableHeading.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};TableHeading.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};TableHeading.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};TableHeading.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};TableHeading.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return TableHeading}();exports.TableHeading=TableHeading;var TableCell=function(){function TableCell(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("td",{id:__context.values.id,class:__context.values.className,colspan:String(__context.values.colspan),rowspan:String(__context.values.rowspan),onclick:__context.values.onclick},__spreadArrays(__context.children))}}TableCell.prototype.registerView=function(v){this.views.push(v);return v};TableCell.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};TableCell.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};TableCell.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};TableCell.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};TableCell.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};TableCell.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};TableCell.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return TableCell}();exports.TableCell=TableCell;var TableWindow=function(){function TableWindow(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{id:__context.values.id,class:__context.values.className},__spreadArrays(__context.children))}}TableWindow.prototype.registerView=function(v){this.views.push(v);return v};TableWindow.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};TableWindow.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};TableWindow.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};TableWindow.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};TableWindow.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};TableWindow.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};TableWindow.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return TableWindow}();exports.TableWindow=TableWindow;var TableLayout=function(){function TableLayout(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("table",{id:__context.values.id,class:__context.values.className},__spreadArrays(__context.children))}}TableLayout.prototype.registerView=function(v){this.views.push(v);return v};TableLayout.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};TableLayout.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};TableLayout.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};TableLayout.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};TableLayout.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};TableLayout.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};TableLayout.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return TableLayout}();exports.TableLayout=TableLayout},{"@quenk/noni/lib/data/maybe":61,"@quenk/wml/lib/dom":155}],149:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Item=exports.ItemClickedEvent=exports.DIVIDER=exports.ITEM=void 0;var wml=require("@quenk/wml");var views=require("./wml/item");var active_1=require("../../content/state/active");var active_2=require("../../content/state/active");var util_1=require("../../util");exports.ITEM="ww-menu-item";exports.DIVIDER="-divider";var ItemClickedEvent=function(){function ItemClickedEvent(name){this.name=name}return ItemClickedEvent}();exports.ItemClickedEvent=ItemClickedEvent;var Item=function(_super){__extends(Item,_super);function Item(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new views.Main(_this);_this.values={root:{wml:{id:"root"},id:_this.attrs.ww&&_this.attrs.ww.id?_this.attrs.ww.id:"",className:util_1.concat(exports.ITEM,_this.attrs.ww&&_this.attrs.ww.active?active_2.ACTIVE:"",_this.attrs.ww&&_this.attrs.ww.divider?exports.DIVIDER:""),content:{render:function(){if(_this.attrs.ww&&_this.attrs.ww.divider)return[];else if(_this.attrs.ww&&_this.attrs.ww.text)return[document.createTextNode(_this.attrs.ww.text)];else return _this.children}}}};return _this}Item.prototype.activate=function(){active_1.activate(this.view,this.values.root.wml.id);return this};Item.prototype.deactivate=function(){active_1.deactivate(this.view,this.values.root.wml.id);return this};return Item}(wml.Component);exports.Item=Item},{"../../content/state/active":109,"../../util":154,"./wml/item":150,"@quenk/wml":156}],150:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("li",{wml:{id:__context.values.root.wml.id},id:__context.values.root.id,class:__context.values.root.className},__spreadArrays(__context.values.root.content.render()))}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"@quenk/noni/lib/data/maybe":61,"@quenk/wml/lib/dom":155}],151:[function(require,module,exports){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.Menu=exports.HeaderItem=exports.CONTENT_MODE=exports.NAV_MODE=exports.MENU_HEADER_ITEM=exports.MENU=void 0;var hidden=require("../../content/state/hidden");var headerViews=require("./wml/header");var wml_1=require("@quenk/wml");var dom_1=require("@quenk/wml/lib/dom");var util_1=require("../../util");var orientation_1=require("../../content/orientation");var __1=require("../../");var menu_1=require("./wml/menu");exports.MENU="ww-menu";exports.MENU_HEADER_ITEM="ww-menu__header-item";exports.NAV_MODE="nav";exports.CONTENT_MODE="content";var HeaderItem=function(_super){__extends(HeaderItem,_super);function HeaderItem(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new headerViews.Main(_this);_this.values={root:{className:util_1.concat(exports.MENU_HEADER_ITEM,__1.getClassName(_this.attrs)),content:_this.attrs.ww&&_this.attrs.ww.text?[dom_1.text(_this.attrs.ww.text)]:_this.children}};return _this}return HeaderItem}(wml_1.Component);exports.HeaderItem=HeaderItem;var Menu=function(_super){__extends(Menu,_super);function Menu(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.view=new menu_1.Main(_this);_this.values={root:{wml:{id:"root"},id:__1.getId(_this.attrs),className:util_1.concat(exports.MENU,__1.getClassName(_this.attrs),_this.attrs.ww&&_this.attrs.ww.hidden?hidden.HIDDEN:"",_this.attrs.ww&&_this.attrs.ww.block?orientation_1.BLOCK:"")},menu:{id:"menu"},content:function(){return _this.children}};return _this}Menu.prototype.isHidden=function(){return hidden.isHidden(this.view,this.values.root.wml.id)};Menu.prototype.hide=function(){hidden.hide(this.view,this.values.root.wml.id);return this};Menu.prototype.show=function(){hidden.show(this.view,this.values.root.wml.id);return this};Menu.prototype.toggle=function(){hidden.toggle(this.view,this.values.root.wml.id);return this};Menu.prototype.setContent=function(content){this.values.content=function(){return content};this.view.invalidate();this.show();return this};return Menu}(wml_1.Component);exports.Menu=Menu},{"../../":139,"../../content/orientation":107,"../../content/state/hidden":110,"../../util":154,"./wml/header":152,"./wml/menu":153,"@quenk/wml":156,"@quenk/wml/lib/dom":155}],152:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("li",{class:__context.values.root.className},__spreadArrays(__context.values.root.content))}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"@quenk/noni/lib/data/maybe":61,"@quenk/wml/lib/dom":155}],153:[function(require,module,exports){"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;for(var r=Array(s),k=0,i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r};Object.defineProperty(exports,"__esModule",{value:true});exports.Main=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var Main=function(){function Main(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("ul",{wml:{id:__context.values.root.wml.id},id:__context.values.root.id,class:__context.values.root.className},__spreadArrays(__context.values.content()))}}Main.prototype.registerView=function(v){this.views.push(v);return v};Main.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};Main.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};Main.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};Main.prototype.findById=function(id){var mW=maybe_1.fromNullable(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};Main.prototype.findByGroup=function(name){var mGroup=maybe_1.fromArray(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};Main.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};Main.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return Main}();exports.Main=Main},{"@quenk/noni/lib/data/maybe":61,"@quenk/wml/lib/dom":155}],154:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.debounce=exports.replaceContent=exports.noop=exports.concat=exports.combine=exports.warnMissing=exports.getById=void 0;exports.getById=function(view,id){var m=view.findById(id);if(m.isNothing()){exports.warnMissing(view,id)}return m};exports.warnMissing=function(view,id){console.warn("The view ",view,' does not have an id "'+id+'"!')};exports.combine=function(str,joiner){if(joiner===void 0){joiner=" "}return str.filter(function(s){return s!=null||s!=""}).join(joiner)};exports.concat=function(){var str=[];for(var _i=0;_i<arguments.length;_i++){str[_i]=arguments[_i]}return str.filter(function(s){return s==null||s==""?false:true}).map(function(s){return s.trim()}).join(" ")};exports.noop=function(){};exports.replaceContent=function(r,node){while(node.lastChild)node.removeChild(node.lastChild);node.appendChild(r.render())};exports.debounce=function(f,delay){var timer=-1;return delay===0?f:function(a){if(timer===-1){timer=window.setTimeout(function(){return f(a)},delay)}else{clearTimeout(timer);timer=window.setTimeout(function(){return f(a)},delay)}}}},{}],155:[function(require,module,exports){(function(global){(function(){"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();Object.defineProperty(exports,"__esModule",{value:true});exports.createElement=exports.unsafe=exports.text=exports.createUnsafeTextNode=exports.createTextNode=exports.escapeHTML=exports.escapeAttrValue=exports.escapeAttrs=exports.isBrowser=exports.WMLDOMElement=exports.WMLDOMText=exports.WMLDOMNode=exports.WMLNodeList=void 0;var record_1=require("@quenk/noni/lib/data/record");var type_1=require("@quenk/noni/lib/data/type");var window=global;var document=global.document;var DOCTYPE="<!DOCTYPE html>";var ATTR_ESC_MAP={"&":"\\u0026",">":"\\u003e","<":"\\u003c",'"':"\\u0022","=":"\\u003d","\\":"\\u005c","\u2028":"\\u2028","\u2029":"\\u2029"};var attrsEscRegex=new RegExp("["+record_1.mapTo(ATTR_ESC_MAP,function(_,k){return k})+"]","g");var HTML_ENT_MAP={'"':"&quot;","&":"&amp;","'":"&apos;","<":"&lt;",">":"&gt;"};var htmlEscRegex=new RegExp("["+record_1.mapTo(HTML_ENT_MAP,function(_,k){return k})+"]","g");var voidElements=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];var WMLNodeList=function(){function WMLNodeList(){this.length=0}WMLNodeList.prototype.item=function(){return null};WMLNodeList.prototype.forEach=function(){};return WMLNodeList}();exports.WMLNodeList=WMLNodeList;var WMLDOMNode=function(){function WMLDOMNode(nodeName,nodeType){this.nodeName=nodeName;this.nodeType=nodeType;this.ATTRIBUTE_NODE=-1;this.CDATA_SECTION_NODE=-1;this.COMMENT_NODE=-1;this.DOCUMENT_FRAGMENT_NODE=-1;this.DOCUMENT_NODE=-1;this.DOCUMENT_POSITION_CONTAINED_BY=-1;this.DOCUMENT_POSITION_CONTAINS=-1;this.DOCUMENT_POSITION_DISCONNECTED=-1;this.DOCUMENT_POSITION_FOLLOWING=-1;this.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC=-1;this.DOCUMENT_POSITION_PRECEDING=-1;this.DOCUMENT_TYPE_NODE=-1;this.ELEMENT_NODE=-1;this.ENTITY_NODE=-1;this.ENTITY_REFERENCE_NODE=-1;this.NOTATION_NODE=-1;this.PROCESSING_INSTRUCTION_NODE=-1;this.TEXT_NODE=-1;this.baseURI="";this.childNodes=new WMLNodeList;this.firstChild=null;this.isConnected=false;this.lastChild=null;this.namespaceURI=null;this.nextSibling=null;this.nodeValue=null;this.ownerDocument=null;this.parentElement=null;this.parentNode=null;this.previousSibling=null}Object.defineProperty(WMLDOMNode.prototype,"textContent",{get:function(){return""},enumerable:false,configurable:true});WMLDOMNode.prototype.addEventListener=function(){};WMLDOMNode.prototype.dispatchEvent=function(){return false};WMLDOMNode.prototype.removeEventListener=function(){};WMLDOMNode.prototype.appendChild=function(newChild){return newChild};WMLDOMNode.prototype.cloneNode=function(){return this};WMLDOMNode.prototype.compareDocumentPosition=function(){return 0};WMLDOMNode.prototype.contains=function(){return false};WMLDOMNode.prototype.getRootNode=function(){return this};WMLDOMNode.prototype.hasChildNodes=function(){return false};WMLDOMNode.prototype.insertBefore=function(newChild){return newChild};WMLDOMNode.prototype.isDefaultNamespace=function(){return false};WMLDOMNode.prototype.isEqualNode=function(){return false};WMLDOMNode.prototype.isSameNode=function(){return false};WMLDOMNode.prototype.lookupNamespaceURI=function(){return null};WMLDOMNode.prototype.lookupPrefix=function(){return null};WMLDOMNode.prototype.normalize=function(){};WMLDOMNode.prototype.remove=function(){};WMLDOMNode.prototype.before=function(){};WMLDOMNode.prototype.after=function(){};WMLDOMNode.prototype.replaceWith=function(){};WMLDOMNode.prototype.removeChild=function(oldChild){return oldChild};WMLDOMNode.prototype.replaceChild=function(_,oldChild){return oldChild};return WMLDOMNode}();exports.WMLDOMNode=WMLDOMNode;var WMLDOMText=function(_super){__extends(WMLDOMText,_super);function WMLDOMText(value,escape){if(escape===void 0){escape=true}var _this=_super.call(this,"#text",-1)||this;_this.value=value;_this.escape=escape;return _this}Object.defineProperty(WMLDOMText.prototype,"textContent",{get:function(){return this.escape?exports.escapeHTML(this.value):this.value},enumerable:false,configurable:true});return WMLDOMText}(WMLDOMNode);exports.WMLDOMText=WMLDOMText;var WMLDOMElement=function(_super){__extends(WMLDOMElement,_super);function WMLDOMElement(tag,attrs,children){if(children===void 0){children=[]}var _this=_super.call(this,tag,-1)||this;_this.tag=tag;_this.attrs=attrs;_this.children=children;return _this}Object.defineProperty(WMLDOMElement.prototype,"innerHTML",{get:function(){return this.children.map(function(c){return c.nodeName==="#text"?c.textContent:c.outerHTML}).join("")},enumerable:false,configurable:true});Object.defineProperty(WMLDOMElement.prototype,"outerHTML",{get:function(){var tag=this.tag;var content=this.innerHTML;var attrs=record_1.mapTo(exports.escapeAttrs(this.attrs),function(value,name){return!value?name:name+'="'+value+'"'}).join(" ");attrs=attrs.trim()!=""?" "+attrs:"";var open="<"+tag+attrs+">";if(tag==="html")open=""+DOCTYPE+open;return voidElements.indexOf(tag)>-1?open:""+open+content+"</"+tag+">"},enumerable:false,configurable:true});WMLDOMElement.prototype.setAttribute=function(key,value){this.attrs[key]=value};WMLDOMElement.prototype.appendChild=function(newChild){this.children.push(newChild);return newChild};return WMLDOMElement}(WMLDOMNode);exports.WMLDOMElement=WMLDOMElement;exports.isBrowser=window!=null&&document!=null;var escapeAttrs=function(attrs){return record_1.map(attrs,function(value){return type_1.isFunction(value)?value:value instanceof WMLDOMText?value.textContent:exports.escapeAttrValue(String(value))})};exports.escapeAttrs=escapeAttrs;var escapeAttrValue=function(value){return value.replace(attrsEscRegex,function(hit){return ATTR_ESC_MAP[hit]})};exports.escapeAttrValue=escapeAttrValue;var escapeHTML=function(value){return value.replace(htmlEscRegex,function(hit){return HTML_ENT_MAP[hit]})};exports.escapeHTML=escapeHTML;var createTextNode=function(txt){var str=String(txt==null?"":txt);return exports.isBrowser?document.createTextNode(str):new WMLDOMText(str)};exports.createTextNode=createTextNode;exports.text=exports.createTextNode;var createUnsafeTextNode=function(txt){var str=String(txt==null?"":txt);return exports.isBrowser?document.createTextNode(str):new WMLDOMText(str,false)};exports.createUnsafeTextNode=createUnsafeTextNode;exports.unsafe=exports.createUnsafeTextNode;var createElement=function(tag,attrs,children){if(attrs===void 0){attrs={}}if(children===void 0){children=[]}if(!exports.isBrowser){return new WMLDOMElement(tag,attrs,children)}else{var e_1=document.createElement(tag);record_1.forEach(attrs,function(value,key){if(typeof value==="function"){e_1[key]=value}else if(typeof value==="string"){if(value!=="")e_1.setAttribute(key,value)}else if(typeof value==="boolean"){e_1.setAttribute(key,"")}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":e_1.appendChild(document.createTextNode(""+c));case"object":e_1.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});return e_1}};exports.createElement=createElement}).call(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"@quenk/noni/lib/data/record":62,"@quenk/noni/lib/data/type":65}],156:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.renderAsNode=exports.Component=void 0;var Component=function(){function Component(attrs,children){this.attrs=attrs;this.children=children}Component.prototype.rendered=function(){};Component.prototype.removed=function(){};Component.prototype.render=function(){return this.view.render()};return Component}();exports.Component=Component;var renderAsNode=function(r){return r.render()};exports.renderAsNode=renderAsNode},{}],157:[function(require,module,exports){},{}],158:[function(require,module,exports){"use strict";var GetIntrinsic=require("get-intrinsic");var callBind=require("./");var $indexOf=callBind(GetIntrinsic("String.prototype.indexOf"));module.exports=function callBoundIntrinsic(name,allowMissing){var intrinsic=GetIntrinsic(name,!!allowMissing);if(typeof intrinsic==="function"&&$indexOf(name,".prototype.")>-1){return callBind(intrinsic)}return intrinsic}},{"./":159,"get-intrinsic":162}],159:[function(require,module,exports){"use strict";var bind=require("function-bind");var GetIntrinsic=require("get-intrinsic");var $apply=GetIntrinsic("%Function.prototype.apply%");var $call=GetIntrinsic("%Function.prototype.call%");var $reflectApply=GetIntrinsic("%Reflect.apply%",true)||bind.call($call,$apply);var $gOPD=GetIntrinsic("%Object.getOwnPropertyDescriptor%",true);var $defineProperty=GetIntrinsic("%Object.defineProperty%",true);var $max=GetIntrinsic("%Math.max%");if($defineProperty){try{$defineProperty({},"a",{value:1})}catch(e){$defineProperty=null}}module.exports=function callBind(originalFunction){var func=$reflectApply(bind,$call,arguments);if($gOPD&&$defineProperty){var desc=$gOPD(func,"length");if(desc.configurable){$defineProperty(func,"length",{value:1+$max(0,originalFunction.length-(arguments.length-1))})}}return func};var applyBind=function applyBind(){return $reflectApply(bind,$apply,arguments)};if($defineProperty){$defineProperty(module.exports,"apply",{value:applyBind})}else{module.exports.apply=applyBind}},{"function-bind":161,"get-intrinsic":162}],160:[function(require,module,exports){"use strict";var ERROR_MESSAGE="Function.prototype.bind called on incompatible ";var slice=Array.prototype.slice;var toStr=Object.prototype.toString;var funcType="[object Function]";module.exports=function bind(that){var target=this;if(typeof target!=="function"||toStr.call(target)!==funcType){throw new TypeError(ERROR_MESSAGE+target)}var args=slice.call(arguments,1);var bound;var binder=function(){if(this instanceof bound){var result=target.apply(this,args.concat(slice.call(arguments)));if(Object(result)===result){return result}return this}else{return target.apply(that,args.concat(slice.call(arguments)))}};var boundLength=Math.max(0,target.length-args.length);var boundArgs=[];for(var i=0;i<boundLength;i++){boundArgs.push("$"+i)}bound=Function("binder","return function ("+boundArgs.join(",")+"){ return binder.apply(this,arguments); }")(binder);if(target.prototype){var Empty=function Empty(){};Empty.prototype=target.prototype;bound.prototype=new Empty;Empty.prototype=null}return bound}},{}],161:[function(require,module,exports){"use strict";var implementation=require("./implementation");module.exports=Function.prototype.bind||implementation},{"./implementation":160}],162:[function(require,module,exports){"use strict";var undefined;var $SyntaxError=SyntaxError;var $Function=Function;var $TypeError=TypeError;var getEvalledConstructor=function(expressionSyntax){try{return $Function('"use strict"; return ('+expressionSyntax+").constructor;")()}catch(e){}};var $gOPD=Object.getOwnPropertyDescriptor;if($gOPD){try{$gOPD({},"")}catch(e){$gOPD=null}}var throwTypeError=function(){throw new $TypeError};var ThrowTypeError=$gOPD?function(){try{arguments.callee;return throwTypeError}catch(calleeThrows){try{return $gOPD(arguments,"callee").get}catch(gOPDthrows){return throwTypeError}}}():throwTypeError;var hasSymbols=require("has-symbols")();var getProto=Object.getPrototypeOf||function(x){return x.__proto__};var needsEval={};var TypedArray=typeof Uint8Array==="undefined"?undefined:getProto(Uint8Array);var INTRINSICS={"%AggregateError%":typeof AggregateError==="undefined"?undefined:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer==="undefined"?undefined:ArrayBuffer,"%ArrayIteratorPrototype%":hasSymbols?getProto([][Symbol.iterator]()):undefined,"%AsyncFromSyncIteratorPrototype%":undefined,"%AsyncFunction%":needsEval,"%AsyncGenerator%":needsEval,"%AsyncGeneratorFunction%":needsEval,"%AsyncIteratorPrototype%":needsEval,"%Atomics%":typeof Atomics==="undefined"?undefined:Atomics,"%BigInt%":typeof BigInt==="undefined"?undefined:BigInt,"%Boolean%":Boolean,"%DataView%":typeof DataView==="undefined"?undefined:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array==="undefined"?undefined:Float32Array,"%Float64Array%":typeof Float64Array==="undefined"?undefined:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry==="undefined"?undefined:FinalizationRegistry,"%Function%":$Function,"%GeneratorFunction%":needsEval,"%Int8Array%":typeof Int8Array==="undefined"?undefined:Int8Array,"%Int16Array%":typeof Int16Array==="undefined"?undefined:Int16Array,"%Int32Array%":typeof Int32Array==="undefined"?undefined:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":hasSymbols?getProto(getProto([][Symbol.iterator]())):undefined,"%JSON%":typeof JSON==="object"?JSON:undefined,"%Map%":typeof Map==="undefined"?undefined:Map,"%MapIteratorPrototype%":typeof Map==="undefined"||!hasSymbols?undefined:getProto((new Map)[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise==="undefined"?undefined:Promise,"%Proxy%":typeof Proxy==="undefined"?undefined:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect==="undefined"?undefined:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set==="undefined"?undefined:Set,"%SetIteratorPrototype%":typeof Set==="undefined"||!hasSymbols?undefined:getProto((new Set)[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer==="undefined"?undefined:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":hasSymbols?getProto(""[Symbol.iterator]()):undefined,"%Symbol%":hasSymbols?Symbol:undefined,"%SyntaxError%":$SyntaxError,"%ThrowTypeError%":ThrowTypeError,"%TypedArray%":TypedArray,"%TypeError%":$TypeError,"%Uint8Array%":typeof Uint8Array==="undefined"?undefined:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray==="undefined"?undefined:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array==="undefined"?undefined:Uint16Array,"%Uint32Array%":typeof Uint32Array==="undefined"?undefined:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap==="undefined"?undefined:WeakMap,"%WeakRef%":typeof WeakRef==="undefined"?undefined:WeakRef,"%WeakSet%":typeof WeakSet==="undefined"?undefined:WeakSet};var doEval=function doEval(name){var value;if(name==="%AsyncFunction%"){value=getEvalledConstructor("async function () {}")}else if(name==="%GeneratorFunction%"){value=getEvalledConstructor("function* () {}")}else if(name==="%AsyncGeneratorFunction%"){value=getEvalledConstructor("async function* () {}")}else if(name==="%AsyncGenerator%"){var fn=doEval("%AsyncGeneratorFunction%");if(fn){value=fn.prototype}}else if(name==="%AsyncIteratorPrototype%"){var gen=doEval("%AsyncGenerator%");if(gen){value=getProto(gen.prototype)}}INTRINSICS[name]=value;return value};var LEGACY_ALIASES={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]};var bind=require("function-bind");var hasOwn=require("has");var $concat=bind.call(Function.call,Array.prototype.concat);var $spliceApply=bind.call(Function.apply,Array.prototype.splice);var $replace=bind.call(Function.call,String.prototype.replace);var $strSlice=bind.call(Function.call,String.prototype.slice);var rePropName=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g;var reEscapeChar=/\\(\\)?/g;var stringToPath=function stringToPath(string){var first=$strSlice(string,0,1);var last=$strSlice(string,-1);if(first==="%"&&last!=="%"){throw new $SyntaxError("invalid intrinsic syntax, expected closing `%`")}else if(last==="%"&&first!=="%"){throw new $SyntaxError("invalid intrinsic syntax, expected opening `%`")}var result=[];$replace(string,rePropName,function(match,number,quote,subString){result[result.length]=quote?$replace(subString,reEscapeChar,"$1"):number||match});return result};var getBaseIntrinsic=function getBaseIntrinsic(name,allowMissing){var intrinsicName=name;var alias;if(hasOwn(LEGACY_ALIASES,intrinsicName)){alias=LEGACY_ALIASES[intrinsicName];intrinsicName="%"+alias[0]+"%"}if(hasOwn(INTRINSICS,intrinsicName)){var value=INTRINSICS[intrinsicName];if(value===needsEval){value=doEval(intrinsicName)}if(typeof value==="undefined"&&!allowMissing){throw new $TypeError("intrinsic "+name+" exists, but is not available. Please file an issue!")}return{alias:alias,name:intrinsicName,value:value}}throw new $SyntaxError("intrinsic "+name+" does not exist!")};module.exports=function GetIntrinsic(name,allowMissing){if(typeof name!=="string"||name.length===0){throw new $TypeError("intrinsic name must be a non-empty string")}if(arguments.length>1&&typeof allowMissing!=="boolean"){throw new $TypeError('"allowMissing" argument must be a boolean')}var parts=stringToPath(name);var intrinsicBaseName=parts.length>0?parts[0]:"";var intrinsic=getBaseIntrinsic("%"+intrinsicBaseName+"%",allowMissing);var intrinsicRealName=intrinsic.name;var value=intrinsic.value;var skipFurtherCaching=false;var alias=intrinsic.alias;if(alias){intrinsicBaseName=alias[0];$spliceApply(parts,$concat([0,1],alias))}for(var i=1,isOwn=true;i<parts.length;i+=1){var part=parts[i];var first=$strSlice(part,0,1);var last=$strSlice(part,-1);if((first==='"'||first==="'"||first==="`"||(last==='"'||last==="'"||last==="`"))&&first!==last){throw new $SyntaxError("property names with quotes must have matching quotes")}if(part==="constructor"||!isOwn){skipFurtherCaching=true}intrinsicBaseName+="."+part;intrinsicRealName="%"+intrinsicBaseName+"%";if(hasOwn(INTRINSICS,intrinsicRealName)){value=INTRINSICS[intrinsicRealName]}else if(value!=null){if(!(part in value)){if(!allowMissing){throw new $TypeError("base intrinsic for "+name+" exists, but the property is not available.")}return void undefined}if($gOPD&&i+1>=parts.length){var desc=$gOPD(value,part);isOwn=!!desc;if(isOwn&&"get"in desc&&!("originalValue"in desc.get)){value=desc.get}else{value=value[part]}}else{isOwn=hasOwn(value,part);value=value[part]}if(isOwn&&!skipFurtherCaching){INTRINSICS[intrinsicRealName]=value}}}return value}},{"function-bind":161,has:165,"has-symbols":163}],163:[function(require,module,exports){"use strict";var origSymbol=typeof Symbol!=="undefined"&&Symbol;var hasSymbolSham=require("./shams");module.exports=function hasNativeSymbols(){if(typeof origSymbol!=="function"){return false}if(typeof Symbol!=="function"){return false}if(typeof origSymbol("foo")!=="symbol"){return false}if(typeof Symbol("bar")!=="symbol"){return false}return hasSymbolSham()}},{"./shams":164}],164:[function(require,module,exports){"use strict";module.exports=function hasSymbols(){if(typeof Symbol!=="function"||typeof Object.getOwnPropertySymbols!=="function"){return false}if(typeof Symbol.iterator==="symbol"){return true}var obj={};var sym=Symbol("test");var symObj=Object(sym);if(typeof sym==="string"){return false}if(Object.prototype.toString.call(sym)!=="[object Symbol]"){return false}if(Object.prototype.toString.call(symObj)!=="[object Symbol]"){return false}var symVal=42;obj[sym]=symVal;for(sym in obj){return false}if(typeof Object.keys==="function"&&Object.keys(obj).length!==0){return false}if(typeof Object.getOwnPropertyNames==="function"&&Object.getOwnPropertyNames(obj).length!==0){return false}var syms=Object.getOwnPropertySymbols(obj);if(syms.length!==1||syms[0]!==sym){return false}if(!Object.prototype.propertyIsEnumerable.call(obj,sym)){return false}if(typeof Object.getOwnPropertyDescriptor==="function"){var descriptor=Object.getOwnPropertyDescriptor(obj,sym);if(descriptor.value!==symVal||descriptor.enumerable!==true){return false}}return true}},{}],165:[function(require,module,exports){"use strict";var bind=require("function-bind");module.exports=bind.call(Function.call,Object.prototype.hasOwnProperty)},{"function-bind":161}],166:[function(require,module,exports){(function(global,factory){typeof exports==="object"&&typeof module!=="undefined"?module.exports=factory():typeof define==="function"&&define.amd?define(factory):global.moment=factory()})(this,function(){"use strict";var hookCallback;function hooks(){return hookCallback.apply(null,arguments)}function setHookCallback(callback){hookCallback=callback}function isArray(input){return input instanceof Array||Object.prototype.toString.call(input)==="[object Array]"}function isObject(input){return input!=null&&Object.prototype.toString.call(input)==="[object Object]"}function hasOwnProp(a,b){return Object.prototype.hasOwnProperty.call(a,b)}function isObjectEmpty(obj){if(Object.getOwnPropertyNames){return Object.getOwnPropertyNames(obj).length===0}else{var k;for(k in obj){if(hasOwnProp(obj,k)){return false}}return true}}function isUndefined(input){return input===void 0}function isNumber(input){return typeof input==="number"||Object.prototype.toString.call(input)==="[object Number]"}function isDate(input){return input instanceof Date||Object.prototype.toString.call(input)==="[object Date]"}function map(arr,fn){var res=[],i;for(i=0;i<arr.length;++i){res.push(fn(arr[i],i))}return res}function extend(a,b){for(var i in b){if(hasOwnProp(b,i)){a[i]=b[i]}}if(hasOwnProp(b,"toString")){a.toString=b.toString}if(hasOwnProp(b,"valueOf")){a.valueOf=b.valueOf}return a}function createUTC(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,true).utc()}function defaultParsingFlags(){return{empty:false,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:false,invalidEra:null,invalidMonth:null,invalidFormat:false,userInvalidated:false,iso:false,parsedDateParts:[],era:null,meridiem:null,rfc2822:false,weekdayMismatch:false}}function getParsingFlags(m){if(m._pf==null){m._pf=defaultParsingFlags()}return m._pf}var some;if(Array.prototype.some){some=Array.prototype.some}else{some=function(fun){var t=Object(this),len=t.length>>>0,i;for(i=0;i<len;i++){if(i in t&&fun.call(this,t[i],i,t)){return true}}return false}}function isValid(m){if(m._isValid==null){var flags=getParsingFlags(m),parsedParts=some.call(flags.parsedDateParts,function(i){return i!=null}),isNowValid=!isNaN(m._d.getTime())&&flags.overflow<0&&!flags.empty&&!flags.invalidEra&&!flags.invalidMonth&&!flags.invalidWeekday&&!flags.weekdayMismatch&&!flags.nullInput&&!flags.invalidFormat&&!flags.userInvalidated&&(!flags.meridiem||flags.meridiem&&parsedParts);if(m._strict){isNowValid=isNowValid&&flags.charsLeftOver===0&&flags.unusedTokens.length===0&&flags.bigHour===undefined}if(Object.isFrozen==null||!Object.isFrozen(m)){m._isValid=isNowValid}else{return isNowValid}}return m._isValid}function createInvalid(flags){var m=createUTC(NaN);if(flags!=null){extend(getParsingFlags(m),flags)}else{getParsingFlags(m).userInvalidated=true}return m}var momentProperties=hooks.momentProperties=[],updateInProgress=false;function copyConfig(to,from){var i,prop,val;if(!isUndefined(from._isAMomentObject)){to._isAMomentObject=from._isAMomentObject}if(!isUndefined(from._i)){to._i=from._i}if(!isUndefined(from._f)){to._f=from._f}if(!isUndefined(from._l)){to._l=from._l}if(!isUndefined(from._strict)){to._strict=from._strict}if(!isUndefined(from._tzm)){to._tzm=from._tzm}if(!isUndefined(from._isUTC)){to._isUTC=from._isUTC}if(!isUndefined(from._offset)){to._offset=from._offset}if(!isUndefined(from._pf)){to._pf=getParsingFlags(from)}if(!isUndefined(from._locale)){to._locale=from._locale}if(momentProperties.length>0){for(i=0;i<momentProperties.length;i++){prop=momentProperties[i];val=from[prop];if(!isUndefined(val)){to[prop]=val}}}return to}function Moment(config){copyConfig(this,config);this._d=new Date(config._d!=null?config._d.getTime():NaN);if(!this.isValid()){this._d=new Date(NaN)}if(updateInProgress===false){updateInProgress=true;hooks.updateOffset(this);updateInProgress=false}}function isMoment(obj){return obj instanceof Moment||obj!=null&&obj._isAMomentObject!=null}function warn(msg){if(hooks.suppressDeprecationWarnings===false&&typeof console!=="undefined"&&console.warn){console.warn("Deprecation warning: "+msg)}}function deprecate(msg,fn){var firstTime=true;return extend(function(){if(hooks.deprecationHandler!=null){hooks.deprecationHandler(null,msg)}if(firstTime){var args=[],arg,i,key;for(i=0;i<arguments.length;i++){arg="";if(typeof arguments[i]==="object"){arg+="\n["+i+"] ";for(key in arguments[0]){if(hasOwnProp(arguments[0],key)){arg+=key+": "+arguments[0][key]+", "}}arg=arg.slice(0,-2)}else{arg=arguments[i]}args.push(arg)}warn(msg+"\nArguments: "+Array.prototype.slice.call(args).join("")+"\n"+(new Error).stack);firstTime=false}return fn.apply(this,arguments)},fn)}var deprecations={};function deprecateSimple(name,msg){if(hooks.deprecationHandler!=null){hooks.deprecationHandler(name,msg)}if(!deprecations[name]){warn(msg);deprecations[name]=true}}hooks.suppressDeprecationWarnings=false;hooks.deprecationHandler=null;function isFunction(input){return typeof Function!=="undefined"&&input instanceof Function||Object.prototype.toString.call(input)==="[object Function]"}function set(config){var prop,i;for(i in config){if(hasOwnProp(config,i)){prop=config[i];if(isFunction(prop)){this[i]=prop}else{this["_"+i]=prop}}}this._config=config;this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function mergeConfigs(parentConfig,childConfig){var res=extend({},parentConfig),prop;for(prop in childConfig){if(hasOwnProp(childConfig,prop)){if(isObject(parentConfig[prop])&&isObject(childConfig[prop])){res[prop]={};extend(res[prop],parentConfig[prop]);extend(res[prop],childConfig[prop])}else if(childConfig[prop]!=null){res[prop]=childConfig[prop]}else{delete res[prop]}}}for(prop in parentConfig){if(hasOwnProp(parentConfig,prop)&&!hasOwnProp(childConfig,prop)&&isObject(parentConfig[prop])){res[prop]=extend({},res[prop])}}return res}function Locale(config){if(config!=null){this.set(config)}}var keys;if(Object.keys){keys=Object.keys}else{keys=function(obj){var i,res=[];for(i in obj){if(hasOwnProp(obj,i)){res.push(i)}}return res}}var defaultCalendar={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function calendar(key,mom,now){var output=this._calendar[key]||this._calendar["sameElse"];return isFunction(output)?output.call(mom,now):output}function zeroFill(number,targetLength,forceSign){var absNumber=""+Math.abs(number),zerosToFill=targetLength-absNumber.length,sign=number>=0;return(sign?forceSign?"+":"":"-")+Math.pow(10,Math.max(0,zerosToFill)).toString().substr(1)+absNumber}var formattingTokens=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,formatFunctions={},formatTokenFunctions={};function addFormatToken(token,padded,ordinal,callback){var func=callback;if(typeof callback==="string"){func=function(){return this[callback]()}}if(token){formatTokenFunctions[token]=func}if(padded){formatTokenFunctions[padded[0]]=function(){return zeroFill(func.apply(this,arguments),padded[1],padded[2])}}if(ordinal){formatTokenFunctions[ordinal]=function(){return this.localeData().ordinal(func.apply(this,arguments),token)}}}function removeFormattingTokens(input){if(input.match(/\[[\s\S]/)){return input.replace(/^\[|\]$/g,"")}return input.replace(/\\/g,"")}function makeFormatFunction(format){var array=format.match(formattingTokens),i,length;for(i=0,length=array.length;i<length;i++){if(formatTokenFunctions[array[i]]){array[i]=formatTokenFunctions[array[i]]}else{array[i]=removeFormattingTokens(array[i])}}return function(mom){var output="",i;for(i=0;i<length;i++){output+=isFunction(array[i])?array[i].call(mom,format):array[i]}return output}}function formatMoment(m,format){if(!m.isValid()){return m.localeData().invalidDate()}format=expandFormat(format,m.localeData());formatFunctions[format]=formatFunctions[format]||makeFormatFunction(format);return formatFunctions[format](m)}function expandFormat(format,locale){var i=5;function replaceLongDateFormatTokens(input){return locale.longDateFormat(input)||input}localFormattingTokens.lastIndex=0;while(i>=0&&localFormattingTokens.test(format)){format=format.replace(localFormattingTokens,replaceLongDateFormatTokens);localFormattingTokens.lastIndex=0;i-=1}return format}var defaultLongDateFormat={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function longDateFormat(key){var format=this._longDateFormat[key],formatUpper=this._longDateFormat[key.toUpperCase()];if(format||!formatUpper){return format}this._longDateFormat[key]=formatUpper.match(formattingTokens).map(function(tok){if(tok==="MMMM"||tok==="MM"||tok==="DD"||tok==="dddd"){return tok.slice(1)}return tok}).join("");return this._longDateFormat[key]}var defaultInvalidDate="Invalid date";function invalidDate(){return this._invalidDate}var defaultOrdinal="%d",defaultDayOfMonthOrdinalParse=/\d{1,2}/;function ordinal(number){return this._ordinal.replace("%d",number)}var defaultRelativeTime={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function relativeTime(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return isFunction(output)?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number)}function pastFuture(diff,output){var format=this._relativeTime[diff>0?"future":"past"];return isFunction(format)?format(output):format.replace(/%s/i,output)}var aliases={};function addUnitAlias(unit,shorthand){var lowerCase=unit.toLowerCase();aliases[lowerCase]=aliases[lowerCase+"s"]=aliases[shorthand]=unit}function normalizeUnits(units){return typeof units==="string"?aliases[units]||aliases[units.toLowerCase()]:undefined}function normalizeObjectUnits(inputObject){var normalizedInput={},normalizedProp,prop;for(prop in inputObject){if(hasOwnProp(inputObject,prop)){normalizedProp=normalizeUnits(prop);if(normalizedProp){normalizedInput[normalizedProp]=inputObject[prop]}}}return normalizedInput}var priorities={};function addUnitPriority(unit,priority){priorities[unit]=priority}function getPrioritizedUnits(unitsObj){var units=[],u;for(u in unitsObj){if(hasOwnProp(unitsObj,u)){units.push({unit:u,priority:priorities[u]})}}units.sort(function(a,b){return a.priority-b.priority});return units}function isLeapYear(year){return year%4===0&&year%100!==0||year%400===0}function absFloor(number){if(number<0){return Math.ceil(number)||0}else{return Math.floor(number)}}function toInt(argumentForCoercion){var coercedNumber=+argumentForCoercion,value=0;if(coercedNumber!==0&&isFinite(coercedNumber)){value=absFloor(coercedNumber)}return value}function makeGetSet(unit,keepTime){return function(value){if(value!=null){set$1(this,unit,value);hooks.updateOffset(this,keepTime);return this}else{return get(this,unit)}}}function get(mom,unit){return mom.isValid()?mom._d["get"+(mom._isUTC?"UTC":"")+unit]():NaN}function set$1(mom,unit,value){if(mom.isValid()&&!isNaN(value)){if(unit==="FullYear"&&isLeapYear(mom.year())&&mom.month()===1&&mom.date()===29){value=toInt(value);mom._d["set"+(mom._isUTC?"UTC":"")+unit](value,mom.month(),daysInMonth(value,mom.month()))}else{mom._d["set"+(mom._isUTC?"UTC":"")+unit](value)}}}function stringGet(units){units=normalizeUnits(units);if(isFunction(this[units])){return this[units]()}return this}function stringSet(units,value){if(typeof units==="object"){units=normalizeObjectUnits(units);var prioritized=getPrioritizedUnits(units),i;for(i=0;i<prioritized.length;i++){this[prioritized[i].unit](units[prioritized[i].unit])}}else{units=normalizeUnits(units);if(isFunction(this[units])){return this[units](value)}}return this}var match1=/\d/,match2=/\d\d/,match3=/\d{3}/,match4=/\d{4}/,match6=/[+-]?\d{6}/,match1to2=/\d\d?/,match3to4=/\d\d\d\d?/,match5to6=/\d\d\d\d\d\d?/,match1to3=/\d{1,3}/,match1to4=/\d{1,4}/,match1to6=/[+-]?\d{1,6}/,matchUnsigned=/\d+/,matchSigned=/[+-]?\d+/,matchOffset=/Z|[+-]\d\d:?\d\d/gi,matchShortOffset=/Z|[+-]\d\d(?::?\d\d)?/gi,matchTimestamp=/[+-]?\d+(\.\d{1,3})?/,matchWord=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,regexes;regexes={};function addRegexToken(token,regex,strictRegex){regexes[token]=isFunction(regex)?regex:function(isStrict,localeData){return isStrict&&strictRegex?strictRegex:regex}}function getParseRegexForToken(token,config){if(!hasOwnProp(regexes,token)){return new RegExp(unescapeFormat(token))}return regexes[token](config._strict,config._locale)}function unescapeFormat(s){return regexEscape(s.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(matched,p1,p2,p3,p4){return p1||p2||p3||p4}))}function regexEscape(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}var tokens={};function addParseToken(token,callback){var i,func=callback;if(typeof token==="string"){token=[token]}if(isNumber(callback)){func=function(input,array){array[callback]=toInt(input)}}for(i=0;i<token.length;i++){tokens[token[i]]=func}}function addWeekParseToken(token,callback){addParseToken(token,function(input,array,config,token){config._w=config._w||{};callback(input,config._w,config,token)})}function addTimeToArrayFromToken(token,input,config){if(input!=null&&hasOwnProp(tokens,token)){tokens[token](input,config._a,config,token)}}var YEAR=0,MONTH=1,DATE=2,HOUR=3,MINUTE=4,SECOND=5,MILLISECOND=6,WEEK=7,WEEKDAY=8;function mod(n,x){return(n%x+x)%x}var indexOf;if(Array.prototype.indexOf){indexOf=Array.prototype.indexOf}else{indexOf=function(o){var i;for(i=0;i<this.length;++i){if(this[i]===o){return i}}return-1}}function daysInMonth(year,month){if(isNaN(year)||isNaN(month)){return NaN}var modMonth=mod(month,12);year+=(month-modMonth)/12;return modMonth===1?isLeapYear(year)?29:28:31-modMonth%7%2}addFormatToken("M",["MM",2],"Mo",function(){return this.month()+1});addFormatToken("MMM",0,0,function(format){return this.localeData().monthsShort(this,format)});addFormatToken("MMMM",0,0,function(format){return this.localeData().months(this,format)});addUnitAlias("month","M");addUnitPriority("month",8);addRegexToken("M",match1to2);addRegexToken("MM",match1to2,match2);addRegexToken("MMM",function(isStrict,locale){return locale.monthsShortRegex(isStrict)});addRegexToken("MMMM",function(isStrict,locale){return locale.monthsRegex(isStrict)});addParseToken(["M","MM"],function(input,array){array[MONTH]=toInt(input)-1});addParseToken(["MMM","MMMM"],function(input,array,config,token){var month=config._locale.monthsParse(input,token,config._strict);if(month!=null){array[MONTH]=month}else{getParsingFlags(config).invalidMonth=input}});var defaultLocaleMonths="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),defaultLocaleMonthsShort="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),MONTHS_IN_FORMAT=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,defaultMonthsShortRegex=matchWord,defaultMonthsRegex=matchWord;function localeMonths(m,format){if(!m){return isArray(this._months)?this._months:this._months["standalone"]}return isArray(this._months)?this._months[m.month()]:this._months[(this._months.isFormat||MONTHS_IN_FORMAT).test(format)?"format":"standalone"][m.month()]}function localeMonthsShort(m,format){if(!m){return isArray(this._monthsShort)?this._monthsShort:this._monthsShort["standalone"]}return isArray(this._monthsShort)?this._monthsShort[m.month()]:this._monthsShort[MONTHS_IN_FORMAT.test(format)?"format":"standalone"][m.month()]}function handleStrictParse(monthName,format,strict){var i,ii,mom,llc=monthName.toLocaleLowerCase();if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[];for(i=0;i<12;++i){mom=createUTC([2e3,i]);this._shortMonthsParse[i]=this.monthsShort(mom,"").toLocaleLowerCase();this._longMonthsParse[i]=this.months(mom,"").toLocaleLowerCase()}}if(strict){if(format==="MMM"){ii=indexOf.call(this._shortMonthsParse,llc);return ii!==-1?ii:null}else{ii=indexOf.call(this._longMonthsParse,llc);return ii!==-1?ii:null}}else{if(format==="MMM"){ii=indexOf.call(this._shortMonthsParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._longMonthsParse,llc);return ii!==-1?ii:null}else{ii=indexOf.call(this._longMonthsParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._shortMonthsParse,llc);return ii!==-1?ii:null}}}function localeMonthsParse(monthName,format,strict){var i,mom,regex;if(this._monthsParseExact){return handleStrictParse.call(this,monthName,format,strict)}if(!this._monthsParse){this._monthsParse=[];this._longMonthsParse=[];this._shortMonthsParse=[]}for(i=0;i<12;i++){mom=createUTC([2e3,i]);if(strict&&!this._longMonthsParse[i]){this._longMonthsParse[i]=new RegExp("^"+this.months(mom,"").replace(".","")+"$","i");this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(mom,"").replace(".","")+"$","i")}if(!strict&&!this._monthsParse[i]){regex="^"+this.months(mom,"")+"|^"+this.monthsShort(mom,"");this._monthsParse[i]=new RegExp(regex.replace(".",""),"i")}if(strict&&format==="MMMM"&&this._longMonthsParse[i].test(monthName)){return i}else if(strict&&format==="MMM"&&this._shortMonthsParse[i].test(monthName)){return i}else if(!strict&&this._monthsParse[i].test(monthName)){return i}}}function setMonth(mom,value){var dayOfMonth;if(!mom.isValid()){return mom}if(typeof value==="string"){if(/^\d+$/.test(value)){value=toInt(value)}else{value=mom.localeData().monthsParse(value);if(!isNumber(value)){return mom}}}dayOfMonth=Math.min(mom.date(),daysInMonth(mom.year(),value));mom._d["set"+(mom._isUTC?"UTC":"")+"Month"](value,dayOfMonth);return mom}function getSetMonth(value){if(value!=null){setMonth(this,value);hooks.updateOffset(this,true);return this}else{return get(this,"Month")}}function getDaysInMonth(){return daysInMonth(this.year(),this.month())}function monthsShortRegex(isStrict){if(this._monthsParseExact){if(!hasOwnProp(this,"_monthsRegex")){computeMonthsParse.call(this)}if(isStrict){return this._monthsShortStrictRegex}else{return this._monthsShortRegex}}else{if(!hasOwnProp(this,"_monthsShortRegex")){this._monthsShortRegex=defaultMonthsShortRegex}return this._monthsShortStrictRegex&&isStrict?this._monthsShortStrictRegex:this._monthsShortRegex}}function monthsRegex(isStrict){if(this._monthsParseExact){if(!hasOwnProp(this,"_monthsRegex")){computeMonthsParse.call(this)}if(isStrict){return this._monthsStrictRegex}else{return this._monthsRegex}}else{if(!hasOwnProp(this,"_monthsRegex")){this._monthsRegex=defaultMonthsRegex}return this._monthsStrictRegex&&isStrict?this._monthsStrictRegex:this._monthsRegex}}function computeMonthsParse(){function cmpLenRev(a,b){return b.length-a.length}var shortPieces=[],longPieces=[],mixedPieces=[],i,mom;for(i=0;i<12;i++){mom=createUTC([2e3,i]);shortPieces.push(this.monthsShort(mom,""));longPieces.push(this.months(mom,""));mixedPieces.push(this.months(mom,""));mixedPieces.push(this.monthsShort(mom,""))}shortPieces.sort(cmpLenRev);longPieces.sort(cmpLenRev);mixedPieces.sort(cmpLenRev);for(i=0;i<12;i++){shortPieces[i]=regexEscape(shortPieces[i]);longPieces[i]=regexEscape(longPieces[i])}for(i=0;i<24;i++){mixedPieces[i]=regexEscape(mixedPieces[i])}this._monthsRegex=new RegExp("^("+mixedPieces.join("|")+")","i");this._monthsShortRegex=this._monthsRegex;this._monthsStrictRegex=new RegExp("^("+longPieces.join("|")+")","i");this._monthsShortStrictRegex=new RegExp("^("+shortPieces.join("|")+")","i")}addFormatToken("Y",0,0,function(){var y=this.year();return y<=9999?zeroFill(y,4):"+"+y});addFormatToken(0,["YY",2],0,function(){return this.year()%100});addFormatToken(0,["YYYY",4],0,"year");addFormatToken(0,["YYYYY",5],0,"year");addFormatToken(0,["YYYYYY",6,true],0,"year");addUnitAlias("year","y");addUnitPriority("year",1);addRegexToken("Y",matchSigned);addRegexToken("YY",match1to2,match2);addRegexToken("YYYY",match1to4,match4);addRegexToken("YYYYY",match1to6,match6);addRegexToken("YYYYYY",match1to6,match6);addParseToken(["YYYYY","YYYYYY"],YEAR);addParseToken("YYYY",function(input,array){array[YEAR]=input.length===2?hooks.parseTwoDigitYear(input):toInt(input)});addParseToken("YY",function(input,array){array[YEAR]=hooks.parseTwoDigitYear(input)});addParseToken("Y",function(input,array){array[YEAR]=parseInt(input,10)});function daysInYear(year){return isLeapYear(year)?366:365}hooks.parseTwoDigitYear=function(input){return toInt(input)+(toInt(input)>68?1900:2e3)};var getSetYear=makeGetSet("FullYear",true);function getIsLeapYear(){return isLeapYear(this.year())}function createDate(y,m,d,h,M,s,ms){var date;if(y<100&&y>=0){date=new Date(y+400,m,d,h,M,s,ms);if(isFinite(date.getFullYear())){date.setFullYear(y)}}else{date=new Date(y,m,d,h,M,s,ms)}return date}function createUTCDate(y){var date,args;if(y<100&&y>=0){args=Array.prototype.slice.call(arguments);args[0]=y+400;date=new Date(Date.UTC.apply(null,args));if(isFinite(date.getUTCFullYear())){date.setUTCFullYear(y)}}else{date=new Date(Date.UTC.apply(null,arguments))}return date}function firstWeekOffset(year,dow,doy){var fwd=7+dow-doy,fwdlw=(7+createUTCDate(year,0,fwd).getUTCDay()-dow)%7;return-fwdlw+fwd-1}function dayOfYearFromWeeks(year,week,weekday,dow,doy){var localWeekday=(7+weekday-dow)%7,weekOffset=firstWeekOffset(year,dow,doy),dayOfYear=1+7*(week-1)+localWeekday+weekOffset,resYear,resDayOfYear;if(dayOfYear<=0){resYear=year-1;resDayOfYear=daysInYear(resYear)+dayOfYear}else if(dayOfYear>daysInYear(year)){resYear=year+1;resDayOfYear=dayOfYear-daysInYear(year)}else{resYear=year;resDayOfYear=dayOfYear}return{year:resYear,dayOfYear:resDayOfYear}}function weekOfYear(mom,dow,doy){var weekOffset=firstWeekOffset(mom.year(),dow,doy),week=Math.floor((mom.dayOfYear()-weekOffset-1)/7)+1,resWeek,resYear;if(week<1){resYear=mom.year()-1;resWeek=week+weeksInYear(resYear,dow,doy)}else if(week>weeksInYear(mom.year(),dow,doy)){resWeek=week-weeksInYear(mom.year(),dow,doy);resYear=mom.year()+1}else{resYear=mom.year();resWeek=week}return{week:resWeek,year:resYear}}function weeksInYear(year,dow,doy){var weekOffset=firstWeekOffset(year,dow,doy),weekOffsetNext=firstWeekOffset(year+1,dow,doy);return(daysInYear(year)-weekOffset+weekOffsetNext)/7}addFormatToken("w",["ww",2],"wo","week");addFormatToken("W",["WW",2],"Wo","isoWeek");addUnitAlias("week","w");addUnitAlias("isoWeek","W");addUnitPriority("week",5);addUnitPriority("isoWeek",5);addRegexToken("w",match1to2);addRegexToken("ww",match1to2,match2);addRegexToken("W",match1to2);addRegexToken("WW",match1to2,match2);addWeekParseToken(["w","ww","W","WW"],function(input,week,config,token){week[token.substr(0,1)]=toInt(input)});function localeWeek(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week}var defaultLocaleWeek={dow:0,doy:6};function localeFirstDayOfWeek(){return this._week.dow}function localeFirstDayOfYear(){return this._week.doy}function getSetWeek(input){var week=this.localeData().week(this);return input==null?week:this.add((input-week)*7,"d")}function getSetISOWeek(input){var week=weekOfYear(this,1,4).week;return input==null?week:this.add((input-week)*7,"d")}addFormatToken("d",0,"do","day");addFormatToken("dd",0,0,function(format){return this.localeData().weekdaysMin(this,format)});addFormatToken("ddd",0,0,function(format){return this.localeData().weekdaysShort(this,format)});addFormatToken("dddd",0,0,function(format){return this.localeData().weekdays(this,format)});addFormatToken("e",0,0,"weekday");addFormatToken("E",0,0,"isoWeekday");addUnitAlias("day","d");addUnitAlias("weekday","e");addUnitAlias("isoWeekday","E");addUnitPriority("day",11);addUnitPriority("weekday",11);addUnitPriority("isoWeekday",11);addRegexToken("d",match1to2);addRegexToken("e",match1to2);addRegexToken("E",match1to2);addRegexToken("dd",function(isStrict,locale){return locale.weekdaysMinRegex(isStrict)});addRegexToken("ddd",function(isStrict,locale){return locale.weekdaysShortRegex(isStrict)});addRegexToken("dddd",function(isStrict,locale){return locale.weekdaysRegex(isStrict)});addWeekParseToken(["dd","ddd","dddd"],function(input,week,config,token){var weekday=config._locale.weekdaysParse(input,token,config._strict);if(weekday!=null){week.d=weekday}else{getParsingFlags(config).invalidWeekday=input}});addWeekParseToken(["d","e","E"],function(input,week,config,token){week[token]=toInt(input)});function parseWeekday(input,locale){if(typeof input!=="string"){return input}if(!isNaN(input)){return parseInt(input,10)}input=locale.weekdaysParse(input);if(typeof input==="number"){return input}return null}function parseIsoWeekday(input,locale){if(typeof input==="string"){return locale.weekdaysParse(input)%7||7}return isNaN(input)?null:input}function shiftWeekdays(ws,n){return ws.slice(n,7).concat(ws.slice(0,n))}var defaultLocaleWeekdays="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),defaultLocaleWeekdaysShort="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),defaultLocaleWeekdaysMin="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),defaultWeekdaysRegex=matchWord,defaultWeekdaysShortRegex=matchWord,defaultWeekdaysMinRegex=matchWord;function localeWeekdays(m,format){var weekdays=isArray(this._weekdays)?this._weekdays:this._weekdays[m&&m!==true&&this._weekdays.isFormat.test(format)?"format":"standalone"];return m===true?shiftWeekdays(weekdays,this._week.dow):m?weekdays[m.day()]:weekdays}function localeWeekdaysShort(m){return m===true?shiftWeekdays(this._weekdaysShort,this._week.dow):m?this._weekdaysShort[m.day()]:this._weekdaysShort}function localeWeekdaysMin(m){return m===true?shiftWeekdays(this._weekdaysMin,this._week.dow):m?this._weekdaysMin[m.day()]:this._weekdaysMin}function handleStrictParse$1(weekdayName,format,strict){var i,ii,mom,llc=weekdayName.toLocaleLowerCase();if(!this._weekdaysParse){this._weekdaysParse=[];this._shortWeekdaysParse=[];this._minWeekdaysParse=[];for(i=0;i<7;++i){mom=createUTC([2e3,1]).day(i);this._minWeekdaysParse[i]=this.weekdaysMin(mom,"").toLocaleLowerCase();this._shortWeekdaysParse[i]=this.weekdaysShort(mom,"").toLocaleLowerCase();this._weekdaysParse[i]=this.weekdays(mom,"").toLocaleLowerCase()}}if(strict){if(format==="dddd"){ii=indexOf.call(this._weekdaysParse,llc);return ii!==-1?ii:null}else if(format==="ddd"){ii=indexOf.call(this._shortWeekdaysParse,llc);return ii!==-1?ii:null}else{ii=indexOf.call(this._minWeekdaysParse,llc);return ii!==-1?ii:null}}else{if(format==="dddd"){ii=indexOf.call(this._weekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._shortWeekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._minWeekdaysParse,llc);return ii!==-1?ii:null}else if(format==="ddd"){ii=indexOf.call(this._shortWeekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._weekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._minWeekdaysParse,llc);return ii!==-1?ii:null}else{ii=indexOf.call(this._minWeekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._weekdaysParse,llc);if(ii!==-1){return ii}ii=indexOf.call(this._shortWeekdaysParse,llc);return ii!==-1?ii:null}}}function localeWeekdaysParse(weekdayName,format,strict){var i,mom,regex;if(this._weekdaysParseExact){return handleStrictParse$1.call(this,weekdayName,format,strict)}if(!this._weekdaysParse){this._weekdaysParse=[];this._minWeekdaysParse=[];this._shortWeekdaysParse=[];this._fullWeekdaysParse=[]}for(i=0;i<7;i++){mom=createUTC([2e3,1]).day(i);if(strict&&!this._fullWeekdaysParse[i]){this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(mom,"").replace(".","\\.?")+"$","i");this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(mom,"").replace(".","\\.?")+"$","i");this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(mom,"").replace(".","\\.?")+"$","i")}if(!this._weekdaysParse[i]){regex="^"+this.weekdays(mom,"")+"|^"+this.weekdaysShort(mom,"")+"|^"+this.weekdaysMin(mom,"");this._weekdaysParse[i]=new RegExp(regex.replace(".",""),"i")}if(strict&&format==="dddd"&&this._fullWeekdaysParse[i].test(weekdayName)){return i}else if(strict&&format==="ddd"&&this._shortWeekdaysParse[i].test(weekdayName)){return i}else if(strict&&format==="dd"&&this._minWeekdaysParse[i].test(weekdayName)){return i}else if(!strict&&this._weekdaysParse[i].test(weekdayName)){return i}}}function getSetDayOfWeek(input){if(!this.isValid()){return input!=null?this:NaN}var day=this._isUTC?this._d.getUTCDay():this._d.getDay();if(input!=null){input=parseWeekday(input,this.localeData());return this.add(input-day,"d")}else{return day}}function getSetLocaleDayOfWeek(input){if(!this.isValid()){return input!=null?this:NaN}var weekday=(this.day()+7-this.localeData()._week.dow)%7;return input==null?weekday:this.add(input-weekday,"d")}function getSetISODayOfWeek(input){if(!this.isValid()){return input!=null?this:NaN}if(input!=null){var weekday=parseIsoWeekday(input,this.localeData());return this.day(this.day()%7?weekday:weekday-7)}else{return this.day()||7}}function weekdaysRegex(isStrict){if(this._weekdaysParseExact){if(!hasOwnProp(this,"_weekdaysRegex")){computeWeekdaysParse.call(this)}if(isStrict){return this._weekdaysStrictRegex}else{return this._weekdaysRegex}}else{if(!hasOwnProp(this,"_weekdaysRegex")){this._weekdaysRegex=defaultWeekdaysRegex}return this._weekdaysStrictRegex&&isStrict?this._weekdaysStrictRegex:this._weekdaysRegex}}function weekdaysShortRegex(isStrict){if(this._weekdaysParseExact){if(!hasOwnProp(this,"_weekdaysRegex")){computeWeekdaysParse.call(this)}if(isStrict){return this._weekdaysShortStrictRegex}else{return this._weekdaysShortRegex}}else{if(!hasOwnProp(this,"_weekdaysShortRegex")){this._weekdaysShortRegex=defaultWeekdaysShortRegex}return this._weekdaysShortStrictRegex&&isStrict?this._weekdaysShortStrictRegex:this._weekdaysShortRegex}}function weekdaysMinRegex(isStrict){if(this._weekdaysParseExact){if(!hasOwnProp(this,"_weekdaysRegex")){computeWeekdaysParse.call(this)}if(isStrict){return this._weekdaysMinStrictRegex}else{return this._weekdaysMinRegex}}else{if(!hasOwnProp(this,"_weekdaysMinRegex")){this._weekdaysMinRegex=defaultWeekdaysMinRegex}return this._weekdaysMinStrictRegex&&isStrict?this._weekdaysMinStrictRegex:this._weekdaysMinRegex}}function computeWeekdaysParse(){function cmpLenRev(a,b){return b.length-a.length}var minPieces=[],shortPieces=[],longPieces=[],mixedPieces=[],i,mom,minp,shortp,longp;for(i=0;i<7;i++){mom=createUTC([2e3,1]).day(i);minp=regexEscape(this.weekdaysMin(mom,""));shortp=regexEscape(this.weekdaysShort(mom,""));longp=regexEscape(this.weekdays(mom,""));minPieces.push(minp);shortPieces.push(shortp);longPieces.push(longp);mixedPieces.push(minp);mixedPieces.push(shortp);mixedPieces.push(longp)}minPieces.sort(cmpLenRev);shortPieces.sort(cmpLenRev);longPieces.sort(cmpLenRev);mixedPieces.sort(cmpLenRev);this._weekdaysRegex=new RegExp("^("+mixedPieces.join("|")+")","i");this._weekdaysShortRegex=this._weekdaysRegex;this._weekdaysMinRegex=this._weekdaysRegex;this._weekdaysStrictRegex=new RegExp("^("+longPieces.join("|")+")","i");this._weekdaysShortStrictRegex=new RegExp("^("+shortPieces.join("|")+")","i");this._weekdaysMinStrictRegex=new RegExp("^("+minPieces.join("|")+")","i")}function hFormat(){return this.hours()%12||12}function kFormat(){return this.hours()||24}addFormatToken("H",["HH",2],0,"hour");addFormatToken("h",["hh",2],0,hFormat);addFormatToken("k",["kk",2],0,kFormat);addFormatToken("hmm",0,0,function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)});addFormatToken("hmmss",0,0,function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)});addFormatToken("Hmm",0,0,function(){return""+this.hours()+zeroFill(this.minutes(),2)});addFormatToken("Hmmss",0,0,function(){return""+this.hours()+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)});function meridiem(token,lowercase){addFormatToken(token,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),lowercase)})}meridiem("a",true);meridiem("A",false);addUnitAlias("hour","h");addUnitPriority("hour",13);function matchMeridiem(isStrict,locale){return locale._meridiemParse}addRegexToken("a",matchMeridiem);addRegexToken("A",matchMeridiem);addRegexToken("H",match1to2);addRegexToken("h",match1to2);addRegexToken("k",match1to2);addRegexToken("HH",match1to2,match2);addRegexToken("hh",match1to2,match2);addRegexToken("kk",match1to2,match2);addRegexToken("hmm",match3to4);addRegexToken("hmmss",match5to6);addRegexToken("Hmm",match3to4);addRegexToken("Hmmss",match5to6);addParseToken(["H","HH"],HOUR);addParseToken(["k","kk"],function(input,array,config){var kInput=toInt(input);array[HOUR]=kInput===24?0:kInput});addParseToken(["a","A"],function(input,array,config){config._isPm=config._locale.isPM(input);config._meridiem=input});addParseToken(["h","hh"],function(input,array,config){array[HOUR]=toInt(input);getParsingFlags(config).bigHour=true});addParseToken("hmm",function(input,array,config){var pos=input.length-2;array[HOUR]=toInt(input.substr(0,pos));array[MINUTE]=toInt(input.substr(pos));getParsingFlags(config).bigHour=true});addParseToken("hmmss",function(input,array,config){var pos1=input.length-4,pos2=input.length-2;array[HOUR]=toInt(input.substr(0,pos1));array[MINUTE]=toInt(input.substr(pos1,2));array[SECOND]=toInt(input.substr(pos2));getParsingFlags(config).bigHour=true});addParseToken("Hmm",function(input,array,config){var pos=input.length-2;array[HOUR]=toInt(input.substr(0,pos));array[MINUTE]=toInt(input.substr(pos))});addParseToken("Hmmss",function(input,array,config){var pos1=input.length-4,pos2=input.length-2;array[HOUR]=toInt(input.substr(0,pos1));array[MINUTE]=toInt(input.substr(pos1,2));array[SECOND]=toInt(input.substr(pos2))});function localeIsPM(input){return(input+"").toLowerCase().charAt(0)==="p"}var defaultLocaleMeridiemParse=/[ap]\.?m?\.?/i,getSetHour=makeGetSet("Hours",true);function localeMeridiem(hours,minutes,isLower){if(hours>11){return isLower?"pm":"PM"}else{return isLower?"am":"AM"}}var baseConfig={calendar:defaultCalendar,longDateFormat:defaultLongDateFormat,invalidDate:defaultInvalidDate,ordinal:defaultOrdinal,dayOfMonthOrdinalParse:defaultDayOfMonthOrdinalParse,relativeTime:defaultRelativeTime,months:defaultLocaleMonths,monthsShort:defaultLocaleMonthsShort,week:defaultLocaleWeek,weekdays:defaultLocaleWeekdays,weekdaysMin:defaultLocaleWeekdaysMin,weekdaysShort:defaultLocaleWeekdaysShort,meridiemParse:defaultLocaleMeridiemParse};var locales={},localeFamilies={},globalLocale;function commonPrefix(arr1,arr2){var i,minl=Math.min(arr1.length,arr2.length);for(i=0;i<minl;i+=1){if(arr1[i]!==arr2[i]){return i}}return minl}function normalizeLocale(key){return key?key.toLowerCase().replace("_","-"):key}function chooseLocale(names){var i=0,j,next,locale,split;while(i<names.length){split=normalizeLocale(names[i]).split("-");j=split.length;next=normalizeLocale(names[i+1]);next=next?next.split("-"):null;while(j>0){locale=loadLocale(split.slice(0,j).join("-"));if(locale){return locale}if(next&&next.length>=j&&commonPrefix(split,next)>=j-1){break}j--}i++}return globalLocale}function loadLocale(name){var oldLocale=null,aliasedRequire;if(locales[name]===undefined&&typeof module!=="undefined"&&module&&module.exports){try{oldLocale=globalLocale._abbr;aliasedRequire=require;aliasedRequire("./locale/"+name);getSetGlobalLocale(oldLocale)}catch(e){locales[name]=null}}return locales[name]}function getSetGlobalLocale(key,values){var data;if(key){if(isUndefined(values)){data=getLocale(key)}else{data=defineLocale(key,values)}if(data){globalLocale=data}else{if(typeof console!=="undefined"&&console.warn){console.warn("Locale "+key+" not found. Did you forget to load it?")}}}return globalLocale._abbr}function defineLocale(name,config){if(config!==null){var locale,parentConfig=baseConfig;config.abbr=name;if(locales[name]!=null){deprecateSimple("defineLocaleOverride","use moment.updateLocale(localeName, config) to change "+"an existing locale. moment.defineLocale(localeName, "+"config) should only be used for creating a new locale "+"See http://momentjs.com/guides/#/warnings/define-locale/ for more info.");parentConfig=locales[name]._config}else if(config.parentLocale!=null){if(locales[config.parentLocale]!=null){parentConfig=locales[config.parentLocale]._config}else{locale=loadLocale(config.parentLocale);if(locale!=null){parentConfig=locale._config}else{if(!localeFamilies[config.parentLocale]){localeFamilies[config.parentLocale]=[]}localeFamilies[config.parentLocale].push({name:name,config:config});return null}}}locales[name]=new Locale(mergeConfigs(parentConfig,config));if(localeFamilies[name]){localeFamilies[name].forEach(function(x){defineLocale(x.name,x.config)})}getSetGlobalLocale(name);return locales[name]}else{delete locales[name];return null}}function updateLocale(name,config){if(config!=null){var locale,tmpLocale,parentConfig=baseConfig;if(locales[name]!=null&&locales[name].parentLocale!=null){locales[name].set(mergeConfigs(locales[name]._config,config))}else{tmpLocale=loadLocale(name);if(tmpLocale!=null){parentConfig=tmpLocale._config}config=mergeConfigs(parentConfig,config);if(tmpLocale==null){config.abbr=name}locale=new Locale(config);locale.parentLocale=locales[name];locales[name]=locale}getSetGlobalLocale(name)}else{if(locales[name]!=null){if(locales[name].parentLocale!=null){locales[name]=locales[name].parentLocale;if(name===getSetGlobalLocale()){getSetGlobalLocale(name)}}else if(locales[name]!=null){delete locales[name]}}}return locales[name]}function getLocale(key){var locale;if(key&&key._locale&&key._locale._abbr){key=key._locale._abbr}if(!key){return globalLocale}if(!isArray(key)){locale=loadLocale(key);if(locale){return locale}key=[key]}return chooseLocale(key)}function listLocales(){return keys(locales)}function checkOverflow(m){var overflow,a=m._a;if(a&&getParsingFlags(m).overflow===-2){overflow=a[MONTH]<0||a[MONTH]>11?MONTH:a[DATE]<1||a[DATE]>daysInMonth(a[YEAR],a[MONTH])?DATE:a[HOUR]<0||a[HOUR]>24||a[HOUR]===24&&(a[MINUTE]!==0||a[SECOND]!==0||a[MILLISECOND]!==0)?HOUR:a[MINUTE]<0||a[MINUTE]>59?MINUTE:a[SECOND]<0||a[SECOND]>59?SECOND:a[MILLISECOND]<0||a[MILLISECOND]>999?MILLISECOND:-1;if(getParsingFlags(m)._overflowDayOfYear&&(overflow<YEAR||overflow>DATE)){overflow=DATE}if(getParsingFlags(m)._overflowWeeks&&overflow===-1){overflow=WEEK}if(getParsingFlags(m)._overflowWeekday&&overflow===-1){overflow=WEEKDAY}getParsingFlags(m).overflow=overflow}return m}var extendedIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,basicIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,tzRegex=/Z|[+-]\d\d(?::?\d\d)?/,isoDates=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,false],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,false],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,false],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,false],["YYYY",/\d{4}/,false]],isoTimes=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],aspNetJsonRegex=/^\/?Date\((-?\d+)/i,rfc2822=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,obsOffsets={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function configFromISO(config){var i,l,string=config._i,match=extendedIsoRegex.exec(string)||basicIsoRegex.exec(string),allowTime,dateFormat,timeFormat,tzFormat;if(match){getParsingFlags(config).iso=true;for(i=0,l=isoDates.length;i<l;i++){if(isoDates[i][1].exec(match[1])){dateFormat=isoDates[i][0];allowTime=isoDates[i][2]!==false;break}}if(dateFormat==null){config._isValid=false;return}if(match[3]){for(i=0,l=isoTimes.length;i<l;i++){if(isoTimes[i][1].exec(match[3])){timeFormat=(match[2]||" ")+isoTimes[i][0];break}}if(timeFormat==null){config._isValid=false;return}}if(!allowTime&&timeFormat!=null){config._isValid=false;return}if(match[4]){if(tzRegex.exec(match[4])){tzFormat="Z"}else{config._isValid=false;return}}config._f=dateFormat+(timeFormat||"")+(tzFormat||"");configFromStringAndFormat(config)}else{config._isValid=false}}function extractFromRFC2822Strings(yearStr,monthStr,dayStr,hourStr,minuteStr,secondStr){var result=[untruncateYear(yearStr),defaultLocaleMonthsShort.indexOf(monthStr),parseInt(dayStr,10),parseInt(hourStr,10),parseInt(minuteStr,10)];if(secondStr){result.push(parseInt(secondStr,10))}return result}function untruncateYear(yearStr){var year=parseInt(yearStr,10);if(year<=49){return 2e3+year}else if(year<=999){return 1900+year}return year}function preprocessRFC2822(s){return s.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function checkWeekday(weekdayStr,parsedInput,config){if(weekdayStr){var weekdayProvided=defaultLocaleWeekdaysShort.indexOf(weekdayStr),weekdayActual=new Date(parsedInput[0],parsedInput[1],parsedInput[2]).getDay();if(weekdayProvided!==weekdayActual){getParsingFlags(config).weekdayMismatch=true;config._isValid=false;return false}}return true}function calculateOffset(obsOffset,militaryOffset,numOffset){if(obsOffset){return obsOffsets[obsOffset]}else if(militaryOffset){return 0}else{var hm=parseInt(numOffset,10),m=hm%100,h=(hm-m)/100;return h*60+m}}function configFromRFC2822(config){var match=rfc2822.exec(preprocessRFC2822(config._i)),parsedArray;if(match){parsedArray=extractFromRFC2822Strings(match[4],match[3],match[2],match[5],match[6],match[7]);if(!checkWeekday(match[1],parsedArray,config)){return}config._a=parsedArray;config._tzm=calculateOffset(match[8],match[9],match[10]);config._d=createUTCDate.apply(null,config._a);config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm);getParsingFlags(config).rfc2822=true}else{config._isValid=false}}function configFromString(config){var matched=aspNetJsonRegex.exec(config._i);if(matched!==null){config._d=new Date(+matched[1]);return}configFromISO(config);if(config._isValid===false){delete config._isValid}else{return}configFromRFC2822(config);if(config._isValid===false){delete config._isValid}else{return}if(config._strict){config._isValid=false}else{hooks.createFromInputFallback(config)}}hooks.createFromInputFallback=deprecate("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), "+"which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are "+"discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(config){config._d=new Date(config._i+(config._useUTC?" UTC":""))});function defaults(a,b,c){if(a!=null){return a}if(b!=null){return b}return c}function currentDateArray(config){var nowValue=new Date(hooks.now());if(config._useUTC){return[nowValue.getUTCFullYear(),nowValue.getUTCMonth(),nowValue.getUTCDate()]}return[nowValue.getFullYear(),nowValue.getMonth(),nowValue.getDate()]}function configFromArray(config){var i,date,input=[],currentDate,expectedWeekday,yearToUse;if(config._d){return}currentDate=currentDateArray(config);if(config._w&&config._a[DATE]==null&&config._a[MONTH]==null){dayOfYearFromWeekInfo(config)}if(config._dayOfYear!=null){yearToUse=defaults(config._a[YEAR],currentDate[YEAR]);if(config._dayOfYear>daysInYear(yearToUse)||config._dayOfYear===0){getParsingFlags(config)._overflowDayOfYear=true}date=createUTCDate(yearToUse,0,config._dayOfYear);config._a[MONTH]=date.getUTCMonth();config._a[DATE]=date.getUTCDate()}for(i=0;i<3&&config._a[i]==null;++i){config._a[i]=input[i]=currentDate[i]}for(;i<7;i++){config._a[i]=input[i]=config._a[i]==null?i===2?1:0:config._a[i]}if(config._a[HOUR]===24&&config._a[MINUTE]===0&&config._a[SECOND]===0&&config._a[MILLISECOND]===0){config._nextDay=true;config._a[HOUR]=0}config._d=(config._useUTC?createUTCDate:createDate).apply(null,input);expectedWeekday=config._useUTC?config._d.getUTCDay():config._d.getDay();if(config._tzm!=null){config._d.setUTCMinutes(config._d.getUTCMinutes()-config._tzm)}if(config._nextDay){config._a[HOUR]=24}if(config._w&&typeof config._w.d!=="undefined"&&config._w.d!==expectedWeekday){getParsingFlags(config).weekdayMismatch=true}}function dayOfYearFromWeekInfo(config){var w,weekYear,week,weekday,dow,doy,temp,weekdayOverflow,curWeek;w=config._w;if(w.GG!=null||w.W!=null||w.E!=null){dow=1;doy=4;weekYear=defaults(w.GG,config._a[YEAR],weekOfYear(createLocal(),1,4).year);week=defaults(w.W,1);weekday=defaults(w.E,1);if(weekday<1||weekday>7){weekdayOverflow=true}}else{dow=config._locale._week.dow;doy=config._locale._week.doy;curWeek=weekOfYear(createLocal(),dow,doy);weekYear=defaults(w.gg,config._a[YEAR],curWeek.year);week=defaults(w.w,curWeek.week);if(w.d!=null){weekday=w.d;if(weekday<0||weekday>6){weekdayOverflow=true}}else if(w.e!=null){weekday=w.e+dow;if(w.e<0||w.e>6){weekdayOverflow=true}}else{weekday=dow}}if(week<1||week>weeksInYear(weekYear,dow,doy)){getParsingFlags(config)._overflowWeeks=true}else if(weekdayOverflow!=null){getParsingFlags(config)._overflowWeekday=true}else{temp=dayOfYearFromWeeks(weekYear,week,weekday,dow,doy);config._a[YEAR]=temp.year;config._dayOfYear=temp.dayOfYear}}hooks.ISO_8601=function(){};hooks.RFC_2822=function(){};function configFromStringAndFormat(config){if(config._f===hooks.ISO_8601){configFromISO(config);return}if(config._f===hooks.RFC_2822){configFromRFC2822(config);return}config._a=[];getParsingFlags(config).empty=true;var string=""+config._i,i,parsedInput,tokens,token,skipped,stringLength=string.length,totalParsedInputLength=0,era;tokens=expandFormat(config._f,config._locale).match(formattingTokens)||[];for(i=0;i<tokens.length;i++){token=tokens[i];parsedInput=(string.match(getParseRegexForToken(token,config))||[])[0];if(parsedInput){skipped=string.substr(0,string.indexOf(parsedInput));if(skipped.length>0){getParsingFlags(config).unusedInput.push(skipped)}string=string.slice(string.indexOf(parsedInput)+parsedInput.length);totalParsedInputLength+=parsedInput.length}if(formatTokenFunctions[token]){if(parsedInput){getParsingFlags(config).empty=false}else{getParsingFlags(config).unusedTokens.push(token)}addTimeToArrayFromToken(token,parsedInput,config)}else if(config._strict&&!parsedInput){getParsingFlags(config).unusedTokens.push(token)}}getParsingFlags(config).charsLeftOver=stringLength-totalParsedInputLength;if(string.length>0){getParsingFlags(config).unusedInput.push(string)}if(config._a[HOUR]<=12&&getParsingFlags(config).bigHour===true&&config._a[HOUR]>0){getParsingFlags(config).bigHour=undefined}getParsingFlags(config).parsedDateParts=config._a.slice(0);getParsingFlags(config).meridiem=config._meridiem;config._a[HOUR]=meridiemFixWrap(config._locale,config._a[HOUR],config._meridiem);era=getParsingFlags(config).era;if(era!==null){config._a[YEAR]=config._locale.erasConvertYear(era,config._a[YEAR])}configFromArray(config);checkOverflow(config)}function meridiemFixWrap(locale,hour,meridiem){var isPm;if(meridiem==null){return hour}if(locale.meridiemHour!=null){return locale.meridiemHour(hour,meridiem)}else if(locale.isPM!=null){isPm=locale.isPM(meridiem);if(isPm&&hour<12){hour+=12}if(!isPm&&hour===12){hour=0}return hour}else{return hour}}function configFromStringAndArray(config){var tempConfig,bestMoment,scoreToBeat,i,currentScore,validFormatFound,bestFormatIsValid=false;if(config._f.length===0){getParsingFlags(config).invalidFormat=true;config._d=new Date(NaN);return}for(i=0;i<config._f.length;i++){currentScore=0;validFormatFound=false;tempConfig=copyConfig({},config);if(config._useUTC!=null){tempConfig._useUTC=config._useUTC}tempConfig._f=config._f[i];configFromStringAndFormat(tempConfig);if(isValid(tempConfig)){validFormatFound=true}currentScore+=getParsingFlags(tempConfig).charsLeftOver;currentScore+=getParsingFlags(tempConfig).unusedTokens.length*10;getParsingFlags(tempConfig).score=currentScore;if(!bestFormatIsValid){if(scoreToBeat==null||currentScore<scoreToBeat||validFormatFound){scoreToBeat=currentScore;bestMoment=tempConfig;if(validFormatFound){bestFormatIsValid=true}}}else{if(currentScore<scoreToBeat){scoreToBeat=currentScore;bestMoment=tempConfig}}}extend(config,bestMoment||tempConfig)}function configFromObject(config){if(config._d){return}var i=normalizeObjectUnits(config._i),dayOrDate=i.day===undefined?i.date:i.day;config._a=map([i.year,i.month,dayOrDate,i.hour,i.minute,i.second,i.millisecond],function(obj){return obj&&parseInt(obj,10)});configFromArray(config)}function createFromConfig(config){var res=new Moment(checkOverflow(prepareConfig(config)));if(res._nextDay){res.add(1,"d");res._nextDay=undefined}return res}function prepareConfig(config){var input=config._i,format=config._f;config._locale=config._locale||getLocale(config._l);if(input===null||format===undefined&&input===""){return createInvalid({nullInput:true})}if(typeof input==="string"){config._i=input=config._locale.preparse(input)}if(isMoment(input)){return new Moment(checkOverflow(input))}else if(isDate(input)){config._d=input}else if(isArray(format)){configFromStringAndArray(config)}else if(format){configFromStringAndFormat(config)}else{configFromInput(config)}if(!isValid(config)){config._d=null}return config}function configFromInput(config){var input=config._i;if(isUndefined(input)){config._d=new Date(hooks.now())}else if(isDate(input)){config._d=new Date(input.valueOf())}else if(typeof input==="string"){configFromString(config)}else if(isArray(input)){config._a=map(input.slice(0),function(obj){return parseInt(obj,10)});configFromArray(config)}else if(isObject(input)){configFromObject(config)}else if(isNumber(input)){config._d=new Date(input)}else{hooks.createFromInputFallback(config)}}function createLocalOrUTC(input,format,locale,strict,isUTC){var c={};if(format===true||format===false){strict=format;format=undefined}if(locale===true||locale===false){strict=locale;locale=undefined}if(isObject(input)&&isObjectEmpty(input)||isArray(input)&&input.length===0){input=undefined}c._isAMomentObject=true;c._useUTC=c._isUTC=isUTC;c._l=locale;c._i=input;c._f=format;c._strict=strict;return createFromConfig(c)}function createLocal(input,format,locale,strict){return createLocalOrUTC(input,format,locale,strict,false)}var prototypeMin=deprecate("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var other=createLocal.apply(null,arguments);if(this.isValid()&&other.isValid()){return other<this?this:other}else{return createInvalid()}}),prototypeMax=deprecate("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var other=createLocal.apply(null,arguments);if(this.isValid()&&other.isValid()){return other>this?this:other}else{return createInvalid()}});function pickBy(fn,moments){var res,i;if(moments.length===1&&isArray(moments[0])){moments=moments[0]}if(!moments.length){return createLocal()}res=moments[0];for(i=1;i<moments.length;++i){if(!moments[i].isValid()||moments[i][fn](res)){res=moments[i]}}return res}function min(){var args=[].slice.call(arguments,0);return pickBy("isBefore",args)}function max(){var args=[].slice.call(arguments,0);return pickBy("isAfter",args)}var now=function(){return Date.now?Date.now():+new Date};var ordering=["year","quarter","month","week","day","hour","minute","second","millisecond"];function isDurationValid(m){var key,unitHasDecimal=false,i;for(key in m){if(hasOwnProp(m,key)&&!(indexOf.call(ordering,key)!==-1&&(m[key]==null||!isNaN(m[key])))){return false}}for(i=0;i<ordering.length;++i){if(m[ordering[i]]){if(unitHasDecimal){return false}if(parseFloat(m[ordering[i]])!==toInt(m[ordering[i]])){unitHasDecimal=true}}}return true}function isValid$1(){return this._isValid}function createInvalid$1(){return createDuration(NaN)}function Duration(duration){var normalizedInput=normalizeObjectUnits(duration),years=normalizedInput.year||0,quarters=normalizedInput.quarter||0,months=normalizedInput.month||0,weeks=normalizedInput.week||normalizedInput.isoWeek||0,days=normalizedInput.day||0,hours=normalizedInput.hour||0,minutes=normalizedInput.minute||0,seconds=normalizedInput.second||0,milliseconds=normalizedInput.millisecond||0;this._isValid=isDurationValid(normalizedInput);this._milliseconds=+milliseconds+seconds*1e3+minutes*6e4+hours*1e3*60*60;this._days=+days+weeks*7;this._months=+months+quarters*3+years*12;this._data={};this._locale=getLocale();this._bubble()}function isDuration(obj){return obj instanceof Duration}function absRound(number){if(number<0){return Math.round(-1*number)*-1}else{return Math.round(number)}}function compareArrays(array1,array2,dontConvert){var len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0,i;for(i=0;i<len;i++){if(dontConvert&&array1[i]!==array2[i]||!dontConvert&&toInt(array1[i])!==toInt(array2[i])){diffs++}}return diffs+lengthDiff}function offset(token,separator){addFormatToken(token,0,0,function(){var offset=this.utcOffset(),sign="+";if(offset<0){offset=-offset;sign="-"}return sign+zeroFill(~~(offset/60),2)+separator+zeroFill(~~offset%60,2)})}offset("Z",":");offset("ZZ","");addRegexToken("Z",matchShortOffset);addRegexToken("ZZ",matchShortOffset);addParseToken(["Z","ZZ"],function(input,array,config){config._useUTC=true;config._tzm=offsetFromString(matchShortOffset,input)});var chunkOffset=/([\+\-]|\d\d)/gi;function offsetFromString(matcher,string){var matches=(string||"").match(matcher),chunk,parts,minutes;if(matches===null){return null}chunk=matches[matches.length-1]||[];parts=(chunk+"").match(chunkOffset)||["-",0,0];minutes=+(parts[1]*60)+toInt(parts[2]);return minutes===0?0:parts[0]==="+"?minutes:-minutes}function cloneWithOffset(input,model){var res,diff;if(model._isUTC){res=model.clone();diff=(isMoment(input)||isDate(input)?input.valueOf():createLocal(input).valueOf())-res.valueOf();res._d.setTime(res._d.valueOf()+diff);hooks.updateOffset(res,false);return res}else{return createLocal(input).local()}}function getDateOffset(m){return-Math.round(m._d.getTimezoneOffset())}hooks.updateOffset=function(){};function getSetOffset(input,keepLocalTime,keepMinutes){var offset=this._offset||0,localAdjust;if(!this.isValid()){return input!=null?this:NaN}if(input!=null){if(typeof input==="string"){input=offsetFromString(matchShortOffset,input);if(input===null){return this}}else if(Math.abs(input)<16&&!keepMinutes){input=input*60}if(!this._isUTC&&keepLocalTime){localAdjust=getDateOffset(this)}this._offset=input;this._isUTC=true;if(localAdjust!=null){this.add(localAdjust,"m")}if(offset!==input){if(!keepLocalTime||this._changeInProgress){addSubtract(this,createDuration(input-offset,"m"),1,false)}else if(!this._changeInProgress){this._changeInProgress=true;hooks.updateOffset(this,true);this._changeInProgress=null}}return this}else{return this._isUTC?offset:getDateOffset(this)}}function getSetZone(input,keepLocalTime){if(input!=null){if(typeof input!=="string"){input=-input}this.utcOffset(input,keepLocalTime);return this}else{return-this.utcOffset()}}function setOffsetToUTC(keepLocalTime){return this.utcOffset(0,keepLocalTime)}function setOffsetToLocal(keepLocalTime){if(this._isUTC){this.utcOffset(0,keepLocalTime);this._isUTC=false;if(keepLocalTime){this.subtract(getDateOffset(this),"m")}}return this}function setOffsetToParsedOffset(){if(this._tzm!=null){this.utcOffset(this._tzm,false,true)}else if(typeof this._i==="string"){var tZone=offsetFromString(matchOffset,this._i);if(tZone!=null){this.utcOffset(tZone)}else{this.utcOffset(0,true)}}return this}function hasAlignedHourOffset(input){if(!this.isValid()){return false}input=input?createLocal(input).utcOffset():0;return(this.utcOffset()-input)%60===0}function isDaylightSavingTime(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function isDaylightSavingTimeShifted(){if(!isUndefined(this._isDSTShifted)){return this._isDSTShifted}var c={},other;copyConfig(c,this);c=prepareConfig(c);if(c._a){other=c._isUTC?createUTC(c._a):createLocal(c._a);this._isDSTShifted=this.isValid()&&compareArrays(c._a,other.toArray())>0}else{this._isDSTShifted=false}return this._isDSTShifted}function isLocal(){return this.isValid()?!this._isUTC:false}function isUtcOffset(){return this.isValid()?this._isUTC:false}function isUtc(){return this.isValid()?this._isUTC&&this._offset===0:false}var aspNetRegex=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,isoRegex=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function createDuration(input,key){var duration=input,match=null,sign,ret,diffRes;if(isDuration(input)){duration={ms:input._milliseconds,d:input._days,M:input._months}}else if(isNumber(input)||!isNaN(+input)){duration={};if(key){duration[key]=+input}else{duration.milliseconds=+input}}else if(match=aspNetRegex.exec(input)){sign=match[1]==="-"?-1:1;duration={y:0,d:toInt(match[DATE])*sign,h:toInt(match[HOUR])*sign,m:toInt(match[MINUTE])*sign,s:toInt(match[SECOND])*sign,ms:toInt(absRound(match[MILLISECOND]*1e3))*sign}}else if(match=isoRegex.exec(input)){sign=match[1]==="-"?-1:1;duration={y:parseIso(match[2],sign),M:parseIso(match[3],sign),w:parseIso(match[4],sign),d:parseIso(match[5],sign),h:parseIso(match[6],sign),m:parseIso(match[7],sign),s:parseIso(match[8],sign)}}else if(duration==null){duration={}}else if(typeof duration==="object"&&("from"in duration||"to"in duration)){diffRes=momentsDifference(createLocal(duration.from),createLocal(duration.to));duration={};duration.ms=diffRes.milliseconds;duration.M=diffRes.months}ret=new Duration(duration);if(isDuration(input)&&hasOwnProp(input,"_locale")){ret._locale=input._locale}if(isDuration(input)&&hasOwnProp(input,"_isValid")){ret._isValid=input._isValid}return ret}createDuration.fn=Duration.prototype;createDuration.invalid=createInvalid$1;function parseIso(inp,sign){var res=inp&&parseFloat(inp.replace(",","."));return(isNaN(res)?0:res)*sign}function positiveMomentsDifference(base,other){var res={};res.months=other.month()-base.month()+(other.year()-base.year())*12;if(base.clone().add(res.months,"M").isAfter(other)){--res.months}res.milliseconds=+other-+base.clone().add(res.months,"M");return res}function momentsDifference(base,other){var res;if(!(base.isValid()&&other.isValid())){return{milliseconds:0,months:0}}other=cloneWithOffset(other,base);if(base.isBefore(other)){res=positiveMomentsDifference(base,other)}else{res=positiveMomentsDifference(other,base);res.milliseconds=-res.milliseconds;res.months=-res.months}return res}function createAdder(direction,name){return function(val,period){var dur,tmp;if(period!==null&&!isNaN(+period)){deprecateSimple(name,"moment()."+name+"(period, number) is deprecated. Please use moment()."+name+"(number, period). "+"See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info.");tmp=val;val=period;period=tmp}dur=createDuration(val,period);addSubtract(this,dur,direction);return this}}function addSubtract(mom,duration,isAdding,updateOffset){var milliseconds=duration._milliseconds,days=absRound(duration._days),months=absRound(duration._months);if(!mom.isValid()){return}updateOffset=updateOffset==null?true:updateOffset;if(months){setMonth(mom,get(mom,"Month")+months*isAdding)}if(days){set$1(mom,"Date",get(mom,"Date")+days*isAdding)}if(milliseconds){mom._d.setTime(mom._d.valueOf()+milliseconds*isAdding)}if(updateOffset){hooks.updateOffset(mom,days||months)}}var add=createAdder(1,"add"),subtract=createAdder(-1,"subtract");function isString(input){return typeof input==="string"||input instanceof String}function isMomentInput(input){return isMoment(input)||isDate(input)||isString(input)||isNumber(input)||isNumberOrStringArray(input)||isMomentInputObject(input)||input===null||input===undefined}function isMomentInputObject(input){var objectTest=isObject(input)&&!isObjectEmpty(input),propertyTest=false,properties=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,property;for(i=0;i<properties.length;i+=1){property=properties[i];propertyTest=propertyTest||hasOwnProp(input,property)}return objectTest&&propertyTest}function isNumberOrStringArray(input){var arrayTest=isArray(input),dataTypeTest=false;if(arrayTest){dataTypeTest=input.filter(function(item){return!isNumber(item)&&isString(input)}).length===0}return arrayTest&&dataTypeTest}function isCalendarSpec(input){var objectTest=isObject(input)&&!isObjectEmpty(input),propertyTest=false,properties=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,property;for(i=0;i<properties.length;i+=1){property=properties[i];propertyTest=propertyTest||hasOwnProp(input,property)}return objectTest&&propertyTest}function getCalendarFormat(myMoment,now){var diff=myMoment.diff(now,"days",true);return diff<-6?"sameElse":diff<-1?"lastWeek":diff<0?"lastDay":diff<1?"sameDay":diff<2?"nextDay":diff<7?"nextWeek":"sameElse"}function calendar$1(time,formats){if(arguments.length===1){if(!arguments[0]){time=undefined;formats=undefined}else if(isMomentInput(arguments[0])){time=arguments[0];formats=undefined}else if(isCalendarSpec(arguments[0])){formats=arguments[0];time=undefined}}var now=time||createLocal(),sod=cloneWithOffset(now,this).startOf("day"),format=hooks.calendarFormat(this,sod)||"sameElse",output=formats&&(isFunction(formats[format])?formats[format].call(this,now):formats[format]);return this.format(output||this.localeData().calendar(format,this,createLocal(now)))}function clone(){return new Moment(this)}function isAfter(input,units){var localInput=isMoment(input)?input:createLocal(input);if(!(this.isValid()&&localInput.isValid())){return false}units=normalizeUnits(units)||"millisecond";if(units==="millisecond"){return this.valueOf()>localInput.valueOf()}else{return localInput.valueOf()<this.clone().startOf(units).valueOf()}}function isBefore(input,units){var localInput=isMoment(input)?input:createLocal(input);if(!(this.isValid()&&localInput.isValid())){return false}units=normalizeUnits(units)||"millisecond";if(units==="millisecond"){return this.valueOf()<localInput.valueOf()}else{return this.clone().endOf(units).valueOf()<localInput.valueOf()}}function isBetween(from,to,units,inclusivity){var localFrom=isMoment(from)?from:createLocal(from),localTo=isMoment(to)?to:createLocal(to);if(!(this.isValid()&&localFrom.isValid()&&localTo.isValid())){return false}inclusivity=inclusivity||"()";return(inclusivity[0]==="("?this.isAfter(localFrom,units):!this.isBefore(localFrom,units))&&(inclusivity[1]===")"?this.isBefore(localTo,units):!this.isAfter(localTo,units))}function isSame(input,units){var localInput=isMoment(input)?input:createLocal(input),inputMs;if(!(this.isValid()&&localInput.isValid())){return false}units=normalizeUnits(units)||"millisecond";if(units==="millisecond"){return this.valueOf()===localInput.valueOf()}else{inputMs=localInput.valueOf();return this.clone().startOf(units).valueOf()<=inputMs&&inputMs<=this.clone().endOf(units).valueOf()}}function isSameOrAfter(input,units){return this.isSame(input,units)||this.isAfter(input,units)}function isSameOrBefore(input,units){return this.isSame(input,units)||this.isBefore(input,units)}function diff(input,units,asFloat){var that,zoneDelta,output;if(!this.isValid()){return NaN}that=cloneWithOffset(input,this);if(!that.isValid()){return NaN}zoneDelta=(that.utcOffset()-this.utcOffset())*6e4;units=normalizeUnits(units);switch(units){case"year":output=monthDiff(this,that)/12;break;case"month":output=monthDiff(this,that);break;case"quarter":output=monthDiff(this,that)/3;break;case"second":output=(this-that)/1e3;break;case"minute":output=(this-that)/6e4;break;case"hour":output=(this-that)/36e5;break;case"day":output=(this-that-zoneDelta)/864e5;break;case"week":output=(this-that-zoneDelta)/6048e5;break;default:output=this-that}return asFloat?output:absFloor(output)}function monthDiff(a,b){if(a.date()<b.date()){return-monthDiff(b,a)}var wholeMonthDiff=(b.year()-a.year())*12+(b.month()-a.month()),anchor=a.clone().add(wholeMonthDiff,"months"),anchor2,adjust;if(b-anchor<0){anchor2=a.clone().add(wholeMonthDiff-1,"months");adjust=(b-anchor)/(anchor-anchor2)}else{anchor2=a.clone().add(wholeMonthDiff+1,"months");adjust=(b-anchor)/(anchor2-anchor)}return-(wholeMonthDiff+adjust)||0}hooks.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";hooks.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function toString(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function toISOString(keepOffset){if(!this.isValid()){return null}var utc=keepOffset!==true,m=utc?this.clone().utc():this;if(m.year()<0||m.year()>9999){return formatMoment(m,utc?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ")}if(isFunction(Date.prototype.toISOString)){if(utc){return this.toDate().toISOString()}else{return new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",formatMoment(m,"Z"))}}return formatMoment(m,utc?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function inspect(){if(!this.isValid()){return"moment.invalid(/* "+this._i+" */)"}var func="moment",zone="",prefix,year,datetime,suffix;if(!this.isLocal()){func=this.utcOffset()===0?"moment.utc":"moment.parseZone";zone="Z"}prefix="["+func+'("]';year=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY";datetime="-MM-DD[T]HH:mm:ss.SSS";suffix=zone+'[")]';return this.format(prefix+year+datetime+suffix)}function format(inputString){if(!inputString){inputString=this.isUtc()?hooks.defaultFormatUtc:hooks.defaultFormat}var output=formatMoment(this,inputString);return this.localeData().postformat(output)}function from(time,withoutSuffix){if(this.isValid()&&(isMoment(time)&&time.isValid()||createLocal(time).isValid())){return createDuration({to:this,from:time}).locale(this.locale()).humanize(!withoutSuffix)}else{return this.localeData().invalidDate()}}function fromNow(withoutSuffix){return this.from(createLocal(),withoutSuffix)}function to(time,withoutSuffix){if(this.isValid()&&(isMoment(time)&&time.isValid()||createLocal(time).isValid())){return createDuration({from:this,to:time}).locale(this.locale()).humanize(!withoutSuffix)}else{return this.localeData().invalidDate()}}function toNow(withoutSuffix){return this.to(createLocal(),withoutSuffix)}function locale(key){var newLocaleData;if(key===undefined){return this._locale._abbr}else{newLocaleData=getLocale(key);if(newLocaleData!=null){this._locale=newLocaleData}return this}}var lang=deprecate("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(key){if(key===undefined){return this.localeData()}else{return this.locale(key)}});function localeData(){return this._locale}var MS_PER_SECOND=1e3,MS_PER_MINUTE=60*MS_PER_SECOND,MS_PER_HOUR=60*MS_PER_MINUTE,MS_PER_400_YEARS=(365*400+97)*24*MS_PER_HOUR;function mod$1(dividend,divisor){return(dividend%divisor+divisor)%divisor}function localStartOfDate(y,m,d){if(y<100&&y>=0){return new Date(y+400,m,d)-MS_PER_400_YEARS}else{return new Date(y,m,d).valueOf()}}function utcStartOfDate(y,m,d){if(y<100&&y>=0){return Date.UTC(y+400,m,d)-MS_PER_400_YEARS}else{return Date.UTC(y,m,d)}}function startOf(units){var time,startOfDate;units=normalizeUnits(units);if(units===undefined||units==="millisecond"||!this.isValid()){return this}startOfDate=this._isUTC?utcStartOfDate:localStartOfDate;switch(units){case"year":time=startOfDate(this.year(),0,1);break;case"quarter":time=startOfDate(this.year(),this.month()-this.month()%3,1);break;case"month":time=startOfDate(this.year(),this.month(),1);break;case"week":time=startOfDate(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":time=startOfDate(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":time=startOfDate(this.year(),this.month(),this.date());break;case"hour":time=this._d.valueOf();time-=mod$1(time+(this._isUTC?0:this.utcOffset()*MS_PER_MINUTE),MS_PER_HOUR);break;case"minute":time=this._d.valueOf();time-=mod$1(time,MS_PER_MINUTE);break;case"second":time=this._d.valueOf();time-=mod$1(time,MS_PER_SECOND);break}this._d.setTime(time);hooks.updateOffset(this,true);return this}function endOf(units){var time,startOfDate;units=normalizeUnits(units);if(units===undefined||units==="millisecond"||!this.isValid()){return this}startOfDate=this._isUTC?utcStartOfDate:localStartOfDate;switch(units){case"year":time=startOfDate(this.year()+1,0,1)-1;break;case"quarter":time=startOfDate(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":time=startOfDate(this.year(),this.month()+1,1)-1;break;case"week":time=startOfDate(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":time=startOfDate(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":time=startOfDate(this.year(),this.month(),this.date()+1)-1;break;case"hour":time=this._d.valueOf();time+=MS_PER_HOUR-mod$1(time+(this._isUTC?0:this.utcOffset()*MS_PER_MINUTE),MS_PER_HOUR)-1;break;case"minute":time=this._d.valueOf();time+=MS_PER_MINUTE-mod$1(time,MS_PER_MINUTE)-1;break;case"second":time=this._d.valueOf();time+=MS_PER_SECOND-mod$1(time,MS_PER_SECOND)-1;break}this._d.setTime(time);hooks.updateOffset(this,true);return this}function valueOf(){return this._d.valueOf()-(this._offset||0)*6e4}function unix(){return Math.floor(this.valueOf()/1e3)}function toDate(){return new Date(this.valueOf())}function toArray(){var m=this;return[m.year(),m.month(),m.date(),m.hour(),m.minute(),m.second(),m.millisecond()]}function toObject(){var m=this;return{years:m.year(),months:m.month(),date:m.date(),hours:m.hours(),minutes:m.minutes(),seconds:m.seconds(),milliseconds:m.milliseconds()}}function toJSON(){return this.isValid()?this.toISOString():null}function isValid$2(){return isValid(this)}function parsingFlags(){return extend({},getParsingFlags(this))}function invalidAt(){return getParsingFlags(this).overflow}function creationData(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}addFormatToken("N",0,0,"eraAbbr");addFormatToken("NN",0,0,"eraAbbr");addFormatToken("NNN",0,0,"eraAbbr");addFormatToken("NNNN",0,0,"eraName");addFormatToken("NNNNN",0,0,"eraNarrow");addFormatToken("y",["y",1],"yo","eraYear");addFormatToken("y",["yy",2],0,"eraYear");addFormatToken("y",["yyy",3],0,"eraYear");addFormatToken("y",["yyyy",4],0,"eraYear");addRegexToken("N",matchEraAbbr);addRegexToken("NN",matchEraAbbr);addRegexToken("NNN",matchEraAbbr);addRegexToken("NNNN",matchEraName);addRegexToken("NNNNN",matchEraNarrow);addParseToken(["N","NN","NNN","NNNN","NNNNN"],function(input,array,config,token){var era=config._locale.erasParse(input,token,config._strict);if(era){getParsingFlags(config).era=era}else{getParsingFlags(config).invalidEra=input}});addRegexToken("y",matchUnsigned);addRegexToken("yy",matchUnsigned);addRegexToken("yyy",matchUnsigned);addRegexToken("yyyy",matchUnsigned);addRegexToken("yo",matchEraYearOrdinal);addParseToken(["y","yy","yyy","yyyy"],YEAR);addParseToken(["yo"],function(input,array,config,token){var match;if(config._locale._eraYearOrdinalRegex){match=input.match(config._locale._eraYearOrdinalRegex)}if(config._locale.eraYearOrdinalParse){array[YEAR]=config._locale.eraYearOrdinalParse(input,match)}else{array[YEAR]=parseInt(input,10)}});function localeEras(m,format){var i,l,date,eras=this._eras||getLocale("en")._eras;for(i=0,l=eras.length;i<l;++i){switch(typeof eras[i].since){case"string":date=hooks(eras[i].since).startOf("day");eras[i].since=date.valueOf();break}switch(typeof eras[i].until){case"undefined":eras[i].until=+Infinity;break;case"string":date=hooks(eras[i].until).startOf("day").valueOf();eras[i].until=date.valueOf();break}}return eras}function localeErasParse(eraName,format,strict){var i,l,eras=this.eras(),name,abbr,narrow;eraName=eraName.toUpperCase();for(i=0,l=eras.length;i<l;++i){name=eras[i].name.toUpperCase();abbr=eras[i].abbr.toUpperCase();narrow=eras[i].narrow.toUpperCase();if(strict){switch(format){case"N":case"NN":case"NNN":if(abbr===eraName){return eras[i]}break;case"NNNN":if(name===eraName){return eras[i]}break;case"NNNNN":if(narrow===eraName){return eras[i]}break}}else if([name,abbr,narrow].indexOf(eraName)>=0){return eras[i]}}}function localeErasConvertYear(era,year){var dir=era.since<=era.until?+1:-1;if(year===undefined){return hooks(era.since).year()}else{return hooks(era.since).year()+(year-era.offset)*dir}}function getEraName(){var i,l,val,eras=this.localeData().eras();for(i=0,l=eras.length;i<l;++i){val=this.clone().startOf("day").valueOf();if(eras[i].since<=val&&val<=eras[i].until){return eras[i].name}if(eras[i].until<=val&&val<=eras[i].since){return eras[i].name}}return""}function getEraNarrow(){var i,l,val,eras=this.localeData().eras();for(i=0,l=eras.length;i<l;++i){val=this.clone().startOf("day").valueOf();if(eras[i].since<=val&&val<=eras[i].until){return eras[i].narrow}if(eras[i].until<=val&&val<=eras[i].since){return eras[i].narrow}}return""}function getEraAbbr(){var i,l,val,eras=this.localeData().eras();for(i=0,l=eras.length;i<l;++i){val=this.clone().startOf("day").valueOf();if(eras[i].since<=val&&val<=eras[i].until){return eras[i].abbr}if(eras[i].until<=val&&val<=eras[i].since){return eras[i].abbr}}return""}function getEraYear(){var i,l,dir,val,eras=this.localeData().eras();for(i=0,l=eras.length;i<l;++i){dir=eras[i].since<=eras[i].until?+1:-1;val=this.clone().startOf("day").valueOf();if(eras[i].since<=val&&val<=eras[i].until||eras[i].until<=val&&val<=eras[i].since){return(this.year()-hooks(eras[i].since).year())*dir+eras[i].offset}}return this.year()}function erasNameRegex(isStrict){if(!hasOwnProp(this,"_erasNameRegex")){computeErasParse.call(this)}return isStrict?this._erasNameRegex:this._erasRegex}function erasAbbrRegex(isStrict){if(!hasOwnProp(this,"_erasAbbrRegex")){computeErasParse.call(this)}return isStrict?this._erasAbbrRegex:this._erasRegex}function erasNarrowRegex(isStrict){if(!hasOwnProp(this,"_erasNarrowRegex")){computeErasParse.call(this)}return isStrict?this._erasNarrowRegex:this._erasRegex}function matchEraAbbr(isStrict,locale){return locale.erasAbbrRegex(isStrict)}function matchEraName(isStrict,locale){return locale.erasNameRegex(isStrict)}function matchEraNarrow(isStrict,locale){return locale.erasNarrowRegex(isStrict)}function matchEraYearOrdinal(isStrict,locale){return locale._eraYearOrdinalRegex||matchUnsigned}function computeErasParse(){var abbrPieces=[],namePieces=[],narrowPieces=[],mixedPieces=[],i,l,eras=this.eras();for(i=0,l=eras.length;i<l;++i){namePieces.push(regexEscape(eras[i].name));abbrPieces.push(regexEscape(eras[i].abbr));narrowPieces.push(regexEscape(eras[i].narrow));mixedPieces.push(regexEscape(eras[i].name));mixedPieces.push(regexEscape(eras[i].abbr));mixedPieces.push(regexEscape(eras[i].narrow))}this._erasRegex=new RegExp("^("+mixedPieces.join("|")+")","i");this._erasNameRegex=new RegExp("^("+namePieces.join("|")+")","i");this._erasAbbrRegex=new RegExp("^("+abbrPieces.join("|")+")","i");this._erasNarrowRegex=new RegExp("^("+narrowPieces.join("|")+")","i")}addFormatToken(0,["gg",2],0,function(){return this.weekYear()%100});addFormatToken(0,["GG",2],0,function(){return this.isoWeekYear()%100});function addWeekYearFormatToken(token,getter){addFormatToken(0,[token,token.length],0,getter)}addWeekYearFormatToken("gggg","weekYear");addWeekYearFormatToken("ggggg","weekYear");addWeekYearFormatToken("GGGG","isoWeekYear");addWeekYearFormatToken("GGGGG","isoWeekYear");addUnitAlias("weekYear","gg");addUnitAlias("isoWeekYear","GG");addUnitPriority("weekYear",1);addUnitPriority("isoWeekYear",1);addRegexToken("G",matchSigned);addRegexToken("g",matchSigned);addRegexToken("GG",match1to2,match2);addRegexToken("gg",match1to2,match2);addRegexToken("GGGG",match1to4,match4);addRegexToken("gggg",match1to4,match4);addRegexToken("GGGGG",match1to6,match6);addRegexToken("ggggg",match1to6,match6);addWeekParseToken(["gggg","ggggg","GGGG","GGGGG"],function(input,week,config,token){week[token.substr(0,2)]=toInt(input)});addWeekParseToken(["gg","GG"],function(input,week,config,token){week[token]=hooks.parseTwoDigitYear(input)});function getSetWeekYear(input){return getSetWeekYearHelper.call(this,input,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function getSetISOWeekYear(input){return getSetWeekYearHelper.call(this,input,this.isoWeek(),this.isoWeekday(),1,4)}function getISOWeeksInYear(){return weeksInYear(this.year(),1,4)}function getISOWeeksInISOWeekYear(){return weeksInYear(this.isoWeekYear(),1,4)}function getWeeksInYear(){var weekInfo=this.localeData()._week;return weeksInYear(this.year(),weekInfo.dow,weekInfo.doy)}function getWeeksInWeekYear(){var weekInfo=this.localeData()._week;return weeksInYear(this.weekYear(),weekInfo.dow,weekInfo.doy)}function getSetWeekYearHelper(input,week,weekday,dow,doy){var weeksTarget;if(input==null){return weekOfYear(this,dow,doy).year}else{weeksTarget=weeksInYear(input,dow,doy);if(week>weeksTarget){week=weeksTarget}return setWeekAll.call(this,input,week,weekday,dow,doy)}}function setWeekAll(weekYear,week,weekday,dow,doy){var dayOfYearData=dayOfYearFromWeeks(weekYear,week,weekday,dow,doy),date=createUTCDate(dayOfYearData.year,0,dayOfYearData.dayOfYear);this.year(date.getUTCFullYear());this.month(date.getUTCMonth());this.date(date.getUTCDate());return this}addFormatToken("Q",0,"Qo","quarter");addUnitAlias("quarter","Q");addUnitPriority("quarter",7);addRegexToken("Q",match1);addParseToken("Q",function(input,array){array[MONTH]=(toInt(input)-1)*3});function getSetQuarter(input){return input==null?Math.ceil((this.month()+1)/3):this.month((input-1)*3+this.month()%3)}addFormatToken("D",["DD",2],"Do","date");addUnitAlias("date","D");addUnitPriority("date",9);addRegexToken("D",match1to2);addRegexToken("DD",match1to2,match2);addRegexToken("Do",function(isStrict,locale){return isStrict?locale._dayOfMonthOrdinalParse||locale._ordinalParse:locale._dayOfMonthOrdinalParseLenient});addParseToken(["D","DD"],DATE);addParseToken("Do",function(input,array){array[DATE]=toInt(input.match(match1to2)[0])});var getSetDayOfMonth=makeGetSet("Date",true);addFormatToken("DDD",["DDDD",3],"DDDo","dayOfYear");addUnitAlias("dayOfYear","DDD");addUnitPriority("dayOfYear",4);addRegexToken("DDD",match1to3);addRegexToken("DDDD",match3);addParseToken(["DDD","DDDD"],function(input,array,config){config._dayOfYear=toInt(input)});function getSetDayOfYear(input){var dayOfYear=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return input==null?dayOfYear:this.add(input-dayOfYear,"d")}addFormatToken("m",["mm",2],0,"minute");addUnitAlias("minute","m");addUnitPriority("minute",14);addRegexToken("m",match1to2);addRegexToken("mm",match1to2,match2);addParseToken(["m","mm"],MINUTE);var getSetMinute=makeGetSet("Minutes",false);addFormatToken("s",["ss",2],0,"second");addUnitAlias("second","s");addUnitPriority("second",15);addRegexToken("s",match1to2);addRegexToken("ss",match1to2,match2);addParseToken(["s","ss"],SECOND);var getSetSecond=makeGetSet("Seconds",false);addFormatToken("S",0,0,function(){return~~(this.millisecond()/100)});addFormatToken(0,["SS",2],0,function(){return~~(this.millisecond()/10)});addFormatToken(0,["SSS",3],0,"millisecond");addFormatToken(0,["SSSS",4],0,function(){return this.millisecond()*10});addFormatToken(0,["SSSSS",5],0,function(){return this.millisecond()*100});addFormatToken(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});addFormatToken(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});addFormatToken(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});addFormatToken(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});addUnitAlias("millisecond","ms");addUnitPriority("millisecond",16);addRegexToken("S",match1to3,match1);addRegexToken("SS",match1to3,match2);addRegexToken("SSS",match1to3,match3);var token,getSetMillisecond;for(token="SSSS";token.length<=9;token+="S"){addRegexToken(token,matchUnsigned)}function parseMs(input,array){array[MILLISECOND]=toInt(("0."+input)*1e3)}for(token="S";token.length<=9;token+="S"){addParseToken(token,parseMs)}getSetMillisecond=makeGetSet("Milliseconds",false);addFormatToken("z",0,0,"zoneAbbr");addFormatToken("zz",0,0,"zoneName");function getZoneAbbr(){return this._isUTC?"UTC":""}function getZoneName(){return this._isUTC?"Coordinated Universal Time":""}var proto=Moment.prototype;proto.add=add;proto.calendar=calendar$1;proto.clone=clone;proto.diff=diff;proto.endOf=endOf;proto.format=format;proto.from=from;proto.fromNow=fromNow;proto.to=to;proto.toNow=toNow;proto.get=stringGet;proto.invalidAt=invalidAt;proto.isAfter=isAfter;proto.isBefore=isBefore;proto.isBetween=isBetween;proto.isSame=isSame;proto.isSameOrAfter=isSameOrAfter;proto.isSameOrBefore=isSameOrBefore;proto.isValid=isValid$2;proto.lang=lang;proto.locale=locale;proto.localeData=localeData;proto.max=prototypeMax;proto.min=prototypeMin;proto.parsingFlags=parsingFlags;proto.set=stringSet;proto.startOf=startOf;proto.subtract=subtract;proto.toArray=toArray;proto.toObject=toObject;proto.toDate=toDate;proto.toISOString=toISOString;proto.inspect=inspect;if(typeof Symbol!=="undefined"&&Symbol.for!=null){proto[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}}proto.toJSON=toJSON;proto.toString=toString;proto.unix=unix;proto.valueOf=valueOf;proto.creationData=creationData;proto.eraName=getEraName;proto.eraNarrow=getEraNarrow;proto.eraAbbr=getEraAbbr;proto.eraYear=getEraYear;proto.year=getSetYear;proto.isLeapYear=getIsLeapYear;proto.weekYear=getSetWeekYear;proto.isoWeekYear=getSetISOWeekYear;proto.quarter=proto.quarters=getSetQuarter;proto.month=getSetMonth;proto.daysInMonth=getDaysInMonth;proto.week=proto.weeks=getSetWeek;proto.isoWeek=proto.isoWeeks=getSetISOWeek;proto.weeksInYear=getWeeksInYear;proto.weeksInWeekYear=getWeeksInWeekYear;proto.isoWeeksInYear=getISOWeeksInYear;proto.isoWeeksInISOWeekYear=getISOWeeksInISOWeekYear;proto.date=getSetDayOfMonth;proto.day=proto.days=getSetDayOfWeek;proto.weekday=getSetLocaleDayOfWeek;proto.isoWeekday=getSetISODayOfWeek;proto.dayOfYear=getSetDayOfYear;proto.hour=proto.hours=getSetHour;proto.minute=proto.minutes=getSetMinute;proto.second=proto.seconds=getSetSecond;proto.millisecond=proto.milliseconds=getSetMillisecond;proto.utcOffset=getSetOffset;proto.utc=setOffsetToUTC;proto.local=setOffsetToLocal;proto.parseZone=setOffsetToParsedOffset;proto.hasAlignedHourOffset=hasAlignedHourOffset;proto.isDST=isDaylightSavingTime;proto.isLocal=isLocal;proto.isUtcOffset=isUtcOffset;proto.isUtc=isUtc;proto.isUTC=isUtc;proto.zoneAbbr=getZoneAbbr;proto.zoneName=getZoneName;proto.dates=deprecate("dates accessor is deprecated. Use date instead.",getSetDayOfMonth);proto.months=deprecate("months accessor is deprecated. Use month instead",getSetMonth);proto.years=deprecate("years accessor is deprecated. Use year instead",getSetYear);proto.zone=deprecate("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",getSetZone);proto.isDSTShifted=deprecate("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",isDaylightSavingTimeShifted);function createUnix(input){return createLocal(input*1e3)}function createInZone(){return createLocal.apply(null,arguments).parseZone()}function preParsePostFormat(string){return string}var proto$1=Locale.prototype;proto$1.calendar=calendar;proto$1.longDateFormat=longDateFormat;proto$1.invalidDate=invalidDate;proto$1.ordinal=ordinal;proto$1.preparse=preParsePostFormat;proto$1.postformat=preParsePostFormat;proto$1.relativeTime=relativeTime;proto$1.pastFuture=pastFuture;proto$1.set=set;proto$1.eras=localeEras;proto$1.erasParse=localeErasParse;proto$1.erasConvertYear=localeErasConvertYear;proto$1.erasAbbrRegex=erasAbbrRegex;proto$1.erasNameRegex=erasNameRegex;proto$1.erasNarrowRegex=erasNarrowRegex;proto$1.months=localeMonths;proto$1.monthsShort=localeMonthsShort;proto$1.monthsParse=localeMonthsParse;proto$1.monthsRegex=monthsRegex;proto$1.monthsShortRegex=monthsShortRegex;proto$1.week=localeWeek;proto$1.firstDayOfYear=localeFirstDayOfYear;proto$1.firstDayOfWeek=localeFirstDayOfWeek;proto$1.weekdays=localeWeekdays;proto$1.weekdaysMin=localeWeekdaysMin;proto$1.weekdaysShort=localeWeekdaysShort;proto$1.weekdaysParse=localeWeekdaysParse;proto$1.weekdaysRegex=weekdaysRegex;proto$1.weekdaysShortRegex=weekdaysShortRegex;proto$1.weekdaysMinRegex=weekdaysMinRegex;proto$1.isPM=localeIsPM;proto$1.meridiem=localeMeridiem;function get$1(format,index,field,setter){var locale=getLocale(),utc=createUTC().set(setter,index);return locale[field](utc,format)}function listMonthsImpl(format,index,field){if(isNumber(format)){index=format;format=undefined}format=format||"";if(index!=null){return get$1(format,index,field,"month")}var i,out=[];for(i=0;i<12;i++){out[i]=get$1(format,i,field,"month")}return out}function listWeekdaysImpl(localeSorted,format,index,field){if(typeof localeSorted==="boolean"){if(isNumber(format)){index=format;format=undefined}format=format||""}else{format=localeSorted;index=format;localeSorted=false;if(isNumber(format)){index=format;format=undefined}format=format||""}var locale=getLocale(),shift=localeSorted?locale._week.dow:0,i,out=[];if(index!=null){return get$1(format,(index+shift)%7,field,"day")}for(i=0;i<7;i++){out[i]=get$1(format,(i+shift)%7,field,"day")}return out}function listMonths(format,index){return listMonthsImpl(format,index,"months")}function listMonthsShort(format,index){return listMonthsImpl(format,index,"monthsShort")}function listWeekdays(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdays")}function listWeekdaysShort(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdaysShort")}function listWeekdaysMin(localeSorted,format,index){return listWeekdaysImpl(localeSorted,format,index,"weekdaysMin")}getSetGlobalLocale("en",{eras:[{since:"0001-01-01",until:+Infinity,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-Infinity,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(number){var b=number%10,output=toInt(number%100/10)===1?"th":b===1?"st":b===2?"nd":b===3?"rd":"th";return number+output}});hooks.lang=deprecate("moment.lang is deprecated. Use moment.locale instead.",getSetGlobalLocale);hooks.langData=deprecate("moment.langData is deprecated. Use moment.localeData instead.",getLocale);var mathAbs=Math.abs;function abs(){var data=this._data;this._milliseconds=mathAbs(this._milliseconds);this._days=mathAbs(this._days);this._months=mathAbs(this._months);data.milliseconds=mathAbs(data.milliseconds);data.seconds=mathAbs(data.seconds);data.minutes=mathAbs(data.minutes);data.hours=mathAbs(data.hours);data.months=mathAbs(data.months);data.years=mathAbs(data.years);return this}function addSubtract$1(duration,input,value,direction){var other=createDuration(input,value);duration._milliseconds+=direction*other._milliseconds;duration._days+=direction*other._days;duration._months+=direction*other._months;return duration._bubble()}function add$1(input,value){return addSubtract$1(this,input,value,1)}function subtract$1(input,value){return addSubtract$1(this,input,value,-1)}function absCeil(number){if(number<0){return Math.floor(number)}else{return Math.ceil(number)}}function bubble(){var milliseconds=this._milliseconds,days=this._days,months=this._months,data=this._data,seconds,minutes,hours,years,monthsFromDays;if(!(milliseconds>=0&&days>=0&&months>=0||milliseconds<=0&&days<=0&&months<=0)){milliseconds+=absCeil(monthsToDays(months)+days)*864e5;days=0;months=0}data.milliseconds=milliseconds%1e3;seconds=absFloor(milliseconds/1e3);data.seconds=seconds%60;minutes=absFloor(seconds/60);data.minutes=minutes%60;hours=absFloor(minutes/60);data.hours=hours%24;days+=absFloor(hours/24);monthsFromDays=absFloor(daysToMonths(days));months+=monthsFromDays;days-=absCeil(monthsToDays(monthsFromDays));years=absFloor(months/12);months%=12;data.days=days;data.months=months;data.years=years;return this}function daysToMonths(days){return days*4800/146097}function monthsToDays(months){return months*146097/4800}function as(units){if(!this.isValid()){return NaN}var days,months,milliseconds=this._milliseconds;units=normalizeUnits(units);if(units==="month"||units==="quarter"||units==="year"){days=this._days+milliseconds/864e5;months=this._months+daysToMonths(days);switch(units){case"month":return months;case"quarter":return months/3;case"year":return months/12}}else{days=this._days+Math.round(monthsToDays(this._months));switch(units){case"week":return days/7+milliseconds/6048e5;case"day":return days+milliseconds/864e5;case"hour":return days*24+milliseconds/36e5;case"minute":return days*1440+milliseconds/6e4;case"second":return days*86400+milliseconds/1e3;case"millisecond":return Math.floor(days*864e5)+milliseconds;default:throw new Error("Unknown unit "+units)}}}function valueOf$1(){if(!this.isValid()){return NaN}return this._milliseconds+this._days*864e5+this._months%12*2592e6+toInt(this._months/12)*31536e6}function makeAs(alias){return function(){return this.as(alias)}}var asMilliseconds=makeAs("ms"),asSeconds=makeAs("s"),asMinutes=makeAs("m"),asHours=makeAs("h"),asDays=makeAs("d"),asWeeks=makeAs("w"),asMonths=makeAs("M"),asQuarters=makeAs("Q"),asYears=makeAs("y");function clone$1(){return createDuration(this)}function get$2(units){units=normalizeUnits(units);return this.isValid()?this[units+"s"]():NaN}function makeGetter(name){return function(){return this.isValid()?this._data[name]:NaN}}var milliseconds=makeGetter("milliseconds"),seconds=makeGetter("seconds"),minutes=makeGetter("minutes"),hours=makeGetter("hours"),days=makeGetter("days"),months=makeGetter("months"),years=makeGetter("years");function weeks(){return absFloor(this.days()/7)}var round=Math.round,thresholds={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function substituteTimeAgo(string,number,withoutSuffix,isFuture,locale){return locale.relativeTime(number||1,!!withoutSuffix,string,isFuture)}function relativeTime$1(posNegDuration,withoutSuffix,thresholds,locale){var duration=createDuration(posNegDuration).abs(),seconds=round(duration.as("s")),minutes=round(duration.as("m")),hours=round(duration.as("h")),days=round(duration.as("d")),months=round(duration.as("M")),weeks=round(duration.as("w")),years=round(duration.as("y")),a=seconds<=thresholds.ss&&["s",seconds]||seconds<thresholds.s&&["ss",seconds]||minutes<=1&&["m"]||minutes<thresholds.m&&["mm",minutes]||hours<=1&&["h"]||hours<thresholds.h&&["hh",hours]||days<=1&&["d"]||days<thresholds.d&&["dd",days];if(thresholds.w!=null){a=a||weeks<=1&&["w"]||weeks<thresholds.w&&["ww",weeks]}a=a||months<=1&&["M"]||months<thresholds.M&&["MM",months]||years<=1&&["y"]||["yy",years];a[2]=withoutSuffix;a[3]=+posNegDuration>0;a[4]=locale;return substituteTimeAgo.apply(null,a)}function getSetRelativeTimeRounding(roundingFunction){if(roundingFunction===undefined){return round}if(typeof roundingFunction==="function"){round=roundingFunction;return true}return false}function getSetRelativeTimeThreshold(threshold,limit){if(thresholds[threshold]===undefined){return false}if(limit===undefined){return thresholds[threshold]}thresholds[threshold]=limit;if(threshold==="s"){thresholds.ss=limit-1}return true}function humanize(argWithSuffix,argThresholds){if(!this.isValid()){return this.localeData().invalidDate()}var withSuffix=false,th=thresholds,locale,output;if(typeof argWithSuffix==="object"){argThresholds=argWithSuffix;argWithSuffix=false}if(typeof argWithSuffix==="boolean"){withSuffix=argWithSuffix}if(typeof argThresholds==="object"){th=Object.assign({},thresholds,argThresholds);if(argThresholds.s!=null&&argThresholds.ss==null){th.ss=argThresholds.s-1}}locale=this.localeData();output=relativeTime$1(this,!withSuffix,th,locale);if(withSuffix){output=locale.pastFuture(+this,output)}return locale.postformat(output)}var abs$1=Math.abs;function sign(x){return(x>0)-(x<0)||+x}function toISOString$1(){if(!this.isValid()){return this.localeData().invalidDate()}var seconds=abs$1(this._milliseconds)/1e3,days=abs$1(this._days),months=abs$1(this._months),minutes,hours,years,s,total=this.asSeconds(),totalSign,ymSign,daysSign,hmsSign;if(!total){return"P0D"}minutes=absFloor(seconds/60);hours=absFloor(minutes/60);seconds%=60;minutes%=60;years=absFloor(months/12);months%=12;s=seconds?seconds.toFixed(3).replace(/\.?0+$/,""):"";totalSign=total<0?"-":"";ymSign=sign(this._months)!==sign(total)?"-":"";daysSign=sign(this._days)!==sign(total)?"-":"";hmsSign=sign(this._milliseconds)!==sign(total)?"-":"";return totalSign+"P"+(years?ymSign+years+"Y":"")+(months?ymSign+months+"M":"")+(days?daysSign+days+"D":"")+(hours||minutes||seconds?"T":"")+(hours?hmsSign+hours+"H":"")+(minutes?hmsSign+minutes+"M":"")+(seconds?hmsSign+s+"S":"")}var proto$2=Duration.prototype;proto$2.isValid=isValid$1;proto$2.abs=abs;proto$2.add=add$1;proto$2.subtract=subtract$1;proto$2.as=as;proto$2.asMilliseconds=asMilliseconds;proto$2.asSeconds=asSeconds;proto$2.asMinutes=asMinutes;proto$2.asHours=asHours;proto$2.asDays=asDays;proto$2.asWeeks=asWeeks;proto$2.asMonths=asMonths;proto$2.asQuarters=asQuarters;proto$2.asYears=asYears;proto$2.valueOf=valueOf$1;proto$2._bubble=bubble;proto$2.clone=clone$1;proto$2.get=get$2;proto$2.milliseconds=milliseconds;proto$2.seconds=seconds;proto$2.minutes=minutes;proto$2.hours=hours;proto$2.days=days;proto$2.weeks=weeks;proto$2.months=months;proto$2.years=years;proto$2.humanize=humanize;proto$2.toISOString=toISOString$1;proto$2.toString=toISOString$1;proto$2.toJSON=toISOString$1;proto$2.locale=locale;proto$2.localeData=localeData;proto$2.toIsoString=deprecate("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",toISOString$1);proto$2.lang=lang;addFormatToken("X",0,0,"unix");addFormatToken("x",0,0,"valueOf");addRegexToken("x",matchSigned);addRegexToken("X",matchTimestamp);addParseToken("X",function(input,array,config){config._d=new Date(parseFloat(input)*1e3)});addParseToken("x",function(input,array,config){config._d=new Date(toInt(input))});hooks.version="2.29.1";setHookCallback(createLocal);hooks.fn=proto;hooks.min=min;hooks.max=max;hooks.now=now;hooks.utc=createUTC;hooks.unix=createUnix;hooks.months=listMonths;hooks.isDate=isDate;hooks.locale=getSetGlobalLocale;hooks.invalid=createInvalid;hooks.duration=createDuration;hooks.isMoment=isMoment;hooks.weekdays=listWeekdays;hooks.parseZone=createInZone;hooks.localeData=getLocale;hooks.isDuration=isDuration;hooks.monthsShort=listMonthsShort;hooks.weekdaysMin=listWeekdaysMin;hooks.defineLocale=defineLocale;hooks.updateLocale=updateLocale;hooks.locales=listLocales;hooks.weekdaysShort=listWeekdaysShort;hooks.normalizeUnits=normalizeUnits;hooks.relativeTimeRounding=getSetRelativeTimeRounding;hooks.relativeTimeThreshold=getSetRelativeTimeThreshold;hooks.calendarFormat=getCalendarFormat;hooks.prototype=proto;hooks.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};return hooks})},{}],167:[function(require,module,exports){var hasMap=typeof Map==="function"&&Map.prototype;var mapSizeDescriptor=Object.getOwnPropertyDescriptor&&hasMap?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null;var mapSize=hasMap&&mapSizeDescriptor&&typeof mapSizeDescriptor.get==="function"?mapSizeDescriptor.get:null;var mapForEach=hasMap&&Map.prototype.forEach;var hasSet=typeof Set==="function"&&Set.prototype;var setSizeDescriptor=Object.getOwnPropertyDescriptor&&hasSet?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null;var setSize=hasSet&&setSizeDescriptor&&typeof setSizeDescriptor.get==="function"?setSizeDescriptor.get:null;var setForEach=hasSet&&Set.prototype.forEach;var hasWeakMap=typeof WeakMap==="function"&&WeakMap.prototype;var weakMapHas=hasWeakMap?WeakMap.prototype.has:null;var hasWeakSet=typeof WeakSet==="function"&&WeakSet.prototype;var weakSetHas=hasWeakSet?WeakSet.prototype.has:null;var hasWeakRef=typeof WeakRef==="function"&&WeakRef.prototype;var weakRefDeref=hasWeakRef?WeakRef.prototype.deref:null;var booleanValueOf=Boolean.prototype.valueOf;var objectToString=Object.prototype.toString;var functionToString=Function.prototype.toString;var match=String.prototype.match;var bigIntValueOf=typeof BigInt==="function"?BigInt.prototype.valueOf:null;var gOPS=Object.getOwnPropertySymbols;var symToString=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?Symbol.prototype.toString:null;var hasShammedSymbols=typeof Symbol==="function"&&typeof Symbol.iterator==="object";var isEnumerable=Object.prototype.propertyIsEnumerable;var gPO=(typeof Reflect==="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(O){return O.__proto__}:null);var inspectCustom=require("./util.inspect").custom;var inspectSymbol=inspectCustom&&isSymbol(inspectCustom)?inspectCustom:null;var toStringTag=typeof Symbol==="function"&&typeof Symbol.toStringTag!=="undefined"?Symbol.toStringTag:null;module.exports=function inspect_(obj,options,depth,seen){var opts=options||{};if(has(opts,"quoteStyle")&&(opts.quoteStyle!=="single"&&opts.quoteStyle!=="double")){throw new TypeError('option "quoteStyle" must be "single" or "double"')}if(has(opts,"maxStringLength")&&(typeof opts.maxStringLength==="number"?opts.maxStringLength<0&&opts.maxStringLength!==Infinity:opts.maxStringLength!==null)){throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`')}var customInspect=has(opts,"customInspect")?opts.customInspect:true;if(typeof customInspect!=="boolean"&&customInspect!=="symbol"){throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`")}if(has(opts,"indent")&&opts.indent!==null&&opts.indent!=="\t"&&!(parseInt(opts.indent,10)===opts.indent&&opts.indent>0)){throw new TypeError('options "indent" must be "\\t", an integer > 0, or `null`')}if(typeof obj==="undefined"){return"undefined"}if(obj===null){return"null"}if(typeof obj==="boolean"){return obj?"true":"false"}if(typeof obj==="string"){return inspectString(obj,opts)}if(typeof obj==="number"){if(obj===0){return Infinity/obj>0?"0":"-0"}return String(obj)}if(typeof obj==="bigint"){return String(obj)+"n"}var maxDepth=typeof opts.depth==="undefined"?5:opts.depth;if(typeof depth==="undefined"){depth=0}if(depth>=maxDepth&&maxDepth>0&&typeof obj==="object"){return isArray(obj)?"[Array]":"[Object]"}var indent=getIndent(opts,depth);if(typeof seen==="undefined"){seen=[]}else if(indexOf(seen,obj)>=0){return"[Circular]"}function inspect(value,from,noIndent){if(from){seen=seen.slice();seen.push(from)}if(noIndent){var newOpts={depth:opts.depth};if(has(opts,"quoteStyle")){newOpts.quoteStyle=opts.quoteStyle}return inspect_(value,newOpts,depth+1,seen)}return inspect_(value,opts,depth+1,seen)}if(typeof obj==="function"){var name=nameOf(obj);var keys=arrObjKeys(obj,inspect);return"[Function"+(name?": "+name:" (anonymous)")+"]"+(keys.length>0?" { "+keys.join(", ")+" }":"")}if(isSymbol(obj)){var symString=hasShammedSymbols?String(obj).replace(/^(Symbol\(.*\))_[^)]*$/,"$1"):symToString.call(obj);return typeof obj==="object"&&!hasShammedSymbols?markBoxed(symString):symString}if(isElement(obj)){var s="<"+String(obj.nodeName).toLowerCase();var attrs=obj.attributes||[];for(var i=0;i<attrs.length;i++){s+=" "+attrs[i].name+"="+wrapQuotes(quote(attrs[i].value),"double",opts)}s+=">";if(obj.childNodes&&obj.childNodes.length){s+="..."}s+="</"+String(obj.nodeName).toLowerCase()+">";return s}if(isArray(obj)){if(obj.length===0){return"[]"}var xs=arrObjKeys(obj,inspect);if(indent&&!singleLineValues(xs)){return"["+indentedJoin(xs,indent)+"]"}return"[ "+xs.join(", ")+" ]"}if(isError(obj)){var parts=arrObjKeys(obj,inspect);if(parts.length===0){return"["+String(obj)+"]"}return"{ ["+String(obj)+"] "+parts.join(", ")+" }"}if(typeof obj==="object"&&customInspect){if(inspectSymbol&&typeof obj[inspectSymbol]==="function"){return obj[inspectSymbol]()}else if(customInspect!=="symbol"&&typeof obj.inspect==="function"){return obj.inspect()}}if(isMap(obj)){var mapParts=[];mapForEach.call(obj,function(value,key){mapParts.push(inspect(key,obj,true)+" => "+inspect(value,obj))});return collectionOf("Map",mapSize.call(obj),mapParts,indent)}if(isSet(obj)){var setParts=[];setForEach.call(obj,function(value){setParts.push(inspect(value,obj))});return collectionOf("Set",setSize.call(obj),setParts,indent)}if(isWeakMap(obj)){return weakCollectionOf("WeakMap")}if(isWeakSet(obj)){return weakCollectionOf("WeakSet")}if(isWeakRef(obj)){return weakCollectionOf("WeakRef")}if(isNumber(obj)){return markBoxed(inspect(Number(obj)))}if(isBigInt(obj)){return markBoxed(inspect(bigIntValueOf.call(obj)))}if(isBoolean(obj)){return markBoxed(booleanValueOf.call(obj))}if(isString(obj)){return markBoxed(inspect(String(obj)))}if(!isDate(obj)&&!isRegExp(obj)){var ys=arrObjKeys(obj,inspect);var isPlainObject=gPO?gPO(obj)===Object.prototype:obj instanceof Object||obj.constructor===Object;var protoTag=obj instanceof Object?"":"null prototype";var stringTag=!isPlainObject&&toStringTag&&Object(obj)===obj&&toStringTag in obj?toStr(obj).slice(8,-1):protoTag?"Object":"";var constructorTag=isPlainObject||typeof obj.constructor!=="function"?"":obj.constructor.name?obj.constructor.name+" ":"";var tag=constructorTag+(stringTag||protoTag?"["+[].concat(stringTag||[],protoTag||[]).join(": ")+"] ":"");if(ys.length===0){return tag+"{}"}if(indent){return tag+"{"+indentedJoin(ys,indent)+"}"}return tag+"{ "+ys.join(", ")+" }"}return String(obj)};function wrapQuotes(s,defaultStyle,opts){var quoteChar=(opts.quoteStyle||defaultStyle)==="double"?'"':"'";return quoteChar+s+quoteChar}function quote(s){return String(s).replace(/"/g,"&quot;")}function isArray(obj){return toStr(obj)==="[object Array]"&&(!toStringTag||!(typeof obj==="object"&&toStringTag in obj))}function isDate(obj){return toStr(obj)==="[object Date]"&&(!toStringTag||!(typeof obj==="object"&&toStringTag in obj))}function isRegExp(obj){return toStr(obj)==="[object RegExp]"&&(!toStringTag||!(typeof obj==="object"&&toStringTag in obj))}function isError(obj){return toStr(obj)==="[object Error]"&&(!toStringTag||!(typeof obj==="object"&&toStringTag in obj))}function isString(obj){return toStr(obj)==="[object String]"&&(!toStringTag||!(typeof obj==="object"&&toStringTag in obj))}function isNumber(obj){return toStr(obj)==="[object Number]"&&(!toStringTag||!(typeof obj==="object"&&toStringTag in obj))}function isBoolean(obj){return toStr(obj)==="[object Boolean]"&&(!toStringTag||!(typeof obj==="object"&&toStringTag in obj))}function isSymbol(obj){if(hasShammedSymbols){return obj&&typeof obj==="object"&&obj instanceof Symbol}if(typeof obj==="symbol"){return true}if(!obj||typeof obj!=="object"||!symToString){return false}try{symToString.call(obj);return true}catch(e){}return false}function isBigInt(obj){if(!obj||typeof obj!=="object"||!bigIntValueOf){return false}try{bigIntValueOf.call(obj);return true}catch(e){}return false}var hasOwn=Object.prototype.hasOwnProperty||function(key){return key in this};function has(obj,key){return hasOwn.call(obj,key)}function toStr(obj){return objectToString.call(obj)}function nameOf(f){if(f.name){return f.name}var m=match.call(functionToString.call(f),/^function\s*([\w$]+)/);if(m){return m[1]}return null}function indexOf(xs,x){if(xs.indexOf){return xs.indexOf(x)}for(var i=0,l=xs.length;i<l;i++){if(xs[i]===x){return i}}return-1}function isMap(x){if(!mapSize||!x||typeof x!=="object"){return false}try{mapSize.call(x);try{setSize.call(x)}catch(s){return true}return x instanceof Map}catch(e){}return false}function isWeakMap(x){if(!weakMapHas||!x||typeof x!=="object"){return false}try{weakMapHas.call(x,weakMapHas);try{weakSetHas.call(x,weakSetHas)}catch(s){return true}return x instanceof WeakMap}catch(e){}return false}function isWeakRef(x){if(!weakRefDeref||!x||typeof x!=="object"){return false}try{weakRefDeref.call(x);return true}catch(e){}return false}function isSet(x){if(!setSize||!x||typeof x!=="object"){return false}try{setSize.call(x);try{mapSize.call(x)}catch(m){return true}return x instanceof Set}catch(e){}return false}function isWeakSet(x){if(!weakSetHas||!x||typeof x!=="object"){return false}try{weakSetHas.call(x,weakSetHas);try{weakMapHas.call(x,weakMapHas)}catch(s){return true}return x instanceof WeakSet}catch(e){}return false}function isElement(x){if(!x||typeof x!=="object"){return false}if(typeof HTMLElement!=="undefined"&&x instanceof HTMLElement){return true}return typeof x.nodeName==="string"&&typeof x.getAttribute==="function"}function inspectString(str,opts){if(str.length>opts.maxStringLength){var remaining=str.length-opts.maxStringLength;var trailer="... "+remaining+" more character"+(remaining>1?"s":"");return inspectString(str.slice(0,opts.maxStringLength),opts)+trailer}var s=str.replace(/(['\\])/g,"\\$1").replace(/[\x00-\x1f]/g,lowbyte);return wrapQuotes(s,"single",opts)}function lowbyte(c){var n=c.charCodeAt(0);var x={8:"b",9:"t",10:"n",12:"f",13:"r"}[n];if(x){return"\\"+x}return"\\x"+(n<16?"0":"")+n.toString(16).toUpperCase()}function markBoxed(str){return"Object("+str+")"}function weakCollectionOf(type){return type+" { ? }"}function collectionOf(type,size,entries,indent){var joinedEntries=indent?indentedJoin(entries,indent):entries.join(", ");return type+" ("+size+") {"+joinedEntries+"}"}function singleLineValues(xs){for(var i=0;i<xs.length;i++){if(indexOf(xs[i],"\n")>=0){return false}}return true}function getIndent(opts,depth){var baseIndent;if(opts.indent==="\t"){baseIndent="\t"}else if(typeof opts.indent==="number"&&opts.indent>0){baseIndent=Array(opts.indent+1).join(" ")}else{return null}return{base:baseIndent,prev:Array(depth+1).join(baseIndent)}}function indentedJoin(xs,indent){if(xs.length===0){return""}var lineJoiner="\n"+indent.prev+indent.base;return lineJoiner+xs.join(","+lineJoiner)+"\n"+indent.prev}function arrObjKeys(obj,inspect){var isArr=isArray(obj);var xs=[];if(isArr){xs.length=obj.length;for(var i=0;i<obj.length;i++){xs[i]=has(obj,i)?inspect(obj[i],obj):""}}var syms=typeof gOPS==="function"?gOPS(obj):[];var symMap;if(hasShammedSymbols){symMap={};for(var k=0;k<syms.length;k++){symMap["$"+syms[k]]=syms[k]}}for(var key in obj){if(!has(obj,key)){continue}if(isArr&&String(Number(key))===key&&key<obj.length){continue}if(hasShammedSymbols&&symMap["$"+key]instanceof Symbol){continue}else if(/[^\w$]/.test(key)){xs.push(inspect(key,obj)+": "+inspect(obj[key],obj))}else{xs.push(key+": "+inspect(obj[key],obj))}}if(typeof gOPS==="function"){for(var j=0;j<syms.length;j++){if(isEnumerable.call(obj,syms[j])){xs.push("["+inspect(syms[j])+"]: "+inspect(obj[syms[j]],obj))}}}return xs}},{"./util.inspect":157}],168:[function(require,module,exports){var process=module.exports={};var cachedSetTimeout;var cachedClearTimeout;function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){cachedSetTimeout=setTimeout}else{cachedSetTimeout=defaultSetTimout}}catch(e){cachedSetTimeout=defaultSetTimout}try{if(typeof clearTimeout==="function"){cachedClearTimeout=clearTimeout}else{cachedClearTimeout=defaultClearTimeout}}catch(e){cachedClearTimeout=defaultClearTimeout}})();function runTimeout(fun){if(cachedSetTimeout===setTimeout){return setTimeout(fun,0)}if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout){cachedSetTimeout=setTimeout;return setTimeout(fun,0)}try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}function runClearTimeout(marker){if(cachedClearTimeout===clearTimeout){return clearTimeout(marker)}if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout){cachedClearTimeout=clearTimeout;return clearTimeout(marker)}try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}var queue=[];var draining=false;var currentQueue;var queueIndex=-1;function cleanUpNextTick(){if(!draining||!currentQueue){return}draining=false;if(currentQueue.length){queue=currentQueue.concat(queue)}else{queueIndex=-1}if(queue.length){drainQueue()}}function drainQueue(){if(draining){return}var timeout=runTimeout(cleanUpNextTick);draining=true;var len=queue.length;while(len){currentQueue=queue;queue=[];while(++queueIndex<len){if(currentQueue){currentQueue[queueIndex].run()}}queueIndex=-1;len=queue.length}currentQueue=null;draining=false;runClearTimeout(timeout)}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1){for(var i=1;i<arguments.length;i++){args[i-1]=arguments[i]}}queue.push(new Item(fun,args));if(queue.length===1&&!draining){runTimeout(drainQueue)}};function Item(fun,array){this.fun=fun;this.array=array}Item.prototype.run=function(){this.fun.apply(null,this.array)};process.title="browser";process.browser=true;process.env={};process.argv=[];process.version="";process.versions={};function noop(){}process.on=noop;process.addListener=noop;process.once=noop;process.off=noop;process.removeListener=noop;process.removeAllListeners=noop;process.emit=noop;process.prependListener=noop;process.prependOnceListener=noop;process.listeners=function(name){return[]};process.binding=function(name){throw new Error("process.binding is not supported")};process.cwd=function(){return"/"};process.chdir=function(dir){throw new Error("process.chdir is not supported")};process.umask=function(){return 0}},{}],169:[function(require,module,exports){"use strict";var GetIntrinsic=require("get-intrinsic");var callBound=require("call-bind/callBound");var inspect=require("object-inspect");var $TypeError=GetIntrinsic("%TypeError%");var $WeakMap=GetIntrinsic("%WeakMap%",true);var $Map=GetIntrinsic("%Map%",true);var $weakMapGet=callBound("WeakMap.prototype.get",true);var $weakMapSet=callBound("WeakMap.prototype.set",true);var $weakMapHas=callBound("WeakMap.prototype.has",true);var $mapGet=callBound("Map.prototype.get",true);var $mapSet=callBound("Map.prototype.set",true);var $mapHas=callBound("Map.prototype.has",true);var listGetNode=function(list,key){for(var prev=list,curr;(curr=prev.next)!==null;prev=curr){if(curr.key===key){prev.next=curr.next;curr.next=list.next;list.next=curr;return curr}}};var listGet=function(objects,key){var node=listGetNode(objects,key);return node&&node.value};var listSet=function(objects,key,value){var node=listGetNode(objects,key);if(node){node.value=value}else{objects.next={key:key,next:objects.next,value:value}}};var listHas=function(objects,key){return!!listGetNode(objects,key)};module.exports=function getSideChannel(){var $wm;var $m;var $o;var channel={assert:function(key){if(!channel.has(key)){throw new $TypeError("Side channel does not contain "+inspect(key))}},get:function(key){if($WeakMap&&key&&(typeof key==="object"||typeof key==="function")){if($wm){return $weakMapGet($wm,key)}}else if($Map){if($m){return $mapGet($m,key)}}else{if($o){return listGet($o,key)}}},has:function(key){if($WeakMap&&key&&(typeof key==="object"||typeof key==="function")){if($wm){return $weakMapHas($wm,key)}}else if($Map){if($m){return $mapHas($m,key)}}else{if($o){return listHas($o,key)}}return false},set:function(key,value){if($WeakMap&&key&&(typeof key==="object"||typeof key==="function")){if(!$wm){$wm=new $WeakMap}$weakMapSet($wm,key,value)}else if($Map){if(!$m){$m=new $Map}$mapSet($m,key,value)}else{if(!$o){$o={key:{},next:null}}listSet($o,key,value)}}};return channel}},{"call-bind/callBound":158,"get-intrinsic":162,"object-inspect":167}],170:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.jobStatuses=exports.JOB_STATUS_ARCHIVED=exports.JOB_STATUS_ACTIVE=exports.JOB_STATUS_NEW=void 0;exports.JOB_STATUS_NEW="new";exports.JOB_STATUS_ACTIVE="active";exports.JOB_STATUS_ARCHIVED="archived";exports.jobStatuses=[exports.JOB_STATUS_NEW,exports.JOB_STATUS_ACTIVE,exports.JOB_STATUS_ARCHIVED]},{}],171:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.truncate=exports.timefromnow=exports.timestamp=void 0;var moment=require("moment");var timestamp=function(str){var stamp=moment(str);if(str===""||!stamp.isValid())return"";return stamp.format("MMMM Do YYYY")};exports.timestamp=timestamp;var timefromnow=function(str){var date=moment(str);if(str===""||!date.isValid())return"";return date.fromNow()};exports.timefromnow=timefromnow;var truncate=function(limit){return function(str){if(str===void 0){str=""}return str.length>limit?str.substr(0,limit)+"...":str}};exports.truncate=truncate},{moment:166}],172:[function(require,module,exports){"use strict";var __spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||arguments.length===2)for(var i=0,l=from.length,ar;i<l;i++){if(ar||!(i in from)){if(!ar)ar=Array.prototype.slice.call(from,0,i);ar[i]=from[i]}}return to.concat(ar||Array.prototype.slice.call(from))};Object.defineProperty(exports,"__esModule",{value:true});exports.JobFeaturesView=void 0;var __document=require("@quenk/wml/lib/dom");var maybe_1=require("@quenk/noni/lib/data/maybe");var filters_1=require("../../filters");var __if=function(__expr,__conseq,__alt){return __expr?__conseq():__alt?__alt():[]};var __forIn=function(list,f,alt){var ret=[];for(var i=0;i<list.length;i++)ret=ret.concat(f(list[i],i,list));return ret.length===0?alt():ret};var __forOf=function(o,f,alt){var ret=[];for(var key in o)if(o.hasOwnProperty(key))ret=ret.concat(f(o[key],key,o));return ret.length===0?alt():ret};var text=__document.text;var unsafe=__document.unsafe;var isSet=function(value){return value!=null};var JobFeaturesView=function(){function JobFeaturesView(__context){this.ids={};this.groups={};this.views=[];this.widgets=[];this.tree=__document.createElement("div");this.template=function(__this){return __this.node("div",{class:"board-job-features"},__spreadArray(__spreadArray(__spreadArray(__spreadArray([],__context.type!=null?function(){return[__this.node("span",{class:"ww-tag -default"},[text(__context.type)])]}():function(){return[]}(),true),__context.location!=null?function(){return[__this.node("span",{class:"ww-tag -default"},[text((0,filters_1.truncate)(60)(__context.location))])]}():function(){return[]}(),true),__context.remote!=null?function(){return[__this.node("span",{class:"ww-tag -default"},[__document.createTextNode("Remote")])]}():function(){return[]}(),true),__context.salary_range!=null?function(){return[__this.node("span",{class:"ww-tag -default"},[__document.createTextNode("$"),text(__context.salary_range)])]}():function(){return[]}(),true))}}JobFeaturesView.prototype.registerView=function(v){this.views.push(v);return v};JobFeaturesView.prototype.register=function(e,attrs){var attrsMap=attrs;if(attrsMap.wml){var _a=attrsMap.wml,id=_a.id,group=_a.group;if(id!=null){if(this.ids.hasOwnProperty(id))throw new Error("Duplicate id '"+id+"' detected!");this.ids[id]=e}if(group!=null){this.groups[group]=this.groups[group]||[];this.groups[group].push(e)}}return e};JobFeaturesView.prototype.node=function(tag,attrs,children){var e=__document.createElement(tag);Object.keys(attrs).forEach(function(key){var value=attrs[key];if(typeof value==="function"){e[key]=value}else if(typeof value==="string"){if(value!=="")e.setAttribute(key,value)}else if(typeof value==="boolean"){e.setAttribute(key,"")}else if(!__document.isBrowser&&value instanceof __document.WMLDOMText){e.setAttribute(key,value)}});children.forEach(function(c){switch(typeof c){case"string":case"number":case"boolean":var tn=__document.createTextNode(""+c);e.appendChild(tn);case"object":e.appendChild(c);break;default:throw new TypeError("Can not adopt child "+c+" of type "+typeof c)}});this.register(e,attrs);return e};JobFeaturesView.prototype.widget=function(w,attrs){this.register(w,attrs);this.widgets.push(w);return w.render()};JobFeaturesView.prototype.findById=function(id){var mW=(0,maybe_1.fromNullable)(this.ids[id]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findById(id)},mW)};JobFeaturesView.prototype.findByGroup=function(name){var mGroup=(0,maybe_1.fromArray)(this.groups.hasOwnProperty(name)?this.groups[name]:[]);return this.views.reduce(function(p,c){return p.isJust()?p:c.findByGroup(name)},mGroup)};JobFeaturesView.prototype.invalidate=function(){var tree=this.tree;var parent=tree.parentNode;if(tree==null)return console.warn("invalidate(): "+"Missing DOM tree!");if(tree.parentNode==null)throw new Error("invalidate(): cannot invalidate this view, it has no parent node!");parent.replaceChild(this.render(),tree)};JobFeaturesView.prototype.render=function(){this.ids={};this.widgets.forEach(function(w){return w.removed()});this.widgets=[];this.views=[];this.tree=this.template(this);this.ids["root"]=this.ids["root"]?this.ids["root"]:this.tree;this.widgets.forEach(function(w){return w.rendered()});return this.tree};return JobFeaturesView}();exports.JobFeaturesView=JobFeaturesView},{"../../filters":171,"@quenk/noni/lib/data/maybe":61,"@quenk/wml/lib/dom":155}]},{},[13]);
